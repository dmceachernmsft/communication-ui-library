(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1002:function(module,exports){},103:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return lightTheme})),__webpack_require__.d(__webpack_exports__,"a",(function(){return darkTheme}));var lightTheme={palette:{themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#59b0f7",themeDarker:"#004578",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},callingPalette:{callRed:"#a42e43",callRedDark:"#8b2c3d",callRedDarker:"#772a38",iconWhite:"#ffffff"}},darkTheme={palette:{themePrimary:"#2899f5",themeLighterAlt:"#02060a",themeLighter:"#061827",themeLight:"#0c2e49",themeTertiary:"#185b93",themeSecondary:"#2286d7",themeDarkAlt:"#3ca2f6",themeDark:"#59b0f7",themeDarker:"#84c5f9",neutralLighterAlt:"#302e2d",neutralLighter:"#383735",neutralLight:"#464443",neutralQuaternaryAlt:"#4e4d4b",neutralQuaternary:"#4d4b49",neutralTertiaryAlt:"#72706e",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#252423"},callingPalette:{callRed:"#c4314b",callRedDark:"#a42e43",callRedDarker:"#8b2c3d",iconWhite:"#ffffff"}}},1095:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(675)},116:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return compositeLocale}));var _azure_communication_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(80),compositeLocale=function compositeLocale(locale){if(""!==locale){var response=compositeLocales[locale];if(void 0===response)throw new Error("No locale found for key "+locale);return response}},compositeLocales={en_US:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_EN_US,en_GB:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_EN_GB,de_DE:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_DE_DE,es_ES:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_ES_ES,fr_FR:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_FR_FR,it_IT:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_IT_IT,ja_JP:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_JA_JP,ko_KR:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_KO_KR,nl_NL:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_NL_NL,pt_BR:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_PT_BR,ru_RU:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_RU_RU,tr_TR:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_TR_TR,zh_CN:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_ZH_CN,zh_TW:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_ZH_TW}},121:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return addParrotBotToThread})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ConfigHintBanner})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ConfigJoinChatThreadHintBanner})),__webpack_require__.d(__webpack_exports__,"d",(function(){return createThreadAndAddUser}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(576);var _azure_communication_chat__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(615),_azure_communication_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(253),_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__(1),__webpack_require__(191)),_constants__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(14),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var addParrotBotToThread=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(userToken,botId,botToken,endpointUrl,threadId,messages){var botIdentifier,chatClient;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return botIdentifier={communicationUserId:botId},chatClient=new _azure_communication_chat__WEBPACK_IMPORTED_MODULE_3__.a(endpointUrl,new _azure_communication_common__WEBPACK_IMPORTED_MODULE_4__.a(userToken)),_context.next=4,chatClient.getChatThreadClient(threadId).addParticipants({participants:[{id:botIdentifier,displayName:"A simple bot"}]});case 4:return sendMessagesAsBot(botToken,endpointUrl,threadId,messages),_context.abrupt("return",botIdentifier);case 6:case"end":return _context.stop()}}),_callee)})));return function addParrotBotToThread(_x,_x2,_x3,_x4,_x5,_x6){return _ref.apply(this,arguments)}}(),sendMessagesAsBot=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(token,envUrl,threadId,messages){var chatClient,threadClient,index;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return chatClient=new _azure_communication_chat__WEBPACK_IMPORTED_MODULE_3__.a(envUrl,new _azure_communication_common__WEBPACK_IMPORTED_MODULE_4__.a(token)),_context2.next=3,chatClient.getChatThreadClient(threadId);case 3:threadClient=_context2.sent,index=0,messages.length>0&&threadClient.sendMessage({content:messages[index++]}),setInterval((function(){index<messages.length&&threadClient.sendMessage({content:messages[index++]})}),5e3);case 7:case"end":return _context2.stop()}}),_callee2)})));return function sendMessagesAsBot(_x7,_x8,_x9,_x10){return _ref2.apply(this,arguments)}}(),ConfigHintBanner=function ConfigHintBanner(){var emptyConfigTips=Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("p",{children:["Please provide an"," ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("a",{href:_constants__WEBPACK_IMPORTED_MODULE_7__.e,target:"_blank",rel:"noreferrer",children:"access token, userId"})," ","for each participant, endpointUrl and display name to use."]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("p",{children:"A display name has already been set by default, but feel free to change it."})]});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_6__.b)([emptyConfigTips])})},ConfigJoinChatThreadHintBanner=function ConfigJoinChatThreadHintBanner(){var emptyConfigTips=Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("p",{children:["Please provide an"," ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("a",{href:_constants__WEBPACK_IMPORTED_MODULE_7__.e,target:"_blank",rel:"noreferrer",children:"access token, userId"}),", thread id, endpoint url, and display name to use."]});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_6__.b)([emptyConfigTips])})},createThreadAndAddUser=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(userId,token,endpointUrl,displayName){var _yield$chatClient$cre,_yield$chatClient$cre2,chatClient,user,threadId;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return chatClient=new _azure_communication_chat__WEBPACK_IMPORTED_MODULE_3__.a(endpointUrl,new _azure_communication_common__WEBPACK_IMPORTED_MODULE_4__.a(token)),user={communicationUserId:userId},_context3.next=4,chatClient.createChatThread({topic:"Chat with a friendly bot"},{participants:[{id:user,displayName:displayName}]});case 4:if(_context3.t2=_yield$chatClient$cre2=_context3.sent.chatThread,_context3.t1=null===_context3.t2,_context3.t1){_context3.next=8;break}_context3.t1=void 0===_yield$chatClient$cre2;case 8:if(!_context3.t1){_context3.next=12;break}_context3.t3=void 0,_context3.next=13;break;case 12:_context3.t3=_yield$chatClient$cre2.id;case 13:if(_context3.t4=_yield$chatClient$cre=_context3.t3,_context3.t0=null!==_context3.t4,!_context3.t0){_context3.next=17;break}_context3.t0=void 0!==_yield$chatClient$cre;case 17:if(!_context3.t0){_context3.next=21;break}_context3.t5=_yield$chatClient$cre,_context3.next=22;break;case 21:_context3.t5="";case 22:return threadId=_context3.t5,_context3.abrupt("return",{userId:user,token:token,endpointUrl:endpointUrl,displayName:displayName,threadId:threadId});case 24:case"end":return _context3.stop()}}),_callee3)})));return function createThreadAndAddUser(_x11,_x12,_x13,_x14){return _ref3.apply(this,arguments)}}();ConfigHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/Utils.tsx"]={name:"ConfigHintBanner",docgenInfo:ConfigHintBanner.__docgenInfo,path:"stories/ChatComposite/snippets/Utils.tsx"}),ConfigJoinChatThreadHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigJoinChatThreadHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/Utils.tsx"]={name:"ConfigJoinChatThreadHintBanner",docgenInfo:ConfigJoinChatThreadHintBanner.__docgenInfo,path:"stories/ChatComposite/snippets/Utils.tsx"})},127:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return groupCallLeaveButtonStyle})),__webpack_require__.d(__webpack_exports__,"d",(function(){return groupCallLeaveButtonCompressedStyle})),__webpack_require__.d(__webpack_exports__,"a",(function(){return buttonFlyoutIncreasedSizeStyles})),__webpack_require__.d(__webpack_exports__,"f",(function(){return participantButtonWithIncreasedTouchTargets})),__webpack_require__.d(__webpack_exports__,"c",(function(){return devicesButtonWithIncreasedTouchTargets})),__webpack_require__.d(__webpack_exports__,"b",(function(){return concatButtonBaseStyles}));__webpack_require__(125),__webpack_require__(70);var _fluentui_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(22),groupCallLeaveButtonStyle={root:{border:"0.125rem",borderRadius:2,height:"2.1875rem",width:"6.5625rem"},flexContainer:{flexFlow:"row"}},groupCallLeaveButtonCompressedStyle={root:{border:"0",borderRadius:"0.5rem"},flexContainer:{flexFlow:"row"}},buttonFlyoutIncreasedSizeStyles={root:{height:"3rem",lineHeight:"3rem",maxHeight:"unset"},linkContent:{height:"3rem",lineHeight:"3rem",maxHeight:"unset"},icon:{maxHeight:"unset"}},participantButtonWithIncreasedTouchTargets={menuStyles:{menuItemStyles:buttonFlyoutIncreasedSizeStyles,participantListStyles:{participantItemStyles:{root:{height:"3rem"},participantSubMenuItemsStyles:buttonFlyoutIncreasedSizeStyles}}}},devicesButtonWithIncreasedTouchTargets={menuStyles:{menuItemStyles:buttonFlyoutIncreasedSizeStyles}},controlButtonBaseStyle={label:{minWidth:"2.25rem"}},concatButtonBaseStyles=function concatButtonBaseStyles(){for(var result=controlButtonBaseStyle,_len=arguments.length,styles=new Array(_len),_key=0;_key<_len;_key++)styles[_key]=arguments[_key];return styles.forEach((function(style){result=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.r)(result,style)})),result}},134:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallAdapterProvider})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useAdapter}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),CallAdapterContext=Object(react__WEBPACK_IMPORTED_MODULE_0__.createContext)(void 0),CallAdapterProvider=function CallAdapterProvider(props){var adapter=props.adapter;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(CallAdapterContext.Provider,{value:adapter,children:props.children})};CallAdapterProvider.displayName="CallAdapterProvider";var useAdapter=function useAdapter(){var adapter=Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(CallAdapterContext);if(!adapter)throw"Cannot find adapter please initialize before usage.";return adapter};CallAdapterProvider.__docgenInfo={description:"@private",methods:[],displayName:"CallAdapterProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},adapter:{required:!0,tsType:{name:"CallAdapter"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/adapter/CallAdapterProvider.tsx"]={name:"CallAdapterProvider",docgenInfo:CallAdapterProvider.__docgenInfo,path:"../react-composites/src/composites/CallComposite/adapter/CallAdapterProvider.tsx"})},1352:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(675).configure)([__webpack_require__(1353),__webpack_require__(1463)],module,!1)}).call(this,__webpack_require__(413)(module))},1353:function(module,exports,__webpack_require__){var map={"./Adapters/Adapters.stories.mdx":1354,"./CallComposite/BasicExample.stories.tsx":1357,"./CallComposite/CustomDataModelExample.stories.tsx":1498,"./CallComposite/JoinExistingCall.stories.tsx":1369,"./CallComposite/ThemeExample.stories.tsx":1370,"./CallWithChatComposite/BasicExample.stories.tsx":1499,"./CallWithChatComposite/JoinExample.stories.tsx":1373,"./ChatComposite/BasicExample.stories.tsx":1374,"./ChatComposite/CustomBehavior.stories.tsx":1500,"./ChatComposite/CustomDataModelExample.stories.tsx":1501,"./ChatComposite/JoinExistingChatThread.stories.tsx":1378,"./ChatComposite/ThemesExample.stories.tsx":1379,"./ControlBar/Buttons/Camera/Camera.stories.tsx":1481,"./ControlBar/Buttons/ControlBarButton/ControlBarButton.stories.tsx":1488,"./ControlBar/Buttons/Devices/Devices.stories.tsx":1489,"./ControlBar/Buttons/EndCall/EndCall.stories.tsx":1490,"./ControlBar/Buttons/Microphone/Microphone.stories.tsx":1482,"./ControlBar/Buttons/Participants/Participants.stories.tsx":1476,"./ControlBar/Buttons/ScreenShare/ScreenShare.stories.tsx":1491,"./ControlBar/ControlBar.stories.tsx":1479,"./CustomIcons/Icons.stories.mdx":1502,"./ErrorBar/ErrorBar.stories.tsx":1503,"./Examples/DevicesDropdown/DeviceSettingsDropDown.stories.tsx":1504,"./Examples/IncomingCallAlerts/IncomingCallModal.stories.tsx":1414,"./Examples/IncomingCallAlerts/IncomingCallToast.stories.tsx":1415,"./Examples/LocalPreview/LocalPreview.stories.tsx":1505,"./Examples/TeamsInterop/ComplianceBanner.stories.tsx":1506,"./Examples/TeamsInterop/Lobby.stories.tsx":1507,"./Examples/Themes/TeamsTheme.stories.tsx":1508,"./GridLayout/GridLayout.stories.tsx":1509,"./MessageStatusIndicator/MessageStatusIndicator.stories.tsx":1510,"./MessageThread/MessageThread.stories.tsx":1474,"./NonReact/NonReactComposites.stories.mdx":1433,"./ParticipantItem/ParticipantItem.stories.tsx":1492,"./ParticipantList/ParticipantList.stories.tsx":1483,"./QuickStarts/QuickstartComposite.stories.mdx":1494,"./QuickStarts/QuickstartStatefulCall.stories.mdx":1484,"./QuickStarts/QuickstartStatefulChat.stories.mdx":1485,"./QuickStarts/QuickstartUIComponents.stories.mdx":1477,"./SendBox/SendBox.stories.tsx":1486,"./Stateful Client/BestPractices.stories.mdx":1445,"./Stateful Client/OverviewStateful.stories.mdx":1446,"./Stateful Client/SettingUpReactHooks.stories.mdx":1447,"./Stateful Client/UsePropsForHook.stories.mdx":1448,"./Stateful Client/UseSelector.stories.mdx":1449,"./Styling/Styling.stories.mdx":1495,"./TypingIndicator/TypingIndicator.stories.tsx":1493,"./VideoGallery/VideoGallery.stories.tsx":1475,"./VideoTile/VideoTile.stories.tsx":1496};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1353},1354:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_fluentui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(616),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var CallAdapterExampleText=__webpack_require__(1355).default,ChatAdapterExampleText=__webpack_require__(1356).default,layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"composite-adapters",title:"Composites/Adapters",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"adapters-for-composites"},"Adapters for Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Composites deliver turn-key communication experiences for developers.\nThey make it easy for developers to add end-to-end communication experiences to their apps with only a couple lines of code.\nTo power Composites, the UI library provides ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Adapters"),", one for the calling composite ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/composites-call-basicexample--basic-example"},"here")," and one for chat composite\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/composites-chat-basicexample--basic-example"},"here"),".\nThese adapters make use of the stateful clients for calling and chat in conjunction with React Hooks like usePropsFor to provide developers a single interface to configure Composites."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"setting-up-adapters"},"Setting Up Adapters"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To setup the adapters, you will need to provide the adapter with key metadata required.\nThis includes most importantly an access token for your Azure Communication Services resource and context information for the call or chat thread you want to join.\nTo create the adapters we will use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createAzureCommunicationCallAdapter")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createAzureCommunicationChatAdapter")," helper methods.\nThese methods are asynchronous so we will use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useEffect")," to create them."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"call-adapter"},"Call Adapter"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To initialize the call adapter, you will be required to provide a call locator with the information of the group or meeting you are trying to join.\nGroup Id for Azure Communication Services take the shape of GUID generated by the developer to identify a call inside their tenant.\nTeams Meeting information can be acquired through ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/graph/overview",target:"_blank",rel:"nofollow noopener noreferrer"},"Microsoft Graph"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.h,{code:CallAdapterExampleText,mdxType:"Source"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{mdxType:"MessageBar"},"Note: The `displayName` in Call Composite can be a maximum of 256 characters."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"chat-adapter"},"Chat Adapter"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To initialize the chat adapter, you will be required to provide an endpoint url for the Azure Communication Services resource on ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://portal.azure.com",target:"_blank",rel:"nofollow noopener noreferrer"},"Azure Portal"),".\nIn addition, you will need to provide a thread Id. Thread Id is provisioned from the Azure Communication Services by creating a new thread or adding the user to an existing thread.\nFor more information on thread Id, see our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts",target:"_blank",rel:"nofollow noopener noreferrer"},"documentation"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.h,{code:ChatAdapterExampleText,mdxType:"Source"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"using-adapters"},"Using Adapters"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Once initialized, adapters can be used to initialize Composites as well as to pragmatically take actions on the call or chat experience."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"initializing-composites-with-adapters"},"Initializing Composites with Adapters"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"With the initialized adapters, we can now hook them into the calling and chat composites."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-typescript"},"\nimport { CallComposite, ChatComposite} from '@azure/communication-react';\n\n<CallComposite adapter={callAdapter} />\n\n<ChatComposite adapter={chatAdapter} />\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"accessing-adapter-contents"},"Accessing Adapter Contents"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The adapters provide developers access to state, actions and events related to the underlying chat and calling SDKs.\nBelow are some examples that might be helpful, but additional methods are available."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h4",{id:"call-adapter-examples"},"Call Adapter Examples"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-typescript"},"\n//Access state and state changes, including CallClient and UI\ncallAdapter.onStateChange((state) => {\n  console.log(state.userId)\n})\ncallAdapter.getState().userId\ncallAdapter.getState().call\ncallAdapter.getState().devices\n\n//Access actions for the call\ncallAdapter.mute()\ncallAdapter.queryMicrophones()\ncallAdapter.startCamera()\n\n//Call events\ncallAdapter.on('participantsJoined, (event)=>{\n  event.joined.forEach((participant) => {\n    console.log(participant.displayName);\n  });\n})\ncallAdapter.on('callEnded, (event) => {\n  console.log(event.callId);\n})\ncallAdapter.on('error', (e: Error) => {\n  console.log(JSON.stringify(e))\n})\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h4",{id:"chat-adapter-examples"},"Chat Adapter Examples"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-typescript"},"\n//Access state and state changes, including ChatClient and UI\nchatAdapter.onStateChange((state) => {\n  console.log(state.userId)\n})\nchatAdapter.getState().thread\nchatAdapter.getState().userId\n\n//Access actions for the chat\nchatAdapter.sendMessage()\nchatAdapter.removeParticipants()\nchatAdapter.setTopic()\n\n//Chat events\nchatAdapter.on('messageReceived, (event) => {\n  console.log(event.message.content?.message);\n})\nchatAdapter.on('messageSent, (event) => {\n  console.log(event.message.content?.message);\n})\nchatAdapter.on('topicChanged', (event) => {\n  console.log(event.topic);\n})\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"interfaces"},"Interfaces"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"calladapter"},"CallAdapter"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Method"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Details"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Signature"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"onStateChange"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Subscribes the handler to stateChanged events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(handler: (state: ")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"#calladapterstate"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"CallAdapterState"))," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => void) => void"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"offStateChange"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Unsubscribes the handler to stateChanged events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(handler: (state: ")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"#calladapterstate"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"CallAdapterState"))," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => void) => void"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"getState"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Get the current State."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => ")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"#calladapterstate"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"CallAdapterState")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"dispose"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Dispose of the Composite."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => void"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"joinCall"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Join the call with microphone initially on/off."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(microphoneOn?: boolean ) => Call ")," ","|"," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"}," undefined")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"microphoneOn"),": Join call with microphone initially enabled.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"leaveCall"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Leave the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(forEveryone?: boolean) => Promise<void>")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"forEveryone"),": Whether to remove all participants when leaving")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"startCamera"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Start the camera This method will start rendering a local camera view when the call is not active."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(options?: ")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/videostreamoptions",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"VideoStreamOptions")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"}," ) => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"stopCamera"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Stop the camera This method will stop rendering a local camera view when the call is not active."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"mute"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Mute the current user during the call or disable microphone locally."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"unmute"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Unmute the current user during the call or enable microphone locally."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"startCall"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Start the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(participants: string[]) => Call ")," ","|"," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"}," undefined")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"participants"),": Array of participantIDs to join")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"startScreenShare"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Start sharing the screen during a call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"stopScreenShare"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Stop sharing the screen."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"removeParticipant"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Remove a participant from the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(userId: string) => Promise<void>")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"userId"),": Id of the participant to be removed")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"createStreamView"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Create the html view for a stream."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(remoteUserId?: string, options?: ")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/videostreamoptions",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"VideoStreamOptions")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => Promise<void>")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"remoteUserId"),": Id of the participant to render. Leave this ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"undefined")," to create the local camera view. ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"options"),": Options to control how video streams are rendered.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"disposeStreamView"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Dispose the html view for a stream."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(remoteUserId?: string, options?: ")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/videostreamoptions",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"VideoStreamOptions")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => Promise<void>")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"remoteUserId"),": Id of the participant to render. Leave this ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"undefined")," to dispose the local camera view. ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"options"),": Options to control how video streams are rendered.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"askDevicePermission"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Ask for permissions of devices."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(constrain: "),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/permissionconstraints",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"PermissionConstraints")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => Promise<void>")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),"Constrain what permissions are being asked for.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"queryCameras"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Query for available camera devices."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/videodeviceinfo",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"VideoDeviceInfo")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"[]>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"queryMicrophones"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Query for available microphone devices."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/audiodeviceinfo",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"AudioDeviceInfo")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"[]>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"querySpeakers"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Query for available microphone devices."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/audiodeviceinfo",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"AudioDeviceInfo")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"[]>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"setCamera"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Set the camera to use in the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(sourceInfo: "),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/videodeviceinfo",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"VideoDeviceInfo")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},", options?: ")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/videostreamoptions",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"VideoStreamOptions")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => Promise<void>")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"sourceInfo"),": Camera device to choose, pick one returned by ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"queryCameras"),". ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"options"),": Options to control how the camera stream is rendered.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"setMicrophone"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Set the microphone to use in the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(sourceInfo: "),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/audiodeviceinfo",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"AudioDeviceInfo")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => Promise<void>")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"sourceInfo"),": Camera device to choose, pick one returned by ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"queryMicrophones"),".")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"setSpeaker"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Set the speaker to use in the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(sourceInfo: "),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/audiodeviceinfo",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"AudioDeviceInfo")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => Promise<void>")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"sourceInfo"),": Camera device to choose, pick one returned by ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"querySpeakers"),".")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"on"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Subscribe to event.",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),"Events:",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"participantsJoined")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"participantsLeft")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"isMutedChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"callIdChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"isLocalScreenSharingActiveChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"displayNameChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"isSpeakingChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"callEnded")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"diagnosticChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"error")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'participantsJoined', listener: ParticipantsJoinedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'participantsLeft', listener: ParticipantsLeftListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'isMutedChanged', listener: IsMutedChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'callIdChanged', listener: CallIdChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'isLocalScreenSharingActiveChanged', listener: IsLocalScreenSharingActiveChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'displayNameChanged', listener: DisplayNameChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'isSpeakingChanged', listener: IsSpeakingChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'callEnded', listener: CallEndedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'diagnosticChanged', listener: DiagnosticChangedEventListner): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"on(event: 'error', listener: (e: AdapterError) => void): void"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"off"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Unsubscribe from event.",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),"Events:",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"participantsJoined")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"participantsLeft")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"isMutedChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"callIdChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"isLocalScreenSharingActiveChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"displayNameChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"isSpeakingChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"callEnded")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"diagnosticChanged")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"error")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'participantsJoined', listener: ParticipantsJoinedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'participantsLeft', listener: ParticipantsLeftListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'isMutedChanged', listener: IsMutedChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'callIdChanged', listener: CallIdChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'isLocalScreenSharingActiveChanged', listener: IsLocalScreenSharingActiveChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'displayNameChanged', listener: DisplayNameChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'isSpeakingChanged', listener: IsSpeakingChangedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'callEnded', listener: CallEndedListener): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'diagnosticChanged', listener: DiagnosticChangedEventListner): void")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null)," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"off(event: 'error', listener: (e: AdapterError) => void): void"))))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"calladapterstate"},"CallAdapterState"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Property"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Type"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"isLocalPreviewMicrophoneEnabled"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"boolean"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"page"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},'"accessDeniedTeamsMeeting"')," ","|"," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},'"call"')," ","|"," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},'"configuration"')," ","|"," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},'"joinCallFailedDueToNoNetwork"')," ","|"," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},'"leftCall"')," ","|"," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},'"lobby"')," ","|"," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},'"removedFromCall"'))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"userId"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"CommunicationIdentifierKind"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"displayName"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"string"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"call"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/callstate",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"CallState")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"devices"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"DeviceManagerState"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"endedCall"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"CallState"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"isTeamsCall"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"boolean"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"latestErrors"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"CallAdapterErrors")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),"Latest error encountered for each operation performed via the adapter.")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"chatadapter"},"ChatAdapter"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Method"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Details"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Signature"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"fetchInitialData"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Fetch initial state for the Chat adapter. Performs the minimal fetch necessary for ChatComposite and API methods."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"onStateChange"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Subscribes the handler to stateChanged events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(handler: (state: "),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"#chatadapterstate"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"ChatAdapterState")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => void) => void"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"offStateChange"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Unsubscribes the handler to stateChanged events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(handler: (state: "),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"#chatadapterstate"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"ChatAdapterState")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},") => void) => void"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"getState"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Get the current State"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => "),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"#chatadapterstate"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"ChatAdapterState")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"dispose"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Dispose of the Composite"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => void"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"sendMessage"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Send a message in the thread."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(content: string) => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"sendReadReceipt"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Send a read receipt for a message."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(chatMessageId: string) => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"sendTypingIndicator"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Send typing indicator in the thread."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"() => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"removeParticipant"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Remove a participant in the thread."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(userId: string) => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"setTopic"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Set the topic for the thread."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(topicName: string) => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"updateMessage"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Update a message content."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(messageId: string, content: string) => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"deleteMessage"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Delete a message in the thread."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(messageId: string) => Promise<void>"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"loadPreviousChatMessages"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Load more previous messages in the chat thread history."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"(messagesToLoad: number) => Promise<boolean>"))))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"chatadapterstate"},"ChatAdapterState"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Property"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Type"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"error"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"Error"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"userId"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationidentifierkind",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"CommunicationIdentifierKind")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"displayName"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"string"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"thread"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-chat/chatthreadclient",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"ChatThreadClientState")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"latestErrors"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"ChatAdapterErrors")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),"Latest error encountered for each operation performed via the adapter")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"functions"},"Functions"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"createazurecommunicationcalladapter"},"createAzureCommunicationCallAdapter"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-ts"},"async function createAzureCommunicationCallAdapter(args: AzureCommunicationCallAdapterArgs);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h4",{id:"azurecommunicationcalladapterargs"},"AzureCommunicationCallAdapterArgs"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Property"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Type"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"userId"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationuseridentifier",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"CommunicationUserIdentifier")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"displayName"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"string")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"td"},"DisplayName has a limit of of 256 characters."))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"credential"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"CommunicationTokenCredential")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"locator"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/groupcalllocator",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"GroupCallLocator"))," ","|"," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/teamsmeetinglinklocator",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"TeamsMeetingLinkLocator")))))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"createazurecommunicationchatadapter"},"createAzureCommunicationChatAdapter"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-ts"},"async function createAzureCommunicationCallAdapter(args: AzureCommunicationChatAdapterArgs);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h4",{id:"azurecommunicationchatadapterargs"},"AzureCommunicationChatAdapterArgs"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Property"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Type"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"userId"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationuseridentifier",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"CommunicationUserIdentifier")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"displayName"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"string")," ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("br",null),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"td"},"DisplayName has a limit of of 256 characters."))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"credential"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential",target:"_blank",rel:"nofollow noopener noreferrer"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"CommunicationTokenCredential")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"endpoint"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"string"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"td"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"strong"},"threadId"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"string"))))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Composites/Adapters",id:"composite-adapters",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1355:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  CallAdapter,\n  CallComposite,\n  createAzureCommunicationCallAdapter,\n  CallAdapterLocator\n} from '@azure/communication-react';\nimport React, { useState, useEffect } from 'react';\n\ntype CallAdapterExampleProps = {\n  userId: CommunicationUserIdentifier;\n  accessToken: string;\n  callLocator: CallAdapterLocator;\n  displayName: string;\n};\n\nexport const CallAdapterExample = (props: CallAdapterExampleProps): JSX.Element => {\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\n  useEffect(() => {\n    if (props) {\n      const createAdapter = async (): Promise<void> => {\n        setCallAdapter(\n          await createAzureCommunicationCallAdapter({\n            userId: props.userId,\n            displayName: props.displayName,\n            credential: new AzureCommunicationTokenCredential(props.accessToken),\n            locator: props.callLocator\n          })\n        );\n      };\n      createAdapter();\n    }\n    return () => {\n      if (callAdapter) {\n        callAdapter.dispose();\n      }\n    };\n  }, [props, callAdapter]);\n\n  return (\n    <div style={{ height: '100vh', width: '100vw' }}>\n      {callAdapter ? <CallComposite adapter={callAdapter} /> : <>Initializing</>}\n    </div>\n  );\n};\n"},1356:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport { ChatAdapter, ChatComposite, createAzureCommunicationChatAdapter } from '@azure/communication-react';\nimport React, { useState, useEffect } from 'react';\n\ntype ChatAdapterExampleProps = {\n  userId: CommunicationUserIdentifier;\n  accessToken: string;\n  endpointUrl: string;\n  threadId: string;\n  displayName: string;\n};\n\nexport const ChatAdapterExample = (props: ChatAdapterExampleProps): JSX.Element => {\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\n  useEffect(() => {\n    if (props) {\n      const createAdapter = async (): Promise<void> => {\n        setChatAdapter(\n          await createAzureCommunicationChatAdapter({\n            endpoint: props.endpointUrl,\n            userId: props.userId,\n            displayName: props.displayName,\n            credential: new AzureCommunicationTokenCredential(props.accessToken),\n            threadId: props.threadId\n          })\n        );\n      };\n      createAdapter();\n    }\n    return () => {\n      if (chatAdapter) {\n        chatAdapter.dispose();\n      }\n    };\n  }, [props, chatAdapter]);\n\n  return (\n    <div style={{ height: '100vh', width: '100vw' }}>\n      {chatAdapter ? <ChatComposite adapter={chatAdapter} /> : <>Initializing </>}\n    </div>\n  );\n};\n"},1357:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BasicExample",(function(){return BasicExample}));__webpack_require__(7),__webpack_require__(47);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(80),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(69),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1),uuid__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(897),_constants__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(14),_controlsUtils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(6),_localizationUtils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(116),_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(245),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(313),_snippets_Utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(246),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(2),BasicStory=function BasicStory(args,context){var locale=context.globals.locale,containerProps=Object(react__WEBPACK_IMPORTED_MODULE_4__.useMemo)((function(){if(args.userId&&args.token)return{userId:{communicationUserId:args.userId},token:args.token,locator:Object(uuid__WEBPACK_IMPORTED_MODULE_5__.a)()}}),[args.userId,args.token]);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_6__.h,children:containerProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_10__.a,Object.assign({fluentTheme:context.theme,displayName:args.displayName},containerProps,{callInvitationURL:args.callInvitationURL,locale:Object(_localizationUtils__WEBPACK_IMPORTED_MODULE_8__.a)(locale),formFactor:args.formFactor,options:{errorBar:args.errorBar}})):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_11__.a,{})})};BasicStory.displayName="BasicStory";var BasicExample=BasicStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_6__.b+"-call-basicexample",title:_constants__WEBPACK_IMPORTED_MODULE_6__.b+"/CallComposite/Basic Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.CallComposite,argTypes:Object.assign({userId:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.userId,token:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.token,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.displayName,formFactor:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.formFactor,callInvitationURL:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.callInvitationURL,errorBar:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.showErrorBar},_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.b),parameters:{docs:{page:function page(){return Object(_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_9__.a)()}}}},BasicExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const {\n    globals: { locale }\n  } = context;\n\n  const containerProps = useMemo(() => {\n    if (args.userId && args.token) {\n      const containerProps = {\n        userId: { communicationUserId: args.userId },\n        token: args.token,\n        locator: createGUID()\n      };\n      return containerProps;\n    }\n    return undefined;\n  }, [args.userId, args.token]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <ContosoCallContainer\n          fluentTheme={context.theme}\n          displayName={args.displayName}\n          {...containerProps}\n          callInvitationURL={args.callInvitationURL}\n          locale={compositeLocale(locale)}\n          formFactor={args.formFactor}\n          options={{ errorBar: args.errorBar }}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},BasicExample.parameters)},1367:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  CallAdapter,\n  CallComposite,\n  CallCompositeOptions,\n  CompositeLocale,\n  createAzureCommunicationCallAdapter\n} from '@azure/communication-react';\nimport { PartialTheme, Theme } from '@fluentui/react';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nexport type ContainerProps = {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  locator: string;\n  displayName: string;\n  formFactor?: 'desktop' | 'mobile';\n  fluentTheme?: PartialTheme | Theme;\n  callInvitationURL?: string;\n  locale?: CompositeLocale;\n  options?: CallCompositeOptions;\n};\n\nconst isTeamsMeetingLink = (link: string): boolean => link.startsWith('https://teams.microsoft.com/l/meetup-join');\n\nexport const ContosoCallContainer = (props: ContainerProps): JSX.Element => {\n  const [adapter, setAdapter] = useState<CallAdapter>();\n\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(props.token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [props.token]);\n\n  useEffect(() => {\n    (async () => {\n      if (!!credential && props.locator && props.displayName) {\n        const callLocator = isTeamsMeetingLink(props.locator)\n          ? { meetingLink: props.locator }\n          : { groupId: props.locator };\n        const createAdapter = async (credential: AzureCommunicationTokenCredential): Promise<void> => {\n          setAdapter(\n            await createAzureCommunicationCallAdapter({\n              userId: props.userId,\n              displayName: props.displayName, // Max 256 Characters\n              credential,\n              locator: callLocator\n            })\n          );\n        };\n        createAdapter(credential);\n      }\n    })();\n  }, [props, credential]);\n\n  useEffect(() => {\n    return () => {\n      (async () => {\n        if (!adapter) {\n          return;\n        }\n        await adapter.leaveCall().catch((e) => {\n          console.error('Failed to leave call', e);\n        });\n        adapter.dispose();\n      })();\n    };\n  }, [adapter]);\n\n  if (adapter) {\n    return (\n      <div style={{ height: '90vh', width: '90vw' }}>\n        <CallComposite\n          adapter={adapter}\n          formFactor={props.formFactor}\n          fluentTheme={props.fluentTheme}\n          callInvitationUrl={props?.callInvitationURL}\n          locale={props?.locale}\n          options={props?.options}\n        />\n      </div>\n    );\n  }\n  if (credential === undefined) {\n    return <>Failed to construct credential. Provided token is malformed.</>;\n  }\n  return <>Initializing...</>;\n};\n"},1368:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  AvatarPersonaData,\n  CallAdapter,\n  CallComposite,\n  CallCompositeOptions,\n  CompositeLocale,\n  createAzureCommunicationCallAdapter,\n  ParticipantMenuItemsCallback\n} from '@azure/communication-react';\nimport { IContextualMenuItem, PartialTheme, Theme } from '@fluentui/react';\nimport React, { useEffect, useState } from 'react';\n\nexport type ContainerProps = {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  locator: string;\n  displayName: string;\n  avatarInitials: string;\n  callInvitationURL?: string;\n  formFactor?: 'desktop' | 'mobile';\n  fluentTheme?: PartialTheme | Theme;\n  locale?: CompositeLocale;\n  options?: CallCompositeOptions;\n};\n\nexport const CustomDataModelExampleContainer = (props: ContainerProps): JSX.Element => {\n  const [adapter, setAdapter] = useState<CallAdapter>();\n\n  useEffect(() => {\n    if (props.token && props.locator) {\n      const callLocator = isTeamsMeetingLink(props.locator)\n        ? { meetingLink: props.locator }\n        : { groupId: props.locator };\n      const createAdapter = async (): Promise<void> => {\n        setAdapter(\n          await createAzureCommunicationCallAdapter({\n            userId: props.userId,\n            displayName: props.displayName,\n            credential: new AzureCommunicationTokenCredential(props.token),\n            locator: callLocator\n          })\n        );\n      };\n      createAdapter();\n    }\n  }, [props]);\n\n  useEffect(() => {\n    return () => {\n      (async () => {\n        if (!adapter) {\n          return;\n        }\n        await adapter.leaveCall().catch((e) => {\n          console.error('Failed to leave call', e);\n        });\n        adapter.dispose();\n      })();\n    };\n  }, [adapter]);\n\n  // Data model injection: Contoso provides custom initials for the user avatar.\n  //\n  // Note: Call Composite doesn't implement a memoization mechanism for this callback.\n  // It is recommended that Contoso memoize the `onFetchAvatarPersonaData` callback\n  // to avoid costly re-fetching of data.\n  // A 3rd Party utility such as Lodash (_.memoize) can be used to memoize the callback.\n  const onFetchAvatarPersonaData = async (/* userId: string */): Promise<AvatarPersonaData> => ({\n    text: props.avatarInitials ? props.avatarInitials : props.displayName\n  });\n\n  // Custom Menu Item Callback for Participant List\n  const onFetchParticipantMenuItems: ParticipantMenuItemsCallback = (participantId, userId, defaultMenuItems) => {\n    let customMenuItems: IContextualMenuItem[] = [\n      {\n        key: 'Custom Menu Item',\n        text: 'Custom Menu Item',\n        onClick: () => console.log('Custom Menu Item Clicked')\n      }\n    ];\n    if (defaultMenuItems) {\n      customMenuItems = customMenuItems.concat(defaultMenuItems);\n    }\n    return customMenuItems;\n  };\n\n  return (\n    <div style={{ height: '100vh', width: '100vw' }}>\n      {adapter && (\n        <CallComposite\n          fluentTheme={props.fluentTheme}\n          adapter={adapter}\n          onFetchAvatarPersonaData={onFetchAvatarPersonaData}\n          onFetchParticipantMenuItems={onFetchParticipantMenuItems}\n          callInvitationUrl={props?.callInvitationURL}\n          locale={props?.locale}\n          formFactor={props?.formFactor}\n          options={props?.options}\n        />\n      )}\n    </div>\n  );\n};\n\nconst isTeamsMeetingLink = (link: string): boolean => link.startsWith('https://teams.microsoft.com/l/meetup-join');\n"},1369:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"JoinExistingCall",(function(){return JoinExistingCall}));__webpack_require__(47),__webpack_require__(7);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(80),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(69),_constants__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__(1),__webpack_require__(14)),_controlsUtils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6),_localizationUtils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(116),_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(245),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(313),_snippets_Utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(246),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(2),JoinExistingCallStory=function JoinExistingCallStory(args,context){var locale=context.globals.locale,areAllKnobsSet=!!(args.callLocator&&args.userId&&args.token&&args.displayName);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_5__.h,children:areAllKnobsSet?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_9__.a,{fluentTheme:context.theme,locator:args.callLocator,userId:{communicationUserId:args.userId},token:args.token,displayName:args.displayName,callInvitationURL:args.callInvitationURL,locale:Object(_localizationUtils__WEBPACK_IMPORTED_MODULE_7__.a)(locale),formFactor:args.formFactor}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_10__.b,{})})};JoinExistingCallStory.displayName="JoinExistingCallStory";var JoinExistingCall=JoinExistingCallStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_5__.b+"-call-joinexistingcall",title:_constants__WEBPACK_IMPORTED_MODULE_5__.b+"/CallComposite/Join Existing Call",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.CallComposite,argTypes:Object.assign({userId:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.userId,token:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.token,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.displayName,callLocator:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.callLocator,formFactor:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.formFactor,callInvitationURL:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.callInvitationURL},_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.b),parameters:{docs:{page:function page(){return Object(_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_8__.a)()}}}},JoinExistingCall.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const {\n    globals: { locale }\n  } = context;\n  const areAllKnobsSet = !!args.callLocator && !!args.userId && !!args.token && !!args.displayName;\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {areAllKnobsSet ? (\n        <ContosoCallContainer\n          fluentTheme={context.theme}\n          locator={args.callLocator}\n          userId={{ communicationUserId: args.userId }}\n          token={args.token}\n          displayName={args.displayName}\n          callInvitationURL={args.callInvitationURL}\n          locale={compositeLocale(locale)}\n          formFactor={args.formFactor}\n        />\n      ) : (\n        <ConfigJoinCallHintBanner />\n      )}\n    </Stack>\n  );\n}'}},JoinExistingCall.parameters)},1370:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ThemeExample",(function(){return ThemeExample}));__webpack_require__(7),__webpack_require__(47);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(80),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(69),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1),uuid__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(897),_constants__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(14),_controlsUtils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(6),_localizationUtils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(116),_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(245),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(313),_snippets_Utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(246),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(2),ThemeExampleStory=function ThemeExampleStory(args,context){var _args$font,locale=context.globals.locale,containerProps=Object(react__WEBPACK_IMPORTED_MODULE_4__.useMemo)((function(){if(args.userId&&args.token)return{userId:args.userId,token:args.token,locator:Object(uuid__WEBPACK_IMPORTED_MODULE_5__.a)()}}),[args.userId,args.token]),theme=Object.assign({},Object(_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.i)(args.theme),{fonts:{},defaultFontStyle:{fontFamily:null!==(_args$font=args.font)&&void 0!==_args$font?_args$font:"Segoe UI"}});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_6__.h,children:containerProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_10__.a,Object.assign({displayName:args.displayName,fluentTheme:theme},containerProps,{callInvitationURL:args.callInvitationURL,locale:Object(_localizationUtils__WEBPACK_IMPORTED_MODULE_8__.a)(locale),formFactor:args.formFactor})):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_11__.a,{})})};ThemeExampleStory.displayName="ThemeExampleStory";var ThemeExample=ThemeExampleStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_6__.b+"-call-themeexample",title:_constants__WEBPACK_IMPORTED_MODULE_6__.b+"/CallComposite/Theme Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.CallComposite,argTypes:Object.assign({userId:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.userId,token:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.token,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.displayName,theme:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.theme,font:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.font,formFactor:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.formFactor,callInvitationURL:_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.a.callInvitationURL},_controlsUtils__WEBPACK_IMPORTED_MODULE_7__.b),parameters:{docs:{page:function page(){return Object(_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_9__.a)()}}}},ThemeExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const {\n    globals: { locale }\n  } = context;\n\n  const containerProps = useMemo(() => {\n    if (args.userId && args.token) {\n      const containerProps = {\n        userId: args.userId,\n        token: args.token,\n        locator: createGUID()\n      };\n      return containerProps;\n    }\n    return undefined;\n  }, [args.userId, args.token]);\n\n  const theme: PartialTheme = {\n    ...getControlledTheme(args.theme),\n    // The default themes exported by fluent samples, enforce Segoe UI using the `fonts` attribute in theme object.\n    // To override it, we need to set the `fonts` attribute to `undefined` in the theme object.\n    fonts: {},\n    defaultFontStyle: { fontFamily: args.font ?? \'Segoe UI\' }\n  };\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <ContosoCallContainer\n          displayName={args.displayName}\n          fluentTheme={theme}\n          {...containerProps}\n          callInvitationURL={args.callInvitationURL}\n          locale={compositeLocale(locale)}\n          formFactor={args.formFactor}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},ThemeExample.parameters)},1371:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TeamsMeetingLinkLocator } from '@azure/communication-calling';\nimport { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  CallAndChatLocator,\n  CallWithChatControlOptions,\n  CallWithChatAdapter,\n  CallWithChatComposite,\n  createAzureCommunicationCallWithChatAdapter\n} from '@azure/communication-react';\nimport { Theme, PartialTheme } from '@fluentui/react';\nimport React, { useState, useEffect, useMemo } from 'react';\n\nexport type CallWithChatExampleProps = {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  locator: TeamsMeetingLinkLocator | CallAndChatLocator;\n  fluentTheme?: PartialTheme | Theme;\n  callInvitationURL?: string;\n  callWithChatControlOptions?: boolean | CallWithChatControlOptions;\n};\n\nexport const CallWithChatExperience = (props: CallWithChatExampleProps): JSX.Element => {\n  const [callWithChatAdapter, setCallWithChatAdapter] = useState<CallWithChatAdapter>();\n\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(props.token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [props.token]);\n\n  useEffect(() => {\n    if (props && credential && props.locator && props.displayName && props.userId && props.endpointUrl) {\n      const createAdapters = async (): Promise<void> => {\n        setCallWithChatAdapter(\n          await createAzureCommunicationCallWithChatAdapter({\n            userId: props.userId,\n            displayName: props.displayName,\n            credential,\n            locator: props.locator,\n            endpoint: props.endpointUrl\n          })\n        );\n      };\n      createAdapters();\n    }\n  }, [credential, props]);\n\n  if (callWithChatAdapter) {\n    const options = { callControls: props.callWithChatControlOptions };\n    return (\n      <CallWithChatComposite\n        callWithChatAdapter={callWithChatAdapter}\n        fluentTheme={props.fluentTheme}\n        options={options}\n      />\n    );\n  }\n\n  if (credential === undefined) {\n    return <>Failed to construct credential. Provided token is malformed.</>;\n  }\n\n  return <>Initializing...</>;\n};\n"},1372:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Contoso server to create a new user and thread.\n\nimport { GroupCallLocator } from '@azure/communication-calling';\nimport { ChatClient, ChatParticipant } from '@azure/communication-chat';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport { v1 as createGUID } from 'uuid';\n\nconst createNewChatThread = async (chatClient: ChatClient, participants: ChatParticipant[]): Promise<string> => {\n  const chatThreadResponse = await chatClient.createChatThread(\n    { topic: 'Meeting with a friendly bot' },\n    { participants }\n  );\n  if (chatThreadResponse.invalidParticipants && chatThreadResponse.invalidParticipants.length > 0) {\n    throw 'Server could not add participants to the chat thread';\n  }\n\n  const chatThread = chatThreadResponse.chatThread;\n  if (!chatThread || !chatThread.id) {\n    throw 'Server could not create chat thread';\n  }\n\n  return chatThread.id;\n};\n\nexport const createCallWithChat = async (\n  token: string,\n  userId: string,\n  endpointUrl: string,\n  displayName: string\n): Promise<{ callLocator: GroupCallLocator; chatThreadId: string }> => {\n  const locator = { groupId: createGUID() };\n  const chatClient = new ChatClient(endpointUrl, new AzureCommunicationTokenCredential(token));\n  const threadId = await createNewChatThread(chatClient, [\n    { id: { communicationUserId: userId }, displayName: displayName }\n  ]);\n\n  return {\n    callLocator: locator,\n    chatThreadId: threadId\n  };\n};\n"},1373:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"JoinTeamsMeeting",(function(){return JoinTeamsMeeting}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(7),__webpack_require__(47),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(80),_fluentui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(69),react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1),_BetaBanners_SingleLineBetaBanner__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(201),_constants__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(14),_controlsUtils__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(6),_CallWithChatCompositeDocs__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(477),_snippets_CallWithChat_snippet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(479),_Utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(480),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var JoinTeamsMeeting=function JoinTeamsMeetingStory(args,context){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_16__.useState)(),2),meetingProps=_useState2[0],setMeetingProps=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_16__.useEffect)((function(){(function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:args.token&&args.userId&&args.endpointUrl&&args.displayName&&args.teamsMeetingLink?setMeetingProps({userId:{communicationUserId:args.userId},token:args.token,displayName:args.displayName,endpointUrl:args.endpointUrl,locator:{meetingLink:args.teamsMeetingLink}}):setMeetingProps(void 0);case 1:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.token,args.userId,args.endpointUrl,args.displayName,args.teamsMeetingLink]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_BetaBanners_SingleLineBetaBanner__WEBPACK_IMPORTED_MODULE_17__.a,{}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_15__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_18__.h,children:meetingProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_CallWithChat_snippet__WEBPACK_IMPORTED_MODULE_21__.a,Object.assign({fluentTheme:context.theme},meetingProps)):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_Utils__WEBPACK_IMPORTED_MODULE_22__.b,{})})]})}.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_18__.b+"-call-with-chat-jointeamsmeeting",title:_constants__WEBPACK_IMPORTED_MODULE_18__.b+"/CallWithChatComposite/Join Teams Meeting",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.CallWithChatComposite,argTypes:Object.assign({token:_controlsUtils__WEBPACK_IMPORTED_MODULE_19__.a.token,userId:_controlsUtils__WEBPACK_IMPORTED_MODULE_19__.a.userId,endpointUrl:_controlsUtils__WEBPACK_IMPORTED_MODULE_19__.a.endpointUrl,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_19__.a.displayName,teamsMeetingLink:_controlsUtils__WEBPACK_IMPORTED_MODULE_19__.a.teamsMeetingLink},_controlsUtils__WEBPACK_IMPORTED_MODULE_19__.c),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(_CallWithChatCompositeDocs__WEBPACK_IMPORTED_MODULE_20__.a)()}}}},JoinTeamsMeeting.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const [meetingProps, setMeetingProps] = useState<CallWithChatExampleProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (!!args.token && !!args.userId && !!args.endpointUrl && !!args.displayName && !!args.teamsMeetingLink) {\n        setMeetingProps({\n          userId: { communicationUserId: args.userId },\n          token: args.token,\n          displayName: args.displayName,\n          endpointUrl: args.endpointUrl,\n          locator: { meetingLink: args.teamsMeetingLink }\n        });\n      } else {\n        setMeetingProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.token, args.userId, args.endpointUrl, args.displayName, args.teamsMeetingLink]);\n\n  return (\n    <>\n      <FloatingSingleLineBetaBanner />\n      <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n        {meetingProps ? (\n          <CallWithChatExperience fluentTheme={context.theme} {...meetingProps} />\n        ) : (\n          <ConfigJoinMeetingHintBanner />\n        )}\n      </Stack>\n    </>\n  );\n}'}},JoinTeamsMeeting.parameters)},1374:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BasicExample",(function(){return BasicExample}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(7),__webpack_require__(47),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(80),_fluentui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(69),react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1),_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(14),_controlsUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(6),_localizationUtils__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(116),_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(202),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(314),_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(121),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var messageArray=["Hello ACS!","Congratulations! You can see this message because you successfully passed in a connection string!","In production environment, it is recommended to issue tokens in server side.","You can also issue a token by creating your own server and input them in required tab below.","Have fun!"],BasicStory=function BasicStory(args,context){var locale=context.globals.locale,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_16__.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_16__.useEffect)((function(){(function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(args.userId&&args.token&&args.botId&&args.botToken&&args.endpointUrl&&args.displayName)){_context.next=9;break}return _context.next=3,Object(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.d)(args.userId,args.token,args.endpointUrl,args.displayName);case 3:return newProps=_context.sent,_context.next=6,Object(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.c)(args.token,args.botId,args.botToken,args.endpointUrl,newProps.threadId,messageArray);case 6:setContainerProps(newProps),_context.next=10;break;case 9:setContainerProps(void 0);case 10:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.userId,args.token,args.botId,args.botToken,args.endpointUrl,args.displayName]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_15__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_17__.h,children:containerProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_21__.a,Object.assign({fluentTheme:context.theme},containerProps,{locale:Object(_localizationUtils__WEBPACK_IMPORTED_MODULE_19__.a)(locale),errorBar:args.showErrorBar,participants:args.showParticipants,topic:args.showTopic})):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.a,{})})};BasicStory.displayName="BasicStory";var BasicExample=BasicStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"-chat-basicexample",title:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"/ChatComposite/Basic Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.ChatComposite,argTypes:Object.assign({userId:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.userId,token:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.token,botId:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.botUserId,botToken:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.botToken,endpointUrl:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.endpointUrl,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.displayName,showErrorBar:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.showErrorBar,showParticipants:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.showChatParticipants,showTopic:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.showChatTopic},_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.d),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_20__.a)()}}}},BasicExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const {\n    globals: { locale }\n  } = context;\n  const [containerProps, setContainerProps] = useState<ChatCompositeSetupProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.userId && args.token && args.botId && args.botToken && args.endpointUrl && args.displayName) {\n        const newProps = await createThreadAndAddUser(args.userId, args.token, args.endpointUrl, args.displayName);\n        await addParrotBotToThread(\n          args.token,\n          args.botId,\n          args.botToken,\n          args.endpointUrl,\n          newProps.threadId,\n          messageArray\n        );\n        setContainerProps(newProps);\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.userId, args.token, args.botId, args.botToken, args.endpointUrl, args.displayName]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <ContosoChatContainer\n          fluentTheme={context.theme}\n          {...containerProps}\n          locale={compositeLocale(locale)}\n          errorBar={args.showErrorBar}\n          participants={args.showParticipants}\n          topic={args.showTopic}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},BasicExample.parameters)},1375:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  ChatAdapter,\n  ChatComposite,\n  CompositeLocale,\n  createAzureCommunicationChatAdapter\n} from '@azure/communication-react';\nimport { PartialTheme, Theme } from '@fluentui/react';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nexport type ContainerProps = {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  threadId: string;\n  fluentTheme?: PartialTheme | Theme;\n  errorBar?: boolean;\n  participants?: boolean;\n  topic?: boolean;\n  locale?: CompositeLocale;\n};\n\nexport const ContosoChatContainer = (props: ContainerProps): JSX.Element => {\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(props.token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [props.token]);\n\n  // Creating an adapter is asynchronous.\n  // An update to `config` triggers a new adapter creation, via the useEffect block.\n  // When the adapter becomes ready, the state update triggers a re-render of the ChatComposite.\n  const [adapter, setAdapter] = useState<ChatAdapter>();\n  useEffect(() => {\n    if (!!credential && props) {\n      const createAdapter = async (credential: AzureCommunicationTokenCredential): Promise<void> => {\n        setAdapter(\n          await createAzureCommunicationChatAdapter({\n            endpoint: props.endpointUrl,\n            userId: props.userId,\n            displayName: props.displayName,\n            credential,\n            threadId: props.threadId\n          })\n        );\n      };\n      createAdapter(credential);\n    }\n  }, [props, credential]);\n\n  if (adapter) {\n    return (\n      <div style={{ height: '90vh', width: '90vw' }}>\n        <ChatComposite\n          adapter={adapter}\n          fluentTheme={props.fluentTheme}\n          options={{\n            errorBar: props.errorBar,\n            participantPane: props.participants,\n            topic: props.topic\n          }}\n          locale={props.locale}\n        />\n      </div>\n    );\n  }\n  if (credential === undefined) {\n    return <>Failed to construct credential. Provided token is malformed.</>;\n  }\n  return <>Initializing...</>;\n};\n"},1376:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  AvatarPersonaData,\n  ChatAdapter,\n  ChatComposite,\n  CompositeLocale,\n  createAzureCommunicationChatAdapter,\n  ParticipantMenuItemsCallback\n} from '@azure/communication-react';\nimport { IContextualMenuItem, PartialTheme, Theme } from '@fluentui/react';\nimport React, { useState, useEffect } from 'react';\n\nexport interface CustomDataModelExampleContainerProps {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  threadId: string;\n  botUserId: string;\n  botAvatar: string;\n  fluentTheme?: PartialTheme | Theme;\n  locale?: CompositeLocale;\n}\n\nexport const CustomDataModelExampleContainer = (props: CustomDataModelExampleContainerProps): JSX.Element => {\n  // Creating an adapter is asynchronous.\n  // An update to `config` triggers a new adapter creation, via the useEffect block.\n  // When the adapter becomes ready, the state update triggers a re-render of the ChatComposite.\n  const [adapter, setAdapter] = useState<ChatAdapter>();\n  useEffect(() => {\n    if (props) {\n      const createAdapter = async (): Promise<void> => {\n        setAdapter(\n          await createAzureCommunicationChatAdapter({\n            endpoint: props.endpointUrl,\n            userId: props.userId,\n            // Data model injection: The display name for the local user comes from Contoso's data model.\n            displayName: props.displayName,\n            credential: new AzureCommunicationTokenCredential(props.token),\n            threadId: props.threadId\n          })\n        );\n      };\n      createAdapter();\n    }\n  }, [props]);\n\n  // Data model injection: Contoso provides avatars for the chat bot participant.\n  // Unlike the displayName example above, this sets the avatar for the remote bot participant.\n  //\n  // Note: Chat Composite doesn't implement a memoization mechanism for this callback.\n  // It is recommended that Contoso memoize the `onFetchAvatarPersonaData` callback\n  // to avoid costly re-fetching of data.\n  // A 3rd Party utility such as Lodash (_.memoize) can be used to memoize the callback.\n  const onFetchAvatarPersonaData = (userId): Promise<AvatarPersonaData> =>\n    new Promise((resolve) => {\n      if (userId === props.botUserId) {\n        return resolve({\n          imageInitials: props.botAvatar,\n          initialsColor: 'white'\n        });\n      }\n    });\n\n  // Custom Menu Item Callback for Participant List\n  const onFetchParticipantMenuItems: ParticipantMenuItemsCallback = (participantId, userId, defaultMenuItems) => {\n    console.log('Remote Participant', participantId);\n    console.log('Current Participant', userId);\n    let customMenuItems: IContextualMenuItem[] = [\n      {\n        key: 'Custom Menu Item',\n        text: 'Custom Menu Item',\n        onClick: () => console.log('Custom Menu Item Clicked')\n      }\n    ];\n    if (defaultMenuItems) {\n      customMenuItems = customMenuItems.concat(defaultMenuItems);\n    }\n    return customMenuItems;\n  };\n\n  return (\n    <div style={{ height: '100vh', width: '100vw' }}>\n      {adapter ? (\n        <ChatComposite\n          fluentTheme={props.fluentTheme}\n          adapter={adapter}\n          onFetchAvatarPersonaData={onFetchAvatarPersonaData}\n          onFetchParticipantMenuItems={onFetchParticipantMenuItems}\n          locale={props.locale}\n          options={{ participantPane: true }}\n        />\n      ) : (\n        <h3>Loading...</h3>\n      )}\n    </div>\n  );\n};\n"},1377:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  ChatAdapter,\n  ChatComposite,\n  CompositeLocale,\n  createAzureCommunicationChatAdapter\n} from '@azure/communication-react';\nimport React, { useState, useEffect } from 'react';\n\nexport type ContainerProps = {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  threadId: string;\n  locale?: CompositeLocale;\n};\n\nexport const ContosoChatContainer = (props: ContainerProps): JSX.Element => {\n  const [adapter, setAdapter] = useState<ChatAdapter>();\n\n  useEffect(() => {\n    if (!props) {\n      return;\n    }\n\n    const createAdapter = async (): Promise<void> => {\n      const chatAdapter = await createAzureCommunicationChatAdapter({\n        endpoint: props.endpointUrl,\n        userId: props.userId,\n        displayName: props.displayName,\n        credential: new AzureCommunicationTokenCredential(props.token),\n        threadId: props.threadId\n      });\n\n      // Custom behavior: Intercept messages from the local user and convert\n      // to uppercase before sending to backend.\n      const sendMessage = chatAdapter.sendMessage.bind(chatAdapter);\n      chatAdapter.sendMessage = async (content: string): Promise<void> => {\n        await sendMessage(content.toUpperCase());\n      };\n\n      setAdapter(chatAdapter);\n    };\n\n    createAdapter();\n  }, [props]);\n\n  return (\n    <>\n      {adapter ? (\n        <div style={{ height: '100vh', width: '100vw' }}>\n          <ChatComposite adapter={adapter} locale={props.locale} />\n        </div>\n      ) : (\n        <h3>Loading...</h3>\n      )}\n    </>\n  );\n};\n"},1378:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"JoinExistingChatThread",(function(){return JoinExistingChatThread}));__webpack_require__(47),__webpack_require__(7);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(80),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(69),_constants__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__(1),__webpack_require__(14)),_controlsUtils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6),_localizationUtils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(116),_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(202),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(314),_snippets_Utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(121),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(2),JoinExistingChatThreadStory=function JoinExistingChatThreadStory(args,context){var locale=context.globals.locale,areAllControlsSet=!!(args.endpointUrl&&args.threadId&&args.userId&&args.token&&args.displayName);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_5__.h,children:areAllControlsSet?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_9__.a,{fluentTheme:context.theme,endpointUrl:args.endpointUrl,threadId:args.threadId,userId:{communicationUserId:args.userId},token:args.token,displayName:args.displayName,locale:Object(_localizationUtils__WEBPACK_IMPORTED_MODULE_7__.a)(locale)}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_10__.b,{})})};JoinExistingChatThreadStory.displayName="JoinExistingChatThreadStory";var JoinExistingChatThread=JoinExistingChatThreadStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_5__.b+"-chat-joinexistingchatthread",title:_constants__WEBPACK_IMPORTED_MODULE_5__.b+"/ChatComposite/Join Existing Chat Thread",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.ChatComposite,argTypes:Object.assign({userId:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.userId,token:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.token,endpointUrl:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.endpointUrl,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.displayName,threadId:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.chatThreadId},_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.d),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_8__.a)()}}}},JoinExistingChatThread.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const {\n    globals: { locale }\n  } = context;\n  const areAllControlsSet =\n    !!args.endpointUrl && !!args.threadId && !!args.userId && !!args.token && !!args.displayName;\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {areAllControlsSet ? (\n        <ContosoChatContainer\n          fluentTheme={context.theme}\n          endpointUrl={args.endpointUrl}\n          threadId={args.threadId}\n          userId={{ communicationUserId: args.userId }}\n          token={args.token}\n          displayName={args.displayName}\n          locale={compositeLocale(locale)}\n        />\n      ) : (\n        <ConfigJoinChatThreadHintBanner />\n      )}\n    </Stack>\n  );\n}'}},JoinExistingChatThread.parameters)},1379:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ThemeExample",(function(){return ThemeExample}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(7),__webpack_require__(47),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(80),_fluentui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(69),react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1),_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(14),_controlsUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(6),_localizationUtils__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(116),_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(202),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(314),_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(121),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var messageArray=["Welcome to the theming example!","The ChatComposite can be themed with a Fluent UI theme, just like the base components.","Here, you can play around with some themes from the @fluentui/theme-samples package.","To build your own theme, we recommend using https://aka.ms/themedesigner","Have fun!"],ThemeStory=function ThemeStory(args,context){var _args$font,locale=context.globals.locale,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_16__.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];Object(react__WEBPACK_IMPORTED_MODULE_16__.useEffect)((function(){(function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(args.userId&&args.token&&args.botId&&args.botToken&&args.endpointUrl&&args.displayName)){_context.next=9;break}return _context.next=3,Object(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.d)(args.userId,args.token,args.endpointUrl,args.displayName);case 3:return newProps=_context.sent,_context.next=6,Object(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.c)(args.token,args.botId,args.botToken,args.endpointUrl,newProps.threadId,messageArray);case 6:setContainerProps(newProps),_context.next=10;break;case 9:setContainerProps(void 0);case 10:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.userId,args.token,args.botId,args.botToken,args.endpointUrl,args.displayName]);var theme=Object.assign({},Object(_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.i)(args.theme),{fonts:{},defaultFontStyle:{fontFamily:null!==(_args$font=args.font)&&void 0!==_args$font?_args$font:"Segoe UI"}});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_15__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_17__.h,children:containerProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_21__.a,Object.assign({},containerProps,{fluentTheme:theme,locale:Object(_localizationUtils__WEBPACK_IMPORTED_MODULE_19__.a)(locale)})):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.a,{})})};ThemeStory.displayName="ThemeStory";var ThemeExample=ThemeStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"-chat-themeexample",title:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"/ChatComposite/Theme Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.ChatComposite,argTypes:Object.assign({userId:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.userId,token:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.token,botId:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.botUserId,botToken:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.botToken,endpointUrl:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.endpointUrl,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.displayName,theme:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.theme,font:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.font},_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.d),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_20__.a)()}}}},ThemeExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const {\n    globals: { locale }\n  } = context;\n  const [containerProps, setContainerProps] = useState<ContainerProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.userId && args.token && args.botId && args.botToken && args.endpointUrl && args.displayName) {\n        const newProps = await createThreadAndAddUser(args.userId, args.token, args.endpointUrl, args.displayName);\n        await addParrotBotToThread(\n          args.token,\n          args.botId,\n          args.botToken,\n          args.endpointUrl,\n          newProps.threadId,\n          messageArray\n        );\n        setContainerProps(newProps);\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.userId, args.token, args.botId, args.botToken, args.endpointUrl, args.displayName]);\n\n  const theme: PartialTheme = {\n    ...getControlledTheme(args.theme),\n    // The default themes exported by fluent samples, enforce Segoe UI using the `fonts` attribute in theme object.\n    // To override it, we need to set the `fonts` attribute to `undefined` in the theme object.\n    fonts: {},\n    defaultFontStyle: { fontFamily: args.font ?? \'Segoe UI\' }\n  };\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <ContosoChatContainer {...containerProps} fluentTheme={theme} locale={compositeLocale(locale)} />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},ThemeExample.parameters)},1380:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomCameraButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'CameraIconKey'} iconName={'Camera'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon\n        key={'CameraIconKey'}\n        iconName={'Camera'}\n        style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }}\n      />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Label key={'CameraLabelKey'} style={{ fontStyle: 'italic' }}>\n          Turn off\n        </Label>\n      );\n    }\n\n    return <Label key={'CameraLabelKey'}>Turn on</Label>;\n  };\n\n  return (\n    <>\n      <CameraButton\n        key={'camera 1'}\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <CameraButton\n        key={'camera 2'}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n    </>\n  );\n};\n"},1381:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CameraButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <CameraButton key={'camBtn1'} checked={true} />\n      <CameraButton key={'camBtn2'} />\n    </FluentThemeProvider>\n  );\n};\n"},1382:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CameraButtonWithDevicesMenuExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <CameraButton\n        enableDeviceSelectionMenu\n        cameras={[\n          { id: 'camera1', name: 'Front Camera' },\n          { id: 'camera2', name: 'Back Camera' }\n        ]}\n        selectedCamera={{ id: 'camera1', name: 'Front Camera' }}\n        onClick={() => {\n          /* onClick is needed to enable clicking on left half */\n        }}\n        onSelectCamera={async () => {\n          /* onSelectCamera is needed to enable opening the device menu */\n        }}\n        styles={{\n          splitButtonContainer: {\n            // Add a border to better show the two halves of the button.\n            border: '1px solid'\n          }\n        }}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1383:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CameraButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <CameraButton showLabel={true} checked={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1384:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ControlBarButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label, Text } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomControlBarButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'customIcon1'} iconName={'Airplane'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon key={'customIcon2'} iconName={'Bus'} style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }} />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Text key={'customText'} style={{ fontStyle: 'italic' }}>\n          unmuted\n        </Text>\n      );\n    }\n\n    return <Label key={'customLabel'}>muted</Label>;\n  };\n\n  return (\n    <>\n      <ControlBarButton\n        key={'customBtn1'}\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <ControlBarButton\n        key={'customBtn2'}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n    </>\n  );\n};\n"},1385:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ControlBarButton } from '@azure/communication-react';\nimport { Airplane20Filled, VehicleShip20Filled } from '@fluentui/react-icons';\nimport React from 'react';\n\nexport const ControlBarButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ControlBarButton\n        key={'btn1'}\n        onRenderIcon={() => <Airplane20Filled key={'airplaneIconKey'} primaryFill=\"currentColor\" />}\n      />\n      <ControlBarButton\n        key={'btn1'}\n        onRenderIcon={() => <VehicleShip20Filled key={'shipIconKey'} primaryFill=\"currentColor\" />}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1386:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ControlBarButton } from '@azure/communication-react';\nimport { Airplane20Filled, VehicleShip20Filled } from '@fluentui/react-icons';\nimport React from 'react';\n\nexport const ControlBarButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ControlBarButton\n        key={'btn1'}\n        onRenderIcon={() => <Airplane20Filled key={'airplaneIconKey'} primaryFill=\"currentColor\" />}\n        strings={{ label: 'airplane' }}\n        labelKey={'airplaneButtonLabel'}\n        showLabel={true}\n      />\n      <ControlBarButton\n        key={'btn1'}\n        onRenderIcon={() => <VehicleShip20Filled key={'shipIconKey'} primaryFill=\"currentColor\" />}\n        strings={{ label: 'ship' }}\n        labelKey={'shipButtonLabel'}\n        showLabel={true}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1387:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { DevicesButton } from '@azure/communication-react';\nimport { Icon, IContextualMenuProps, Label } from '@fluentui/react';\nimport React from 'react';\n\nconst exampleOptionsMenuProps: IContextualMenuProps = {\n  items: [\n    {\n      key: '1',\n      name: 'Choose Camera',\n      iconProps: { iconName: 'Camera' },\n      onClick: () => alert('Choose Camera Menu Item Clicked!')\n    }\n  ]\n};\n\nexport const DevicesButtonCustomExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (): JSX.Element => {\n    return (\n      <Icon key={'optionsCustomIconKey'} iconName={'CircleAddition'} style={{ color: 'orange', fontSize: '20px' }} />\n    );\n  };\n\n  const customOnRenderText = (): JSX.Element => {\n    return (\n      <Label key={'optionsCustomLabelKey'} style={{ color: 'darkviolet', fontStyle: 'italic' }}>\n        More\n      </Label>\n    );\n  };\n\n  return (\n    <DevicesButton\n      key={'optionsCustomBtnKey'}\n      showLabel={true}\n      menuProps={exampleOptionsMenuProps}\n      onRenderIcon={customOnRenderIcon}\n      onRenderText={customOnRenderText}\n    />\n  );\n};\n"},1388:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, DevicesButton } from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nconst exampleOptionsMenuProps: IContextualMenuProps = {\n  items: [\n    {\n      key: '1',\n      name: 'Choose Camera',\n      iconProps: { iconName: 'LocationCircle' },\n      onClick: () => alert('Choose Camera Menu Item Clicked!')\n    }\n  ]\n};\n\nexport const DevicesButtonDefaultExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <DevicesButton menuProps={exampleOptionsMenuProps} />\n    </FluentThemeProvider>\n  );\n};\n"},1389:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, DevicesButton } from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nconst exampleOptionsMenuProps: IContextualMenuProps = {\n  items: [\n    {\n      key: '1',\n      name: 'Choose Camera',\n      iconProps: { iconName: 'LocationCircle' },\n      onClick: () => alert('Choose Camera Menu Item Clicked!')\n    }\n  ]\n};\n\nexport const DevicesButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <DevicesButton showLabel={true} menuProps={exampleOptionsMenuProps} />\n    </FluentThemeProvider>\n  );\n};\n"},1390:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { EndCallButton } from '@azure/communication-react';\nimport { Icon, Label } from '@fluentui/react';\nimport React from 'react';\n\nexport const EndCallButtonCustomExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (): JSX.Element => {\n    return <Icon key={'endCallCustomIconKey'} iconName={'DeclineCall'} style={{ color: 'black', fontSize: '25px' }} />;\n  };\n\n  const customOnRenderText = (/*props?: IButtonProps*/): JSX.Element => {\n    return (\n      <Label key={'endCallCustomLabelKey'} style={{ color: 'blue', fontStyle: 'italic' }}>\n        end call\n      </Label>\n    );\n  };\n\n  return (\n    <EndCallButton\n      style={{ background: 'cyan' }}\n      key={'endCallCustomBtnKey'}\n      showLabel={true}\n      onRenderIcon={customOnRenderIcon}\n      onRenderText={customOnRenderText}\n    />\n  );\n};\n"},1391:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { EndCallButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const EndCallButtonDefaultExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <EndCallButton />\n    </FluentThemeProvider>\n  );\n};\n"},1392:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { EndCallButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const EndCallButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <EndCallButton showLabel={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1393:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { MicrophoneButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label, Text } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomMicrophoneButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'micCustomIcon1'} iconName={'Microphone'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon\n        key={'micCustomIcon2'}\n        iconName={'Microphone'}\n        style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }}\n      />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Text key={'micCustomText'} style={{ fontStyle: 'italic' }}>\n          unmuted\n        </Text>\n      );\n    }\n\n    return <Label key={'micCustomLabel'}>muted</Label>;\n  };\n\n  return (\n    <>\n      <MicrophoneButton\n        key={'micCustomBtn1'}\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <MicrophoneButton\n        key={'micCustomBtn2'}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n    </>\n  );\n};\n"},1394:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MicrophoneButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const MicrophoneButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MicrophoneButton key={'micBtn1'} checked={true} />\n      <MicrophoneButton key={'micBtn2'} />\n    </FluentThemeProvider>\n  );\n};\n"},1395:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { MicrophoneButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const MicrophoneButtonWithDevicesMenuExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MicrophoneButton\n        onClick={() => {\n          /* onClick is needed to enable clicking on left half */\n        }}\n        enableDeviceSelectionMenu\n        speakers={[\n          { id: 'speaker1', name: 'Internal Speakers' },\n          { id: 'speaker2', name: 'Headphones' }\n        ]}\n        selectedSpeaker={{ id: 'speaker2', name: 'Headphones' }}\n        onSelectSpeaker={async () => {\n          /* onSelectSpeaker is needed to enable opening the device menu */\n        }}\n        microphones={[{ id: 'microphone1', name: 'Internal Microphone' }]}\n        selectedMicrophone={{ id: 'microphone1', name: 'Internal Microphone' }}\n        onSelectMicrophone={async () => {\n          /* onSelectMicrophone is needed to enable opening the device menu */\n        }}\n        styles={{\n          splitButtonContainer: {\n            // Add a border to better show the two halves of the button.\n            border: '1px solid'\n          }\n        }}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1396:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MicrophoneButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const MicrophoneButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MicrophoneButton showLabel={true} checked={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1397:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipantListParticipant, FluentThemeProvider, ParticipantsButton } from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: false\n  }\n];\n\nexport const ParticipantsButtonDefaultExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton participants={mockParticipants} />\n    </FluentThemeProvider>\n  );\n};\n"},1398:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipantListParticipant, FluentThemeProvider, ParticipantsButton } from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: false\n  }\n];\n\nconst mockCallLink = 'URL to invite new participants to the current call (https://...)';\n\nexport const ParticipantsButtonWithCallLinkExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton participants={mockParticipants} myUserId={'user1'} callInvitationURL={mockCallLink} />\n    </FluentThemeProvider>\n  );\n};\n"},1399:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipantListParticipant, FluentThemeProvider, ParticipantsButton } from '@azure/communication-react';\nimport { Icon, Label, Persona, PersonaSize } from '@fluentui/react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: false\n  }\n];\n\nconst customOnRenderAvatar = (userId?: string, options?): JSX.Element => {\n  if (userId === 'user2') {\n    return (\n      <img\n        key={`avatar${userId}`}\n        src=\"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif\"\n        style={{\n          borderRadius: '32px',\n          width: '32px',\n          position: 'relative',\n          margin: 'auto',\n          left: 0,\n          right: 0,\n          top: 0,\n          bottom: 0\n        }}\n      />\n    );\n  }\n\n  return <Persona text={options.displayName} hidePersonaDetails={true} size={PersonaSize.size32} />;\n};\n\nconst mockCallLink = 'URL to invite new participants to the current call (https://...)';\n\nconst onMuteAll = (): void => {\n  // your implementation to mute all participants\n};\n\nexport const ParticipantsButtonWithCustomRenderExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (): JSX.Element => {\n    return <Icon key={'participantsCustomIconKey'} iconName={'Group'} style={{ color: 'orange', fontSize: '20px' }} />;\n  };\n\n  const customOnRenderText = (): JSX.Element => {\n    return (\n      <Label key={'participantsCustomLabelKey'} style={{ color: 'darkviolet', fontStyle: 'italic' }}>\n        who is on this call\n      </Label>\n    );\n  };\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton\n        showLabel={true}\n        participants={mockParticipants}\n        myUserId={'user1'}\n        callInvitationURL={mockCallLink}\n        onMuteAll={onMuteAll}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n        onRenderAvatar={(userId?, options?) => customOnRenderAvatar(userId, options)}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},14:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"l",(function(){return mediaGalleryWidthOptions})),__webpack_require__.d(__webpack_exports__,"k",(function(){return mediaGalleryWidthDefault})),__webpack_require__.d(__webpack_exports__,"j",(function(){return mediaGalleryHeightOptions})),__webpack_require__.d(__webpack_exports__,"i",(function(){return mediaGalleryHeightDefault})),__webpack_require__.d(__webpack_exports__,"h",(function(){return compositeExperienceContainerStyle})),__webpack_require__.d(__webpack_exports__,"m",(function(){return overviewPageImagesStackStyle})),__webpack_require__.d(__webpack_exports__,"a",(function(){return COMPONENT_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"b",(function(){return COMPOSITE_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"d",(function(){return EXAMPLES_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"c",(function(){return CONCEPTS_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"g",(function(){return STATEFUL_CLIENT_PREFIX})),__webpack_require__.d(__webpack_exports__,"f",(function(){return MICROSOFT_AZURE_PREVIEWS_URL})),__webpack_require__.d(__webpack_exports__,"e",(function(){return MICROSOFT_AZURE_ACCESS_TOKEN_QUICKSTART}));var mediaGalleryWidthOptions={range:!0,min:500,max:1e3,step:10},mediaGalleryWidthDefault=600,mediaGalleryHeightOptions={range:!0,min:500,max:1e3,step:10},mediaGalleryHeightDefault=500,compositeExperienceContainerStyle={root:{width:"90vw",height:"90vh"}},overviewPageImagesStackStyle={backgroundColor:"#EFF6FC",padding:"2.25rem"},COMPONENT_FOLDER_PREFIX="UI Components",COMPOSITE_FOLDER_PREFIX="Composites",EXAMPLES_FOLDER_PREFIX="Examples",CONCEPTS_FOLDER_PREFIX="Concepts",STATEFUL_CLIENT_PREFIX="Stateful Client",MICROSOFT_AZURE_PREVIEWS_URL="https://azure.microsoft.com/support/legal/preview-supplemental-terms/",MICROSOFT_AZURE_ACCESS_TOKEN_QUICKSTART="https://docs.microsoft.com/en-us/azure/communication-services/quickstarts/identity/quick-create-identity"},1400:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipantListParticipant,\n  FluentThemeProvider,\n  ParticipantsButton,\n  ParticipantsButtonStyles\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: false\n  }\n];\n\nconst mockCallLink = 'URL to invite new participants to the current call (https://...)';\n\nconst onMuteAll = (): void => {\n  // your implementation to mute all participants\n};\n\nconst mockStyles: ParticipantsButtonStyles = {\n  root: { background: 'blue', color: 'white' },\n  rootHovered: { background: 'crimson', color: 'white' },\n  rootExpanded: { background: 'dimgrey', color: 'white' },\n  label: { color: 'white', fontStyle: 'italic' },\n  menuStyles: {\n    participantListStyles: { root: { border: 'solid 1px red' } }\n  }\n};\n\nexport const ParticipantsButtonWithCustomStylesExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton\n        showLabel={true}\n        participants={mockParticipants}\n        myUserId={'user1'}\n        callInvitationURL={mockCallLink}\n        onMuteAll={onMuteAll}\n        styles={mockStyles}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1401:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipantListParticipant, FluentThemeProvider, ParticipantsButton } from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: false\n  }\n];\n\nexport const ParticipantsButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton showLabel={true} participants={mockParticipants} />\n    </FluentThemeProvider>\n  );\n};\n"},1402:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipantListParticipant, FluentThemeProvider, ParticipantsButton } from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: false\n  }\n];\n\nconst mockCallLink = 'URL to invite new participants to the current call (https://...)';\n\nconst onMuteAll = (): void => {\n  // your implementation to mute all participants\n};\n\nexport const ParticipantsButtonWithMuteAllOptionExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton\n        participants={mockParticipants}\n        myUserId={'user1'}\n        callInvitationURL={mockCallLink}\n        onMuteAll={onMuteAll}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1403:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipantListParticipant, FluentThemeProvider, ParticipantsButton } from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: false\n  }\n];\n\nexport const ParticipantsButtonWithUserExcludeFromListExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton participants={mockParticipants} myUserId={'user1'} excludeMe={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1404:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ScreenShareButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomScreenShareButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'screenShareIconKey'} iconName={'Presentation'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon\n        key={'screenShareIconKey'}\n        iconName={'Presentation'}\n        style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }}\n      />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Label key={'screenShareLabelKey'} style={{ fontStyle: 'italic' }}>\n          sharing screen\n        </Label>\n      );\n    }\n\n    return <Label key={'screenShareLabelKey'}>not sharing screen</Label>;\n  };\n\n  return (\n    <>\n      <ScreenShareButton\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <ScreenShareButton showLabel={true} onRenderIcon={customOnRenderIcon} onRenderText={customOnRenderText} />\n    </>\n  );\n};\n"},1405:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ScreenShareButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const ScreenShareButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ScreenShareButton key={'micBtn1'} checked={true} />\n      <ScreenShareButton key={'micBtn2'} />\n    </FluentThemeProvider>\n  );\n};\n"},1406:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ScreenShareButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const ScreenShareButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ScreenShareButton showLabel={true} checked={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1407:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipantListParticipant,\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  DevicesButton,\n  ParticipantsButton,\n  ScreenShareButton\n} from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: false\n  }\n];\n\nexport const AllButtonsControlBarExample: () => JSX.Element = () => {\n  const exampleOptionsMenuProps: IContextualMenuProps = {\n    items: [\n      {\n        key: '1',\n        name: 'Choose Camera',\n        iconProps: { iconName: 'LocationCircle' },\n        onClick: () => alert('Choose Camera Menu Item Clicked!')\n      }\n    ]\n  };\n  const onMuteAll = (): void => {\n    // your implementation to mute all participants\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'}>\n        <CameraButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <MicrophoneButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <ScreenShareButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <ParticipantsButton\n          participants={mockParticipants}\n          myUserId={'user1'}\n          callInvitationURL={'URL to copy'}\n          onMuteAll={onMuteAll}\n        />\n        <DevicesButton menuProps={exampleOptionsMenuProps} />\n        <EndCallButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1408:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  DevicesButton,\n  ParticipantsButton,\n  ScreenShareButton\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst componentMainDivStyle = {\n  display: 'flex',\n  border: 'solid 0.5px lightgray',\n  height: '24rem',\n  alignItems: 'center',\n  justifyContent: 'center'\n};\n\nexport const ControlBarLayoutExample: () => JSX.Element = () => {\n  return (\n    <div style={componentMainDivStyle}>\n      <FluentThemeProvider>\n        <ControlBar layout=\"floatingLeft\">\n          <CameraButton />\n          <MicrophoneButton />\n          <ScreenShareButton />\n          <ParticipantsButton participants={[]} />\n          <DevicesButton />\n          <EndCallButton />\n        </ControlBar>\n      </FluentThemeProvider>\n    </div>\n  );\n};\n"},1409:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton\n} from '@azure/communication-react';\nimport { CallEnd20Filled } from '@fluentui/react-icons';\nimport React from 'react';\n\nexport const CustomButtonsExample: () => JSX.Element = () => {\n  const CustomEndCallButton: () => JSX.Element = () => {\n    const customStyles = {\n      root: {\n        height: 'inherit',\n        background: 'darkorange',\n        color: 'white',\n        width: '10rem'\n      },\n      rootHovered: {\n        background: 'darkred',\n        color: 'white'\n      },\n      flexContainer: { flexFlow: 'row' }\n    };\n\n    return (\n      <EndCallButton\n        styles={customStyles}\n        showLabel={true}\n        onRenderIcon={() => <CallEnd20Filled primaryFill=\"currentColor\" key={'hangupBtnIconKey'} />}\n        onRenderText={() => (\n          <span key={'hangupBtnTextKey'} style={{ marginLeft: '0.5rem' }}>\n            End Call\n          </span>\n        )}\n        onClick={() => {\n          /* handle hangup */\n        }}\n      />\n    );\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'}>\n        <CameraButton />\n        <MicrophoneButton />\n        <CustomEndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1410:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const CustomControlBarStylesExample: () => JSX.Element = () => {\n  const customStyles = {\n    root: {\n      backgroundColor: 'lightgray',\n      border: 'solid black',\n      borderRadius: '0.3rem',\n      maxWidth: 'fit-content'\n    }\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'} styles={customStyles}>\n        <CameraButton />\n        <MicrophoneButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1411:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, ControlBar, FluentThemeProvider, DevicesButton } from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nexport const DevicesButtonExample: () => JSX.Element = () => {\n  const exampleOptionsMenuProps: IContextualMenuProps = {\n    items: [\n      {\n        key: '1',\n        name: 'Choose Camera',\n        iconProps: { iconName: 'LocationCircle' },\n        subMenuProps: {\n          items: [\n            { key: 'camera1', text: 'Full HD Webcam', title: 'Full HD Webcam', canCheck: true, isChecked: true },\n            { key: 'camera2', text: 'Macbook Pro Webcam', title: 'Macbook Pro Webcam' }\n          ]\n        }\n      },\n      {\n        key: '2',\n        name: 'Choose Microphone',\n        iconProps: { iconName: 'LocationCircle' },\n        subMenuProps: {\n          items: [\n            { key: 'mic1', text: 'Realtek HD Audio', title: 'Realtek HD Audio' },\n            { key: 'mic2', text: 'Macbook Pro Mic', title: 'Macbook Pro Mic', canCheck: true, isChecked: true }\n          ]\n        }\n      }\n    ]\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'}>\n        <CameraButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <DevicesButton menuProps={exampleOptionsMenuProps} />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1412:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ErrorBar } from '@azure/communication-react';\nimport React from 'react';\n\nexport const ExampleErrorBar = (): JSX.Element => {\n  return (\n    <ErrorBar\n      activeErrorMessages={[\n        {\n          type: 'callCameraAccessDenied',\n          timestamp: new Date()\n        }\n      ]}\n    />\n  );\n};\n"},1413:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, useTheme } from '@azure/communication-react';\nimport { Dropdown, IDropdownOption } from '@fluentui/react';\nimport React from 'react';\n\nexport interface DeviceSettingsProps {\n  devices: string[];\n  onChange: (event: React.FormEvent<HTMLDivElement>, option?: IDropdownOption, index?: number) => void;\n}\n\nexport const DeviceSettingDropdownExample = ({ devices, onChange }: DeviceSettingsProps): JSX.Element => {\n  const theme = useTheme();\n\n  return (\n    <FluentThemeProvider fluentTheme={theme}>\n      <Dropdown\n        style={{ width: '15rem', overflow: 'hidden' }}\n        placeholder=\"Select an option\"\n        onChange={onChange}\n        options={devices.map((device) => {\n          return {\n            selected: false,\n            key: device,\n            text: device\n          };\n        })}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1414:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"IncomingCallModal",(function(){return IncomingCallModal}));__webpack_require__(47),__webpack_require__(7),__webpack_require__(1);var _constants__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(14),_controlsUtils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6),_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(178),_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(322),_IncomingCallAlertsDocs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(482),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2),IncomingCallModalStory=function IncomingCallModalStory(args){var videoStreamElements=Object(_utils__WEBPACK_IMPORTED_MODULE_5__.a)(args.localVideoStreamEnabled?1:0),videoStreamElement=videoStreamElements[0]?videoStreamElements[0]:null;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_components__WEBPACK_IMPORTED_MODULE_6__.a,{callerName:args.callerName,callerNameAlt:args.callerNameAlt,callerTitle:args.callerTitle,alertText:args.alertText,avatar:args.images.length>0?args.images[0]:void 0,onClickVideoToggle:function onClickVideoToggle(){return null},onClickAccept:function onClickAccept(){return null},onClickReject:function onClickReject(){return null},localParticipantDisplayName:args.localParticipantDisplayName,localVideoInverted:args.localVideoInverted,localVideoStreamElement:videoStreamElement})};IncomingCallModalStory.displayName="IncomingCallModalStory";var IncomingCallModal=IncomingCallModalStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_3__.d+"-incomingcallalerts-incomingcallmodal",title:_constants__WEBPACK_IMPORTED_MODULE_3__.d+"/Incoming Call Alerts/Incoming Call Modal",component:_components__WEBPACK_IMPORTED_MODULE_6__.a,argTypes:{alertText:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callModalAlertText,callerName:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callerName,callerNameAlt:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callerNameAlt,callerTitle:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callerTitle,images:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callerImages,localParticipantDisplayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.localParticipantDisplayName,localVideoStreamEnabled:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.localVideoStreamEnabled,localVideoInverted:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.localVideoInverted,avatar:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j,onClickAccept:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j,onClickReject:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j,localVideoStreamElement:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j,onClickVideoToggle:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j},parameters:{docs:{page:function page(){return Object(_IncomingCallAlertsDocs__WEBPACK_IMPORTED_MODULE_7__.a)()}}}},IncomingCallModal.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const videoStreamElements = useVideoStreams(args.localVideoStreamEnabled ? 1 : 0);\n  const videoStreamElement = videoStreamElements[0] ? videoStreamElements[0] : null;\n\n  return (\n    <IncomingCallModalComponent\n      callerName={args.callerName}\n      callerNameAlt={args.callerNameAlt}\n      callerTitle={args.callerTitle}\n      alertText={args.alertText}\n      avatar={args.images.length > 0 ? args.images[0] : undefined}\n      onClickVideoToggle={() => null}\n      onClickAccept={() => null}\n      onClickReject={() => null}\n      localParticipantDisplayName={args.localParticipantDisplayName}\n      localVideoInverted={args.localVideoInverted}\n      localVideoStreamElement={videoStreamElement}\n    />\n  );\n}"}},IncomingCallModal.parameters)},1415:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"IncomingCallToast",(function(){return IncomingCallToast}));__webpack_require__(47),__webpack_require__(7);var _fluentui_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(69),_constants__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(1),__webpack_require__(14)),_controlsUtils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(6),_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(322),_IncomingCallAlertsDocs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(482),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2),IncomingCallToastStory=function IncomingCallToastStory(args){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.a,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_components__WEBPACK_IMPORTED_MODULE_6__.b,{callerName:args.callerName,alertText:args.alertText,avatar:args.images.length>0?args.images[0]:void 0,onClickAccept:function onClickAccept(){return null},onClickReject:function onClickReject(){return null}})})};IncomingCallToastStory.displayName="IncomingCallToastStory";var IncomingCallToast=IncomingCallToastStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_4__.d+"-incomingcallalerts-incomingcalltoast",title:_constants__WEBPACK_IMPORTED_MODULE_4__.d+"/Incoming Call Alerts/Incoming Call Toast",component:_components__WEBPACK_IMPORTED_MODULE_6__.b,argTypes:{callerName:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.a.callerName,alertText:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.a.callToastAlertText,images:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.a.callerImages,avatar:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.j,onClickAccept:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.j,onClickReject:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.j},parameters:{docs:{page:function page(){return Object(_IncomingCallAlertsDocs__WEBPACK_IMPORTED_MODULE_7__.a)()}}}},IncomingCallToast.parameters=Object.assign({storySource:{source:"(args) => {\n  return (\n    <Stack>\n      <IncomingCallToastComponent\n        callerName={args.callerName}\n        alertText={args.alertText}\n        avatar={args.images.length > 0 ? args.images[0] : undefined}\n        onClickAccept={() => null}\n        onClickReject={() => null}\n      />\n    </Stack>\n  );\n}"}},IncomingCallToast.parameters)},1416:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  StreamMedia,\n  VideoTile,\n  ControlBar,\n  CameraButton,\n  MicrophoneButton,\n  FluentThemeProvider,\n  useTheme\n} from '@azure/communication-react';\nimport { Stack, mergeStyles, Text } from '@fluentui/react';\nimport { VideoOff20Filled } from '@fluentui/react-icons';\nimport React, { useCallback, useState } from 'react';\nimport { useVideoStreams } from '../../../utils';\n\nexport interface LocalPreviewProps {\n  isVideoAvailable: boolean;\n  isCameraEnabled: boolean;\n  isMicrophoneEnabled: boolean;\n}\n\nexport const LocalPreviewExample = ({\n  isVideoAvailable,\n  isCameraEnabled,\n  isMicrophoneEnabled\n}: LocalPreviewProps): JSX.Element => {\n  const [microphone, setMicrophone] = useState(true);\n  const [camera, setCamera] = useState(true);\n  const theme = useTheme();\n  const palette = theme.palette;\n\n  const localPreviewContainerStyle = mergeStyles({\n    minWidth: '25rem',\n    width: '100\\u0025',\n    height: '100\\u0025',\n    maxHeight: '18.75rem',\n    minHeight: '16.875rem',\n    margin: '0 auto',\n    background: palette.neutralLighter,\n    color: palette.neutralTertiary\n  });\n\n  const videoTileStyle = {\n    root: {\n      minHeight: '14rem'\n    }\n  };\n\n  const cameraOffLabelStyle = mergeStyles({\n    fontFamily: 'Segoe UI Regular',\n    fontSize: '0.625rem', // 10px\n    color: palette.neutralTertiary\n  });\n\n  const renderCameraOffPlaceholder = useCallback(\n    () => (\n      <Stack style={{ width: '100\\u0025', height: '100\\u0025' }} verticalAlign=\"center\">\n        <Stack.Item align=\"center\">\n          <VideoOff20Filled primaryFill=\"currentColor\" />\n        </Stack.Item>\n        <Stack.Item align=\"center\">\n          <Text className={cameraOffLabelStyle}>Your camera is turned off</Text>\n        </Stack.Item>\n      </Stack>\n    ),\n    [cameraOffLabelStyle]\n  );\n\n  const videoStreams = useVideoStreams(1);\n  const videoStreamElement = isVideoAvailable ? videoStreams[0] : null;\n\n  return (\n    <FluentThemeProvider fluentTheme={theme}>\n      <Stack style={{ width: '100\\u0025', height: '100\\u0025' }} verticalAlign=\"center\">\n        <Stack.Item align=\"center\">\n          <Stack className={localPreviewContainerStyle}>\n            <VideoTile\n              styles={videoTileStyle}\n              // Here this storybook example isn't connected with Azure Communication Services\n              // We would suggest you replace this videoStreamElement below with a rendered video stream from the calling SDK\n              renderElement={\n                isVideoAvailable && isCameraEnabled && camera ? (\n                  <StreamMedia videoStreamElement={videoStreamElement} />\n                ) : undefined\n              }\n              onRenderPlaceholder={renderCameraOffPlaceholder}\n            >\n              <ControlBar layout=\"floatingBottom\">\n                <CameraButton\n                  disabled={!isCameraEnabled}\n                  checked={isCameraEnabled ? camera : false}\n                  onClick={() => setCamera(!camera)}\n                />\n                <MicrophoneButton\n                  disabled={!isMicrophoneEnabled}\n                  checked={isMicrophoneEnabled ? microphone : false}\n                  onClick={() => setMicrophone(!microphone)}\n                />\n              </ControlBar>\n            </VideoTile>\n          </Stack>\n        </Stack.Item>\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1417:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile } from '@azure/communication-react';\nimport React from 'react';\nimport { ComplianceBanner } from './ComplianceBanner.snippet';\n\nexport const CallComponent = (): JSX.Element => {\n  const videoTileStyles = {\n    root: { height: '100%', width: '100%' },\n    overlayContainer: {}\n  };\n\n  return (\n    <VideoTile styles={videoTileStyles}>\n      <ComplianceBanner callRecordState={true} callTranscribeState={true} />\n    </VideoTile>\n  );\n};\n"},1418:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default='// ComplianceBanner.snippet.tsx\n\nimport { Link, MessageBar } from \'@fluentui/react\';\nimport React, { ReactElement, useEffect, useRef, useState } from \'react\';\n\nexport type ComplianceBannerProps = {\n  callTranscribeState?: boolean;\n  callRecordState?: boolean;\n};\n\ntype CachedComplianceBannerProps = {\n  latest: ComplianceBannerProps;\n  previous: ComplianceBannerProps;\n};\n\nexport const ComplianceBanner = (props: ComplianceBannerProps): JSX.Element => {\n  const cachedProps = useRef<CachedComplianceBannerProps>({\n    latest: {\n      callTranscribeState: false,\n      callRecordState: false\n    },\n    previous: {\n      callTranscribeState: false,\n      callRecordState: false\n    }\n  });\n\n  // Only update cached props if there is _some_ change in the latest props.\n  // This ensures that state machine is only updated if there is an actual change in the props.\n  if (\n    props.callRecordState !== cachedProps.current.latest.callRecordState ||\n    props.callTranscribeState !== cachedProps.current.latest.callTranscribeState\n  ) {\n    cachedProps.current = {\n      latest: props,\n      previous: cachedProps.current.latest\n    };\n  }\n\n  const variant = computeVariant(\n    cachedProps.current.previous.callRecordState,\n    cachedProps.current.previous.callTranscribeState,\n    cachedProps.current.latest.callRecordState,\n    cachedProps.current.latest.callTranscribeState\n  );\n\n  return <DismissableMessageBar variant={variant} />;\n};\n\nfunction DismissableMessageBar(props: { variant: number }): ReactElement {\n  const { variant: newVariant } = props;\n\n  const [variant, setVariant] = useState(0);\n  // We drive the `MessageBar` indirectly via the `variant` state variable.\n  // This allows the `onDismiss` handler to set the `variant` state to dismiss the `MessageBar`.\n  // This means that when props change, this component renders *twice*: After the first render, this `useEffect` block\n  // updates the value of `variant` state variable, which triggers a second render to update the message in the `MessageBar`.\n  useEffect(() => {\n    setVariant(newVariant);\n  }, [newVariant, setVariant]);\n\n  return variant === NO_STATE ? (\n    <></>\n  ) : (\n    <MessageBar\n      onDismiss={() => {\n        setVariant(NO_STATE);\n      }}\n      dismissButtonAriaLabel="Close"\n    >\n      <BannerMessage variant={variant} />\n    </MessageBar>\n  );\n}\n\nconst TRANSCRIPTION_STOPPED_STILL_RECORDING = 1;\nconst RECORDING_STOPPED_STILL_TRANSCRIBING = 2;\nconst RECORDING_AND_TRANSCRIPTION_STOPPED = 3;\nconst RECORDING_AND_TRANSCRIPTION_STARTED = 4;\nconst TRANSCRIPTION_STARTED = 5;\nconst RECORDING_STOPPED = 6;\nconst RECORDING_STARTED = 7;\nconst TRANSCRIPTION_STOPPED = 8;\nconst NO_STATE = 0;\n\nfunction computeVariant(\n  previousCallRecordState: boolean | undefined,\n  previousCallTranscribeState: boolean | undefined,\n  callRecordState: boolean | undefined,\n  callTranscribeState: boolean | undefined\n): number {\n  if (previousCallRecordState && previousCallTranscribeState) {\n    if (callRecordState && !callTranscribeState) {\n      return TRANSCRIPTION_STOPPED_STILL_RECORDING;\n    } else if (!callRecordState && callTranscribeState) {\n      return RECORDING_STOPPED_STILL_TRANSCRIBING;\n    } else if (!callRecordState && !callTranscribeState) {\n      return RECORDING_AND_TRANSCRIPTION_STOPPED;\n    } else {\n      return NO_STATE;\n    }\n  } else if (previousCallRecordState && !previousCallTranscribeState) {\n    if (callRecordState && callTranscribeState) {\n      return RECORDING_AND_TRANSCRIPTION_STARTED;\n    } else if (!callRecordState && callTranscribeState) {\n      return TRANSCRIPTION_STARTED;\n    } else if (!callRecordState && !callTranscribeState) {\n      return RECORDING_STOPPED;\n    } else {\n      return NO_STATE;\n    }\n  } else if (!previousCallRecordState && previousCallTranscribeState) {\n    if (callRecordState && callTranscribeState) {\n      return RECORDING_AND_TRANSCRIPTION_STARTED;\n    } else if (!callRecordState && callTranscribeState) {\n      return RECORDING_STARTED;\n    } else if (!callRecordState && !callTranscribeState) {\n      return TRANSCRIPTION_STOPPED;\n    } else {\n      return NO_STATE;\n    }\n  } else if (!previousCallRecordState && !previousCallTranscribeState) {\n    if (callRecordState && callTranscribeState) {\n      return RECORDING_AND_TRANSCRIPTION_STARTED;\n    } else if (callRecordState && !callTranscribeState) {\n      return RECORDING_STARTED;\n    } else if (!callRecordState && callTranscribeState) {\n      return TRANSCRIPTION_STARTED;\n    } else {\n      return NO_STATE;\n    }\n  }\n  return NO_STATE;\n}\n\nfunction BannerMessage(props: { variant: number }): JSX.Element {\n  switch (props.variant) {\n    case TRANSCRIPTION_STOPPED_STILL_RECORDING:\n      return (\n        <>\n          <b>Transcription has stopped.</b> You are now only recording this meeting.\n          <PrivacyPolicy />\n        </>\n      );\n    case RECORDING_STOPPED_STILL_TRANSCRIBING:\n      return (\n        <>\n          <b>Recording has stopped.</b> You are now only transcribing this meeting.\n          <PrivacyPolicy />\n        </>\n      );\n    case RECORDING_AND_TRANSCRIPTION_STOPPED:\n      return (\n        <>\n          <b>Recording and transcription are being saved. </b> Recording and transcription have stopped.\n          <LearnMore />\n        </>\n      );\n    case RECORDING_AND_TRANSCRIPTION_STARTED:\n      return (\n        <>\n          <b>Recording and transcription have started.</b> By joining, you are giving consent for this meeting to be\n          transcribed.\n          <PrivacyPolicy />\n        </>\n      );\n    case TRANSCRIPTION_STARTED:\n      return (\n        <>\n          <b>Transcription has started.</b> By joining, you are giving consent for this meeting to be transcribed.\n          <PrivacyPolicy />\n        </>\n      );\n    case RECORDING_STOPPED:\n      return (\n        <>\n          <b>Recording is being saved.</b> Recording has stopped.\n          <LearnMore />\n        </>\n      );\n    case RECORDING_STARTED:\n      return (\n        <>\n          <b>Recording has started.</b> By joining, you are giving consent for this meeting to be transcribed.\n          <PrivacyPolicy />\n        </>\n      );\n    case TRANSCRIPTION_STOPPED:\n      return (\n        <>\n          <b>Transcription is being saved.</b> Transcription has stopped.\n          <LearnMore />\n        </>\n      );\n  }\n  return <></>;\n}\n\nfunction PrivacyPolicy(): JSX.Element {\n  return (\n    <Link href="https://privacy.microsoft.com/privacystatement#mainnoticetoendusersmodule" target="_blank" underline>\n      Privacy policy\n    </Link>\n  );\n}\n\nfunction LearnMore(): JSX.Element {\n  return (\n    <Link\n      href="https://support.microsoft.com/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24"\n      target="_blank"\n      underline\n    >\n      Learn more\n    </Link>\n  );\n}\n'},1419:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  StreamMedia,\n  VideoTile,\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  MicrophoneButton,\n  DevicesButton,\n  useTheme\n} from '@azure/communication-react';\nimport React from 'react';\n\n// Don't import this. It's just a helper for the story.\nimport { useVideoStreams } from '../../../utils';\n\nexport interface LobbyProps {\n  isVideoReady: boolean;\n  callStateText: string;\n  callStateSubText: string;\n}\n\nexport const Lobby = (props: LobbyProps): JSX.Element => {\n  const theme = useTheme();\n  const palette = theme.palette;\n\n  const videoTileStyles = {\n    root: { height: '100%', width: '100%' },\n    overlayContainer: {}\n  };\n\n  const ControlBarStyles = {\n    root: { background: theme.palette.white, minHeight: '4.25rem', alignItems: 'center' }\n  };\n\n  // Helper code to make the storybook work. Replace with your own code for video stream element.\n  const videoStreams = useVideoStreams(1);\n  const videoStreamElement = props.isVideoReady ? videoStreams[0] : undefined;\n  const videoRenderElement = videoStreamElement ? <StreamMedia videoStreamElement={videoStreamElement} /> : undefined;\n\n  return (\n    <VideoTile\n      styles={videoTileStyles}\n      isMirrored={true}\n      onRenderPlaceholder={() => <></>}\n      renderElement={videoRenderElement}\n    >\n      <div\n        style={{\n          width: '100%',\n          height: '100%',\n          position: 'absolute',\n          background: props.isVideoReady ? '#201f1e' : palette.neutralLight,\n          opacity: 0.75\n        }}\n      />\n\n      <div\n        style={{\n          position: 'absolute',\n          top: '50%',\n          left: '50%',\n          transform: 'translate(-50%, -50%)',\n          marginTop: '-2.125rem'\n        }}\n      >\n        <p\n          style={{\n            fontSize: '1.75rem',\n            color: props.isVideoReady ? 'white' : palette.neutralPrimary,\n            textAlign: 'center',\n            margin: '0'\n          }}\n        >\n           <br /> {props.callStateText} <br />\n        </p>\n        <p\n          style={{\n            fontSize: '0.75rem',\n            color: props.isVideoReady ? 'white' : palette.neutralPrimary,\n            textAlign: 'center',\n            margin: '0'\n          }}\n        >\n          {props.callStateSubText}\n        </p>\n      </div>\n\n      <ControlBar layout=\"dockedBottom\" styles={ControlBarStyles}>\n        <CameraButton showLabel={true} checked={true} />\n        <MicrophoneButton showLabel={true} checked={true} />\n        <DevicesButton showLabel={true} />\n        <EndCallButton showLabel={true} style={{ borderRadius: '0.25rem', marginLeft: '0.25rem' }} />\n      </ControlBar>\n    </VideoTile>\n  );\n};\n"},142:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useHandlers}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(34);var _internal_acs_ui_common__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(32),memoize_one__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(153),_adapter_CallAdapterProvider__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(134),_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(179);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var useHandlers=function useHandlers(_component){return createCompositeHandlers(Object(_adapter_CallAdapterProvider__WEBPACK_IMPORTED_MODULE_5__.b)())},createCompositeHandlers=Object(memoize_one__WEBPACK_IMPORTED_MODULE_4__.a)((function(adapter){return{onCreateLocalStreamView:(_onCreateLocalStreamView=_asyncToGenerator(regeneratorRuntime.mark((function _callee(options){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,adapter.createStreamView(void 0,options);case 2:case"end":return _context.stop()}}),_callee)}))),function onCreateLocalStreamView(_x){return _onCreateLocalStreamView.apply(this,arguments)}),onCreateRemoteStreamView:(_onCreateRemoteStreamView=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(userId,options){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,adapter.createStreamView(userId,options);case 2:case"end":return _context2.stop()}}),_callee2)}))),function onCreateRemoteStreamView(_x2,_x3){return _onCreateRemoteStreamView.apply(this,arguments)}),onHangUp:(_onHangUp=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,adapter.leaveCall();case 2:case"end":return _context3.stop()}}),_callee3)}))),function onHangUp(){return _onHangUp.apply(this,arguments)}),onRemoveParticipant:(_onRemoveParticipant=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(userId){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,adapter.removeParticipant(userId);case 2:case"end":return _context4.stop()}}),_callee4)}))),function onRemoveParticipant(_x4){return _onRemoveParticipant.apply(this,arguments)}),onSelectCamera:(_onSelectCamera=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(deviceInfo,options){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,adapter.setCamera(deviceInfo,options);case 2:case"end":return _context5.stop()}}),_callee5)}))),function onSelectCamera(_x5,_x6){return _onSelectCamera.apply(this,arguments)}),onSelectMicrophone:(_onSelectMicrophone=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(deviceInfo){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,adapter.setMicrophone(deviceInfo);case 2:case"end":return _context6.stop()}}),_callee6)}))),function onSelectMicrophone(_x7){return _onSelectMicrophone.apply(this,arguments)}),onSelectSpeaker:(_onSelectSpeaker=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(deviceInfo){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,adapter.setSpeaker(deviceInfo);case 2:case"end":return _context7.stop()}}),_callee7)}))),function onSelectSpeaker(_x8){return _onSelectSpeaker.apply(this,arguments)}),onStartCall:function onStartCall(participants){var rawIds=participants.map((function(participant){return Object(_internal_acs_ui_common__WEBPACK_IMPORTED_MODULE_3__.g)(participant)}));return adapter.startCall(rawIds)},onStartScreenShare:(_onStartScreenShare=_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,adapter.startScreenShare();case 2:case"end":return _context8.stop()}}),_callee8)}))),function onStartScreenShare(){return _onStartScreenShare.apply(this,arguments)}),onStopScreenShare:(_onStopScreenShare=_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,adapter.stopScreenShare();case 2:case"end":return _context9.stop()}}),_callee9)}))),function onStopScreenShare(){return _onStopScreenShare.apply(this,arguments)}),onToggleCamera:(_onToggleCamera=_asyncToGenerator(regeneratorRuntime.mark((function _callee10(options){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(!Object(_utils__WEBPACK_IMPORTED_MODULE_6__.c)(adapter.getState())){_context10.next=5;break}return _context10.next=3,adapter.stopCamera();case 3:_context10.next=7;break;case 5:return _context10.next=7,adapter.startCamera(options);case 7:case"end":return _context10.stop()}}),_callee10)}))),function onToggleCamera(_x9){return _onToggleCamera.apply(this,arguments)}),onToggleMicrophone:(_onToggleMicrophone=_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){var _adapter$getState$cal;return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(null===(_adapter$getState$cal=adapter.getState().call)||void 0===_adapter$getState$cal||!_adapter$getState$cal.isMuted){_context11.next=6;break}return _context11.next=3,adapter.unmute();case 3:_context11.t0=_context11.sent,_context11.next=9;break;case 6:return _context11.next=8,adapter.mute();case 8:_context11.t0=_context11.sent;case 9:return _context11.abrupt("return",_context11.t0);case 10:case"end":return _context11.stop()}}),_callee11)}))),function onToggleMicrophone(){return _onToggleMicrophone.apply(this,arguments)}),onToggleScreenShare:(_onToggleScreenShare=_asyncToGenerator(regeneratorRuntime.mark((function _callee12(){var _adapter$getState$cal2;return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:if(null===(_adapter$getState$cal2=adapter.getState().call)||void 0===_adapter$getState$cal2||!_adapter$getState$cal2.isScreenSharingOn){_context12.next=6;break}return _context12.next=3,adapter.stopScreenShare();case 3:_context12.t0=_context12.sent,_context12.next=9;break;case 6:return _context12.next=8,adapter.startScreenShare();case 8:_context12.t0=_context12.sent;case 9:return _context12.abrupt("return",_context12.t0);case 10:case"end":return _context12.stop()}}),_callee12)}))),function onToggleScreenShare(){return _onToggleScreenShare.apply(this,arguments)}),onStartLocalVideo:(_onStartLocalVideo=_asyncToGenerator(regeneratorRuntime.mark((function _callee13(){return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:if(!adapter.getState().call){_context13.next=2;break}return _context13.abrupt("return",adapter.startCamera());case 2:case"end":return _context13.stop()}}),_callee13)}))),function onStartLocalVideo(){return _onStartLocalVideo.apply(this,arguments)}),onDisposeLocalStreamView:(_onDisposeLocalStreamView=_asyncToGenerator(regeneratorRuntime.mark((function _callee14(){return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return _context14.abrupt("return",adapter.disposeStreamView());case 1:case"end":return _context14.stop()}}),_callee14)}))),function onDisposeLocalStreamView(){return _onDisposeLocalStreamView.apply(this,arguments)}),onDisposeRemoteStreamView:(_onDisposeRemoteStreamView=_asyncToGenerator(regeneratorRuntime.mark((function _callee15(userId){return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return _context15.abrupt("return",adapter.disposeStreamView(userId));case 1:case"end":return _context15.stop()}}),_callee15)}))),function onDisposeRemoteStreamView(_x10){return _onDisposeRemoteStreamView.apply(this,arguments)})};var _onDisposeRemoteStreamView,_onDisposeLocalStreamView,_onStartLocalVideo,_onToggleScreenShare,_onToggleMicrophone,_onToggleCamera,_onStopScreenShare,_onStartScreenShare,_onSelectSpeaker,_onSelectMicrophone,_onSelectCamera,_onRemoveParticipant,_onHangUp,_onCreateRemoteStreamView,_onCreateLocalStreamView}))},1420:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  GridLayout,\n  MicrophoneButton,\n  ScreenShareButton,\n  VideoTile,\n  useTheme\n} from '@azure/communication-react';\nimport { Stack, mergeStyles } from '@fluentui/react';\nimport React from 'react';\n\nconst teamsTheme = {\n  palette: {\n    themePrimary: '#4b53bc',\n    themeLighterAlt: '#030308',\n    themeLighter: '#0c0d1e',\n    themeLight: '#171939',\n    themeTertiary: '#2d3271',\n    themeSecondary: '#4249a6',\n    themeDarkAlt: '#5a61c3',\n    themeDark: '#6f76cd',\n    themeDarker: '#9196da',\n    neutralLighterAlt: '#1e1e1e',\n    neutralLighter: '#1d1d1d',\n    neutralLight: '#1c1c1c',\n    neutralQuaternaryAlt: '#1a1a1a',\n    neutralQuaternary: '#191919',\n    neutralTertiaryAlt: '#181818',\n    neutralTertiary: '#c8c8c8',\n    neutralSecondary: '#d0d0d0',\n    neutralPrimaryAlt: '#dadada',\n    neutralPrimary: '#ffffff',\n    neutralDark: '#f4f4f4',\n    black: '#f8f8f8',\n    white: '#1f1f1f'\n  }\n};\n\nexport const TeamsTheme: () => JSX.Element = () => {\n  const wrapperStyle = {\n    width: '100%',\n    height: '100%',\n    maxWidth: '50rem',\n    maxHeight: '30rem'\n  };\n\n  return (\n    <div style={wrapperStyle}>\n      <FluentThemeProvider fluentTheme={teamsTheme}>\n        <App />\n      </FluentThemeProvider>\n    </div>\n  );\n};\n\nconst App: () => JSX.Element = () => {\n  const theme = useTheme();\n\n  const headerContainer = mergeStyles({\n    width: '100%',\n    height: '3.875rem',\n    overflow: 'hidden',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    alignItems: 'center',\n    marginBottom: 2,\n    background: theme.palette.white\n  });\n\n  const controlBarStyle = {\n    root: {\n      marginRight: '.5rem',\n      alignItems: 'center'\n    }\n  };\n\n  const teamsButtonStyle = {\n    root: { minWidth: '2.75rem' },\n    rootHovered: { color: theme.palette.themePrimary, background: 'none' }\n  };\n\n  const endCallButtonStyles = {\n    root: {\n      height: '2rem',\n      minHeight: '2rem',\n      width: '6.5rem',\n      borderRadius: '0.125rem'\n    }\n  };\n\n  const videoTileStyle = {\n    root: { background: theme.palette.white }\n  };\n\n  return (\n    <Stack\n      style={{\n        height: '100%',\n        width: '100%',\n        background: theme.palette.neutralQuaternaryAlt\n      }}\n    >\n      <Stack className={headerContainer}>\n        <Stack.Item>\n          <ControlBar styles={controlBarStyle}>\n            <CameraButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              styles={teamsButtonStyle}\n            />\n            <MicrophoneButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              styles={teamsButtonStyle}\n            />\n            <ScreenShareButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              styles={teamsButtonStyle}\n            />\n            <EndCallButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              showLabel={true}\n              onRenderText={() => (\n                <span key={'endCallBtnTextKey'} style={{ marginLeft: '0.5rem' }}>\n                  Leave\n                </span>\n              )}\n              styles={endCallButtonStyles}\n            />\n          </ControlBar>\n        </Stack.Item>\n      </Stack>\n      <GridLayout>\n        <VideoTile displayName={'Michael'} styles={videoTileStyle} />\n      </GridLayout>\n    </Stack>\n  );\n};\n"},1421:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { GridLayout, VideoTile } from '@azure/communication-react';\nimport React from 'react';\n\nexport const GridLayoutExample = (): JSX.Element => {\n  const videoTileStyles = { root: { padding: '10px', border: '1px solid #999' } };\n  return (\n    <div style={{ height: '530px', width: '830px' }}>\n      <GridLayout>\n        <VideoTile styles={videoTileStyles} displayName={'Michael'} />\n        <VideoTile styles={videoTileStyles} displayName={'Jim'} />\n        <VideoTile styles={videoTileStyles} displayName={'Pam'} />\n        <VideoTile styles={videoTileStyles} displayName={'Dwight'} />\n      </GridLayout>\n    </div>\n  );\n};\n"},1422:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { MessageStatus, MessageStatusIndicator } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nexport const DefaultMessageStatusIndicatorsExample: () => JSX.Element = () => {\n  return (\n    <Stack horizontalAlign=\"start\">\n      <MessageStatusIndicator status={'delivered' as MessageStatus} />\n      <MessageStatusIndicator status={'seen' as MessageStatus} />\n      <MessageStatusIndicator status={'sending' as MessageStatus} />\n      <MessageStatusIndicator status={'failed' as MessageStatus} />\n    </Stack>\n  );\n};\n"},1423:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport { Persona, PersonaPresence, PersonaSize } from '@fluentui/react';\nimport React from 'react';\nimport { GetAvatarUrlByUserId, GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomAvatarExample: () => JSX.Element = () => {\n  // Customize the Avatar of other participants to be a Persona component from Fluent and show the presence status on the avatar.\n  return (\n    <FluentThemeProvider>\n      <MessageThread\n        userId={'1'}\n        messages={GetHistoryChatMessages()}\n        onRenderAvatar={(userId?: string) => {\n          return (\n            <Persona\n              size={PersonaSize.size32}\n              hidePersonaDetails\n              presence={PersonaPresence.online}\n              text={userId}\n              imageUrl={GetAvatarUrlByUserId(userId ?? '')}\n            />\n          );\n        }}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1424:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomChatContainerExample: () => JSX.Element = () => {\n  const messageThreadStyles = {\n    chatContainer: {\n      backgroundColor: 'lightgray',\n      padding: '15px'\n    }\n  };\n\n  // Show a customized Chat container.\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} styles={messageThreadStyles} />\n    </FluentThemeProvider>\n  );\n};\n"},1425:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread, MessageThreadStyles } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryWithSystemMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomMessageContainerExample: () => JSX.Element = () => {\n  const messageThreadStyle: MessageThreadStyles = {\n    chatMessageContainer: {\n      fontStyle: 'italic',\n      boxShadow: '0px 3.2px 7.2px rgb(0 0 0 / 13\\u0025), 0px 0.6px 1.8px rgb(0 0 0 / 11\\u0025)'\n    },\n    myChatMessageContainer: {\n      fontStyle: 'italic',\n      boxShadow: '0px 3.2px 7.2px rgb(0 0 0 / 13\\u0025), 0px 0.6px 1.8px rgb(0 0 0 / 11\\u0025)'\n    },\n    systemMessageContainer: { fontWeight: 'bold', border: 'double red' }\n  };\n\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} styles={messageThreadStyle} messages={GetHistoryWithSystemMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1426:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { MessageRenderer, FluentThemeProvider, MessageProps, MessageThread } from '@azure/communication-react';\nimport { Divider } from '@fluentui/react-northstar';\nimport React from 'react';\nimport { GetHistoryWithCustomMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomMessagesExample: () => JSX.Element = () => {\n  // As an example, we want to use render custom message as a Divider.\n  const onRenderMessage = (messageProps: MessageProps, defaultOnRender?: MessageRenderer): JSX.Element => {\n    if (messageProps.message.messageType === 'custom') {\n      return <Divider content={messageProps.message.content} color=\"brand\" important />;\n    }\n\n    return defaultOnRender ? defaultOnRender(messageProps) : <></>;\n  };\n\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryWithCustomMessages()} onRenderMessage={onRenderMessage} />\n    </FluentThemeProvider>\n  );\n};\n"},1427:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport { Text } from '@fluentui/react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomMessageStatusIndicatorExample: () => JSX.Element = () => {\n  // Show the status of messages that I sent by setting 'showMessageStatus' prop to be true and customized it\n  return (\n    <FluentThemeProvider>\n      <MessageThread\n        userId={'1'}\n        messages={GetHistoryChatMessages()}\n        showMessageStatus={true}\n        onRenderMessageStatus={(messageStatusIndicatorProps) => {\n          return messageStatusIndicatorProps.status === 'seen' ? (\n            <Text style={{ fontStyle: 'italic', fontWeight: 'bold', color: 'green' }}>seen</Text>\n          ) : null;\n        }}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1428:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const DefaultMessageThreadExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1429:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithMessageStatusIndicatorExample: () => JSX.Element = () => {\n  // Show the status of messages that I sent by setting 'showMessageStatus' prop to be true.\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} showMessageStatus={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1430:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { ChatMessage, CustomMessage, MessageStatus, SystemMessage } from '@azure/communication-react';\n\n// This is some mock messages for example purposes.\n// For actual projects, you can get chat messages from declarative/selectors for ACS.\nexport const GetHistoryChatMessages = (): ChatMessage[] => {\n  return [\n    {\n      messageType: 'chat',\n      senderId: 'user1',\n      senderDisplayName: 'Kat Larsson',\n      messageId: Math.random().toString(),\n      content: 'Hi everyone, I created this awesome group chat for us!',\n      createdOn: new Date('2019-04-13T00:00:00.000+08:10'),\n      mine: true,\n      attached: false,\n      status: 'seen' as MessageStatus,\n      contentType: 'text'\n    },\n    {\n      messageType: 'chat',\n      senderId: 'user2',\n      senderDisplayName: 'Robert Tolbert',\n      messageId: Math.random().toString(),\n      content: 'Nice! This looks great!',\n      createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n      mine: false,\n      attached: false,\n      contentType: 'text'\n    },\n    {\n      messageType: 'chat',\n      senderId: 'user3',\n      senderDisplayName: 'Carole Poland',\n      messageId: Math.random().toString(),\n      content: \"Yeah agree, let's chat here from now on!\",\n      createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n      mine: false,\n      attached: false,\n      contentType: 'text'\n    }\n  ];\n};\n\nexport const GetHistoryWithSystemMessages = (): (SystemMessage | ChatMessage)[] => {\n  return [\n    ...GetHistoryChatMessages(),\n    {\n      messageType: 'system',\n      createdOn: new Date('2020-04-13T00:00:00.000+07:01'),\n      systemMessageType: 'content',\n      messageId: Math.random().toString(),\n      iconName: 'PeopleAdd',\n      content: 'Miguel Garcia is added to the chat'\n    }\n  ];\n};\n\nexport const GetHistoryWithCustomMessages = (): (CustomMessage | ChatMessage)[] => {\n  return [\n    {\n      messageType: 'custom',\n      // Custom message's payload can be any shape, this is just an example.\n      // Whatever is defined in the custom message's payload needs to be handled in onRenderMessage in MessageThread.\n      createdOn: new Date('2020-04-13T00:00:00.000+07:01'),\n      messageId: Math.random().toString(),\n      content: 'Today'\n    },\n    ...GetHistoryChatMessages()\n  ];\n};\n\n// This is some mock avatars for example purposes.\nexport const GetAvatarUrlByUserId = (userId: string): string => {\n  switch (userId) {\n    case 'user1':\n      return 'images/avatars/avatar-1.jpg';\n    case 'user2':\n      return 'images/avatars/avatar-2.jpg';\n    case 'user3':\n      return 'images/avatars/avatar-8.jpg';\n    default:\n      return '';\n  }\n};\n"},1431:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryWithSystemMessages } from './placeholdermessages';\n\nexport const MessageThreadWithSystemMessagesExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryWithSystemMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1432:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithMessageDateExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} showMessageDate={true} messages={GetHistoryChatMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1433:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"use-composite-in-non-react-environment",title:"Composites/Cross-Framework Support",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"use-composites-inside-javascript-based-applications"},"Use Composites inside JavaScript-based Applications"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If you are not using React, you can still embed a calling/chat composite into your html page with a simple ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"<script>")," tag and several lines of code like:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"You can easily find prebuilt bundles from:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/releases/latest/download/chatComposite.js",target:"_blank",rel:"nofollow noopener noreferrer"},"The latest bundles for chat composite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/releases/latest/download/callComposite.js",target:"_blank",rel:"nofollow noopener noreferrer"},"The latest bundles for call composite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For development and prototyping purpose, import these 2 urls with ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"<script>")," tags will be the fastest way. In production environment, we recommend that serving composite files on your own CDN will help with performance."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-composites-in-html"},"Use Composites in html"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"After importing chat/calling composite bundle, you are able to load composites using these 2 code snippets:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const chatAdapter = await chatComposite.loadChatComposite(\n  //The for composite which allows you control composite externally,\n  // This function will be exposed to window.chatComposite once you import composite bundle\n  {\n    displayName, // string\n    threadId, // string\n    endpoint, // string\n    userId, // Object { communicationUserId: string }\n    token // string\n  },\n  elementToRender, // Container element\n  props // Optional, Object contains all optional props for composite, check composite page for more details\n);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const callAdapter = await callComposite.loadCallComposite(\n  //The for composite which allows you control composite externally,\n  // This function will be exposed to window.callComposite once you import composite bundle\n  {\n    groupId, // string, Provide any GUID to join a group\n    displayName, // string\n    userId, // Object { communicationUserId: string }\n    token // string\n  },\n  elementToRender, // container element\n  props // Optional, Object contains all optional props for composite, check composite page for more details\n);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/composites-chat-basicexample--basic-example"},"Chat Composite Basic Example")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/composites-call-basicexample--basic-example"},"Call Composite Basic Example")," to see optional props of composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For more details of adapter, check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/story/composite-adapters--page"},"Adapters for Composites")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"example-html-code"},"Example html code"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/blob/PublicPreview/1.0.0-beta.3/samples/StaticHtmlComposites/index.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Example")," for more detailed example of using calling/chat composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-html"},'\x3c!-- Replace this url with your own CDN in production environment --\x3e\n<script src="https://github.com/Azure/communication-ui-library/releases/latest/download/chatComposite.js"><\/script>\n\x3c!-- height need to be set for composite to fit the layout --\x3e\n<div id="chat-container" style="height: 50vh"></div>\n<script type="module">\n  const chatAdapter = await chatComposite.loadChatComposite(\n    {\n      displayName: displayName,\n      threadId: threadId,\n      endpoint: endpoint,\n      userId: user,\n      token: token\n    },\n    document.getElementById(\'chat-container\')\n  );\n<\/script>\n')),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"build-your-own-composite-js-bundle-files"},"Build your own composite js bundle files:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"git-clone-our-repo"},"git clone our repo"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/Azure/communication-ui-library.git\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"install-rush"},"Install rush"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For this example, we use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://rushjs.io/",target:"_blank",rel:"nofollow noopener noreferrer"},"rush")," to create the bundles."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install -g @microsoft/rush\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"install-packages-and-build-js-bundles"},"Install packages and build js bundles"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"cd communication-ui-library\\samples\\StaticHtmlComposites\\\nrush install\nrush build\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Then you will be able to see 2 js bundle files:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre"},".\\samples\\StaticHtmlComposites\\dist\\chatComposite.js\n.\\samples\\StaticHtmlComposites\\dist\\callComposite.js\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"There is also an example html for how to use it, you might want to allocate your own acs token before you embed the code piece to your own web app, check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create and manage Communication Services resources"),":"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre"},".\\samples\\StaticHtmlComposites\\index.html\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"try-it-the-sample"},"Try it the sample"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"After finishing building the bundle, you can also try the sample"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},"Replace the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ResourceConnectionString")," in the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"samples/Server/appsettings.json")," file with the connection string from your Azure Communication Services resource, which is listed in the Azure Portal under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Keys"),".")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},"Replace the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"EndpointUrl")," in the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"samples/Server/appsettings.json")," file with the endpoint from your Azure Communication Services resource, which is listed in the Azure Portal under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Keys"),".")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},"Run this command to start the server:"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"rushx start\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",{start:4},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Browse to http://localhost:3000")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Composites/Cross-Framework Support",id:"use-composite-in-non-react-environment",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1434:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ParticipantItem } from '@azure/communication-react';\nimport { PersonaPresence } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomAvatarExample: () => JSX.Element = () => {\n  const avatarStyle = {\n    borderRadius: 20,\n    display: 'block'\n  };\n  const onRenderAvatar = (): JSX.Element => {\n    return (\n      <img\n        src=\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png\"\n        width=\"32px\"\n        height=\"32px\"\n        style={avatarStyle}\n      />\n    );\n  };\n\n  return (\n    <ParticipantItem displayName=\"Annie Lindqvist\" presence={PersonaPresence.online} onRenderAvatar={onRenderAvatar} />\n  );\n};\n"},1435:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ParticipantItem, ParticipantItemProps } from '@azure/communication-react';\nimport { PersonaPresence, Icon, Stack, mergeStyles } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomIconExample: () => JSX.Element = () => {\n  const onRenderIcon = (props?: ParticipantItemProps): JSX.Element | null => {\n    if (props?.displayName === 'Patrick') {\n      return <Icon iconName=\"FavoriteStar\" style={{ cursor: 'inherit' }} />;\n    } else if (props?.me) {\n      return null;\n    }\n    return <Icon iconName=\"AddFriend\" />;\n  };\n\n  const containerStyle = mergeStyles({ width: '15rem' });\n\n  return (\n    <Stack className={containerStyle}>\n      <ParticipantItem\n        displayName=\"Spongebob\"\n        presence={PersonaPresence.online}\n        me={true}\n        onRenderIcon={onRenderIcon}\n      />\n      <ParticipantItem displayName=\"Patrick\" presence={PersonaPresence.online} onRenderIcon={onRenderIcon} />\n      <ParticipantItem displayName=\"Sandy\" presence={PersonaPresence.online} onRenderIcon={onRenderIcon} />\n    </Stack>\n  );\n};\n"},1436:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ParticipantItem } from '@azure/communication-react';\nimport { IContextualMenuItem, PersonaPresence } from '@fluentui/react';\nimport React from 'react';\n\nexport const ParticipantItemExample: () => JSX.Element = () => {\n  const menuItems: IContextualMenuItem[] = [\n    {\n      key: 'Mute',\n      text: 'Mute',\n      onClick: () => alert('Mute')\n    },\n    {\n      key: 'Remove',\n      text: 'Remove',\n      onClick: () => alert('Remove')\n    }\n  ];\n\n  return <ParticipantItem displayName=\"Johnny Bravo\" menuItems={menuItems} presence={PersonaPresence.online} />;\n};\n"},1437:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipantListParticipant, FluentThemeProvider, ParticipantList } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nexport const DefaultCallParticipantListExample: () => JSX.Element = () => {\n  const mockParticipants: CallParticipantListParticipant[] = [\n    {\n      userId: 'user1',\n      displayName: 'You',\n      state: 'Connected',\n      isMuted: true,\n      isScreenSharing: false,\n      isRemovable: true\n    },\n    {\n      userId: 'user2',\n      displayName: 'Hal Jordan',\n      state: 'Connected',\n      isMuted: true,\n      isScreenSharing: true,\n      isRemovable: true\n    },\n    {\n      userId: 'user3',\n      displayName: 'Barry Allen',\n      state: 'Idle',\n      isMuted: false,\n      isScreenSharing: false,\n      isRemovable: true\n    },\n    {\n      userId: 'user4',\n      displayName: 'Bruce Wayne',\n      state: 'Connecting',\n      isMuted: false,\n      isScreenSharing: false,\n      isRemovable: false\n    }\n  ];\n\n  return (\n    <FluentThemeProvider>\n      <Stack>\n        <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n        <ParticipantList participants={mockParticipants} myUserId={'user1'} />\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1438:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ParticipantListParticipant, ParticipantList } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nexport const DefaultChatParticipantListExample: () => JSX.Element = () => {\n  const mockParticipants: ParticipantListParticipant[] = [\n    {\n      userId: 'user 1',\n      displayName: 'You',\n      isRemovable: true\n    },\n    {\n      userId: 'user 2',\n      displayName: 'Hal Jordan',\n      isRemovable: true\n    },\n    {\n      userId: 'user 3',\n      displayName: 'Barry Allen',\n      isRemovable: true\n    },\n    {\n      userId: 'user 4',\n      displayName: 'Bruce Wayne',\n      isRemovable: true\n    }\n  ];\n\n  return (\n    <Stack>\n      <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n      <ParticipantList participants={mockParticipants} />\n    </Stack>\n  );\n};\n"},1439:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipantListParticipant,\n  FluentThemeProvider,\n  ParticipantList,\n  ParticipantItem,\n  ParticipantListParticipant\n} from '@azure/communication-react';\nimport { Icon, IContextualMenuItem, PersonaPresence, Stack } from '@fluentui/react';\nimport React, { useState } from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker',\n    state: 'Connected',\n    isMuted: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Matthew Murdock',\n    state: 'Idle',\n    isMuted: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Frank Castiglione',\n    state: 'Connecting',\n    isMuted: false,\n    isRemovable: false\n  }\n];\n\nexport const InteractiveCallParticipantListExample: () => JSX.Element = () => {\n  const [participants, setParticpants] = useState<any[]>(mockParticipants);\n\n  const mockMyUserId = 'user1';\n\n  const onRenderParticipant = (participant: ParticipantListParticipant): JSX.Element => {\n    const participantIndex = participants.map((p) => p.userId).indexOf(participant.userId);\n\n    const callingParticipant = participants[participantIndex] as CallParticipantListParticipant;\n\n    let presence: PersonaPresence | undefined = undefined;\n    if (callingParticipant) {\n      if (callingParticipant.state === 'Connected') {\n        presence = PersonaPresence.online;\n      } else if (callingParticipant.state === 'Idle') {\n        presence = PersonaPresence.away;\n      } else if (callingParticipant.state === 'Connecting') {\n        presence = PersonaPresence.offline;\n      }\n    }\n\n    const menuItems: IContextualMenuItem[] = [\n      {\n        key: 'mute',\n        text: callingParticipant.isMuted ? 'Unmute' : 'Mute',\n        onClick: () => {\n          const newParticipants = [...participants];\n          newParticipants[participantIndex].isMuted = !participants[participantIndex].isMuted;\n          setParticpants(newParticipants);\n        }\n      }\n    ];\n\n    const onRenderIcon = callingParticipant?.isMuted ? () => <Icon iconName=\"MicOff2\" /> : () => <></>;\n\n    if (participant.displayName) {\n      return (\n        <ParticipantItem\n          displayName={participant.displayName}\n          me={participant.userId === mockMyUserId}\n          menuItems={menuItems}\n          presence={presence}\n          onRenderIcon={onRenderIcon}\n        />\n      );\n    }\n    return <></>;\n  };\n\n  return (\n    <FluentThemeProvider>\n      <Stack>\n        <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n        <ParticipantList\n          participants={participants}\n          myUserId={mockMyUserId}\n          onRenderParticipant={onRenderParticipant}\n        />\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1440:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipantListParticipant, FluentThemeProvider, ParticipantList } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipantListParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true,\n    isRemovable: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: true\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false,\n    isRemovable: false\n  }\n];\n\nexport const ParticipantListWithExcludedUserExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <Stack>\n        <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n        <ParticipantList participants={mockParticipants} myUserId={'user1'} excludeMe={true} />\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1441:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport { Icon } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomIconExample: () => JSX.Element = () => (\n  <FluentThemeProvider>\n    <div style={{ width: '31.25rem' }}>\n      <SendBox\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n        styles={{ sendMessageIconContainer: { marginTop: '0.65rem' } }}\n        onRenderIcon={() => <Icon iconName=\"AirplaneSolid\" />}\n      />\n    </div>\n  </FluentThemeProvider>\n);\n"},1442:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CustomStylingExample: () => JSX.Element = () => {\n  const sendBoxStyles = {\n    root: { border: '2px solid gray', borderRadius: '10px', padding: '10px' },\n    systemMessage: { border: '1px solid darkred', background: 'lightpink' },\n    textField: { background: 'ghostwhite' }\n    // The sub-components below are also available\n    // sendMessageIconContainer: { },\n    // sendMessageIcon: { }\n  };\n  return (\n    <FluentThemeProvider>\n      <div style={{ width: '31.25rem' }}>\n        <SendBox\n          onSendMessage={async () => {\n            return;\n          }}\n          onTyping={async () => {\n            return;\n          }}\n          styles={sendBoxStyles}\n          systemMessage=\"This is a system message\"\n        />\n      </div>\n    </FluentThemeProvider>\n  );\n};\n"},1443:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const SendBoxExample: () => JSX.Element = () => (\n  <FluentThemeProvider>\n    <div style={{ width: '31.25rem' }}>\n      <SendBox\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n      />\n    </div>\n  </FluentThemeProvider>\n);\n"},1444:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const SendBoxWithSystemMessageExample: () => JSX.Element = () => (\n  <FluentThemeProvider>\n    <div style={{ width: '31.25rem' }}>\n      <SendBox\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n        systemMessage=\"Please wait 30 seconds to send new messages\"\n      />\n    </div>\n  </FluentThemeProvider>\n);\n"},1445:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"statefulclient-bestpractices",title:"Stateful Client/Best Practices",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"best-practices"},"Best Practices"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"We are sharing some of our recommended best practices when handling state with Azure Communication Services UI Library."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-the-stateful-clients"},"Use the Stateful Clients"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Managing the complex state of a calling or chat sesion can be challenging. This was a complex problem we found we were in and we think many of our developer community\nwill run into this challenge themselves. We wanted to find a convenient way to store this information on the client in a way that plays nicely with our components we are offering.\nBy using the stateful client for calling or chat, you are on our recommended path for powering your own communications experience using Azure Communication Services."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-usepropsfor"},"Use usePropsFor"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If you are using our provided UI Components, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," will help you get integrated with the underlying functionality quickly. This provides a series of properties our\nprovided components are expecting from the stateful client to render an experience your users will be expecting. This is the fastest way to get your experience up and running with Azure Communication Services."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"you-can-use-your-own-ui-components"},"You can use your own UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Today you can use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useSelector")," to connect your own components to create your own experiences! We use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useSelector")," under the hood when you leverage our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," hook.\nWe wanted to ensure that developers wanting to create custom components had the same development path that we were using as well. Using this development path allows\nyou to start on the path that we use as well to create amazing components."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"populating-the-devicemanager-state"},"Populating the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"DeviceManager")," State"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"When using Stateful Calling, the call related state will be automatically retrieved for you.\nHowever, this is not the case for ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManager")," state.\nTo be able to retrieve ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManager")," state from the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"StatefulCallClient"),"s state, you must trigger the appropriate APIs to populate the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManager")," state."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"li"},"DeviceManager.askPermission()"),"  this must be called to ask for device permissions from the user. The result of their decisions will be stored in DeviceManagerState.deviceAccess."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"li"},"DeviceManager.getCameras()"),"  When called, the result will be stored in DeviceManagerState.cameras."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"li"},"DeviceManager.getMicrophones()"),"  When called, the result will be stored in DeviceManagerState.microphones."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"li"},"DeviceManager.getSpeakers()"),"  When called, the result will be stored in DeviceManagerState.speakers")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-of-selectedcamera-inside-the-devicemanager"},"Use of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"selectedCamera")," inside the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"DeviceManager")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To make Stateful Calling easier to use weve added a property to the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManagerState")," called ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"selectedCamera"),".\nThis is not a proxy of the SDK state and is completely controlled by you.\nIt is populated when you set it and updated when you update it. It has no bearing on the function of the SDK and not automatically used by the SDK."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-of-createview-and-disposeview-on-the-statefulcallclient"},"Use of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"createView")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"disposeView")," on the StatefulCallClient"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To allow developers to generate a HTMLElement/view of a Stateful VideoStream, we provide a createView and disposeView API.\nThese APIs are located in StatefulCallClient and should only be used for scenarios where developers want to generate their own components to use in conjunction with the UI Library.\nThere are three scenarios to using these APIs:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Rendering a RemoteVideoStreamState"),"\nYou are required to call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," with a valid ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"participantIdentifier"),", and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"remoteVideoStreamState"),".\nThe ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," is async and if your architecture can support awaiting for it we recommend you do that.\nOnce the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," completes the view will be stored under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState.RemoteParticipants.[your remote participant].videoStream.[your videostream].view"),".\nIf you cannot await the result of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView"),", it is fine to call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," again, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," will no-op the second call. Once the view has been created, the call state will be automatically updated and you can check the state for the view.\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CreateView")," will not allow creating multiple view of the same stream.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Rendering a LocalVideoStreamState in a Call"),"\nSame as #1 except this time ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," only requires a valid ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStreamState"),".\nNote that this will only work if the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStream")," is already part of the call (youll have to first call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Call.startVideo")," to add the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStream")," to the Call).\nEverything else is the same as #1 after this except the view can be found in ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState.localVideoStreams.(your videostream).view"),".")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Rendering a LocalVideoStreamState when not in a call"),"\nThis scenario supports the case if you want to see a video render without adding that stream to the call, for instance ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalPreview")," scenario.\nIn this case ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," requires only a valid ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStreamState"),".\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CreateView")," will put the created view under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManagerState.unparentedViews.(your videostream).view"),".\nYou can access this Map using your original ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStreamState")," as the key."))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To debug ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"disposeView"),", they emit ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"console.warns")," when used incorrectly that can be tracked."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"track-changes-to-callid"},"Track Changes to ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"callId")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"One major gotcha with using Stateful Calling is that ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId")," may change and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId")," is used to look up data in Stateful state.\nIf you have an old callId and the callId changed, you will not be able to access or find ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState")," in ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClientState"),".\nTo work around, we recommend you do not cache the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId")," and instead cache the entire call object.\nThe id in the call object will be kept up to date and when ever you access ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClientState")," use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"call.id"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"detecting-screenshare-participant"},"Detecting Screenshare Participant"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To make Stateful Calling easier to use we added a ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"screenshareRemoteParticipant")," property to ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState"),".\nIf there is a remote participant screensharing, this will allow you to quickly look up that participants state by doing something like this:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"CallState.remoteParticipants.get(CallState.screenshareRemoteParticipant);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"This property will be undefined if there are no remote participants screensharing.\nNote that this only applies to remote screenshares and not local screenshares."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"detecting-transcription-and-recording"},"Detecting Transcription and Recording"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Stateful Calling will manage transcription/recording for you.\nYou only need to simply check the states under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState.transcription")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState.recording"),"."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/Best Practices",id:"statefulclient-bestpractices",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1446:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"statefulclient-overview",title:"Stateful Client/Overview",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"overview-of-stateful-client"},"Overview of Stateful Client"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Azure Communication Service UI Library exposes stateful clients for calling and chat.\nStateful clients are a 1:1 representation of the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatClient")," exposed by the underlying low-level calling and chat SDKs.\nThey simply add a state layer on top of it to help track state that can be rendered as part of the UI.\nThey can be used in the same way as low-level clients would be used, so developers can use it to query the service and handle events (i.e. participant added or message recieved).\nStateful clients are agnostic to any specific state management framework."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"component-binding-with-stateful-clients"},"Component Binding with Stateful Clients"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To make it simpler to connect the stateful client with UI Components, the UI Library exposes helpers, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/statefulclient-reacthooks-usepropsfor--page"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"usePropsFor")),", to generate props\nThese helpers aid in extracting the correct set of props required for different UI Components.\nThey expose both data for the UI Components to render such as a message list or a participants remote video, and default handlers for UI Components action such as sending a message."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"installing-stateful-clients"},"Installing Stateful Clients"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"npm install")," command to install the Azure Communication Services UI Library for JavaScript."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-react\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," specifies core Azure Communication Services as ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"peerDependencies")," so that\nyou can most consistently use the API from the core libraries in your application. You need to install those libraries as well:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-calling@1.3.2\nnpm install @azure/communication-chat@1.1.0\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"calling-statefulclient"},"Calling StatefulClient"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Using ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createStatefulCallClient"),", developer can generate a stateful version of the call client."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import { createStatefulCallClient } from '@azure/communication-react';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\n\nconst endpointUrl = '<ENDPOINT>';\nconst userAccessToken = '<USER_ACCESS_TOKEN>';\nconst tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n\nconst statefulCallClient = createStatefulCallClient({\n  userId: userId,\n});\n\n// You can then use the `statefulCallClient` in the same way as a `CallClient` with a slight variation.\n\nconst callAgent = await statefulCallClient.createCallAgent(tokenCredential, {displayName: 'Optional User Name'})\n\nconst call = callAgent.join({groupId: <GUID>})\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To interact with the call, developers have access to ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulCallClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallAgent"),". The stateful clients are a 1:1 representation.\nFor state to be tracked, developers should use the stateful clients to query the service and listen to events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"accessing-the-device-manager"},"Accessing the Device Manager"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Through the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulCallClient"),", developers can access the device manager to query the device available for the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const deviceManager = await statefulCallClient.getDeviceManager();\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The device manager allows developers to access the local video stream to render for the user ahead of joining a call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const cameras = await deviceManager.getCameras();\nconst camera = cameras[0];\nconst localCameraStream = { source: camera, mediaStreamType: 'Video' } as LocalVideoStreamState;\nconst view = statefulClient.createView(localCameraStream);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For more information on the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManager"),", see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/javascript/api/azure-communication-services/@azure/communication-calling/devicemanager?view=azure-communication-services-js",target:"_blank",rel:"nofollow noopener noreferrer"},"Device Management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"chat-statefulclient"},"Chat StatefulClient"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Using the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createStatefulChatClient"),", developer can generate a stateful version of the chat client."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import { createStatefulChatClient } from '@azure/communication-react';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\n\nconst endpointUrl = '<ENDPOINT>';\nconst userAccessToken = '<USER_ACCESS_TOKEN>';\nconst tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n\nconst statefulChatClient = createStatefulChatClient({\n  userId: userId,\n  displayName: displayName,\n  endpoint: endpointUrl,\n  credential: tokenCredential\n});\n\n// You can then use the `statefulChatClient` in the same way as a `ChatClient` with a slight variation.\n\nconst chatThreadClient = await statefulChatClient.createChatThread({});\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To interact with the chat thread, developers have access ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulChatClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"chatThreadClient"),". The stateful clients are a 1:1 representation.\nFor state to be tracked, developers should use the stateful clients to query the service and listen to events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"access-the-chat-thread-client"},"Access the Chat Thread Client"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The Chat Thread Client allows developers to access a variety of methods to query participants and send messages to a thread."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const sendMessageRequest = {\n  content: 'Hello! Can you share the deck for the conference?'\n};\n\nlet sendMessageOptions = {\n  senderDisplayName: 'Jack',\n  type: 'text'\n};\nconst sendChatMessageResult = await chatThreadClient.sendMessage(sendMessageRequest, sendMessageOptions);\nconst messageId = sendChatMessageResult.id;\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For more information on the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatThreadClient"),", see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://azuresdkdocs.blob.core.windows.net/$web/javascript/azure-communication-chat/1.0.0/classes/chatthreadclient.html",target:"_blank",rel:"nofollow noopener noreferrer"},"ChatThreadClient")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"capabilities"},"Capabilities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Stateful clients enable developers to access all the APIs that low-level calling and chat SDKs expose.\nFor a complete list of capabilities see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/voice-video-calling/calling-sdk-features",target:"_blank",rel:"nofollow noopener noreferrer"},"Calling Overview")," and\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/chat/sdk-features",target:"_blank",rel:"nofollow noopener noreferrer"},"Chat Overview"),".\nAt a high level, stateful clients allow developers the following capabilities."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Capabilities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Example"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Read state"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Query the state ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.state")," to access properties such as ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.state.messsages"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Handle state event changes"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Subscribe to events ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.onStateChange()")," and unsubscribe from events ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.offStateChange()"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Send commands"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Mute the microphone ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.mute()"))))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/Overview",id:"statefulclient-overview",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1447:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"statefulclient-reacthooks-setup",title:"Stateful Client/React Hooks/Setting up",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"hooks"},"Hooks"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://reactjs.org/docs/hooks-intro.html",target:"_blank",rel:"nofollow noopener noreferrer"},"React Hooks")," allows developers to use state and other react features without writing a class component."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"While you can choose any state management library such as Redux, we also provide a simple way to power react components with our Stateful SDK.\nWe provide two ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://reactjs.org/docs/hooks-custom.html",target:"_blank",rel:"nofollow noopener noreferrer"},"custom hooks")," in our library, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor()")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/statefulclient-reacthooks-useselector--page"},"useSelector()"),", that allow you to subscribe to changes in the SDK state and bind to our UI components.\nAfter binding with the custom hooks a SDK state change will trigger a re-render of the UI component, and events on the component will call into the SDK clients."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"before-you-start"},"Before you Start"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Before you start, you need to wrap your whole App with Providers.\nThey give you access to global variables (like Stateful ChatClient/CallClient) for our hooks to consume.\nThere are different Providers for building apps with varying functionality:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"chat"},"Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For your Chat app, use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatClientProvider")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatThreadClientProvider")," to give hooks access to the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatThreadClient"),".\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulChatClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"chatThreadClient")," instances need to be passed to the Provider when you wrap your app.\nFor more information on creating them, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/statefulclient-overview--page"},"Overview")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"ReactDOM.render(\n  <ChatClientProvider chatClient={statefulChatClient}>\n    <ChatThreadClientProvider chatThreadClient={ChatThreadClient}>\n      <App />\n    </ChatThreadClientProvider>\n  </ChatClientProvider>,\n  document.getElementById('root')\n);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"calling"},"Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For your Chat app, use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClientProvider"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallAgentProvider")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallProvider")," to give hooks access to the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClient"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallAgentClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Call"),".\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulCallClient"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callAgent")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"call")," instances need to be passed to the Provider when you wrap your app.\nFor more information on creating them, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/statefulclient-overview--page"},"Overview")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"ReactDOM.render(\n  <CallClientProvider callClient={statefulCallClient}>\n    <CallAgentProvider callAgent={callAgent}>\n      <CallProvider call={call}>\n        <App />\n      </CallProvider>\n    </CallAgentProvider>\n  </CallClientProvider>,\n  document.getElementById('root')\n);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"next"},"Next"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Once you have wrapped your entire app with providers, you are now can use the usePropsFor() method inside of your app to connect your components to the state."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To see a full end-to-end example using providers, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/quickstarts-statefulclient--page"},"Getting Started with StatefulClient")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/React Hooks/Setting up",id:"statefulclient-reacthooks-setup",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1448:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"statefulclient-reacthooks-usepropsfor",title:"Stateful Client/React Hooks/UsePropsFor",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"usepropsfor-a-nameusepropsfora"},"usePropsFor ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{name:"usePropsFor"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If you are using React Component from our communication-react components, usePropsFor is the go-to hook.\nIt provides all the required props to power a feature component.\nIt subscribes to state changes of stateful clients, gets props designed for your component, and triggers a re-render whenever the props change."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To see a full end-to-end example using usePropsFor, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/quickstarts-statefulclient--page"},"Getting Started with StatefulClient")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"usepropsfor-calling-app-example"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"h2"},"usePropsFor")," Calling App Example"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import React from 'react';\nimport { VideoGallery, usePropsFor } from '@azure/communication-react';\n\nexport const ChatScreen = () => {\n  const props = usePropsFor(VideoGallery);\n  return <VideoGallery {...props} />;\n};\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"usepropsfor-chat-app-example"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"h2"},"usePropsFor")," Chat App Example"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import React from 'react';\nimport { MessageThread, usePropsFor } from '@azure/communication-react';\n\nexport const ChatScreen = () => {\n  const props = usePropsFor(MessageThread);\n  return <MessageThread {...props} />;\n};\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," supports the following components:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Chat")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-messagethread--message-thread"},"MessageThread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-sendbox--send-box"},"SendBox")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-typingindicator--typing-indicator"},"TypingIndicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-participantlist--participant-list"},"ParticipantList"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Calling")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-videogallery--video-gallery"},"VideoGallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-participantlist--participant-list"},"ParticipantList")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-controlbar-buttons-camera--camera"},"CameraButton")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-controlbar-buttons-endcall--end-call"},"EndCallButton")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-controlbar-buttons-microphone--microphone"},"MicrophoneButton")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-controlbar-buttons-options--options"},"DevicesButton")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/docs/ui-components-controlbar-buttons-screenshare--screen-share"},"ScreenShareButton"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"choose-your-target"},"Choose your target"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"usePropsFor() is context-aware. It picks out props from the relevant Provider for the component. One exception is ParticipantList -- a component applicable to both chat and calling settings. Thus, ChatClientProvider and CallingClientProvider both provide props for this component","*",". Thus, usePropsFor() can not determine which provider should be used to satisfy the props. You must explicitly set the target to use:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"*","only ParticipantList component is shared by both chat and calling")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import React from 'react';\nimport { ParticipantList, usePropsFor } from '@azure/communication-react';\n\n// This will show 2 different participantLists in parallel\nexport const ParicipantLists = () => {\n  const chatParticipantProps = usePropsFor(ParticipantList, 'chat');\n  const callingParticipantProps = usePropsFor(ParticipantList, 'calling');\n  return (\n    <>\n      <ParticipantList {...chatParticipantProps} />\n      <ParticipantList {...callingParticipantProps} />\n    </>\n  );\n};\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"under-the-hood-of-usepropsfor"},"Under the Hood of usePropsFor"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"usePropsFor() is a function that provides all you need to run a component in our library.\nIt combines 2 tasks for generating the component's props for you:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Finds the right selector designed for the component, then call useSelector()"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Constructs a set of handlers tailored for the component")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"using-usepropsfor-with-custom-components"},"Using usePropsFor with Custom Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"You can use the usePropsFor function for your own custom components by matching the props structure of the supported UI Components.\nBy passing the component that matches your custom components prop structure, you can then use the outputted props on your own custom component.\nThis means you could build your own ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Video Gallery")," with a custom layout using our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Grid Layout")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Video Tile")," components, and still leverage our usePropsFor helper.\nIn cases, where matching the prop structure is not possible, the stateful clients can still be leveraged to extract and maintain your own props.\nFor more information, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/statefulclient-reacthooks-useselector--page"},"useSelector"),"."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/React Hooks/UsePropsFor",id:"statefulclient-reacthooks-usepropsfor",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1449:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"statefulclient-reacthooks-useselector",title:"Stateful Client/React Hooks/UseSelector",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"useselector-a-nameuseselectora"},"useSelector ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{name:"useSelector"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useSelector")," allows you to provide your own selector function that maps the stateful SDK state to your own props for your own component. It subscribes to state changes and runs the selector every time when anything changes in the state, but note that it will only trigger a component re-render when the return value of the selector changes."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"when-to-call-useselector"},"When to Call useSelector"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"By default, if you are satisfied with props we prepared for component library, all you need is to call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," to power our component. If just one or two props need to be filtered or modified, directly overriding properties from return value of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," is recommended. But sometimes you might want to call use selector instead when:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Override the way how it generates props from state"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Write your own components (which we don't provide dedicated selectors for it)")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"basic-example"},"Basic Example:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const userInfoSelector = (state) => ({\n  id: state.userId\n  userName: state.displayName\n});\n\nconst chatInfoProps = useSelector(userInfoSelector);\n\nconst ChatInfo = ({id: string, userName: string}) => {\n  return <div> userName: {userName}, id: {id} </div>;\n}\n\n<ChatInfo {...chatInfoProps} />\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"passing-your-own-props"},"Passing your own props"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"When creating your own selector, you can inject your own custom properties through the second parameter of the selector function."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const threadSelector = (state, props) => ({\n  thread: state.threads[props.threadId]\n});\n\nconst selectorProps = useMemo(() => ({ threadId: myThreadId }), [threadId]);\n\nconst threadProps = useSelector(threadSelector, selectorProps);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If you don't pass in any selector props or pass an undefined value into useSelector(), useSelector() will also provide a default props object for you, which includes threadId/callId under chat/call context, so this also works:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const threadSelector = (state, props) => ({\n  thread: state.threads[props.threadId] // default props = {threadId: string} in chat, {callId: string} in call\n});\n\nconst threadProps = useSelector(threadSelector);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"choose-your-target"},"Choose your target"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Similar to usePropsFor, useSelector() is context-aware. It picks out props from available context from providers. Thus, when it is under both ChatClientProvider and CallingClientProvider, it can not determine which provider should be used to satisfy the props. You must explicitly set the target to use:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const threadSelector = (state, props) => ({\n  thread: state.threads[props.threadId]\n});\n\nconst threadProps = useSelector(threadSelector, undefined /* get default selector props */, 'chat');\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"memoizing-your-selector"},"Memoizing your Selector"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"(Recommended for optimized perf)"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"While this basic example will work without problems, but it is not a good way to optimize your app perf, we recommend to use the reselect library to enable memoization for selectors to get better performance, check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://redux-toolkit.js.org/api/createSelector#createselector",target:"_blank",rel:"nofollow noopener noreferrer"},"reselect's official docs")," for more information."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import { createSelector } from 'reselect';\n\nconst userInfoSelector = createSelector([(state) => state.userId, (state) => state.displayName], (id, userName) => ({\n  id,\n  userName\n}));\n\nconst chatInfoProps = useSelector(userInfoSelector);\n\nconst ChatInfo = ({ id: string, userName: string }) => {\n  return (\n    <div>\n      {' '}\n      userName: {userName}, id: {id}{' '}\n    </div>\n  );\n};\n\n<ChatInfo {...chatInfoProps} />;\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"override-default-behaviors"},"Override Default Behaviors"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"While we provide a set of default props(which includes data and handler functions) for our UI library component, you might find it doesn't fit all you needs, there are several different ways you can choose to override the default behavior."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"write-your-own-handler-function"},"Write your own Handler Function"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"In some situations, you may want to override default behavior and place your own API call (like call another service, or call another API in our stateful SDK). Here is an example of how to change the message before using the stateful client to send it."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const sendBoxProps = usePropsFor(SendBox);\n// This hook will get stateful client you created\nconst chatThreadClient = useThreadClient();\n\nconst onSendMessage = useCallback(\n  (message: string) => {\n    const sendMessageRequest = {\n      `: ${content}`,\n      senderDisplayName: chatClient.getState().displayName\n    };\n    // directly call into stateful client\n    await chatThreadClient.sendMessage(sendMessageRequest);\n  },\n  [chatThreadClient]\n);\n\n<SendBox {...sendBoxProps} onSendMessage={onSendMessage} />;\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"override-selector"},"Override Selector"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"With the hooks that we provide it is also possible to override a selector without re-writing the default handlers."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const customSelector = createSelector(....); // create your own selector\nconst messageThreadProps = useSelector(customSelector);\nconst messageThreadHandlers = useChatHandlers(MessageThread);\n\n\n<MessageThread {...messageThreadProps} {...messageThreadHandlers} />\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"choose-your-own-overridden-combination"},"Choose your own Overridden Combination"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"By calling ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useSelector"),"/",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor"),", you can get the right combination of default selector + overrided handler/default handler + overrided selector for your own needs. You can even entirely override the whole behavior by writing your own handler and selectors:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const customSelector = createSelector(....); // create your own selector\nconst messageThreadProps = useSelector(customSelector);\n// This hook will get stateful client you created\nconst chatThreadClient = useThreadClient();\n\n// Create your own handlers\nconst onMessageSeen = useCallback((message: string) => {\n  await chatThreadClient.sendReadReceipt({ chatMessageId });\n}, [chatThreadClient]);\n\n<MessageThread {...messageThreadProps} onMessageSeen={onMessageSeen} />\n")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/React Hooks/UseSelector",id:"statefulclient-reacthooks-useselector",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1450:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TypingIndicator } from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const CustomStylingSnippet: () => JSX.Element = () => {\r\n  const twoTypingUsers = [\r\n    { userId: '1', displayName: 'User1' },\r\n    { userId: '2', displayName: 'User2' }\r\n  ];\r\n\r\n  const styles = {\r\n    root: { border: '1px solid darkblue', width: '400px', padding: '5px' },\r\n    typingUserDisplayName: { font: '15px Tahoma , sans-serif;' },\r\n    typingString: { color: 'slategrey' }\r\n  };\r\n\r\n  return <TypingIndicator typingUsers={twoTypingUsers} styles={styles} />;\r\n};\r\n"},1451:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TypingIndicator, CommunicationParticipant } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CustomUserRenderSnippet: () => JSX.Element = () => {\n  const avatarStyle = {\n    borderRadius: 20,\n    display: 'inline-block',\n    width: '2rem',\n    height: '2rem'\n  };\n  const imageMap = {\n    ['1']: 'https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png',\n    ['2']: 'https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-male.png'\n  };\n\n  const onRenderUser = (user: CommunicationParticipant): JSX.Element => {\n    return (\n      <>\n        <img src={imageMap[user.userId]} style={avatarStyle} /> {user.displayName}\n      </>\n    );\n  };\n\n  const twoTypingUsers = [\n    { userId: '1', displayName: 'Annie Lindqvist' },\n    { userId: '2', displayName: 'Ted Randall' }\n  ];\n\n  return <TypingIndicator typingUsers={twoTypingUsers} onRenderUser={onRenderUser} />;\n};\n"},1452:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TypingIndicator, CommunicationParticipant } from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const TypingIndicatorSnippet: () => JSX.Element = () => {\r\n  const oneTypingUsers = [{ userId: '1', displayName: 'User1' }];\r\n  const twoTypingUsers = [\r\n    { userId: '1', displayName: 'User1' },\r\n    { userId: '2', displayName: 'User2' }\r\n  ];\r\n\r\n  const twentyUsers: CommunicationParticipant[] = [];\r\n  for (let idx = 0; idx < 20; idx++) {\r\n    twentyUsers.push({ userId: `${idx}`, displayName: `User${idx}` });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <TypingIndicator typingUsers={oneTypingUsers} />\r\n      <TypingIndicator typingUsers={twoTypingUsers} />\r\n      <TypingIndicator typingUsers={twentyUsers} />\r\n      <TypingIndicator typingUsers={oneTypingUsers} />\r\n    </>\r\n  );\r\n};\r\n"},1453:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker',\n    state: 'Connected',\n    isMuted: false\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor',\n    state: 'Connecting',\n    isMuted: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock',\n    state: 'Idle',\n    isMuted: false\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nexport const CustomAvatarVideoGalleryExample: () => JSX.Element = () => {\n  const onRenderAvatar = (userId, options, defaultOnRender): JSX.Element => {\n    switch (options.text) {\n      case 'You':\n        return (\n          <Stack>\n            <img\n              src=\"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif\"\n              style={{\n                borderRadius: '100px',\n                width: '100px',\n                position: 'absolute',\n                margin: 'auto',\n                left: 0,\n                right: 0,\n                top: 0,\n                bottom: 0\n              }}\n            />\n          </Stack>\n        );\n      case 'Thor':\n        return (\n          <Stack>\n            <img\n              src=\"https://media.giphy.com/media/7FgZWm6sGY0CNphZDJ/giphy.gif\"\n              style={{\n                width: '100px',\n                position: 'absolute',\n                margin: 'auto',\n                left: 0,\n                right: 0,\n                top: 0,\n                bottom: 0\n              }}\n            />\n          </Stack>\n        );\n      default:\n        return defaultOnRender(options);\n    }\n  };\n\n  const containerStyle = { height: '50vh' };\n\n  return (\n    <Stack style={containerStyle}>\n      <VideoGallery\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n        onRenderAvatar={onRenderAvatar}\n      />\n    </Stack>\n  );\n};\n"},1454:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery, VideoGalleryStyles } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst mockVideoElement = document.createElement('div');\nmockVideoElement.innerHTML = '<span />';\nmockVideoElement.style.width = decodeURIComponent('100%25');\nmockVideoElement.style.height = decodeURIComponent('100%25');\nmockVideoElement.style.background = 'url(https://media.giphy.com/media/QvMUP3619500qb6mtw/giphy.gif)';\nmockVideoElement.style.backgroundPosition = 'center';\nmockVideoElement.style.backgroundRepeat = 'no-repeat';\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker'\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Hal Jordan'\n  },\n  {\n    userId: 'user6',\n    displayName: 'Maria Hill'\n  },\n  {\n    userId: 'user7',\n    displayName: 'Kurt Wagner'\n  },\n  {\n    userId: 'user8',\n    displayName: 'Anna Marie LeBeau'\n  },\n  {\n    userId: 'user9',\n    displayName: 'Bruce Wayne',\n    videoStream: {\n      isAvailable: true,\n      renderElement: mockVideoElement\n    }\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const CustomStyleVideoGalleryExample: () => JSX.Element = () => {\n  const containerStyles = { height: '50vh' };\n  const customStyles: VideoGalleryStyles = {\n    root: {\n      border: 'solid 5px red'\n    },\n    gridLayout: {\n      children: { border: 'solid 5px red' }\n    },\n    horizontalGallery: {\n      children: { border: 'solid 5px red' }\n    }\n  };\n  return (\n    <Stack style={containerStyles}>\n      <VideoGallery\n        styles={customStyles}\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n      />\n    </Stack>\n  );\n};\n"},1455:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker'\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne'\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const DefaultVideoGalleryExample: () => JSX.Element = () => {\n  const containerStyle = { height: '50vh' };\n  return (\n    <Stack style={containerStyle}>\n      <VideoGallery localParticipant={MockLocalParticipant} remoteParticipants={MockRemoteParticipants} />\n    </Stack>\n  );\n};\n"},1456:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker'\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne'\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const FloatingLocalVideoExample: () => JSX.Element = () => {\n  const containerStyle = { height: '50vh' };\n  return (\n    <Stack style={containerStyle}>\n      <VideoGallery\n        layout=\"floatingLocalVideo\"\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n      />\n    </Stack>\n  );\n};\n"},1457:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery } from '@azure/communication-react';\nimport { registerIcons, Stack } from '@fluentui/react';\nimport { CameraSwitch24Regular } from '@fluentui/react-icons';\nimport React, { useState } from 'react';\n\nconst mockVideoElement = document.createElement('div');\nmockVideoElement.innerHTML = '<span />';\nmockVideoElement.style.width = decodeURIComponent('100%25');\nmockVideoElement.style.height = decodeURIComponent('100%25');\nmockVideoElement.style.background = 'url(https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif)';\nmockVideoElement.style.backgroundRepeat = 'no-repeat';\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const LocalCameraSwitcherExample: () => JSX.Element = () => {\n  registerIcons({\n    icons: {\n      LocalCameraSwitch: <CameraSwitch24Regular />\n    }\n  });\n\n  const [cameraState, setCameraState] = useState<number>(0);\n\n  const cameraButtonProps = {\n    cameras: [\n      {\n        id: '1',\n        name: 'camera 1'\n      },\n      {\n        id: '2',\n        name: 'camera 2'\n      }\n    ],\n    selectedCamera: {\n      id: '1',\n      name: 'camera 1'\n    },\n    onSelectCamera: (): Promise<void> => {\n      return new Promise(() => {\n        console.log('switch Camera');\n        if (cameraState === 0) {\n          setCameraState(1);\n          mockVideoElement.style.background = 'url(https://media.giphy.com/media/mokQK7oyiR8Sk/giphy.gif)';\n          mockVideoElement.style.backgroundPosition = 'center';\n        } else if (cameraState === 1) {\n          setCameraState(0);\n          mockVideoElement.style.background = 'url(https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif)';\n        }\n      });\n    }\n  };\n\n  const MockLocalParticipant = {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    videoStream: {\n      available: true,\n      renderElement: mockVideoElement\n    }\n  };\n\n  const MockRemoteParticipants = [\n    {\n      userId: 'user2',\n      displayName: 'Peter Parker'\n    },\n    {\n      userId: 'user3',\n      displayName: 'Thor'\n    },\n    {\n      userId: 'user4',\n      displayName: 'Matthew Murdock'\n    },\n    {\n      userId: 'user5',\n      displayName: 'Bruce Wayne'\n    }\n  ];\n\n  const containerStyle = { height: '50vh' };\n\n  return (\n    <Stack style={containerStyle}>\n      <VideoGallery\n        layout=\"floatingLocalVideo\"\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n        showCameraSwitcherInLocalPreview={true}\n        localVideoCameraCycleButtonProps={cameraButtonProps}\n      />\n    </Stack>\n  );\n};\n"},1458:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true,\n  isScreenSharingOn: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker'\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne'\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const ScreenSharingFromPresenterExample: () => JSX.Element = () => {\n  const containerStyle = { height: '50vh' };\n  return (\n    <Stack style={containerStyle}>\n      <VideoGallery\n        layout=\"floatingLocalVideo\"\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n      />\n    </Stack>\n  );\n};\n"},1459:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst mockVideoElement = document.createElement('div');\nmockVideoElement.style.width = decodeURIComponent('100%25');\nmockVideoElement.style.height = decodeURIComponent('100%25');\nmockVideoElement.style.textAlign = 'center';\nconst imageElement = document.createElement('img');\nimageElement.src = 'images/screenshare-example.png';\nimageElement.style.maxWidth = decodeURIComponent('100%25');\nimageElement.style.maxHeight = decodeURIComponent('100%25');\nmockVideoElement.appendChild(imageElement);\nconst mockScreenShareStream = {\n  isAvailable: true,\n  renderElement: mockVideoElement as HTMLElement\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker',\n    isScreenSharingOn: true,\n    screenShareStream: mockScreenShareStream\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne'\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const ScreenSharingFromViewerExample: () => JSX.Element = () => {\n  const containerStyle = { height: '50vh' };\n  return (\n    <Stack style={containerStyle}>\n      <VideoGallery\n        layout=\"floatingLocalVideo\"\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n      />\n    </Stack>\n  );\n};\n"},1460:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst mockVideoElement = document.createElement('div');\nmockVideoElement.innerHTML = '<span />';\nmockVideoElement.style.width = decodeURIComponent('100%25');\nmockVideoElement.style.height = decodeURIComponent('100%25');\nmockVideoElement.style.background = 'url(https://media.giphy.com/media/QvMUP3619500qb6mtw/giphy.gif)';\nmockVideoElement.style.backgroundPosition = 'center';\nmockVideoElement.style.backgroundRepeat = 'no-repeat';\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker'\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne',\n    videoStream: {\n      isAvailable: true,\n      renderElement: mockVideoElement\n    }\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const WithHorizontalGalleryExample: () => JSX.Element = () => {\n  const containerStyle = { height: '50vh' };\n  return (\n    <Stack style={containerStyle}>\n      <VideoGallery localParticipant={MockLocalParticipant} remoteParticipants={MockRemoteParticipants} />\n    </Stack>\n  );\n};\n"},1461:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const VideoTileExample: () => JSX.Element = () => {\n  const videoTileStyles = { root: { height: '300px', width: '400px', border: '1px solid #999' } };\n\n  return (\n    <FluentThemeProvider>\n      <VideoTile\n        styles={videoTileStyles}\n        displayName={'Maximus Aurelius'}\n        showMuteIndicator={true}\n        isMuted={true}\n        renderElement={null}\n        isMirrored={true}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1462:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile, FluentThemeProvider } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst onRenderPlaceholder = (): JSX.Element => (\n  <Stack>\n    <img\n      src=\"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif\"\n      style={{\n        borderRadius: '150px',\n        width: '150px',\n        position: 'absolute',\n        margin: 'auto',\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0\n      }}\n    />\n  </Stack>\n);\nexport const VideoTilePlaceholderExample: () => JSX.Element = () => {\n  const videoTileStyles = { root: { height: '300px', width: '400px', border: '1px solid #999' } };\n\n  return (\n    <FluentThemeProvider>\n      <VideoTile\n        userId=\"UserIdPlaceholder\"\n        styles={videoTileStyles}\n        displayName={'Maximus Aurelius'}\n        renderElement={null}\n        isMirrored={true}\n        onRenderPlaceholder={onRenderPlaceholder}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1463:function(module,exports,__webpack_require__){var map={"./Accessibility.stories.mdx":1464,"./CustomUserDataModel.stories.mdx":1465,"./ErrorHandling.stories.mdx":1466,"./Feedback.stories.mdx":1467,"./Identity.stories.mdx":1468,"./Localization.stories.mdx":1473,"./Overview.stories.mdx":1469,"./Theming.stories.mdx":1478,"./Troubleshooting.stories.mdx":1470,"./UseCases.stories.mdx":1471};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1463},1464:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"accessibility",title:"Concepts/Accessibility",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"accessibility"},"Accessibility"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Accessibility by design is a principle across Microsoft products.\nUI Library follows this principle in making sure that all UI Components are fully accessible.\nThe UI Library is fully compliant with Microsoft standards for accessibility.\nLearn more about how Microsoft develops with ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://www.microsoft.com/accessibility",target:"_blank",rel:"nofollow noopener noreferrer"},"accessibility by design"),"."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Concepts/Accessibility",id:"accessibility",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1465:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"customuserdatamodel",title:"Concepts/Custom User Data Model",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"custom-user-data-model"},"Custom User Data Model"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Azure Communication Services uses an identity agnostic model where developers can ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/identity-model",target:"_blank",rel:"nofollow noopener noreferrer"},"bring their own identities"),".\nDevelopers can bring their own data model and link it to Azure Communication Services identities.\nA developers data model for a user most likely includes information such as their display name, profile picture or avatar and other details. Information used by developers to power their own applications and platforms.\nThe UI Library makes it simple for developers to inject that user data model into the UI Components, so that when rendered they show a users provided information rather than generic information that Azure Communication Services has.\nUI Library enables these capabilities for both UI Components and Composites. Below, we will introduce the patterns to customize user data model for both types of components."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"ui-components"},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For UI Components, user data model can be customized for each individual component.\nThis provides developers the most flexibility when building truly custom experiences that might expose and reflect different parts of a users persona.\nUser data model injection is available for those components that expose user information, particularly their display name and their avatar.\nBelow you will find a table with the components that support injection and the pattern/method used to inject information."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Display Name"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Avatar"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-videotile--video-tile"},"Video Tile")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"displayName"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"placeholder")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-videogallery--video-gallery"},"Video Gallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderRemoteVideoTile and onRenderLocalVideoTile"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-messagethread--message-thread"},"Message Thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderMessage"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-typingindicator--typing-indicator"},"Typing Indicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderUsers"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderUsers")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-participantitem--participant-item"},"Participant Item")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"displayName"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-participantlist--participant-list"},"Participant List")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderParticipant"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderAvatar")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For additional examples on how this user data model injection pattern works, visit the individual component pages for each component."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"composites"},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For Composites, user data model can be customized at a composite level.\nAs turn-key experience, developers can provide a single data model mapping to the composite and the composite takes care of rendering the correct information for a user.\nComposites support user data model injection for display name and avatar across both chat and calling composites."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Composite"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Display Name"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Avatar"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/composites-call-basicexample--basic-example"},"CallComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/composites-call-basicexample--basic-example"},"displayName")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/docs/composites-call-customdatamodelexample--custom-data-model-example"},"onFetchAvatarPersonaData"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/composites-chat-basicexample--basic-example"},"ChatComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/composites-chat-basicexample--basic-example"},"displayName")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/docs/composites-chat-customdatamodelexample--custom-data-model-example"},"onFetchAvatarPersonaData"))))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For additional examples on how this user data model injection pattern works, visit the individual composite pages."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Concepts/Custom User Data Model",id:"customuserdatamodel",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1466:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"errorhandling",title:"Concepts/Error Handling",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"error-handling"},"Error handling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"An application must properly respond to unexpected conditions for a delightful end-user experience.\nThe Azure Communication Services UI library contains multiple mechanisms that an application can use for this purpose.\nChoose the error handling mechanisms that best balances your need for ease-of-use and flexibility."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"error-conditions"},"Error conditions"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Unexpected operational conditions that may occur in an application include:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},"Network drop or quality issues"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},"Inability to contact Azure Communication Services backends or quality of service degradation"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},"Inability to use or control local devices like microphone, camera etc"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},"Removal of the local participant from a call, chat or meeting")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The Azure Communication Services client side SDKs surface these error conditions in a variety of ways, including:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},"Failure of API method invocations"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},"Diagnostic events (e.g. call quality diagnostics)")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The UI library plumbs through these error conditions to its own API surfaces.\nIn addition, it provides a UI component to directly surface these conditions to end-users in your application."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Error conditions handled in this way exclude programming errors in your application,\nUI library or its dependencies. These errors are best caught upstream through robust Continuous Integration practices."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Error conditions also exclude operational errors unrelated to Azure Communication Services\n(e.g., errors caused in your application logic due to network issues). ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://reactjs.org/docs/error-boundaries.html",target:"_blank",rel:"nofollow noopener noreferrer"},"React error boundaries")," is a popular mechanism for handling\nthose errors."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"errorbar-component"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"ErrorBar")," component"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/ui-components-error-bar--error-bar"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"ErrorBar")," component")," provides an out of the box solution to surface error\nconditions in your application's UI. This component translates errors returned from client SDKs and diagnostic events into\nlocalizable error notifications to the user."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The UI Composites in this library use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ErrorBar")," to show errors. This feature can be enabled when constructing the Composite."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"advanced-error-handling"},"Advanced error handling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Applications that need more flexibility than what ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ErrorBar")," provides can leverage the error information directly."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Diagnostic events update corresponding parts of the state maintained by the stateful clients (used with UI Components) and adapters\n(used with UI Composites). e.g., Call diagnostics information is stored in the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"diagnostics")," field of the stateful calling client state."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Similarly, the latest error returned from Azure Communication Services API methods is stored in the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"latestErrors")," field of the state.\nIn addition, adapters also generate an ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"'error'")," event for each error encountered in an underlying API method invocation."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Concepts/Error Handling",id:"errorhandling",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1467:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_fluentui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(379),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"feedback",title:"Feedback",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"feedback"},"Feedback"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"In order to improve the UI Library for Azure Communication Services we need your feedback!"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"There are various ways for you to provide feedback of your experience and help us make the UI Library better."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"contribute-to-ui-library"},"Contribute to UI Library"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If there is a feature or bug you find and you are intersted in contributing directly to our code base please refer to our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/blob/main/docs/contributing-guide/1.%20getting-set-up.md",target:"_blank",rel:"nofollow noopener noreferrer"},"contribution guide"),".\nWe encourage developers to feel welcomed into the code base and directly contribute."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{href:"https://github.com/Azure/communication-ui-library/blob/main/docs/contributing-guide/1.%20getting-set-up.md",target:"_blank",iconProps:{iconName:"CodeEdit"},text:"Contribute",primary:!0,mdxType:"DefaultButton"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"report-issues"},"Report Issues"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"File feature requests, bugs or other issues against the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/issues",target:"_blank",rel:"nofollow noopener noreferrer"},"UI Library GitHub Repo"),".\nTo help us get to your issue faster use the GitHub labels provided.\nA team member will look to help out with outstanding issues and navigate them to the right owner.\nIssues on this repo should only be related to the UI Library. Issues for Azure Communication Services generally should be added to the main ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication",target:"_blank",rel:"nofollow noopener noreferrer"},"repo"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{href:"https://github.com/Azure/communication-ui-library/issues",target:"_blank",iconProps:{iconName:"Warning"},text:"Report an issue",primary:!0,mdxType:"DefaultButton"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"search-microsoft-qa"},"Search Microsoft Q&A"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For any questions on UI Library or Azure Communication Services, use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/answers/topics/azure-communication-services.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Microsoft Q&A"),".\nThere use the tag ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"azure-communication-services")," for the question to be funneled to our team."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{href:"https://docs.microsoft.com/answers/topics/azure-communication-services.html",target:"_blank",iconProps:{iconName:"QandA"},text:"Search Q&A",primary:!0,mdxType:"DefaultButton"}))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Feedback",id:"feedback",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1468:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"identity",title:"Concepts/Identity",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"identity"},"Identity"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Azure Communication Services is an ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/identity-model",target:"_blank",rel:"nofollow noopener noreferrer"},"identity-agnostic service"),".\nGenerating Azure Communication Services identities and tokens for users is a privileged operation.\nFor more information on authentication, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/authentication",target:"_blank",rel:"nofollow noopener noreferrer"},"Authentication")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/access-tokens?pivots=programming-language-javascript",target:"_blank",rel:"nofollow noopener noreferrer"},"Access Tokens")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Typically:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},"Customers deploy a secure backend service for generating Azure Communication Services identity tokens."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},"This secure service interacts with the identity service, and optionally customers' own backends to generate the Azure Communication Services identity tokens for users."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},"The identity tokens are supplied to the client application to be used with API calls to the Azure Communication Services Chat and Calling backends.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"identities-for-testing"},"Identities for Testing"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For testing purposes, you can use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/identity/quick-create-identity",target:"_blank",rel:"nofollow noopener noreferrer"},"identity generator")," on Azure Portal."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"recommended-architecture"},"Recommended Architecture"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{parentName:"p",src:"images/ui-library-architecture.png",alt:"UI Library recommended architecture with client-server architecture"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Composite and Base Components are initialized using an Azure Communication Services access token. Access tokens should be procured from Azure Communication Services through a\ntrusted service that you manage. See ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/access-tokens?pivots=programming-language-javascript",target:"_blank",rel:"nofollow noopener noreferrer"},"Quickstart: Create Access Tokens")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/tutorials/trusted-service-tutorial",target:"_blank",rel:"nofollow noopener noreferrer"},"Trusted Service Tutorial")," for more information."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"These client libraries also require the context for the call or chat they will join. Similar to user access tokens, this context should be disseminated to clients via your own trusted service. The list below summarizes the initialization and resource management functions that you need to operationalize."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Contoso Responsibilities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"UI Library Responsibilities"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Provide access token from Azure"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Pass through given access token to initialize components")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Provide refresh function"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Refresh access token using developer provided function")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Retrieve/Pass join information for call or chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Pass through call and chat information to initialize components")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Retrieve/Pass user information for any custom data model"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Pass through custom data model to components to render")))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Concepts/Identity",id:"identity",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1469:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_fluentui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(69),_constants__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(14),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"overview",title:"Overview",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{horizontal:!0,horizontalAlign:"space-between",style:_constants__WEBPACK_IMPORTED_MODULE_8__.m,mdxType:"Stack"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{style:{fontFamily:'"Segoe UI", sans-serif',color:"rgba(0,0,0,.5)",fontSize:"1.125rem",fontWeight:"500",border:"none",margin:"0rem 0rem 0.25rem 0rem",lineHeight:"1.5rem"}},"Azure Communication Services"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{style:{fontFamily:'"Segoe UI", sans-serif',color:"#0078D4",fontWeight:"600",fontSize:"2rem",margin:"0rem",lineHeight:"2.5rem"}},"UI Library")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/hero.svg",alt:"UI Library Hero Image",style:{maxHeight:"18.75rem"}}))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"p"},"Azure Communication Services UI Library")," makes it easy for you to build visual communications experiences."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Building these experiences can be challenging.\nThere are a lot of moving pieces including dynamic remote video galleries, local user controls, rendering incoming chat messages, etc.\nOn top of that developers must worry about accessibility and localization for this experiences.\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"p"},"UI Library")," is here to help!"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If you just want an out of the box communications experiences that you can drop into your application, we offer ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"p"},"Composites"),".\nIt takes only a couple lines of code to add and configure."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"In some cases, you might additional customization and control over the overall communication experiences, for that we offer ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"p"},"UI Components"),".\nThese components can be composed together to build calling and chat experiences. For example, a ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/story/ui-components-videotile--video-tile"},"Video Gallery")," or a ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/story/ui-components-messagethread--message-thread"},"Message Thread"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"These UI client libraries all use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://developer.microsoft.com/fluentui/",target:"_blank",rel:"nofollow noopener noreferrer"},"Microsoft's Fluent design language")," and assets. Fluent UI provides a foundational layer for the UI Library and is actively used across Microsoft products."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The UI Library for Azure Communication Services delivers on the Microsoft promise of diversity and inclusion.\nAll the UI Library components are fully accessible based on Microsoft ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/accessibility--page"},"accessibility")," guidelines.\nThey provide full ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/localization--page"},"localization")," to enable developers to tweak them to their target audience."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"installing-ui-library"},"Installing UI Library"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"npm i @azure/communication-react\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"composites-overview"},"Composites Overview"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Composites are higher-level components composed of UI components that deliver turn-key solutions for common communication scenarios using Azure Communication Services.\nDevelopers can easily instantiate the Composite using an Azure Communication Services access token and the required configuration attributed for call or chat."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"call-composite"},"Call composite"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/story/composites-call-basicexample--basic-example"},"CallComposite")," is providing a calling experience that allows users to start or join a call. Inside the experience users can configure their\ndevices, participate in the call with video and see other participants, including those with video turn on."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Here are visual examples of Call composite where participants have their camera turned off, then some ahve them turned on.\nPeople speaking with microphone unmuted will have their tile appearing with a blue border."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:"2rem"},style:_constants__WEBPACK_IMPORTED_MODULE_8__.m,mdxType:"Stack"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/callComposite_CamerasOff.png",alt:"Call composite where all participants have their camera turned off"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/callComposite_CamerasOn.png",alt:"Call composite where some participants have their camera turned on"}))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"When joining a Microsoft Teams call (",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/docs/examples-teamsinterop-compliancebanner--compliance-banner"},"Teams Interop experience"),"), the\nCall Composite includes a lobby experience where the user is waiting to be admitted into the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:"3rem"},style:_constants__WEBPACK_IMPORTED_MODULE_8__.m,mdxType:"Stack"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/callComposite_TeamsInterop_WaitingLobby.png",alt:"Call composite waiting to be admitted in a Teams meeting"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center",tokens:{childrenGap:"2rem"}},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{style:{textAlign:"center"}},"Popup appearing in Teams to admit ACS participant"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/callComposite_TeamsInterop_AdmissionFromTeams.png",alt:"Popup in Teams to admit ACS participants"}))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"chat-composite"},"Chat composite"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/story/composites-chat-basicexample--basic-example"},"ChatComposite")," is providing a chat experience where user can send and receive\nmessages. Message thread events such as typing indicators, whether the message has been successfully delivered or read, or participants entering\nand leaving the chat are displayed to the user as part of the chat thread."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Here is a visual example of Chat composite."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{style:_constants__WEBPACK_IMPORTED_MODULE_8__.m,mdxType:"Stack"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/chatComposite_NoParticipantsList.png",alt:"Chat composite with the participants list"}))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"ui-component-overview"},"UI Component Overview"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Pure UI Components that can be used by developers to compose communication experiences, from stitching video tiles into a grid to showcase remote participants, to organizing components to fit your applications specifications.\nUI Components support customization to give the components the right feel and look to match an applications branding and style."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Following are lists of components that can be used for specific areas."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"main-components-for-calling"},"Main Components for Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{tokens:{childrenGap:"3rem"},style:_constants__WEBPACK_IMPORTED_MODULE_8__.m,mdxType:"Stack"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/components_calling.png",alt:"example of components that can be used for calling"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/components_common.png",alt:"example of components that can be used for chat"}))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Component"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Description"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-gridlayout--grid-layout"},"Grid Layout")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Grid component to organize Video Tiles into an NxN grid")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-videotile--video-tile"},"Video Tile")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Component that displays video stream when available and a default static component when not")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-controlbar--control-bar"},"Control Bar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Container to organize DefaultButtons to hook up to specific call actions like mute or share screen")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-videogallery--video-gallery"},"Video Gallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Turn-key video gallery component which dynamically changes as participants are added")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-participantitem--participant-item"},"Participant Item")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Common component to render a call or chat participant including avatar and display name")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-participantlist--participant-list"},"Participant List")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Common component to render a call or chat participant list including avatar and display name")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"main-components-for-chat"},"Main Components for Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{style:_constants__WEBPACK_IMPORTED_MODULE_8__.m,mdxType:"Stack"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/components_chat.png",alt:"example of components that can be used for chat"}))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Component"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Description"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-messagethread--message-thread"},"Message Thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Container that renders chat messages, system messages, and custom messages")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-sendbox--send-box"},"Send Box")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Text input component with a discrete send button")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-messagestatusindicator--message-status-indicator"},"Message Status Indicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Multi-state message status indicator component to show status of sent message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"./?path=/story/ui-components-typingindicator--typing-indicator"},"Typing indicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Text component to render the participants who are actively typing on a thread")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"what-ui-artifact-is-best-for-my-project"},"What UI Artifact is Best for my Project?"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Understanding these requirements will help you choose the right client library:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"li"},"How much customization do you desire?")," Azure Communication core client libraries don't have a UX and are designed so you can build whatever UX you want. UI Library components provide UI assets at the cost of reduced customization."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"li"},"What platforms are you targeting?")," Different platforms have different capabilities.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Details about feature availability in the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"./?path=/story/usecases--page"},"UI Library is available here"),", but key trade-offs are summarized below."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Client library / SDK"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Implementation Complexity"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Customization Ability"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"th",href:"https://docs.microsoft.com/azure/communication-services/concepts/teams-interop",target:"_blank",rel:"nofollow noopener noreferrer"},"Teams Interop")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Low"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Low"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Medium"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Medium"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Core client libraries"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"High"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"High"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"platform-support"},"Platform support"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"SDK"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Windows"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"macOS"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Ubuntu"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Linux"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Android"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"iOS"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"UI SDK - Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*",", new Edge"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*",", Safari","*","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Safari","*","*","*")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"UI SDK - Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Firefox","*",", Chrome","*",", new Edge"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Firefox","*",", Chrome","*",", Safari","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Safari","*","*","*")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"*","Note that the latest version is supported in addition to the\nprevious two releases."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"*","*","Note that outgoing screen sharing is not supported for Chrome on Android."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"*","*","*","Note that Safari versions 13.1+ are supported. 1:1 calls are not supported on Safari. Outgoing video for Safari\nmacOS supported only for Safari 14+/macOS 11+. Outgoing screen sharing\nis not supported on iOS, device selection(for example choosing Bluetooth headset) is limited by OS, only one device available."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Overview",id:"overview",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1470:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"troubleshooting",title:"Concepts/Troubleshooting",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"troubleshooting"},"Troubleshooting"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Guidance for some common problems encountered when building with the Azure Communication Services UI library."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"These tips only cover problems you may encounter working with the UI library. For general troubleshooting guidance\nfor Azure Communication Services, see the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/troubleshooting-info",target:"_blank",rel:"nofollow noopener noreferrer"},"common troubleshooting guide"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"project-setup-errors"},"Project setup errors"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"npm-add-azurecommunication-react-fails-with-code-eresolve"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h3"},"npm add @azure/communication-react")," fails with 'code ERESOLVE'"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"This error occurs on projects using NPM v7+. The error log looks so:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre"},'PS C:\\tmp\\acs\\my-react-app> npm add @azure/communication-react\nnpm ERR! code ERESOLVE\nnpm ERR! ERESOLVE unable to resolve dependency tree\nnpm ERR!\nnpm ERR! node_modules/react\nnpm ERR!   peer react@"17.0.2" from react-dom@17.0.2\nnpm ERR!   node_modules/react-dom\nnpm ERR!     peer react-dom@"*" from @testing-library/react@11.2.7\nnpm ERR!     node_modules/@testing-library/react\nnpm ERR!       @testing-library/react@"^11.1.0" from the root project\nnpm ERR!     react-dom@"^17.0.2" from the root project\nnpm ERR!     2 more (@azure/communication-react, @fluentui/react)\nnpm ERR!   peer react@">= 16" from react-scripts@4.0.3\nnpm ERR!   node_modules/react-scripts\nnpm ERR!     react-scripts@"4.0.3" from the root project\nnpm ERR!   4 more (@testing-library/react, the root project, ...)\nnpm ERR!\nnpm ERR! Could not resolve dependency:\nnpm ERR! peer react@"^16.8.0" from @fluentui/react-northstar@0.51.7\nnpm ERR! node_modules/@azure/communication-react/node_modules/@fluentui/react-northstar\nnpm ERR!   @fluentui/react-northstar@"^0.51.2" from @azure/communication-react@1.0.0-beta.4\nnpm ERR!   node_modules/@azure/communication-react\nnpm ERR!     @azure/communication-react@"*" from the root project\nnpm ERR!\nnpm ERR! Fix the upstream dependency conflict, or retry\nnpm ERR! this command with --force, or --legacy-peer-deps\nnpm ERR! to accept an incorrect (and potentially broken) dependency resolution.\n')),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The root cause is that one of @azure/communication-react NPM package's dependencies\nspecifies an older version of React as a peer dependency than the one installed by default by\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://create-react-app.dev/",target:"_blank",rel:"nofollow noopener noreferrer"},"create-react-app"),".\nSince v7, npm automatically install peer dependencies for packages. This fails because of the existence of the\nmore recent version of React installed by create-react-app."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"p"},"Solution"),": We recommend using the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"--legacy-peer-deps")," flag when adding the @azure/communication-react dependency, as suggested\nby ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"npm add"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre"},"PS C:\\tmp\\acs\\my-react-app> npm add --legacy-peer-deps @azure/communication-react\n")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Concepts/Troubleshooting",id:"troubleshooting",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1471:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.f,{id:"usecases",title:"Use Cases",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"ui-library-use-cases"},"UI Library Use Cases"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"UI Library supports many use cases across calling and chat experiences.\nThese capabilities are available through UI Components and Composites.\nFor Composites, these capabilities are built directly in and exposed when the composite is integrated into an application.\nFor UI Components, these capabilities are exposed through a combination of UI functionality and underlying stateful libraries.\nTo take full advantage of these capabilities, we recommend using the UI Components with the stateful call and chat client libraries."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"calling-use-cases"},"Calling Use Cases"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Area"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Use Cases"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call Types"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Join Teams Meeting")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Join Azure Communication Services call with Group Id")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/azure/communication-services/concepts/teams-interop",target:"_blank",rel:"nofollow noopener noreferrer"},"Teams Interop")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call Lobby")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Transcription and recording alert banner")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call Controls"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Mute/unmute call")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Video on/off on call")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Screen Sharing")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"End call")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant Gallery"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Remote participants are divided into audio and video participants")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Dominant speaker capabilities sort participants to show who is speaking")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Video preview available throughout call for local user")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Default avatars available when video is off")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Shared screen content displayed on participant gallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call configuration"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Microphone device management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Camera device management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Speaker device management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Local preview available for user to check video")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participants"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant roster")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Diagnostics"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/azure/communication-services/concepts/voice-video-calling/user-facing-diagnostics",target:"_blank",rel:"nofollow noopener noreferrer"},"User Facing Diagnostics (UFD)")," are available")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"chat-use-cases"},"Chat Use Cases"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Area"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Use Cases"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat Types"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Join a Teams Meeting Chat")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Join an Azure Communication Services chat thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat Actions"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Send chat message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Receive chat message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Edit chat message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Remove chat message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat Events"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Typing Indicators")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Read Receipt")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant added/removed")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat title changed")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participants"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant roster")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"teams-interop-use-case"},"Teams Interop Use Case"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/teams-interop",target:"_blank",rel:"nofollow noopener noreferrer"},"Teams Interop")," scenarios, developers can use UI Library Components to join Teams meetings through Azure Communication Services.\nTo enable Teams Interop, developers can either use calling and chat composites directly or use UI Components to build a custom experience.\nWhen enabling applications with both calling and chat, its important to remember that the chat client can't be initialized until the participant has been admitted to the call.\nOnce admitted, the chat client can be initialized to join the meeting chat thread.\nSee the diagram below for guidance:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{parentName:"p",src:"images/teams-interop-pattern.png",alt:"Teams Interop pattern for calling and chat"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"When using UI Components to deliver Teams Interop experiences, UI Library provides examples for key pieces of the experience.\nFor example:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/story/examples-teamsinterop-lobby--lobby"},"Lobby Example"),": Sample lobby for participant to wait to be admitted to the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/story/examples-teamsinterop-compliancebanner--compliance-banner"},"Compliance banner"),": Sample banner to show the user whether the call is being recorded or not."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"./?path=/story/examples-themes-teams--teams"},"Teams Theme"),": Sample theme that makes the UI Library looks like Microsoft Teams.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"customization"},"Customization"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"UI Library exposes patterns for developers to modify components to fit the look and feel of their application.\nThese capabilities are a key area of differentiation between Composites and UI Components, where Composites provide less customization options in favor of a simpler integration experience."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Use Case"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"UI Components"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Fluent based Theming"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Experience layout is composable"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"CSS Styling can be used to modify style properties"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Icons can be replaced"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant gallery layout can be modified"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call control layout can be modified"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Data models can be injected to modify user metadata"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"observability"},"Observability"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"As part of the decoupled state management architecture of the UI Library, developers are able to access the stateful calling and chat clients directly.\nDevelopers can hook into the stateful client to read the state, handle events and override behavior to pass onto the UI Components."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Use Case"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Example"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call/Chat client state can be accessed"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Check whether a all is connected or see the participants in a thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Commands can be sent to the call and chat client"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Mute or Unmute the call client or send messages on behalf of the user")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Client events can be accessed and handled"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Handle a participant join a call or intercept a message coming into a thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"UI events can be accessed and handled"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Handle mute button click or chat send button to add your own logic")))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Use Cases",id:"usecases",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1473:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var esm=__webpack_require__(0),dist_esm=__webpack_require__(4),locales=__webpack_require__(436),src=__webpack_require__(21),jsx_runtime=__webpack_require__(2),CustomLocale_snippet_CustomLocaleSnippet=function CustomLocaleSnippet(){return locales.c.strings.cameraButton.offLabel="Start",Object(jsx_runtime.jsx)(src.y,{locale:locales.c,children:Object(jsx_runtime.jsxs)(src.p,{children:[Object(jsx_runtime.jsx)(src.o,{showLabel:!0}),Object(jsx_runtime.jsx)(src.B,{showLabel:!0}),Object(jsx_runtime.jsx)(src.F,{showLabel:!0}),Object(jsx_runtime.jsx)(src.t,{showLabel:!0})]})})};CustomLocale_snippet_CustomLocaleSnippet.displayName="CustomLocaleSnippet",CustomLocale_snippet_CustomLocaleSnippet.__docgenInfo={description:"",methods:[],displayName:"CustomLocaleSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/CustomLocale.snippet.tsx"]={name:"CustomLocaleSnippet",docgenInfo:CustomLocale_snippet_CustomLocaleSnippet.__docgenInfo,path:"stories/snippets/localization/CustomLocale.snippet.tsx"});var LocalizationProvider_snippet_LocalizationProviderSnippet=function LocalizationProviderSnippet(){return Object(jsx_runtime.jsx)(src.y,{locale:locales.e,children:Object(jsx_runtime.jsxs)(src.p,{children:[Object(jsx_runtime.jsx)(src.o,{showLabel:!0}),Object(jsx_runtime.jsx)(src.B,{showLabel:!0}),Object(jsx_runtime.jsx)(src.F,{showLabel:!0}),Object(jsx_runtime.jsx)(src.t,{showLabel:!0})]})})};LocalizationProvider_snippet_LocalizationProviderSnippet.displayName="LocalizationProviderSnippet",LocalizationProvider_snippet_LocalizationProviderSnippet.__docgenInfo={description:"",methods:[],displayName:"LocalizationProviderSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/LocalizationProvider.snippet.tsx"]={name:"LocalizationProviderSnippet",docgenInfo:LocalizationProvider_snippet_LocalizationProviderSnippet.__docgenInfo,path:"stories/snippets/localization/LocalizationProvider.snippet.tsx"});var LongTranslations_snippet_LongTranslationsSnippet=function LongTranslationsSnippet(){return Object(jsx_runtime.jsx)(src.y,{locale:locales.a,children:Object(jsx_runtime.jsxs)(src.p,{children:[Object(jsx_runtime.jsx)(src.o,{showLabel:!0}),Object(jsx_runtime.jsx)(src.B,{showLabel:!0}),Object(jsx_runtime.jsx)(src.F,{showLabel:!0}),Object(jsx_runtime.jsx)(src.t,{showLabel:!0})]})})};LongTranslations_snippet_LongTranslationsSnippet.displayName="LongTranslationsSnippet",LongTranslations_snippet_LongTranslationsSnippet.__docgenInfo={description:"",methods:[],displayName:"LongTranslationsSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/LongTranslations.snippet.tsx"]={name:"LongTranslationsSnippet",docgenInfo:LongTranslations_snippet_LongTranslationsSnippet.__docgenInfo,path:"stories/snippets/localization/LongTranslations.snippet.tsx"});var theming=__webpack_require__(77),SetRTL_snippet_SetRTLSnippet=function SetRTLSnippet(){return Object(jsx_runtime.jsx)(theming.b,{rtl:!0,children:Object(jsx_runtime.jsxs)(src.p,{children:[Object(jsx_runtime.jsx)(src.o,{showLabel:!0}),Object(jsx_runtime.jsx)(src.B,{showLabel:!0}),Object(jsx_runtime.jsx)(src.F,{showLabel:!0}),Object(jsx_runtime.jsx)(src.t,{showLabel:!0})]})})};SetRTL_snippet_SetRTLSnippet.displayName="SetRTLSnippet",SetRTL_snippet_SetRTLSnippet.__docgenInfo={description:"",methods:[],displayName:"SetRTLSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/SetRTL.snippet.tsx"]={name:"SetRTLSnippet",docgenInfo:SetRTL_snippet_SetRTLSnippet.__docgenInfo,path:"stories/snippets/localization/SetRTL.snippet.tsx"});var StringsProperty_snippet_StringsPropertySnippet=function StringsPropertySnippet(){return Object(jsx_runtime.jsxs)(src.p,{children:[Object(jsx_runtime.jsx)(src.o,{showLabel:!0,strings:{offLabel:"Start"}}),Object(jsx_runtime.jsx)(src.B,{showLabel:!0}),Object(jsx_runtime.jsx)(src.F,{showLabel:!0}),Object(jsx_runtime.jsx)(src.t,{showLabel:!0})]})};StringsProperty_snippet_StringsPropertySnippet.displayName="StringsPropertySnippet",StringsProperty_snippet_StringsPropertySnippet.__docgenInfo={description:"",methods:[],displayName:"StringsPropertySnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/StringsProperty.snippet.tsx"]={name:"StringsPropertySnippet",docgenInfo:StringsProperty_snippet_StringsPropertySnippet.__docgenInfo,path:"stories/snippets/localization/StringsProperty.snippet.tsx"});var Truncation_snippet_TruncationSnippet=function TruncationSnippet(){var buttonStyle={root:{width:"4rem",padding:"0"},label:{width:"2.75rem",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",margin:"0 auto"}};return Object(jsx_runtime.jsx)(src.y,{locale:locales.a,children:Object(jsx_runtime.jsxs)(src.p,{children:[Object(jsx_runtime.jsx)(src.o,{showLabel:!0,styles:buttonStyle}),Object(jsx_runtime.jsx)(src.B,{showLabel:!0,styles:buttonStyle}),Object(jsx_runtime.jsx)(src.F,{showLabel:!0,styles:buttonStyle}),Object(jsx_runtime.jsx)(src.t,{showLabel:!0,styles:buttonStyle})]})})};Truncation_snippet_TruncationSnippet.displayName="TruncationSnippet",Truncation_snippet_TruncationSnippet.__docgenInfo={description:"",methods:[],displayName:"TruncationSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/Truncation.snippet.tsx"]={name:"TruncationSnippet",docgenInfo:Truncation_snippet_TruncationSnippet.__docgenInfo,path:"stories/snippets/localization/Truncation.snippet.tsx"});var _excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.f,{id:"localization",title:"Concepts/Localization",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(esm.b)("h1",{id:"localization"},"Localization"),Object(esm.b)("p",null,"Localization is a key to making products that can be used across the world and by people who who speak different languages.\nUI Library will provide out of the box support for some languages and capabilities such as RTL.\nDevelopers can provide their own localization files to be used for the UI Library."),Object(esm.b)("h2",{id:"localizationprovider"},"LocalizationProvider"),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"LocalizationProvider")," is a component wrapper that sets all the strings for UI Library components using a ",Object(esm.b)("inlineCode",{parentName:"p"},"ComponentLocale"),". By default, all\ncomponents use our English (US) locale. If desired, LocalizationProvider can be used to set a different locale. Out of the box,\nthe UI library includes a set of locales usable with the UI components and composites"),Object(esm.b)("h3",{id:"usage"},"Usage"),Object(esm.b)("p",null,"To use the LocalizationProvider, import it from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," and wrap it around UI Library components. Then assign a ",Object(esm.b)("inlineCode",{parentName:"p"},"ComponentLocale")," to the ",Object(esm.b)("inlineCode",{parentName:"p"},"locale")," prop.\nFor the example below, we will localize buttons in a ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar")," in French (France) by also importing locale ",Object(esm.b)("inlineCode",{parentName:"p"},"COMPONENT_LOCALE_FR_FR")," from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react"),"."),Object(esm.b)(dist_esm.h,{code:"import {\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  LocalizationProvider,\r\n  MicrophoneButton,\r\n  ScreenShareButton,\r\n  COMPONENT_LOCALE_FR_FR\r\n} from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const LocalizationProviderSnippet = (): JSX.Element => {\r\n  return (\r\n    <LocalizationProvider locale={COMPONENT_LOCALE_FR_FR}>\r\n      <ControlBar>\r\n        <CameraButton showLabel={true} />\r\n        <MicrophoneButton showLabel={true} />\r\n        <ScreenShareButton showLabel={true} />\r\n        <EndCallButton showLabel={true} />\r\n      </ControlBar>\r\n    </LocalizationProvider>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CLocalizationProviderSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(LocalizationProvider_snippet_LocalizationProviderSnippet,{mdxType:"LocalizationProviderSnippet"})),Object(esm.b)("h3",{id:"composites"},"Composites"),Object(esm.b)("p",null,"If you want to localize your ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatComposite")," or ",Object(esm.b)("inlineCode",{parentName:"p"},"CallComposite"),", import one of our composite locales such as ",Object(esm.b)("inlineCode",{parentName:"p"},"COMPOSITE_LOCALE_FR_FR")," for French (France) and assign it\nto the ",Object(esm.b)("inlineCode",{parentName:"p"},"locale")," prop like in the example below."),Object(esm.b)(dist_esm.h,{code:"import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\r\nimport {\r\n  CallComposite,\r\n  CallAdapter,\r\n  createAzureCommunicationCallAdapter,\r\n  ChatComposite,\r\n  ChatAdapter,\r\n  createAzureCommunicationChatAdapter,\r\n  COMPOSITE_LOCALE_FR_FR\r\n} from '@azure/communication-react';\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\n\r\nexport type AppProps = {\r\n  userId: CommunicationUserIdentifier;\r\n  token: string;\r\n  displayName: string;\r\n  endpointUrl: string;\r\n  threadId: string;\r\n  locator: string;\r\n};\r\n\r\nexport const App = (props: AppProps): JSX.Element => {\r\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\r\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\r\n\r\n  // We can't even initialize the Chat and Call adapters without a well-formed token.\r\n  const credential = useMemo(() => {\r\n    try {\r\n      return new AzureCommunicationTokenCredential(props.token);\r\n    } catch {\r\n      console.error('Failed to construct token credential');\r\n      return undefined;\r\n    }\r\n  }, [props.token]);\r\n\r\n  useEffect(() => {\r\n    const createAdapter = async (): Promise<void> => {\r\n      setChatAdapter(\r\n        await createAzureCommunicationChatAdapter({\r\n          endpoint: props.endpointUrl,\r\n          userId: props.userId,\r\n          displayName: props.displayName,\r\n          credential: new AzureCommunicationTokenCredential(props.token),\r\n          threadId: props.threadId\r\n        })\r\n      );\r\n      const callLocator = isTeamsMeetingLink(props.locator)\r\n        ? { meetingLink: props.locator }\r\n        : { groupId: props.locator };\r\n      setCallAdapter(\r\n        await createAzureCommunicationCallAdapter({\r\n          userId: props.userId,\r\n          displayName: props.displayName,\r\n          credential: new AzureCommunicationTokenCredential(props.token),\r\n          locator: callLocator\r\n        })\r\n      );\r\n    };\r\n    createAdapter();\r\n  }, [props]);\r\n\r\n  if (!!callAdapter && !!chatAdapter) {\r\n    return (\r\n      <div style={{ height: '100vh', display: 'flex' }}>\r\n        <div style={{ width: '50vw' }}>\r\n          <ChatComposite adapter={chatAdapter} locale={COMPOSITE_LOCALE_FR_FR} />\r\n        </div>\r\n        <div style={{ width: '50vw' }}>\r\n          <CallComposite adapter={callAdapter} locale={COMPOSITE_LOCALE_FR_FR} />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  if (credential === undefined) {\r\n    return <h3>Failed to construct credential. Provided token is malformed.</h3>;\r\n  }\r\n  return <h3>Initializing...</h3>;\r\n};\r\n\r\nconst isTeamsMeetingLink = (link: string): boolean => link.startsWith('https://teams.microsoft.com/l/meetup-join');\r\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"available-locales"},"Available locales"),Object(esm.b)("p",null,"The following is a table of locales for components and composites which can be imported from our package. If you want to localize your components then import a\ncomponent locale from below and pass it as the ",Object(esm.b)("inlineCode",{parentName:"p"},"locale")," prop of ",Object(esm.b)("inlineCode",{parentName:"p"},"LocalizationProvider")," that is wrapping your components. If you want to localize your composite then import a\ncomposite locale from below and pass it as the ",Object(esm.b)("inlineCode",{parentName:"p"},"locale")," prop of your ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatComposite")," or ",Object(esm.b)("inlineCode",{parentName:"p"},"CallComposite"),"."),Object(esm.b)("table",null,Object(esm.b)("tr",null,Object(esm.b)("th",null,"Locale"),Object(esm.b)("th",null,"Component strings"),Object(esm.b)("th",null,"Composite strings")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"English (US)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_EN_US"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_EN_US")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"English (British)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_EN_GB"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_EN_GB")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Spanish (Spain)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_ES_ES"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_ES_ES")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"French (France)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_FR_FR"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_FR_FR")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"German (Germany)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_DE_DE"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_DE_DE")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Italian (Italy)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_IT_IT"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_IT_IT")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Japanese (Japan)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_JA_JP"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_JA_JP")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Korean (South Korea)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_KO_KR"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_KO_KR")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Dutch (Netherlands)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_NL_NL"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_NL_NL")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Portuguese (Brazil)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_PT_BR"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_PT_BR")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Russian (Russia)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_RU_RU"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_RU_RU")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Turkish (Turkey)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_TR_TR"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_TR_TR")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Chinese (Mainland China)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_ZH_CN"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_ZH_CN")),Object(esm.b)("tr",null,Object(esm.b)("td",null,"Chinese (Taiwan)"),Object(esm.b)("td",null,"COMPONENT_LOCALE_ZH_TW"),Object(esm.b)("td",null,"COMPOSITE_LOCALE_ZH_TW"))),Object(esm.b)("h2",{id:"customizing-locales"},"Customizing locales"),Object(esm.b)("p",null,"There are two options to customize the locales that we provide. For the examples below, let's say you wish to have a ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar"),"\nwith strings from our English (US) locale but you want to change the label of ",Object(esm.b)("inlineCode",{parentName:"p"},"CameraButton"),' to "Start" when its state is off.'),Object(esm.b)("h3",{id:"option-1-import-and-customize-locales"},"Option 1: Import and customize locales"),Object(esm.b)("p",null,"The first option is to import and customize locales. First, import ",Object(esm.b)("inlineCode",{parentName:"p"},"COMPONENT_LOCALE_EN_US")," locale from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," and then reassign the\nvalue ",Object(esm.b)("inlineCode",{parentName:"p"},"strings.cameraButton.offLabel")," like shown below."),Object(esm.b)(dist_esm.h,{code:"import {\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  LocalizationProvider,\r\n  MicrophoneButton,\r\n  ScreenShareButton,\r\n  COMPONENT_LOCALE_EN_US\r\n} from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const CustomLocaleSnippet = (): JSX.Element => {\r\n  COMPONENT_LOCALE_EN_US.strings.cameraButton.offLabel = 'Start';\r\n  return (\r\n    <LocalizationProvider locale={COMPONENT_LOCALE_EN_US}>\r\n      <ControlBar>\r\n        <CameraButton showLabel={true} />\r\n        <MicrophoneButton showLabel={true} />\r\n        <ScreenShareButton showLabel={true} />\r\n        <EndCallButton showLabel={true} />\r\n      </ControlBar>\r\n    </LocalizationProvider>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CCustomLocaleSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(CustomLocale_snippet_CustomLocaleSnippet,{mdxType:"CustomLocaleSnippet"})),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"ComponentLocale")," stores all strings in the ",Object(esm.b)("inlineCode",{parentName:"p"},"strings")," property as a nested object. The component name is the first identifer and the string key is\nthe second identifier such that each string can be accessed in this pattern ",Object(esm.b)("inlineCode",{parentName:"p"},"strings.<componentName>.<stringKey>"),". If you are using\ntypescript and have intellisense available in your IDE, it will be easy to discover all the strings."),Object(esm.b)("h3",{id:"option-2-override-strings-prop-in-the-ui-component"},"Option 2: Override ",Object(esm.b)("inlineCode",{parentName:"h3"},"strings")," prop in the UI Component"),Object(esm.b)("p",null,"The second option is to pass custom strings directly through the ",Object(esm.b)("inlineCode",{parentName:"p"},"strings")," prop. Strings can be overriden for a UI Library\ncomponent through the optional ",Object(esm.b)("inlineCode",{parentName:"p"},"strings")," property. There is no need to use ",Object(esm.b)("inlineCode",{parentName:"p"},"LocalizationProvider")," because all\ncomponents default to English (US). Just assign the string directly through ",Object(esm.b)("inlineCode",{parentName:"p"},"CameraButton")," like shown below."),Object(esm.b)(dist_esm.h,{code:"import {\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  MicrophoneButton,\r\n  ScreenShareButton\r\n} from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const StringsPropertySnippet = (): JSX.Element => {\r\n  return (\r\n    <ControlBar>\r\n      <CameraButton showLabel={true} strings={{ offLabel: 'Start' }} />\r\n      <MicrophoneButton showLabel={true} />\r\n      <ScreenShareButton showLabel={true} />\r\n      <EndCallButton showLabel={true} />\r\n    </ControlBar>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CStringsPropertySnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(StringsProperty_snippet_StringsPropertySnippet,{mdxType:"StringsPropertySnippet"})),Object(esm.b)("p",null,"We recommend using option 1 for localization for large applications with many components because all changes to the locale are made in one place. Option 2 is\nan alternative that can be used to override the strings from the locale is certain conditions you may want to use as part of business logic."),Object(esm.b)("h2",{id:"managing-long-translations"},"Managing long translations"),Object(esm.b)("p",null,"There are cases when translations can be long and make components overall look awkward like the ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar")," below using strings from a German locale."),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CLongTranslationsSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(LongTranslations_snippet_LongTranslationsSnippet,{mdxType:"LongTranslationsSnippet"})),Object(esm.b)("p",null,"We suggest the following options to achieve a better looking interface."),Object(esm.b)("ol",null,Object(esm.b)("li",{parentName:"ol"},"Trying less literal translations. If there is a shorter text alternative that does not sacrifice clarity, then that would be an easy option."),Object(esm.b)("li",{parentName:"ol"},"Using styling to set limits and truncating long translations. The following styling in the example below is passed to each button.")),Object(esm.b)(dist_esm.h,{code:"import {\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  LocalizationProvider,\r\n  MicrophoneButton,\r\n  ScreenShareButton,\r\n  COMPONENT_LOCALE_DE_DE\r\n} from '@azure/communication-react';\r\nimport { IStyle } from '@fluentui/react';\r\nimport React from 'react';\r\n\r\nexport const TruncationSnippet = (): JSX.Element => {\r\n  const buttonStyle = {\r\n    root: { width: '4rem', padding: '0' },\r\n    label: {\r\n      width: '2.75rem',\r\n      textOverflow: 'ellipsis',\r\n      whiteSpace: 'nowrap',\r\n      overflow: 'hidden',\r\n      margin: '0 auto'\r\n    } as IStyle\r\n  };\r\n  return (\r\n    <LocalizationProvider locale={COMPONENT_LOCALE_DE_DE}>\r\n      <ControlBar>\r\n        <CameraButton showLabel={true} styles={buttonStyle} />\r\n        <MicrophoneButton showLabel={true} styles={buttonStyle} />\r\n        <ScreenShareButton showLabel={true} styles={buttonStyle} />\r\n        <EndCallButton showLabel={true} styles={buttonStyle} />\r\n      </ControlBar>\r\n    </LocalizationProvider>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxType:"Canvas"},Object(esm.b)(Truncation_snippet_TruncationSnippet,{mdxType:"TruncationSnippet"})),Object(esm.b)("p",null,"Note: All ACS UI Library components will have aria labels with the full text as part of our Accessibility promise."),Object(esm.b)("ol",{start:3},Object(esm.b)("li",{parentName:"ol"},"Using styling to reduce font size.")),Object(esm.b)("h2",{id:"setting-rtl"},"Setting rtl"),Object(esm.b)("p",null,"To set rtl of ACS UI Library components for rtl languages, use the ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," and set the ",Object(esm.b)("inlineCode",{parentName:"p"},"rtl")," prop to true like in\nthe example below."),Object(esm.b)(dist_esm.h,{code:"import {\r\n  FluentThemeProvider,\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  MicrophoneButton,\r\n  ScreenShareButton\r\n} from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const SetRTLSnippet = (): JSX.Element => {\r\n  return (\r\n    <FluentThemeProvider rtl={true}>\r\n      <ControlBar>\r\n        <CameraButton showLabel={true} />\r\n        <MicrophoneButton showLabel={true} />\r\n        <ScreenShareButton showLabel={true} />\r\n        <EndCallButton showLabel={true} />\r\n      </ControlBar>\r\n    </FluentThemeProvider>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CSetRTLSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(SetRTL_snippet_SetRTLSnippet,{mdxType:"SetRTLSnippet"})))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Concepts/Localization",id:"localization",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1474:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"MessageThread",(function(){return MessageThread}));__webpack_require__(125),__webpack_require__(70),__webpack_require__(45),__webpack_require__(39),__webpack_require__(12),__webpack_require__(47),__webpack_require__(7),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var src=__webpack_require__(21),Stack=__webpack_require__(69),Persona=__webpack_require__(1542),Persona_types=__webpack_require__(27),PrimaryButton=__webpack_require__(1721),Divider=__webpack_require__(1749),esm=__webpack_require__(4),react=__webpack_require__(1),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),MessageThreadStoryContainerStyles=(__webpack_require__(123),__webpack_require__(98),{width:"100%",height:"100%",maxWidth:"50rem",padding:"1rem"}),UserOne={senderId:"user1",senderDisplayName:"Elliot Woodward"},UserTwo={senderId:"user2",senderDisplayName:"Katri Ahokas"},UserThree={senderId:"user3",senderDisplayName:"Miguel Garcia"},GetAvatarUrlByUserId=function GetAvatarUrlByUserId(userId){switch(userId){case"user1":return"images/avatars/avatar-4.jpg";case"user2":return"images/avatars/avatar-9.jpg";case"user3":return"images/avatars/avatar-6.jpg";default:return""}},GenerateMockNewChatMessage=function GenerateMockNewChatMessage(){return Object.assign({messageType:"chat"},UserOne,{messageId:Math.random().toString(),content:"I just sent a new Message!",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),mine:!0,attached:!1,status:"seen",contentType:"text"})},GenerateMockNewChatMessageFromOthers=function GenerateMockNewChatMessageFromOthers(){return Object.assign({messageType:"chat"},UserThree,{messageId:Math.random().toString(),content:"Sure! Let's checkout calling UI components as well!",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),mine:!1,attached:!1,contentType:"text"})},GenerateMockSystemMessage=function GenerateMockSystemMessage(){return{messageType:"system",systemMessageType:"content",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),messageId:Math.random().toString(),iconName:"PeopleAdd",content:"Elliot Woodward added Carole Poland to the chat and shared all chat history."}},GenerateMockCustomMessage=function GenerateMockCustomMessage(){return{messageType:"custom",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),messageId:Math.random().toString(),content:"Today"}},GenerateMockHistoryChatMessages=function GenerateMockHistoryChatMessages(){return[Object.assign({messageType:"chat"},UserOne,{messageId:Math.random().toString(),content:"Hi everyone, I created this awesome group chat for us!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,contentType:"text"}),Object.assign({messageType:"chat"},UserTwo,{messageId:Math.random().toString(),content:"Nice! This looks great!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,contentType:"text"}),Object.assign({messageType:"chat"},UserThree,{messageId:Math.random().toString(),content:"Yeah agree, let's chat here from now on!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!1,attached:!1,contentType:"text"})]},theming=__webpack_require__(77);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var GetHistoryChatMessages=function GetHistoryChatMessages(){return[{messageType:"chat",senderId:"user1",senderDisplayName:"Kat Larsson",messageId:Math.random().toString(),content:"Hi everyone, I created this awesome group chat for us!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,status:"seen",contentType:"text"},{messageType:"chat",senderId:"user2",senderDisplayName:"Robert Tolbert",messageId:Math.random().toString(),content:"Nice! This looks great!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,contentType:"text"},{messageType:"chat",senderId:"user3",senderDisplayName:"Carole Poland",messageId:Math.random().toString(),content:"Yeah agree, let's chat here from now on!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,contentType:"text"}]},GetHistoryWithSystemMessages=function GetHistoryWithSystemMessages(){return[].concat(_toConsumableArray(GetHistoryChatMessages()),[{messageType:"system",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),systemMessageType:"content",messageId:Math.random().toString(),iconName:"PeopleAdd",content:"Miguel Garcia is added to the chat"}])},GetHistoryWithCustomMessages=function GetHistoryWithCustomMessages(){return[{messageType:"custom",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),messageId:Math.random().toString(),content:"Today"}].concat(_toConsumableArray(GetHistoryChatMessages()))},placeholdermessages_GetAvatarUrlByUserId=function GetAvatarUrlByUserId(userId){switch(userId){case"user1":return"images/avatars/avatar-1.jpg";case"user2":return"images/avatars/avatar-2.jpg";case"user3":return"images/avatars/avatar-8.jpg";default:return""}},jsx_runtime=__webpack_require__(2),CustomAvatar_snippet_MessageThreadWithCustomAvatarExample=function MessageThreadWithCustomAvatarExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.A,{userId:"1",messages:GetHistoryChatMessages(),onRenderAvatar:function onRenderAvatar(userId){return Object(jsx_runtime.jsx)(Persona.a,{size:Persona_types.c.size32,hidePersonaDetails:!0,presence:Persona_types.b.online,text:userId,imageUrl:placeholdermessages_GetAvatarUrlByUserId(null!=userId?userId:"")})}})})};CustomAvatar_snippet_MessageThreadWithCustomAvatarExample.displayName="MessageThreadWithCustomAvatarExample",CustomAvatar_snippet_MessageThreadWithCustomAvatarExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomAvatarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomAvatar.snippet.tsx"]={name:"MessageThreadWithCustomAvatarExample",docgenInfo:CustomAvatar_snippet_MessageThreadWithCustomAvatarExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomAvatar.snippet.tsx"});var CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample=function MessageThreadWithCustomChatContainerExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.A,{userId:"1",messages:GetHistoryChatMessages(),styles:{chatContainer:{backgroundColor:"lightgray",padding:"15px"}}})})};CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample.displayName="MessageThreadWithCustomChatContainerExample",CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomChatContainerExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomChatContainer.snippet.tsx"]={name:"MessageThreadWithCustomChatContainerExample",docgenInfo:CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomChatContainer.snippet.tsx"});var CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample=function MessageThreadWithCustomMessageContainerExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.A,{userId:"1",styles:{chatMessageContainer:{fontStyle:"italic",boxShadow:"0px 3.2px 7.2px rgb(0 0 0 / 13%), 0px 0.6px 1.8px rgb(0 0 0 / 11%)"},myChatMessageContainer:{fontStyle:"italic",boxShadow:"0px 3.2px 7.2px rgb(0 0 0 / 13%), 0px 0.6px 1.8px rgb(0 0 0 / 11%)"},systemMessageContainer:{fontWeight:"bold",border:"double red"}},messages:GetHistoryWithSystemMessages()})})};CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample.displayName="MessageThreadWithCustomMessageContainerExample",CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomMessageContainerExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomMessageContainer.snippet.tsx"]={name:"MessageThreadWithCustomMessageContainerExample",docgenInfo:CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomMessageContainer.snippet.tsx"});var CustomMessages_snippet_MessageThreadWithCustomMessagesExample=function MessageThreadWithCustomMessagesExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.A,{userId:"1",messages:GetHistoryWithCustomMessages(),onRenderMessage:function onRenderMessage(messageProps,defaultOnRender){return"custom"===messageProps.message.messageType?Object(jsx_runtime.jsx)(Divider.a,{content:messageProps.message.content,color:"brand",important:!0}):defaultOnRender?defaultOnRender(messageProps):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}})})};CustomMessages_snippet_MessageThreadWithCustomMessagesExample.displayName="MessageThreadWithCustomMessagesExample",CustomMessages_snippet_MessageThreadWithCustomMessagesExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomMessagesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomMessages.snippet.tsx"]={name:"MessageThreadWithCustomMessagesExample",docgenInfo:CustomMessages_snippet_MessageThreadWithCustomMessagesExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomMessages.snippet.tsx"});var Text=__webpack_require__(499),CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample=function MessageThreadWithCustomMessageStatusIndicatorExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.A,{userId:"1",messages:GetHistoryChatMessages(),showMessageStatus:!0,onRenderMessageStatus:function onRenderMessageStatus(messageStatusIndicatorProps){return"seen"===messageStatusIndicatorProps.status?Object(jsx_runtime.jsx)(Text.a,{style:{fontStyle:"italic",fontWeight:"bold",color:"green"},children:"seen"}):null}})})};CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample.displayName="MessageThreadWithCustomMessageStatusIndicatorExample",CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomMessageStatusIndicatorExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomMessageStatusIndicator.snippet.tsx"]={name:"MessageThreadWithCustomMessageStatusIndicatorExample",docgenInfo:CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomMessageStatusIndicator.snippet.tsx"});var Default_snippet_DefaultMessageThreadExample=function DefaultMessageThreadExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.A,{userId:"1",messages:GetHistoryChatMessages()})})};Default_snippet_DefaultMessageThreadExample.displayName="DefaultMessageThreadExample",Default_snippet_DefaultMessageThreadExample.__docgenInfo={description:"",methods:[],displayName:"DefaultMessageThreadExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/Default.snippet.tsx"]={name:"DefaultMessageThreadExample",docgenInfo:Default_snippet_DefaultMessageThreadExample.__docgenInfo,path:"stories/MessageThread/snippets/Default.snippet.tsx"});var MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample=function MessageThreadWithMessageStatusIndicatorExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.A,{userId:"1",messages:GetHistoryChatMessages(),showMessageStatus:!0})})};MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample.displayName="MessageThreadWithMessageStatusIndicatorExample",MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithMessageStatusIndicatorExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/MessageStatusIndicator.snippet.tsx"]={name:"MessageThreadWithMessageStatusIndicatorExample",docgenInfo:MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample.__docgenInfo,path:"stories/MessageThread/snippets/MessageStatusIndicator.snippet.tsx"});var SystemMessages_snippet_MessageThreadWithSystemMessagesExample=function MessageThreadWithSystemMessagesExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.A,{userId:"1",messages:GetHistoryWithSystemMessages()})})};SystemMessages_snippet_MessageThreadWithSystemMessagesExample.displayName="MessageThreadWithSystemMessagesExample",SystemMessages_snippet_MessageThreadWithSystemMessagesExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithSystemMessagesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/SystemMessages.snippet.tsx"]={name:"MessageThreadWithSystemMessagesExample",docgenInfo:SystemMessages_snippet_MessageThreadWithSystemMessagesExample.__docgenInfo,path:"stories/MessageThread/snippets/SystemMessages.snippet.tsx"});var WithMessageDate_snippet_MessageThreadWithMessageDateExample=function MessageThreadWithMessageDateExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.A,{userId:"1",showMessageDate:!0,messages:GetHistoryChatMessages()})})};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function MessageThread_stories_toConsumableArray(arr){return function MessageThread_stories_arrayWithoutHoles(arr){if(Array.isArray(arr))return MessageThread_stories_arrayLikeToArray(arr)}(arr)||function MessageThread_stories_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||MessageThread_stories_unsupportedIterableToArray(arr)||function MessageThread_stories_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||MessageThread_stories_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MessageThread_stories_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return MessageThread_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MessageThread_stories_arrayLikeToArray(o,minLen):void 0}}function MessageThread_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}WithMessageDate_snippet_MessageThreadWithMessageDateExample.displayName="MessageThreadWithMessageDateExample",WithMessageDate_snippet_MessageThreadWithMessageDateExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithMessageDateExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/WithMessageDate.snippet.tsx"]={name:"MessageThreadWithMessageDateExample",docgenInfo:WithMessageDate_snippet_MessageThreadWithMessageDateExample.__docgenInfo,path:"stories/MessageThread/snippets/WithMessageDate.snippet.tsx"});var MessageThreadWithCustomAvatarExampleText=__webpack_require__(1423).default,MessageThreadWithCustomChatContainerExampleText=__webpack_require__(1424).default,MessageThreadWithCustomMessageContainerExampleText=__webpack_require__(1425).default,MessageThreadWithCustomMessagesExampleText=__webpack_require__(1426).default,MessageThreadWithCustomMessageStatusIndicatorExampleText=__webpack_require__(1427).default,DefaultMessageThreadExampleText=__webpack_require__(1428).default,MessageThreadWithMessageStatusIndicatorExampleText=__webpack_require__(1429).default,ExampleConstantsText=__webpack_require__(1430).default,MessageThreadWithSystemMessagesExampleText=__webpack_require__(1431).default,MessageThreadWithMessageDateExampleText=__webpack_require__(1432).default,MessageThread_stories_MessageThreadStory=function MessageThreadStory(args){var _useState2=_slicedToArray(Object(react.useState)(function GenerateMockChatMessages(){return[Object.assign({messageType:"chat"},UserOne,{messageId:Math.random().toString(),content:"Hey folks!",createdOn:new Date("2020-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,contentType:"text"}),Object.assign({messageType:"chat"},UserTwo,{messageId:Math.random().toString(),content:"Hey how are you?",createdOn:new Date("2020-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,contentType:"text"}),Object.assign({messageType:"chat"},UserThree,{messageId:Math.random().toString(),content:"Hey everyone!",createdOn:new Date("2020-04-13T00:00:00.000+08:08"),mine:!1,attached:!1,contentType:"text"}),Object.assign({messageType:"chat"},UserOne,{messageId:Math.random().toString(),content:"Doing well!",createdOn:new Date("2020-04-13T00:00:00.000+08:07"),mine:!0,attached:!1,contentType:"text"}),Object.assign({messageType:"chat"},UserTwo,{messageId:Math.random().toString(),content:"Checking out the new UI Components for Azure Communication Services!",createdOn:new Date("2020-04-13T00:00:00.000+08:06"),mine:!1,attached:"top",contentType:"text"}),Object.assign({messageType:"chat"},UserTwo,{messageId:Math.random().toString(),content:"The chat thread is very responsive.",createdOn:new Date("2020-04-13T00:00:00.000+08:05"),mine:!1,attached:!0,contentType:"text"}),Object.assign({messageType:"chat"},UserTwo,{messageId:Math.random().toString(),content:"It even scrolls!",createdOn:new Date("2020-04-13T00:00:00.000+08:05"),mine:!1,attached:"bottom",contentType:"text"}),Object.assign({messageType:"chat"},UserThree,{messageId:Math.random().toString(),content:"Can you customize it?",createdOn:new Date("2020-04-13T00:00:00.000+08:04"),mine:!1,attached:!1,contentType:"text"}),Object.assign({messageType:"chat"},UserTwo,{messageId:Math.random().toString(),content:"Yes you can customize it.",createdOn:new Date("2020-04-13T00:00:00.000+08:03"),mine:!1,attached:!1,contentType:"text"}),Object.assign({messageType:"chat"},UserOne,{messageId:Math.random().toString(),content:"I saw there are also calling UI components",createdOn:new Date("2020-04-13T00:00:00.000+08:02"),mine:!0,attached:!1,status:"seen",contentType:"text"}),Object.assign({messageType:"chat"},UserTwo,{messageId:Math.random().toString(),content:"Yeah you can combine chat and calling components to build full communication experiences!",createdOn:new Date("2020-04-13T00:00:00.000+08:01"),mine:!1,attached:!1,contentType:"text"})]}()),2),chatMessages=_useState2[0],setChatMessages=_useState2[1],onLoadPreviousMessages=function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",new Promise((function(resolve){setChatMessages([].concat(MessageThread_stories_toConsumableArray(GenerateMockHistoryChatMessages()),MessageThread_stories_toConsumableArray(chatMessages))),resolve(!0)})));case 1:case"end":return _context.stop()}}),_callee)})));return function onLoadPreviousMessages(){return _ref.apply(this,arguments)}}();return Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,style:MessageThreadStoryContainerStyles,tokens:{childrenGap:"1rem"},children:[Object(jsx_runtime.jsx)(src.A,{userId:UserOne.senderId,messages:chatMessages,showMessageDate:args.showMessageDate,showMessageStatus:args.showMessageStatus,disableJumpToNewMessageButton:!args.enableJumpToNewMessageButton,onLoadPreviousChatMessages:onLoadPreviousMessages,onRenderMessage:function onRenderMessage(messageProps,defaultOnRender){return"custom"===messageProps.message.messageType?Object(jsx_runtime.jsx)(Divider.a,{content:messageProps.message.content,color:"brand",important:!0}):defaultOnRender?defaultOnRender(messageProps):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},onRenderAvatar:function onRenderAvatar(userId){return Object(jsx_runtime.jsx)(Persona.a,{size:Persona_types.c.size32,hidePersonaDetails:!0,presence:Persona_types.b.online,text:userId,imageUrl:GetAvatarUrlByUserId(null!=userId?userId:"")})}}),Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:"1rem"},children:[Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new message from others",onClick:function onSendNewMessageFromOthers(){setChatMessages([].concat(MessageThread_stories_toConsumableArray(chatMessages),[GenerateMockNewChatMessageFromOthers()]))}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new message",onClick:function onSendNewMessage(){var existingChatMessages=chatMessages;existingChatMessages.forEach((function(message){"chat"===message.messageType&&(message.status=void 0)})),setChatMessages([].concat(MessageThread_stories_toConsumableArray(existingChatMessages),[GenerateMockNewChatMessage()]))}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new system message",onClick:function onSendNewSystemMessage(){setChatMessages([].concat(MessageThread_stories_toConsumableArray(chatMessages),[GenerateMockSystemMessage()]))}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new custom message",onClick:function onSendCustomMessage(){setChatMessages([].concat(MessageThread_stories_toConsumableArray(chatMessages),[GenerateMockCustomMessage()]))}})]})]})};MessageThread_stories_MessageThreadStory.displayName="MessageThreadStory";var MessageThread=MessageThread_stories_MessageThreadStory.bind({});__webpack_exports__.default={id:constants.a+"-messagethread",title:constants.a+"/Message Thread",component:src.A,argTypes:{showMessageDate:controlsUtils.a.showMessageDate,showMessageStatus:controlsUtils.a.showMessageStatus,enableJumpToNewMessageButton:controlsUtils.a.enableJumpToNewMessageButton,styles:controlsUtils.j,strings:controlsUtils.j,userId:controlsUtils.j,messages:controlsUtils.j,disableJumpToNewMessageButton:controlsUtils.j,numberOfChatMessagesToReload:controlsUtils.j,onMessageSeen:controlsUtils.j,onRenderMessageStatus:controlsUtils.j,onRenderAvatar:controlsUtils.j,onRenderJumpToNewMessageButton:controlsUtils.j,onLoadPreviousChatMessages:controlsUtils.j,onRenderMessage:controlsUtils.j,onUpdateMessage:controlsUtils.j,onDeleteMessage:controlsUtils.j,disableEditing:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"MessageThread"}),Object(jsx_runtime.jsx)(esm.d,{children:"MessageThread allows you to easily create a component for rendering chat messages, handling scrolling behavior of new/old messages and customizing icons & controls inside the chat thread."}),Object(jsx_runtime.jsx)(esm.d,{children:"MessageThread internally uses the `Chat` & `Chat.Message` component from `@fluentui/react-northstar`. You can checkout the details about these [two components](https://fluentsite.z22.web.core.windows.net/0.53.0/components/chat/props)."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { FluentThemeProvider, MessageThread } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Sample Messages"}),Object(jsx_runtime.jsx)(esm.d,{children:"Create a `placeholdermessages.ts` file in the current folder you are working on. Then copy paste the code below into that file."}),Object(jsx_runtime.jsx)(esm.h,{code:ExampleConstantsText}),Object(jsx_runtime.jsx)(esm.e,{children:"Default MessageThread"}),Object(jsx_runtime.jsx)(esm.d,{children:"By default, MessageThread displays Chat messages with display name of only for other users and creation time of message when available."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DefaultMessageThreadExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_DefaultMessageThreadExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"MessageThread With Message Date"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MessageThreadWithMessageDateExampleText,children:Object(jsx_runtime.jsx)(WithMessageDate_snippet_MessageThreadWithMessageDateExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"System Message"}),Object(jsx_runtime.jsx)(esm.d,{children:"The example below shows a message thread with a system message."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MessageThreadWithSystemMessagesExampleText,children:Object(jsx_runtime.jsx)(SystemMessages_snippet_MessageThreadWithSystemMessagesExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom Message"}),Object(jsx_runtime.jsx)(esm.d,{children:"The example below shows how to render a `custom` message with `onRenderMessage` in `MessageThread`"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MessageThreadWithCustomMessagesExampleText,children:Object(jsx_runtime.jsx)(CustomMessages_snippet_MessageThreadWithCustomMessagesExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Messages with Customized Chat Container"}),Object(jsx_runtime.jsx)(esm.d,{children:"The example below shows how to render a `custom` chat container with `styles.chatContainer` in `MessageThread`"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MessageThreadWithCustomChatContainerExampleText,children:Object(jsx_runtime.jsx)(CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Messages with Customized Message Container"}),Object(jsx_runtime.jsx)(esm.d,{children:"The example below shows how to render a `custom` message container with `styles.chatMessageContainer` or `styles.systemMessageContainer` in `MessageThread`"}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: In the code example, all `%` characters were replaced by their unicode value `\\u0025` due to URI malformed issue when loading the storybook snippets"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MessageThreadWithCustomMessageContainerExampleText,children:Object(jsx_runtime.jsx)(CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Default Message Status Indicator"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MessageThreadWithMessageStatusIndicatorExampleText,children:Object(jsx_runtime.jsx)(MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Cutom Message Status Indicator"}),Object(jsx_runtime.jsx)(esm.d,{children:"The example below shows how to render a `custom` message status indicator with `onRenderMessageStatus` in `MessageThread`"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MessageThreadWithCustomMessageStatusIndicatorExampleText,children:Object(jsx_runtime.jsx)(CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom Avatar"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MessageThreadWithCustomAvatarExampleText,children:Object(jsx_runtime.jsx)(CustomAvatar_snippet_MessageThreadWithCustomAvatarExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: You can view the details of the [Persona](https://developer.microsoft.com/fluentui#/controls/web/persona) component"}),Object(jsx_runtime.jsx)(esm.e,{children:"Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.A})]})}()}},storyshots:{disable:!0}}};MessageThread.parameters=Object.assign({storySource:{source:'(args): JSX.Element => {\n  const [chatMessages, setChatMessages] = useState<(SystemMessage | CustomMessage | ChatMessage)[]>(\n    GenerateMockChatMessages()\n  );\n\n  const onSendNewMessage = (): void => {\n    const existingChatMessages = chatMessages;\n    // We dont want to render the status for previous messages\n    existingChatMessages.forEach((message) => {\n      if (message.messageType === \'chat\') {\n        message.status = undefined;\n      }\n    });\n    setChatMessages([...existingChatMessages, GenerateMockNewChatMessage()]);\n  };\n\n  const onSendNewMessageFromOthers = (): void => {\n    setChatMessages([...chatMessages, GenerateMockNewChatMessageFromOthers()]);\n  };\n\n  const onLoadPreviousMessages = async (): Promise<boolean> => {\n    return new Promise((resolve) => {\n      setChatMessages([...GenerateMockHistoryChatMessages(), ...chatMessages]);\n      resolve(true);\n    });\n  };\n\n  const onSendNewSystemMessage = (): void => {\n    setChatMessages([...chatMessages, GenerateMockSystemMessage()]);\n  };\n\n  const onSendCustomMessage = (): void => {\n    setChatMessages([...chatMessages, GenerateMockCustomMessage()]);\n  };\n\n  const onRenderMessage = (messageProps: MessageProps, defaultOnRender?: MessageRenderer): JSX.Element => {\n    if (messageProps.message.messageType === \'custom\') {\n      return <Divider content={messageProps.message.content} color="brand" important />;\n    }\n\n    return defaultOnRender ? defaultOnRender(messageProps) : <></>;\n  };\n\n  return (\n    <Stack verticalFill style={MessageThreadStoryContainerStyles} tokens={{ childrenGap: \'1rem\' }}>\n      <MessageThreadComponent\n        userId={UserOne.senderId}\n        messages={chatMessages}\n        showMessageDate={args.showMessageDate}\n        showMessageStatus={args.showMessageStatus}\n        disableJumpToNewMessageButton={!args.enableJumpToNewMessageButton}\n        onLoadPreviousChatMessages={onLoadPreviousMessages}\n        onRenderMessage={onRenderMessage}\n        onRenderAvatar={(userId?: string) => {\n          return (\n            <Persona\n              size={PersonaSize.size32}\n              hidePersonaDetails\n              presence={PersonaPresence.online}\n              text={userId}\n              imageUrl={GetAvatarUrlByUserId(userId ?? \'\')}\n            />\n          );\n        }}\n      />\n      {/* We need to use these two buttons to render more messages in the chat thread and showcase the "new message" button.\n        Using storybook controls would trigger the whole story to do a fresh re-render, not just components inside the story. */}\n      <Stack horizontal horizontalAlign="space-between" tokens={{ childrenGap: \'1rem\' }}>\n        <PrimaryButton text="Send new message from others" onClick={onSendNewMessageFromOthers} />\n        <PrimaryButton text="Send new message" onClick={onSendNewMessage} />\n        <PrimaryButton text="Send new system message" onClick={onSendNewSystemMessage} />\n        <PrimaryButton text="Send new custom message" onClick={onSendCustomMessage} />\n      </Stack>\n    </Stack>\n  );\n}'}},MessageThread.parameters)},1475:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"VideoGallery",(function(){return VideoGallery}));__webpack_require__(34),__webpack_require__(62),__webpack_require__(113),__webpack_require__(56),__webpack_require__(256),__webpack_require__(47),__webpack_require__(7);var src=__webpack_require__(21),esm=__webpack_require__(4),react=__webpack_require__(1),DetailedBetaBanner=__webpack_require__(478),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),Stack=__webpack_require__(69),jsx_runtime=__webpack_require__(2),CustomAvatar_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},CustomAvatar_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker",state:"Connected",isMuted:!1},{userId:"user3",displayName:"Thor",state:"Connecting",isMuted:!1},{userId:"user4",displayName:"Matthew Murdock",state:"Idle",isMuted:!1},{userId:"user5",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],CustomAvatar_snippet_CustomAvatarVideoGalleryExample=function CustomAvatarVideoGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"50vh"},children:Object(jsx_runtime.jsx)(src.J,{localParticipant:CustomAvatar_snippet_MockLocalParticipant,remoteParticipants:CustomAvatar_snippet_MockRemoteParticipants,onRenderAvatar:function onRenderAvatar(userId,options,defaultOnRender){switch(options.text){case"You":return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif",style:{borderRadius:"100px",width:"100px",position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0}})});case"Thor":return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/7FgZWm6sGY0CNphZDJ/giphy.gif",style:{width:"100px",position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0}})});default:return defaultOnRender(options)}}})})};CustomAvatar_snippet_CustomAvatarVideoGalleryExample.displayName="CustomAvatarVideoGalleryExample",CustomAvatar_snippet_CustomAvatarVideoGalleryExample.__docgenInfo={description:"",methods:[],displayName:"CustomAvatarVideoGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/CustomAvatar.snippet.tsx"]={name:"CustomAvatarVideoGalleryExample",docgenInfo:CustomAvatar_snippet_CustomAvatarVideoGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/CustomAvatar.snippet.tsx"});var CustomStyle_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},CustomStyle_snippet_mockVideoElement=document.createElement("div");CustomStyle_snippet_mockVideoElement.innerHTML="<span />",CustomStyle_snippet_mockVideoElement.style.width=decodeURIComponent("100%25"),CustomStyle_snippet_mockVideoElement.style.height=decodeURIComponent("100%25"),CustomStyle_snippet_mockVideoElement.style.background="url(https://media.giphy.com/media/QvMUP3619500qb6mtw/giphy.gif)",CustomStyle_snippet_mockVideoElement.style.backgroundPosition="center",CustomStyle_snippet_mockVideoElement.style.backgroundRepeat="no-repeat";var CustomStyle_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Hal Jordan"},{userId:"user6",displayName:"Maria Hill"},{userId:"user7",displayName:"Kurt Wagner"},{userId:"user8",displayName:"Anna Marie LeBeau"},{userId:"user9",displayName:"Bruce Wayne",videoStream:{isAvailable:!0,renderElement:CustomStyle_snippet_mockVideoElement}}],CustomStyle_snippet_CustomStyleVideoGalleryExample=function CustomStyleVideoGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"50vh"},children:Object(jsx_runtime.jsx)(src.J,{styles:{root:{border:"solid 5px red"},gridLayout:{children:{border:"solid 5px red"}},horizontalGallery:{children:{border:"solid 5px red"}}},localParticipant:CustomStyle_snippet_MockLocalParticipant,remoteParticipants:CustomStyle_snippet_MockRemoteParticipants})})};CustomStyle_snippet_CustomStyleVideoGalleryExample.displayName="CustomStyleVideoGalleryExample",CustomStyle_snippet_CustomStyleVideoGalleryExample.__docgenInfo={description:"",methods:[],displayName:"CustomStyleVideoGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/CustomStyle.snippet.tsx"]={name:"CustomStyleVideoGalleryExample",docgenInfo:CustomStyle_snippet_CustomStyleVideoGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/CustomStyle.snippet.tsx"});var Default_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},Default_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne"}],Default_snippet_DefaultVideoGalleryExample=function DefaultVideoGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"50vh"},children:Object(jsx_runtime.jsx)(src.J,{localParticipant:Default_snippet_MockLocalParticipant,remoteParticipants:Default_snippet_MockRemoteParticipants})})};Default_snippet_DefaultVideoGalleryExample.displayName="DefaultVideoGalleryExample",Default_snippet_DefaultVideoGalleryExample.__docgenInfo={description:"",methods:[],displayName:"DefaultVideoGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/Default.snippet.tsx"]={name:"DefaultVideoGalleryExample",docgenInfo:Default_snippet_DefaultVideoGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/Default.snippet.tsx"});var FloatingLocalVideo_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},FloatingLocalVideo_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne"}],FloatingLocalVideo_snippet_FloatingLocalVideoExample=function FloatingLocalVideoExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"50vh"},children:Object(jsx_runtime.jsx)(src.J,{layout:"floatingLocalVideo",localParticipant:FloatingLocalVideo_snippet_MockLocalParticipant,remoteParticipants:FloatingLocalVideo_snippet_MockRemoteParticipants})})};FloatingLocalVideo_snippet_FloatingLocalVideoExample.displayName="FloatingLocalVideoExample",FloatingLocalVideo_snippet_FloatingLocalVideoExample.__docgenInfo={description:"",methods:[],displayName:"FloatingLocalVideoExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/FloatingLocalVideo.snippet.tsx"]={name:"FloatingLocalVideoExample",docgenInfo:FloatingLocalVideo_snippet_FloatingLocalVideoExample.__docgenInfo,path:"stories/VideoGallery/snippets/FloatingLocalVideo.snippet.tsx"});__webpack_require__(39),__webpack_require__(12),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var lib=__webpack_require__(22),CameraSwitch24Regular=__webpack_require__(1530);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var LocalCameraSwitcher_snippet_mockVideoElement=document.createElement("div");LocalCameraSwitcher_snippet_mockVideoElement.innerHTML="<span />",LocalCameraSwitcher_snippet_mockVideoElement.style.width=decodeURIComponent("100%25"),LocalCameraSwitcher_snippet_mockVideoElement.style.height=decodeURIComponent("100%25"),LocalCameraSwitcher_snippet_mockVideoElement.style.background="url(https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif)",LocalCameraSwitcher_snippet_mockVideoElement.style.backgroundRepeat="no-repeat";var LocalCameraSwitcher_snippet_LocalCameraSwitcherExample=function LocalCameraSwitcherExample(){Object(lib.L)({icons:{LocalCameraSwitch:Object(jsx_runtime.jsx)(CameraSwitch24Regular.a,{})}});var _useState2=_slicedToArray(Object(react.useState)(0),2),cameraState=_useState2[0],setCameraState=_useState2[1],cameraButtonProps={cameras:[{id:"1",name:"camera 1"},{id:"2",name:"camera 2"}],selectedCamera:{id:"1",name:"camera 1"},onSelectCamera:function onSelectCamera(){return new Promise((function(){console.log("switch Camera"),0===cameraState?(setCameraState(1),LocalCameraSwitcher_snippet_mockVideoElement.style.background="url(https://media.giphy.com/media/mokQK7oyiR8Sk/giphy.gif)",LocalCameraSwitcher_snippet_mockVideoElement.style.backgroundPosition="center"):1===cameraState&&(setCameraState(0),LocalCameraSwitcher_snippet_mockVideoElement.style.background="url(https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif)")}))}},MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0,videoStream:{available:!0,renderElement:LocalCameraSwitcher_snippet_mockVideoElement}};return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"50vh"},children:Object(jsx_runtime.jsx)(src.J,{layout:"floatingLocalVideo",localParticipant:MockLocalParticipant,remoteParticipants:[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne"}],showCameraSwitcherInLocalPreview:!0,localVideoCameraCycleButtonProps:cameraButtonProps})})};LocalCameraSwitcher_snippet_LocalCameraSwitcherExample.displayName="LocalCameraSwitcherExample",LocalCameraSwitcher_snippet_LocalCameraSwitcherExample.__docgenInfo={description:"",methods:[],displayName:"LocalCameraSwitcherExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/LocalCameraSwitcher.snippet.tsx"]={name:"LocalCameraSwitcherExample",docgenInfo:LocalCameraSwitcher_snippet_LocalCameraSwitcherExample.__docgenInfo,path:"stories/VideoGallery/snippets/LocalCameraSwitcher.snippet.tsx"});var ScreenSharingFromPresenter_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharingOn:!0},ScreenSharingFromPresenter_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne"}],ScreenSharingFromPresenter_snippet_ScreenSharingFromPresenterExample=function ScreenSharingFromPresenterExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"50vh"},children:Object(jsx_runtime.jsx)(src.J,{layout:"floatingLocalVideo",localParticipant:ScreenSharingFromPresenter_snippet_MockLocalParticipant,remoteParticipants:ScreenSharingFromPresenter_snippet_MockRemoteParticipants})})};ScreenSharingFromPresenter_snippet_ScreenSharingFromPresenterExample.displayName="ScreenSharingFromPresenterExample",ScreenSharingFromPresenter_snippet_ScreenSharingFromPresenterExample.__docgenInfo={description:"",methods:[],displayName:"ScreenSharingFromPresenterExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/ScreenSharingFromPresenter.snippet.tsx"]={name:"ScreenSharingFromPresenterExample",docgenInfo:ScreenSharingFromPresenter_snippet_ScreenSharingFromPresenterExample.__docgenInfo,path:"stories/VideoGallery/snippets/ScreenSharingFromPresenter.snippet.tsx"});var ScreenSharingFromViewer_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},ScreenSharingFromViewer_snippet_mockVideoElement=document.createElement("div");ScreenSharingFromViewer_snippet_mockVideoElement.style.width=decodeURIComponent("100%25"),ScreenSharingFromViewer_snippet_mockVideoElement.style.height=decodeURIComponent("100%25"),ScreenSharingFromViewer_snippet_mockVideoElement.style.textAlign="center";var ScreenSharingFromViewer_snippet_imageElement=document.createElement("img");ScreenSharingFromViewer_snippet_imageElement.src="images/screenshare-example.png",ScreenSharingFromViewer_snippet_imageElement.style.maxWidth=decodeURIComponent("100%25"),ScreenSharingFromViewer_snippet_imageElement.style.maxHeight=decodeURIComponent("100%25"),ScreenSharingFromViewer_snippet_mockVideoElement.appendChild(ScreenSharingFromViewer_snippet_imageElement);var ScreenSharingFromViewer_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker",isScreenSharingOn:!0,screenShareStream:{isAvailable:!0,renderElement:ScreenSharingFromViewer_snippet_mockVideoElement}},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne"}],ScreenSharingFromViewer_snippet_ScreenSharingFromViewerExample=function ScreenSharingFromViewerExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"50vh"},children:Object(jsx_runtime.jsx)(src.J,{layout:"floatingLocalVideo",localParticipant:ScreenSharingFromViewer_snippet_MockLocalParticipant,remoteParticipants:ScreenSharingFromViewer_snippet_MockRemoteParticipants})})};ScreenSharingFromViewer_snippet_ScreenSharingFromViewerExample.displayName="ScreenSharingFromViewerExample",ScreenSharingFromViewer_snippet_ScreenSharingFromViewerExample.__docgenInfo={description:"",methods:[],displayName:"ScreenSharingFromViewerExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/ScreenSharingFromViewer.snippet.tsx"]={name:"ScreenSharingFromViewerExample",docgenInfo:ScreenSharingFromViewer_snippet_ScreenSharingFromViewerExample.__docgenInfo,path:"stories/VideoGallery/snippets/ScreenSharingFromViewer.snippet.tsx"});var WithHorizontalGallery_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},WithHorizontalGallery_snippet_mockVideoElement=document.createElement("div");WithHorizontalGallery_snippet_mockVideoElement.innerHTML="<span />",WithHorizontalGallery_snippet_mockVideoElement.style.width=decodeURIComponent("100%25"),WithHorizontalGallery_snippet_mockVideoElement.style.height=decodeURIComponent("100%25"),WithHorizontalGallery_snippet_mockVideoElement.style.background="url(https://media.giphy.com/media/QvMUP3619500qb6mtw/giphy.gif)",WithHorizontalGallery_snippet_mockVideoElement.style.backgroundPosition="center",WithHorizontalGallery_snippet_mockVideoElement.style.backgroundRepeat="no-repeat";var WithHorizontalGallery_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne",videoStream:{isAvailable:!0,renderElement:WithHorizontalGallery_snippet_mockVideoElement}}],WithHorizontalGallery_snippet_WithHorizontalGalleryExample=function WithHorizontalGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"50vh"},children:Object(jsx_runtime.jsx)(src.J,{localParticipant:WithHorizontalGallery_snippet_MockLocalParticipant,remoteParticipants:WithHorizontalGallery_snippet_MockRemoteParticipants})})};WithHorizontalGallery_snippet_WithHorizontalGalleryExample.displayName="WithHorizontalGalleryExample",WithHorizontalGallery_snippet_WithHorizontalGalleryExample.__docgenInfo={description:"",methods:[],displayName:"WithHorizontalGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/WithHorizontalGallery.snippet.tsx"]={name:"WithHorizontalGalleryExample",docgenInfo:WithHorizontalGallery_snippet_WithHorizontalGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/WithHorizontalGallery.snippet.tsx"});var CustomAvatarVideoGalleryExampleText=__webpack_require__(1453).default,CustomStyleVideoGalleryExampleText=__webpack_require__(1454).default,DefaultVideoGalleryExampleText=__webpack_require__(1455).default,FloatingLocalVideoExampleText=__webpack_require__(1456).default,LocalVideoCameraCycleButtonExampleText=__webpack_require__(1457).default,ScreenSharingFromPresenterExampleText=__webpack_require__(1458).default,ScreenSharingFromViewerExampleText=__webpack_require__(1459).default,WithHorizontalGalleryExampleText=__webpack_require__(1460).default,VideoGallery_stories_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharingOn:!1},VideoGallery_stories_VideoGalleryStory=function VideoGalleryStory(args){var remoteParticipants=args.remoteParticipants.split(",").map((function(p){return p.trim()})).filter((function(p){return p})).map((function(p,i){return{userId:"user"+i,displayName:p,videoStream:{isAvailable:!0}}}));if(VideoGallery_stories_MockLocalParticipant.isScreenSharingOn="presenter"===args.screenShareExperience,remoteParticipants.length>0&&(remoteParticipants[0].isScreenSharingOn="viewer"===args.screenShareExperience,"viewer"===args.screenShareExperience)){var mockVideoElement=document.createElement("div");mockVideoElement.style.width="100%",mockVideoElement.style.height="100%",mockVideoElement.style.textAlign="center";var imageElement=document.createElement("img");imageElement.src="images/screenshare-example.png",imageElement.style.maxWidth=decodeURIComponent("100%25"),imageElement.style.maxHeight=decodeURIComponent("100%25"),mockVideoElement.appendChild(imageElement);var mockScreenShareStream={isAvailable:!0,renderElement:mockVideoElement};remoteParticipants[0].screenShareStream=mockScreenShareStream}return Object(jsx_runtime.jsx)(src.J,{layout:args.layout,localParticipant:VideoGallery_stories_MockLocalParticipant,remoteParticipants:remoteParticipants})};VideoGallery_stories_VideoGalleryStory.displayName="VideoGalleryStory";var VideoGallery=VideoGallery_stories_VideoGalleryStory.bind({});__webpack_exports__.default={id:constants.a+"-videogallery",title:constants.a+"/Video Gallery",component:src.J,argTypes:{remoteParticipants:controlsUtils.a.remoteParticipantNames,layout:controlsUtils.a.videoGallerylayout,screenShareExperience:controlsUtils.a.screenShareExperience,styles:controlsUtils.j,localParticipant:controlsUtils.j,localVideoViewOptions:controlsUtils.j,remoteVideoViewOption:controlsUtils.j,onCreateLocalStreamView:controlsUtils.j,onDisposeLocalStreamView:controlsUtils.j,onRenderLocalVideoTile:controlsUtils.j,onCreateRemoteStreamView:controlsUtils.j,onRenderRemoteVideoTile:controlsUtils.j,onDisposeRemoteStreamView:controlsUtils.j,onRenderAvatar:controlsUtils.j,showMuteIndicator:controlsUtils.j,dominantSpeakers:controlsUtils.j,strings:controlsUtils.j,maxRemoteVideoStreams:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"VideoGallery"}),Object(jsx_runtime.jsx)(esm.d,{children:"VideoGallery lays out the local user and each remote participant in a call in a [VideoTile](./?path=/docs/ui-components-videotile--video-tile) component. The VideoGallery component is made up of a [Grid Layout](./?path=/docs/ui-components-videogallery--video-gallery#grid-layout), [Horizontal Gallery](./?path=/docs/ui-components-videogallery--video-gallery#grid-layout), and a [Local Video Tile](./?path=/docs/ui-components-videogallery--video-gallery#local-video-tile). The logic used to place each [VideoTile](./?path=/docs/ui-components-videotile--video-tile) component into which section is explained below."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"import { VideoGallery } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.e,{children:"Grid Layout"}),Object(jsx_runtime.jsx)(esm.d,{children:"If there are no remote video streams on, all participants are placed in the [Grid Layout](./?path=/docs/ui-components-gridlayout--grid-layout) including the local user. Otherwise, only remote participants with their video streams on are placed in the Grid Layout upto a max of `maxRemoteVideoStreams`. The remaining participants are placed in the Horizontal Gallery."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DefaultVideoGalleryExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_DefaultVideoGalleryExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: The `maxRemoteVideoStreams` prop limits the number of remote video streams in the [GridLayout](./?path=/docs/ui-components-gridlayout--grid-layout). If the number of remote participants with their video stream on exceeds `maxRemoteVideoStreams` then remote participants in the `dominantSpeakers` prop will be prioritized. Furthermore, the VideoGallery is designed to limit the re-ordering when the `dominantSpeakers` prop is changed."}),Object(jsx_runtime.jsx)(esm.e,{children:"Horizontal Gallery"}),Object(jsx_runtime.jsx)(esm.d,{children:"The remote participants not in the Grid Layout are placed in a Horizontal Gallery in the lower section. A gif element is used to simulate a remote video stream to move the other remote participants to the Horizontal Gallery in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:WithHorizontalGalleryExampleText,children:Object(jsx_runtime.jsx)(WithHorizontalGallery_snippet_WithHorizontalGalleryExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Local Video Tile"}),Object(jsx_runtime.jsx)(esm.d,{children:"By default, the local video tile is placed in the Grid Layout. But the local video tile can be placed in a floating and draggable video tile in the bottom right corner by setting the `layout` prop to 'floatingLocalVideo'."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:FloatingLocalVideoExampleText,children:Object(jsx_runtime.jsx)(FloatingLocalVideo_snippet_FloatingLocalVideoExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Screen Sharing Experience"}),Object(jsx_runtime.jsx)(esm.d,{children:"The screen shared is the only element placed in the GridLayout and all remote participants are placed in the Horizontal Gallery in the lower section. To be able to view this screen share, the sharing participant should have their `isScreenSharingOn` prop set to true as well as a defined `screenShareStream` prop (see `localParticipant` and `remoteParticipants` props)."}),Object(jsx_runtime.jsx)(esm.i,{children:"From a presenter point of view"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ScreenSharingFromPresenterExampleText,children:Object(jsx_runtime.jsx)(ScreenSharingFromPresenter_snippet_ScreenSharingFromPresenterExample,{})}),Object(jsx_runtime.jsx)(esm.i,{children:"From a viewer point of view"}),Object(jsx_runtime.jsx)(esm.d,{children:"Note that in this example, we substitute the screenshare video stream with an image just for mocking experience."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ScreenSharingFromViewerExampleText,children:Object(jsx_runtime.jsx)(ScreenSharingFromViewer_snippet_ScreenSharingFromViewerExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom Avatar"}),Object(jsx_runtime.jsx)(esm.d,{children:"Rendering of avatars can be customized through the VideoGallery callback `onRenderAvatar`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomAvatarVideoGalleryExampleText,children:Object(jsx_runtime.jsx)(CustomAvatar_snippet_CustomAvatarVideoGalleryExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom Style"}),Object(jsx_runtime.jsx)(esm.d,{children:"Style of the VideoGallery container can be customized through its `styles` prop. The `styles` prop is a `VideoGalleryStyles` type with subproperties for each part of the VideoGallery as shown in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomStyleVideoGalleryExampleText,children:Object(jsx_runtime.jsx)(CustomStyle_snippet_CustomStyleVideoGalleryExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Local Video Camera Button"}),Object(jsx_runtime.jsx)(DetailedBetaBanner.a,{}),Object(jsx_runtime.jsx)(esm.d,{children:"The Video Gallery can take in customization to allow for the introduction of local camera controls where the button will cycle through the different camera's in the users device. Typical usage is to enable this button on mobile devices. This button is enabled through the use of the `showCameraSwitcherInLocalPreview` prop."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:LocalVideoCameraCycleButtonExampleText,children:Object(jsx_runtime.jsx)(LocalCameraSwitcher_snippet_LocalCameraSwitcherExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Props"}),Object(jsx_runtime.jsx)(esm.b,{of:src.J})]})}()}}}};VideoGallery.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const remoteParticipants = args.remoteParticipants\n    .split(',')\n    .map((p) => p.trim())\n    .filter((p) => p)\n    .map((p, i) => {\n      return {\n        userId: `user${i}`,\n        displayName: p,\n        videoStream: { isAvailable: true }\n      };\n    });\n\n  const localParticipant = MockLocalParticipant;\n  localParticipant.isScreenSharingOn = args.screenShareExperience === 'presenter';\n\n  if (remoteParticipants.length > 0) {\n    remoteParticipants[0].isScreenSharingOn = args.screenShareExperience === 'viewer';\n\n    if (args.screenShareExperience === 'viewer') {\n      const mockVideoElement = document.createElement('div');\n      mockVideoElement.style.width = '100%';\n      mockVideoElement.style.height = '100%';\n      mockVideoElement.style.textAlign = 'center';\n      const imageElement = document.createElement('img');\n      imageElement.src = 'images/screenshare-example.png';\n      imageElement.style.maxWidth = decodeURIComponent('100%25');\n      imageElement.style.maxHeight = decodeURIComponent('100%25');\n      mockVideoElement.appendChild(imageElement);\n      const mockScreenShareStream = {\n        isAvailable: true,\n        renderElement: mockVideoElement as HTMLElement\n      };\n      remoteParticipants[0].screenShareStream = mockScreenShareStream;\n    }\n  }\n\n  return (\n    <VideoGalleryComponent\n      layout={args.layout}\n      localParticipant={MockLocalParticipant}\n      remoteParticipants={remoteParticipants}\n    />\n  );\n}"}},VideoGallery.parameters)},1476:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Participants",(function(){return Participants}));__webpack_require__(74),__webpack_require__(34),__webpack_require__(62),__webpack_require__(113),__webpack_require__(56),__webpack_require__(256),__webpack_require__(7),__webpack_require__(47);var src=__webpack_require__(21),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),theming=__webpack_require__(77),jsx_runtime=__webpack_require__(2),Default_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],Default_snippet_ParticipantsButtonDefaultExample=function ParticipantsButtonDefaultExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.E,{participants:Default_snippet_mockParticipants})})};Default_snippet_ParticipantsButtonDefaultExample.displayName="ParticipantsButtonDefaultExample",Default_snippet_ParticipantsButtonDefaultExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonDefaultExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/Default.snippet.tsx"]={name:"ParticipantsButtonDefaultExample",docgenInfo:Default_snippet_ParticipantsButtonDefaultExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/Default.snippet.tsx"});var WithCallLink_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],WithCallLink_snippet_ParticipantsButtonWithCallLinkExample=function ParticipantsButtonWithCallLinkExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.E,{participants:WithCallLink_snippet_mockParticipants,myUserId:"user1",callInvitationURL:"URL to invite new participants to the current call (https://...)"})})};WithCallLink_snippet_ParticipantsButtonWithCallLinkExample.displayName="ParticipantsButtonWithCallLinkExample",WithCallLink_snippet_ParticipantsButtonWithCallLinkExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithCallLinkExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithCallLink.snippet.tsx"]={name:"ParticipantsButtonWithCallLinkExample",docgenInfo:WithCallLink_snippet_ParticipantsButtonWithCallLinkExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithCallLink.snippet.tsx"});var Persona=__webpack_require__(1542),Persona_types=__webpack_require__(27),Icon=__webpack_require__(884),Label=__webpack_require__(1742),WithCustomRender_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],WithCustomRender_snippet_customOnRenderAvatar=function customOnRenderAvatar(userId,options){return"user2"===userId?Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif",style:{borderRadius:"32px",width:"32px",position:"relative",margin:"auto",left:0,right:0,top:0,bottom:0}},"avatar"+userId):Object(jsx_runtime.jsx)(Persona.a,{text:options.displayName,hidePersonaDetails:!0,size:Persona_types.c.size32})};WithCustomRender_snippet_customOnRenderAvatar.displayName="customOnRenderAvatar";var WithCustomRender_snippet_onMuteAll=function onMuteAll(){},WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample=function ParticipantsButtonWithCustomRenderExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.E,{showLabel:!0,participants:WithCustomRender_snippet_mockParticipants,myUserId:"user1",callInvitationURL:"URL to invite new participants to the current call (https://...)",onMuteAll:WithCustomRender_snippet_onMuteAll,onRenderIcon:function customOnRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"Group",style:{color:"orange",fontSize:"20px"}},"participantsCustomIconKey")},onRenderText:function customOnRenderText(){return Object(jsx_runtime.jsx)(Label.a,{style:{color:"darkviolet",fontStyle:"italic"},children:"who is on this call"},"participantsCustomLabelKey")},onRenderAvatar:function onRenderAvatar(userId,options){return WithCustomRender_snippet_customOnRenderAvatar(userId,options)}})})};WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample.displayName="ParticipantsButtonWithCustomRenderExample",WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithCustomRenderExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithCustomRender.snippet.tsx"]={name:"ParticipantsButtonWithCustomRenderExample",docgenInfo:WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithCustomRender.snippet.tsx"});var WithCustomStyles_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],WithCustomStyles_snippet_onMuteAll=function onMuteAll(){},mockStyles={root:{background:"blue",color:"white"},rootHovered:{background:"crimson",color:"white"},rootExpanded:{background:"dimgrey",color:"white"},label:{color:"white",fontStyle:"italic"},menuStyles:{participantListStyles:{root:{border:"solid 1px red"}}}},WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample=function ParticipantsButtonWithCustomStylesExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.E,{showLabel:!0,participants:WithCustomStyles_snippet_mockParticipants,myUserId:"user1",callInvitationURL:"URL to invite new participants to the current call (https://...)",onMuteAll:WithCustomStyles_snippet_onMuteAll,styles:mockStyles})})};WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample.displayName="ParticipantsButtonWithCustomStylesExample",WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithCustomStylesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithCustomStyles.snippet.tsx"]={name:"ParticipantsButtonWithCustomStylesExample",docgenInfo:WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithCustomStyles.snippet.tsx"});var WithLabel_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],WithLabel_snippet_ParticipantsButtonWithLabelExample=function ParticipantsButtonWithLabelExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.E,{showLabel:!0,participants:WithLabel_snippet_mockParticipants})})};WithLabel_snippet_ParticipantsButtonWithLabelExample.displayName="ParticipantsButtonWithLabelExample",WithLabel_snippet_ParticipantsButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithLabel.snippet.tsx"]={name:"ParticipantsButtonWithLabelExample",docgenInfo:WithLabel_snippet_ParticipantsButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithLabel.snippet.tsx"});var WithMuteAllOption_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],WithMuteAllOption_snippet_onMuteAll=function onMuteAll(){},WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample=function ParticipantsButtonWithMuteAllOptionExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.E,{participants:WithMuteAllOption_snippet_mockParticipants,myUserId:"user1",callInvitationURL:"URL to invite new participants to the current call (https://...)",onMuteAll:WithMuteAllOption_snippet_onMuteAll})})};WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample.displayName="ParticipantsButtonWithMuteAllOptionExample",WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithMuteAllOptionExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithMuteAllOption.snippet.tsx"]={name:"ParticipantsButtonWithMuteAllOptionExample",docgenInfo:WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithMuteAllOption.snippet.tsx"});var WithUserExcludeFromList_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample=function ParticipantsButtonWithUserExcludeFromListExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.E,{participants:WithUserExcludeFromList_snippet_mockParticipants,myUserId:"user1",excludeMe:!0})})};WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample.displayName="ParticipantsButtonWithUserExcludeFromListExample",WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithUserExcludeFromListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithUserExcludeFromList.snippet.tsx"]={name:"ParticipantsButtonWithUserExcludeFromListExample",docgenInfo:WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithUserExcludeFromList.snippet.tsx"});var ParticipantsButtonDefaultExampleText=__webpack_require__(1397).default,ParticipantsButtonWithCallLinkExampleText=__webpack_require__(1398).default,ParticipantsButtonWithCustomRenderExampleText=__webpack_require__(1399).default,ParticipantsButtonWithCustomStylesExampleText=__webpack_require__(1400).default,ParticipantsButtonWithLabelExampleText=__webpack_require__(1401).default,ParticipantsButtonWithMuteAllOptionExampleText=__webpack_require__(1402).default,ParticipantsButtonWithUserExcludeFromListExampleText=__webpack_require__(1403).default,onlyUnique=function onlyUnique(value,index,self){return self.indexOf(value)===index},Participants_stories_ParticipantsStory=function ParticipantsStory(args){var mockParticipants=args.participants.split(",").map((function(p){return p.trim()})).filter((function(p){return p})).filter(onlyUnique).map((function(p,i){return{userId:"user"+i,displayName:p,state:i%3?"Connected":"Idle",isMuted:!(i%3),isScreenSharing:2===i}})),userIndex=mockParticipants.map((function(p){return p.displayName})).indexOf("You"),myUserId=-1!==userIndex?mockParticipants[userIndex].userId:"";return Object(jsx_runtime.jsx)(src.E,Object.assign({},args,{participants:mockParticipants,myUserId:myUserId,onMuteAll:args.isMuteAllAvailable?function onMuteAll(){}:void 0}))};Participants_stories_ParticipantsStory.displayName="ParticipantsStory";var Participants=Participants_stories_ParticipantsStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-participants",title:constants.a+"/Control Bar/Buttons/Participants",component:src.E,argTypes:{isMuteAllAvailable:controlsUtils.a.isMuteAllAvailable,showLabel:controlsUtils.a.showLabel,callInvitationURL:controlsUtils.a.callInvitationURL,participants:controlsUtils.a.participantNames,onRenderParticipantList:controlsUtils.j,styles:controlsUtils.j,onMuteAll:controlsUtils.j,strings:controlsUtils.j,myUserId:controlsUtils.j,excludeMe:controlsUtils.j,onRenderParticipant:controlsUtils.j,onRenderAvatar:controlsUtils.j,onRemoveParticipant:controlsUtils.j,onFetchParticipantMenuItems:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ParticipantsButton"}),Object(jsx_runtime.jsx)(esm.d,{children:"A button to show a menu containing the call or chat participants. For use with the [Control Bar](./?path=/docs/ui-components-controlbar--control-bar)."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note that for accessibility purposes, this button can be focused on even when disabled. This behaviour can be changed by setting the button prop `allowDisabledFocus` to `false`."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { ParticipantsButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Default Example"}),Object(jsx_runtime.jsx)(esm.d,{children:"The default `ParticipantsButton` component shows `People` icon with no label, and contains menu items displaying the number of participants with a list as sub-menu like shown in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ParticipantsButtonDefaultExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_ParticipantsButtonDefaultExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ParticipantsButton with default label"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can display the button label which, by default, will show below the icon as `People`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ParticipantsButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_ParticipantsButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ParticipantsButton with local user excluded from participant list"}),Object(jsx_runtime.jsx)(esm.d,{children:"When excluding local user from participant list, `ParticipantsButton` displays their presence to the call as a menu item above the number of remote participants like shown in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ParticipantsButtonWithUserExcludeFromListExampleText,children:Object(jsx_runtime.jsx)(WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ParticipantsButton with copyable call invitation link"}),Object(jsx_runtime.jsx)(esm.d,{children:"When opting to have a copyable link available, `ParticipantsButton` displays it as a menu item below the number of participants like shown in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ParticipantsButtonWithCallLinkExampleText,children:Object(jsx_runtime.jsx)(WithCallLink_snippet_ParticipantsButtonWithCallLinkExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ParticipantsButton with option to mute all participants"}),Object(jsx_runtime.jsx)(esm.d,{children:"When opting to have the possibility of muting all participants, `ParticipantsButton` displays this options as a sub-menu item of the number of participants, just below the list of participants, like shown in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ParticipantsButtonWithMuteAllOptionExampleText,children:Object(jsx_runtime.jsx)(WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ParticipantsButton with custom styles"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can change the styles of `ParticipantsButton` through its `styles` props as you would customize any Button styles (root, label, etc..) with the addition of customizing the participant list container like shown in the example below."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, do not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ParticipantsButtonWithCustomStylesExampleText,children:Object(jsx_runtime.jsx)(WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ParticipantsButton with custom render"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can change the render of the `ParticipantsButton` as you would do for any Button (onRenderIcon, onRenderText, etc... ) with the addition of customizing the render of the participant list (see [ParticipantList](./?path=/docs/ui-components-participantlist--participant-list) component)."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ParticipantsButtonWithCustomRenderExampleText,children:Object(jsx_runtime.jsx)(WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ParticipantsButton Props"}),Object(jsx_runtime.jsx)(esm.d,{children:"`ParticipantsButton` features all props a [FluentUI Button](https://developer.microsoft.com/fluentui#/controls/web/button) offers, with the following additional properties."}),Object(jsx_runtime.jsx)(esm.g,{of:src.E})]})}()}}}};Participants.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const mockParticipants = args.participants\n    .split(',')\n    .map((p) => p.trim())\n    .filter((p) => p)\n    .filter(onlyUnique)\n    .map((p, i) => {\n      return {\n        userId: `user${i}`,\n        displayName: p,\n        state: i % 3 ? 'Connected' : 'Idle',\n        isMuted: i % 3 ? false : true,\n        isScreenSharing: i === 2 ? true : false\n      };\n    });\n\n  const userIndex = mockParticipants.map((p) => p.displayName).indexOf('You');\n  const myUserId = userIndex !== -1 ? mockParticipants[userIndex].userId : '';\n  const onMuteAll = (): void => {\n    // your implementation to mute all participants\n  };\n  return (\n    <ParticipantsButton\n      {...args}\n      participants={mockParticipants}\n      myUserId={myUserId}\n      onMuteAll={args.isMuteAllAvailable ? onMuteAll : undefined}\n    />\n  );\n}"}},Participants.parameters)},1477:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7);var react=__webpack_require__(1),esm=__webpack_require__(0),dist_esm=__webpack_require__(4),theming=__webpack_require__(77),Stack=__webpack_require__(69),src=(__webpack_require__(40),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28),__webpack_require__(21)),lib=__webpack_require__(22),jsx_runtime=__webpack_require__(2);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CallingComponents_CallingComponents=function CallingComponents(){var exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},_useState2=_slicedToArray(Object(react.useState)(!1),2),videoButtonChecked=_useState2[0],setVideoButtonChecked=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(!1),2),audioButtonChecked=_useState4[0],setAudioButtonChecked=_useState4[1],_useState6=_slicedToArray(Object(react.useState)(!1),2),screenshareButtonChecked=_useState6[0],setScreenshareButtonChecked=_useState6[1];return Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.H)({height:"100%"}),children:[Object(jsx_runtime.jsx)("div",{style:{height:"30rem",width:"30rem",border:"1px solid"},children:Object(jsx_runtime.jsx)(src.w,{children:Object(jsx_runtime.jsx)(src.K,{displayName:"Michael"})})}),Object(jsx_runtime.jsxs)(src.p,{styles:{root:{justifyContent:"center"}},children:[Object(jsx_runtime.jsx)(src.o,{checked:videoButtonChecked,onClick:function onClick(){return setVideoButtonChecked(!videoButtonChecked)}}),Object(jsx_runtime.jsx)(src.B,{checked:audioButtonChecked,onClick:function onClick(){return setAudioButtonChecked(!audioButtonChecked)}}),Object(jsx_runtime.jsx)(src.F,{checked:screenshareButtonChecked,onClick:function onClick(){return setScreenshareButtonChecked(!screenshareButtonChecked)}}),Object(jsx_runtime.jsx)(src.s,{menuProps:exampleOptionsMenuProps}),Object(jsx_runtime.jsx)(src.t,{})]})]})};CallingComponents_CallingComponents.displayName="CallingComponents",CallingComponents_CallingComponents.__docgenInfo={description:"",methods:[],displayName:"CallingComponents"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/QuickStarts/snippets/CallingComponents.tsx"]={name:"CallingComponents",docgenInfo:CallingComponents_CallingComponents.__docgenInfo,path:"stories/QuickStarts/snippets/CallingComponents.tsx"});__webpack_require__(123),__webpack_require__(98),__webpack_require__(39);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var ChatComponents_ChatComponents=function ChatComponents(){return Object(jsx_runtime.jsxs)("div",{style:{height:"30rem",width:"30rem"},children:[Object(jsx_runtime.jsx)(src.A,{userId:"1",messages:function GetHistoryChatMessages(){return[{messageType:"chat",contentType:"text",senderId:"1",senderDisplayName:"User1",messageId:Math.random().toString(),content:"Hi everyone, I created this awesome group chat for us!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,status:"seen"},{messageType:"chat",contentType:"text",senderId:"2",senderDisplayName:"User2",messageId:Math.random().toString(),content:"Nice! This looks great!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1},{messageType:"chat",contentType:"text",senderId:"3",senderDisplayName:"User3",messageId:Math.random().toString(),content:"Yeah agree, let's chat here from now on!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1}]}(),showMessageStatus:!0}),Object(jsx_runtime.jsx)(src.G,{disabled:!1,onSendMessage:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)})))})]})};function CompletedComponentsApp(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"space-evenly",styles:{root:{width:"100%"}},children:[Object(jsx_runtime.jsx)(CallingComponents_CallingComponents,{}),Object(jsx_runtime.jsx)(ChatComponents_ChatComponents,{})]})})}ChatComponents_ChatComponents.displayName="ChatComponents",ChatComponents_ChatComponents.__docgenInfo={description:"",methods:[],displayName:"ChatComponents"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/QuickStarts/snippets/ChatComponents.tsx"]={name:"ChatComponents",docgenInfo:ChatComponents_ChatComponents.__docgenInfo,path:"stories/QuickStarts/snippets/ChatComponents.tsx"}),CompletedComponentsApp.displayName="CompletedComponentsApp",CompletedComponentsApp.__docgenInfo={description:"",methods:[],displayName:"CompletedComponentsApp"};var CompletedComponentsApp_snippet=CompletedComponentsApp;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/QuickStarts/snippets/CompletedComponentsApp.snippet.tsx"]={name:"CompletedComponentsApp",docgenInfo:CompletedComponentsApp.__docgenInfo,path:"stories/QuickStarts/snippets/CompletedComponentsApp.snippet.tsx"});var _excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.f,{id:"quickstarts-uicomponents",title:"UI Components/Get Started",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(esm.b)("h1",{id:"quickstart-get-started-with-ui-components"},"Quickstart: Get started with UI Components"),Object(esm.b)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications. In this quickstart, you'll learn how to integrate UI Library base components into your application to build communication experiences."),Object(esm.b)("p",null,"UI Library components come in two flavors: UI and Composite."),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("strong",{parentName:"li"},"UI components")," represent discrete communication capabilities; they're the basic building blocks that can be used to build complex communication experiences."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("strong",{parentName:"li"},"Composite components")," are turn-key experiences for common communication scenarios that have been built using ",Object(esm.b)("strong",{parentName:"li"},"base components")," as building blocks and packaged to be easily integrated into applications.")),Object(esm.b)("h2",{id:"download-the-code"},"Download the code"),Object(esm.b)("p",null,"You can find the completed code for this quickstart here: ",Object(esm.b)("a",{parentName:"p",href:"https://github.com/Azure-Samples/communication-services-javascript-quickstarts/tree/main/ui-library-quickstart-ui-components",target:"_blank",rel:"nofollow noopener noreferrer"},"Get started with UI Components")),Object(esm.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.b)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 14.19.0 and above).")),Object(esm.b)("h2",{id:"setting-up"},"Setting Up"),Object(esm.b)("p",null,"UI Library requires a React environment to be setup. Next we will do that. If you already have a React App, you can skip this section."),Object(esm.b)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.b)("p",null,"We'll use the create-react-app template for this quickstart. For more information, see: ",Object(esm.b)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-library-quickstart --template typescript\n\ncd ui-library-quickstart\n\n")),Object(esm.b)("p",null,"At the end of this process, you should have a full application inside the folder ",Object(esm.b)("inlineCode",{parentName:"p"},"UI-library-Quickstart"),".\nFor this quickstart, we'll be modifying files inside the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.b)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.b)("p",null,"Use the ",Object(esm.b)("inlineCode",{parentName:"p"},"npm install")," command to install the Azure Communication Services UI Library for JavaScript."),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-react\n\n")),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," specifies core Azure Communication Services as ",Object(esm.b)("inlineCode",{parentName:"p"},"peerDependencies")," so that\nyou can most consistently use the API from the core libraries in your application. You need to install those libraries as well:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-calling@1.3.2\nnpm install @azure/communication-chat@1.1.0\n\n")),Object(esm.b)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.b)("p",null,"Let's test the Create React App installation by running:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"object-model"},"Object Model"),Object(esm.b)("p",null,"The following classes and interfaces handle some of the major features of the Azure Communication Services UI client library:"),Object(esm.b)("table",null,Object(esm.b)("thead",{parentName:"table"},Object(esm.b)("tr",{parentName:"thead"},Object(esm.b)("th",{parentName:"tr",align:null},"Name"),Object(esm.b)("th",{parentName:"tr",align:null},"Description"))),Object(esm.b)("tbody",{parentName:"table"},Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/theming--page"},"FluentThemeProvider")),Object(esm.b)("td",{parentName:"tr",align:null},"Provider that controls Theming on the components. Can be used to override theme")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/ui-components-gridlayout--grid-layout"},"GridLayout")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component that organizes video tiles into a grid")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/ui-components-videotile--video-tile"},"VideoTile")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component to render participants either with or without video")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/ui-components-controlbar--control-bar"},"ControlBar")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component to control call including mute, video, share screen")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/ui-components-messagethread--message-thread"},"MessageThread")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component that renders a chat thread with typing indicators, read receipts, etc.")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/ui-components-sendbox--send-box"},"SendBox")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component that allows user to input messages that will be sent to the joined thread")))),Object(esm.b)("h2",{id:"set-up-fluent-theme-provider-and-icons"},"Set Up Fluent Theme Provider and Icons"),Object(esm.b)("p",null,"The ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," is a required wrapper around the UI Library components to provide theming that makes the components look amazing!\nIt is in charge of allowing developer customize the theme of the components as well. Check out ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/theming--page"},"Theming")," for more information. ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," defaults to using light theme."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { FluentThemeProvider, DEFAULT_COMPONENT_ICONS } from '@azure/communication-react';\nimport { registerIcons } from '@fluentui/react';\nimport React from 'react';\n\nfunction App(): JSX.Element {\n  // If you don't want to provide custom icons, you can register the default ones included with the library.\n  // This will ensure that all the icons are rendered correctly.\n  registerIcons({ icons: DEFAULT_COMPONENT_ICONS });\n\n  return (\n    <FluentThemeProvider>\n      <h1>Hooray! You set up Fluent Theme Provider </h1>\n    </FluentThemeProvider>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("p",null,"Inside the ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider"),", you can add additional components.\nNext we'll use various UI components to showcase a sample experience.\nYou can customize the layout of these components and add any other custom components that you want to render with them."),Object(esm.b)("h2",{id:"calling-ui-components"},"Calling UI Components"),Object(esm.b)("p",null,"For Calling, we'll use the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/ui-components-gridlayout--grid-layout-component"},Object(esm.b)("inlineCode",{parentName:"a"},"GridLayout"))," and ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/ui-components-controlbar--control-bar"},Object(esm.b)("inlineCode",{parentName:"a"},"ControlBar"))," components.\nTo start, in the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder, create a new file called ",Object(esm.b)("inlineCode",{parentName:"p"},"CallingComponents.tsx"),".\nHere we'll initialize a function component that will hold our base components to then import in ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx"),".\nYou can add extra layout and styling around the components."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"CallingComponents.tsx")),Object(esm.b)(dist_esm.h,{code:"// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  GridLayout,\n  MicrophoneButton,\n  DevicesButton,\n  ScreenShareButton,\n  VideoTile\n} from '@azure/communication-react';\n\nimport { IContextualMenuProps, mergeStyles, Stack } from '@fluentui/react';\nimport React, { useState } from 'react';\n\nexport const CallingComponents = (): JSX.Element => {\n  const exampleOptionsMenuProps: IContextualMenuProps = {\n    items: [\n      {\n        key: '1',\n        name: 'Choose Camera',\n        iconProps: { iconName: 'LocationCircle' },\n        onClick: () => alert('Choose Camera Menu Item Clicked!')\n      }\n    ]\n  };\n\n  const controlBarStyle = {\n    root: {\n      justifyContent: 'center'\n    }\n  };\n  const [videoButtonChecked, setVideoButtonChecked] = useState<boolean>(false);\n  const [audioButtonChecked, setAudioButtonChecked] = useState<boolean>(false);\n  const [screenshareButtonChecked, setScreenshareButtonChecked] = useState<boolean>(false);\n\n  return (\n    <Stack className={mergeStyles({ height: '100%' })}>\n      {/* GridLayout Component relies on the parent's height and width, so it's required to set the height and width on its parent. */}\n      <div style={{ height: '30rem', width: '30rem', border: '1px solid' }}>\n        <GridLayout>\n          <VideoTile displayName={'Michael'} />\n        </GridLayout>\n      </div>\n\n      {/* Control Bar with default set up */}\n      <ControlBar styles={controlBarStyle}>\n        <CameraButton checked={videoButtonChecked} onClick={() => setVideoButtonChecked(!videoButtonChecked)} />\n        <MicrophoneButton checked={audioButtonChecked} onClick={() => setAudioButtonChecked(!audioButtonChecked)} />\n        <ScreenShareButton\n          checked={screenshareButtonChecked}\n          onClick={() => setScreenshareButtonChecked(!screenshareButtonChecked)}\n        />\n        <DevicesButton menuProps={exampleOptionsMenuProps} />\n        <EndCallButton />\n      </ControlBar>\n    </Stack>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)("p",null,"For this example we added a single ",Object(esm.b)("inlineCode",{parentName:"p"},"Video Tile")," to the grid, but additional can be added."),Object(esm.b)("h2",{id:"chat-ui-components"},"Chat UI Components"),Object(esm.b)("p",null,"For Chat, we will use the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/ui-components-chatthread--chat-thread-component"},Object(esm.b)("inlineCode",{parentName:"a"},"MessageThread"))," and ",Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/ui-components-sendbox--send-box-story-book-component"},Object(esm.b)("inlineCode",{parentName:"a"},"SendBox"))," components.\nTo start, in the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder, create a new file called ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatComponents.tsx"),".\nHere we'll initialize a function component that will hold our base components to then import in ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx"),"."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"ChatComponents.tsx")),Object(esm.b)(dist_esm.h,{code:"import {\n  MessageThread,\n  ChatMessage as WebUiChatMessage,\n  SendBox,\n  MessageStatus,\n  MessageContentType\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const ChatComponents = (): JSX.Element => {\n  //A sample chat history\n  const GetHistoryChatMessages = (): WebUiChatMessage[] => {\n    return [\n      {\n        messageType: 'chat',\n        contentType: 'text' as MessageContentType,\n        senderId: '1',\n        senderDisplayName: 'User1',\n        messageId: Math.random().toString(),\n        content: 'Hi everyone, I created this awesome group chat for us!',\n        createdOn: new Date('2019-04-13T00:00:00.000+08:10'),\n        mine: true,\n        attached: false,\n        status: 'seen' as MessageStatus\n      },\n      {\n        messageType: 'chat',\n        contentType: 'text' as MessageContentType,\n        senderId: '2',\n        senderDisplayName: 'User2',\n        messageId: Math.random().toString(),\n        content: 'Nice! This looks great!',\n        createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n        mine: false,\n        attached: false\n      },\n      {\n        messageType: 'chat',\n        contentType: 'text' as MessageContentType,\n        senderId: '3',\n        senderDisplayName: 'User3',\n        messageId: Math.random().toString(),\n        content: \"Yeah agree, let's chat here from now on!\",\n        createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n        mine: false,\n        attached: false\n      }\n    ];\n  };\n\n  return (\n    <div style={{ height: '30rem', width: '30rem' }}>\n      {/* Chat thread component with message status indicator feature enabled */}\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} showMessageStatus={true} />\n\n      <SendBox\n        disabled={false}\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n      />\n    </div>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"add-calling-and-chat-components"},"Add Calling and Chat Components"),Object(esm.b)("p",null,"Back in the ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx")," file, we will now add the components to the ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," like shown below."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { FluentThemeProvider } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\nimport { CallingComponents } from './CallingComponents';\nimport { ChatComponents } from './ChatComponents';\n\nfunction CompletedComponentsApp(): JSX.Element {\n  const stackStyle = {\n    root: {\n      width: '100%'\n    }\n  };\n  return (\n    <FluentThemeProvider>\n      <Stack horizontal horizontalAlign=\"space-evenly\" styles={stackStyle}>\n        <CallingComponents />\n        <ChatComponents />\n      </Stack>\n    </FluentThemeProvider>\n  );\n}\n\nexport default CompletedComponentsApp;\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxType:"Canvas"},Object(esm.b)(CompletedComponentsApp_snippet,{mdxType:"CompletedComponentsApp"})),Object(esm.b)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.b)("p",null,"To run the code above use the command:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-console"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"troubleshooting"},"Troubleshooting"),Object(esm.b)("p",null,"See the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/troubleshooting--page"},"troubleshooting page")," for some common problems and recommended solutions."),Object(esm.b)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.b)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.b)("h2",{id:"next-steps"},"Next Steps"),Object(esm.b)("p",null,Object(esm.b)("a",{parentName:"p",href:"./?path=/story/quickstarts-statefulclient--page"},"Try UI Library Stateful Client")),Object(esm.b)("p",null,"For more information, see the following resources:"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/styling--page"},"UI Library Styling")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/theming--page"},"UI Library Theming"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"UI Components/Get Started",id:"quickstarts-uicomponents",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1478:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var esm=__webpack_require__(0),dist_esm=__webpack_require__(4),theming=__webpack_require__(77),src=__webpack_require__(21),jsx_runtime=__webpack_require__(2),DarkControlBar_snippet_DarkControlBar=function DarkControlBar(){return Object(jsx_runtime.jsx)(theming.b,{fluentTheme:theming.c,children:Object(jsx_runtime.jsxs)(src.p,{children:[Object(jsx_runtime.jsx)(src.o,{}),Object(jsx_runtime.jsx)(src.B,{}),Object(jsx_runtime.jsx)(src.F,{}),Object(jsx_runtime.jsx)(src.s,{}),Object(jsx_runtime.jsx)(src.t,{})]})})};DarkControlBar_snippet_DarkControlBar.displayName="DarkControlBar",DarkControlBar_snippet_DarkControlBar.__docgenInfo={description:"",methods:[],displayName:"DarkControlBar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/DarkControlBar.snippet.tsx"]={name:"DarkControlBar",docgenInfo:DarkControlBar_snippet_DarkControlBar.__docgenInfo,path:"stories/snippets/DarkControlBar.snippet.tsx"});var DefaultTheme_snippet_DefaultThemeSnippet=function DefaultThemeSnippet(){return Object(jsx_runtime.jsxs)(src.p,{children:[Object(jsx_runtime.jsx)(src.o,{}),Object(jsx_runtime.jsx)(src.B,{}),Object(jsx_runtime.jsx)(src.F,{}),Object(jsx_runtime.jsx)(src.t,{})]})};DefaultTheme_snippet_DefaultThemeSnippet.displayName="DefaultThemeSnippet",DefaultTheme_snippet_DefaultThemeSnippet.__docgenInfo={description:"",methods:[],displayName:"DefaultThemeSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/DefaultTheme.snippet.tsx"]={name:"DefaultThemeSnippet",docgenInfo:DefaultTheme_snippet_DefaultThemeSnippet.__docgenInfo,path:"stories/snippets/DefaultTheme.snippet.tsx"});var ThemedButton_snippet_ThemedButton=function ThemedButton(){var theme=Object(theming.e)(),defaultButtonStyle={root:{background:theme.palette.neutralLighter},rootHovered:{background:theme.palette.neutralLight}};return Object(jsx_runtime.jsx)(src.o,{styles:defaultButtonStyle})};ThemedButton_snippet_ThemedButton.displayName="ThemedButton",ThemedButton_snippet_ThemedButton.__docgenInfo={description:"",methods:[],displayName:"ThemedButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/ThemedButton.snippet.tsx"]={name:"ThemedButton",docgenInfo:ThemedButton_snippet_ThemedButton.__docgenInfo,path:"stories/snippets/ThemedButton.snippet.tsx"});var _excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.f,{id:"theming",title:"Concepts/Theming",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(esm.b)("h1",{id:"theming"},"Theming"),Object(esm.b)("p",null,"ACS UI Library uses components and icons from both ",Object(esm.b)("a",{parentName:"p",href:"https://aka.ms/fluentui#/controls/web",target:"_blank",rel:"nofollow noopener noreferrer"},"Fluent UI"),"\nand ",Object(esm.b)("a",{parentName:"p",href:"https://fluentsite.z22.web.core.windows.net",target:"_blank",rel:"nofollow noopener noreferrer"},"Fluent React Northstar"),". The ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider"),"\nis a wrapping component that allows you to theme all ACS UI Library components consistently."),Object(esm.b)("h2",{id:"usage"},"Usage"),Object(esm.b)("p",null,"ACS UI Library components are themed with a light theme by default as shown by the ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar")," and buttons below."),Object(esm.b)(dist_esm.h,{code:"import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  MicrophoneButton,\n  ScreenShareButton\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const DefaultThemeSnippet = (): JSX.Element => {\n  return (\n    <ControlBar>\n      <CameraButton />\n      <MicrophoneButton />\n      <ScreenShareButton />\n      <EndCallButton />\n    </ControlBar>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CDefaultThemeSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(DefaultTheme_snippet_DefaultThemeSnippet,{mdxType:"DefaultThemeSnippet"})),Object(esm.b)("p",null,"To theme this ControlBar, import ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," and wrap it around the ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar"),".\nThen import ",Object(esm.b)("inlineCode",{parentName:"p"},"darkTheme")," from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," and assign it to the ",Object(esm.b)("inlineCode",{parentName:"p"},"fluentTheme")," property of ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider"),".\n",Object(esm.b)("inlineCode",{parentName:"p"},"darkTheme")," is a ",Object(esm.b)("a",{parentName:"p",href:"https://aka.ms/fluentui#/controls/web/references/theme",target:"_blank",rel:"nofollow noopener noreferrer"},"Theme")," object from Fluent UI."),Object(esm.b)(dist_esm.h,{code:"import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  DevicesButton,\n  ScreenShareButton,\n  darkTheme\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const DarkControlBar = (): JSX.Element => {\n  return (\n    <FluentThemeProvider fluentTheme={darkTheme}>\n      <ControlBar>\n        <CameraButton />\n        <MicrophoneButton />\n        <ScreenShareButton />\n        <DevicesButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CDarkControlBar%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(DarkControlBar_snippet_DarkControlBar,{mdxType:"DarkControlBar"})),Object(esm.b)("h2",{id:"fluentthemeprovider-props"},"FluentThemeProvider Props"),Object(esm.b)(dist_esm.g,{of:theming.b,mdxType:"Props"}),Object(esm.b)("h2",{id:"creating-your-own-theme"},"Creating your own theme"),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"lightTheme")," and ",Object(esm.b)("inlineCode",{parentName:"p"},"darkTheme")," are available from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react"),". But if you wish to use your own theme,\nwe recommend using Microsoft's ",Object(esm.b)("a",{parentName:"p",href:"https://aka.ms/themedesigner",target:"_blank",rel:"nofollow noopener noreferrer"},"Fluent UI Theme Designer")," to create your theme. Please ensure\nthat the Accessibility checker on the same page passes when creating your own theme."),Object(esm.b)("img",{src:"images/accessibility_checker_pass.png",alt:"Accessibility checker pass"}),Object(esm.b)("p",null,"The default light theme we export looks like this:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-typescript"},"export const lightTheme = {\n  palette: {\n    themePrimary: '#0078d4',\n    themeLighterAlt: '#f3f9fd',\n    themeLighter: '#d0e7f8',\n    themeLight: '#a9d3f2',\n    themeTertiary: '#5ca9e5',\n    themeSecondary: '#1a86d9',\n    themeDarkAlt: '#006cbe',\n    themeDark: '#005ba1',\n    themeDarker: '#004377',\n    neutralLighterAlt: '#faf9f8',\n    neutralLighter: '#f3f2f1',\n    neutralLight: '#edebe9',\n    neutralQuaternaryAlt: '#e1dfdd',\n    neutralQuaternary: '#d0d0d0',\n    neutralTertiaryAlt: '#c8c6c4',\n    neutralTertiary: '#a19f9d',\n    neutralSecondary: '#605e5c',\n    neutralPrimaryAlt: '#3b3a39',\n    neutralPrimary: '#323130',\n    neutralDark: '#201f1e',\n    black: '#000000',\n    white: '#ffffff'\n  }\n};\n")),Object(esm.b)("h2",{id:"custom-theme-mapping"},"Custom Theme Mapping"),Object(esm.b)("p",null,"The ACS UI Library and Fluent UI components are themed with palette values from the\n",Object(esm.b)("a",{parentName:"p",href:"https://aka.ms/fluentui#/controls/web/references/theme",target:"_blank",rel:"nofollow noopener noreferrer"},"Theme")," object with a mapping that is designed to work for any valid theme.\nBut if you wish to override the mapping, we recommend that you use the ",Object(esm.b)("inlineCode",{parentName:"p"},"useTheme")," hook from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," and\nuse the component's ",Object(esm.b)("inlineCode",{parentName:"p"},"styles")," prop like in the example below."),Object(esm.b)(dist_esm.h,{code:"import { useTheme, CameraButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const ThemedButton = (): JSX.Element => {\n  const theme = useTheme();\n\n  const defaultButtonStyle = {\n    root: {\n      background: theme.palette.neutralLighter\n    },\n    rootHovered: {\n      background: theme.palette.neutralLight\n    }\n  };\n  return <CameraButton styles={defaultButtonStyle} />;\n};\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CThemedButton%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(ThemedButton_snippet_ThemedButton,{mdxType:"ThemedButton"})),Object(esm.b)("p",null,"Should you override the palette mapping, please note that ACS UI Library components abide by the general Fluent UI\nmappings. Foreground colors are used for text, icons, and outlines while background colors for component\nbackgrounds. Primary colors are also used for component backgrounds or icons."),Object(esm.b)("h2",{id:"custom-fonts"},"Custom Fonts"),Object(esm.b)("p",null,"Custom Fonts can be applied to UI Components or Composites using the existing theming mechansim.\nAlong with the ability to change colors, a JSON object containing the theme palette also allows users to specify custom fonts.\nAs long as the fonts have been loaded in the application, a custom font name can be specified as shown in the example below."),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-tsx"},"export const lightTheme = {\n  defaultFontStyle: { fontFamily: 'Monaco, Menlo, Consolas', fontWeight: 'regular' },\n  palette: {\n    themePrimary: '#0078d4',\n    themeLighterAlt: '#f3f9fd'\n  }\n};\n")),Object(esm.b)("p",null,"If you wish to apply the same font to all the font weights, simply remove the ",Object(esm.b)("inlineCode",{parentName:"p"},"fontWeight")," property from the ",Object(esm.b)("inlineCode",{parentName:"p"},"defaultFontStyle")," object."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Concepts/Theming",id:"theming",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1479:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ControlBar",(function(){return ControlBar}));__webpack_require__(195),__webpack_require__(7),__webpack_require__(47);var src=__webpack_require__(21),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),DevicesButtonWithKnobs_snippet=__webpack_require__(481),theming=__webpack_require__(77),jsx_runtime=__webpack_require__(2),mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],AllButtonsControlBar_snippet_AllButtonsControlBarExample=function AllButtonsControlBarExample(){var exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]};return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(src.p,{layout:"horizontal",children:[Object(jsx_runtime.jsx)(src.o,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.B,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.F,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.E,{participants:mockParticipants,myUserId:"user1",callInvitationURL:"URL to copy",onMuteAll:function onMuteAll(){}}),Object(jsx_runtime.jsx)(src.s,{menuProps:exampleOptionsMenuProps}),Object(jsx_runtime.jsx)(src.t,{onClick:function onClick(){}})]})})};AllButtonsControlBar_snippet_AllButtonsControlBarExample.displayName="AllButtonsControlBarExample",AllButtonsControlBar_snippet_AllButtonsControlBarExample.__docgenInfo={description:"",methods:[],displayName:"AllButtonsControlBarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/AllButtonsControlBar.snippet.tsx"]={name:"AllButtonsControlBarExample",docgenInfo:AllButtonsControlBar_snippet_AllButtonsControlBarExample.__docgenInfo,path:"stories/ControlBar/snippets/AllButtonsControlBar.snippet.tsx"});var componentMainDivStyle={display:"flex",border:"solid 0.5px lightgray",height:"24rem",alignItems:"center",justifyContent:"center"},ControlBarLayout_snippet_ControlBarLayoutExample=function ControlBarLayoutExample(){return Object(jsx_runtime.jsx)("div",{style:componentMainDivStyle,children:Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(src.p,{layout:"floatingLeft",children:[Object(jsx_runtime.jsx)(src.o,{}),Object(jsx_runtime.jsx)(src.B,{}),Object(jsx_runtime.jsx)(src.F,{}),Object(jsx_runtime.jsx)(src.E,{participants:[]}),Object(jsx_runtime.jsx)(src.s,{}),Object(jsx_runtime.jsx)(src.t,{})]})})})};ControlBarLayout_snippet_ControlBarLayoutExample.displayName="ControlBarLayoutExample",ControlBarLayout_snippet_ControlBarLayoutExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/ControlBarLayout.snippet.tsx"]={name:"ControlBarLayoutExample",docgenInfo:ControlBarLayout_snippet_ControlBarLayoutExample.__docgenInfo,path:"stories/ControlBar/snippets/ControlBarLayout.snippet.tsx"});var CallEnd20Filled=__webpack_require__(1520),CustomButtons_snippet_CustomButtonsExample=function CustomButtonsExample(){var CustomEndCallButton=function CustomEndCallButton(){return Object(jsx_runtime.jsx)(src.t,{styles:{root:{height:"inherit",background:"darkorange",color:"white",width:"10rem"},rootHovered:{background:"darkred",color:"white"},flexContainer:{flexFlow:"row"}},showLabel:!0,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(CallEnd20Filled.a,{primaryFill:"currentColor"},"hangupBtnIconKey")},onRenderText:function onRenderText(){return Object(jsx_runtime.jsx)("span",{style:{marginLeft:"0.5rem"},children:"End Call"},"hangupBtnTextKey")},onClick:function onClick(){}})};return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(src.p,{layout:"horizontal",children:[Object(jsx_runtime.jsx)(src.o,{}),Object(jsx_runtime.jsx)(src.B,{}),Object(jsx_runtime.jsx)(CustomEndCallButton,{})]})})};CustomButtons_snippet_CustomButtonsExample.displayName="CustomButtonsExample",CustomButtons_snippet_CustomButtonsExample.__docgenInfo={description:"",methods:[],displayName:"CustomButtonsExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/CustomButtons.snippet.tsx"]={name:"CustomButtonsExample",docgenInfo:CustomButtons_snippet_CustomButtonsExample.__docgenInfo,path:"stories/ControlBar/snippets/CustomButtons.snippet.tsx"});var CustomControlBarStyles_snippet_CustomControlBarStylesExample=function CustomControlBarStylesExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(src.p,{layout:"horizontal",styles:{root:{backgroundColor:"lightgray",border:"solid black",borderRadius:"0.3rem",maxWidth:"fit-content"}},children:[Object(jsx_runtime.jsx)(src.o,{}),Object(jsx_runtime.jsx)(src.B,{}),Object(jsx_runtime.jsx)(src.t,{})]})})};CustomControlBarStyles_snippet_CustomControlBarStylesExample.displayName="CustomControlBarStylesExample",CustomControlBarStyles_snippet_CustomControlBarStylesExample.__docgenInfo={description:"",methods:[],displayName:"CustomControlBarStylesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/CustomControlBarStyles.snippet.tsx"]={name:"CustomControlBarStylesExample",docgenInfo:CustomControlBarStyles_snippet_CustomControlBarStylesExample.__docgenInfo,path:"stories/ControlBar/snippets/CustomControlBarStyles.snippet.tsx"});var DevicesButton_snippet_DevicesButtonExample=function DevicesButtonExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(src.p,{layout:"horizontal",children:[Object(jsx_runtime.jsx)(src.o,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.s,{menuProps:{items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"camera1",text:"Full HD Webcam",title:"Full HD Webcam",canCheck:!0,isChecked:!0},{key:"camera2",text:"Macbook Pro Webcam",title:"Macbook Pro Webcam"}]}},{key:"2",name:"Choose Microphone",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"mic1",text:"Realtek HD Audio",title:"Realtek HD Audio"},{key:"mic2",text:"Macbook Pro Mic",title:"Macbook Pro Mic",canCheck:!0,isChecked:!0}]}}]}})]})})};DevicesButton_snippet_DevicesButtonExample.displayName="DevicesButtonExample",DevicesButton_snippet_DevicesButtonExample.__docgenInfo={description:"",methods:[],displayName:"DevicesButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/DevicesButton.snippet.tsx"]={name:"DevicesButtonExample",docgenInfo:DevicesButton_snippet_DevicesButtonExample.__docgenInfo,path:"stories/ControlBar/snippets/DevicesButton.snippet.tsx"});var AllButtonsControlBarExampleText=__webpack_require__(1407).default,ControlBarLayoutExampleText=__webpack_require__(1408).default,CustomButtonsExampleText=__webpack_require__(1409).default,CustomControlBarStylesExampleText=__webpack_require__(1410).default,DevicesButtonExampleText=__webpack_require__(1411).default,ControlBar_stories_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],ControlBar_stories_ControlBarStory=function ControlBarStory(args,_ref){var background="#f8f8f8";"Dark"===_ref.globals.theme&&(background=args.layout.startsWith("floating")?"#252423":"#161514");return Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",display:"inherit",background:background},children:Object(jsx_runtime.jsxs)(src.p,{layout:args.layout,children:[Object(jsx_runtime.jsx)(src.o,{showLabel:args.showLabel,checked:args.checked}),Object(jsx_runtime.jsx)(src.B,{showLabel:args.showLabel,checked:args.checked}),Object(jsx_runtime.jsx)(src.F,{showLabel:args.showLabel,checked:args.checked}),Object(jsx_runtime.jsx)(src.E,{showLabel:args.showLabel,participants:ControlBar_stories_mockParticipants,myUserId:"user1",callInvitationURL:"URL to copy",onMuteAll:function onMuteAll(){}}),Object(jsx_runtime.jsx)(DevicesButtonWithKnobs_snippet.a,Object.assign({},args)),Object(jsx_runtime.jsx)(src.t,{showLabel:args.showLabel})]})})};ControlBar_stories_ControlBarStory.displayName="ControlBarStory";var ControlBar=ControlBar_stories_ControlBarStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar",title:constants.a+"/Control Bar",component:src.p,argTypes:{layout:controlsUtils.a.controlBarLayout,checked:controlsUtils.a.checked,showLabel:controlsUtils.a.showLabel,cameras:controlsUtils.a.cameras,microphones:controlsUtils.a.microphones,speakers:controlsUtils.a.speakers,children:controlsUtils.j,styles:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ControlBar"}),Object(jsx_runtime.jsx)(esm.d,{children:"A container for call control buttons. See [layouts](#layouts) for the different formats this control provides."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { FluentThemeProvider, ControlBar } from '@azure/communication-react';\nimport { DefaultButton } from '@fluentui/react';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.d,{children:"We recommend using our pre-defined buttons you can start find [here](./?path=/docs/ui-components-controlbar-buttons) or `DefaultButton`, a [Button](https://developer.microsoft.com/fluentui#/controls/web/button) component from Fluent UI, as controls inside `ControlBar`. Pre-defined styles like `controlButtonStyles` or `controlButtonLabelStyles` can also be imported and used as `DefaultButton` styles for easy styling. `FluentThemeProvider` is needed around `ControlBar` to provide theming and icons. Learn more about theming [here](./?path=/docs/theming--page)."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note that for accessibility purposes, our pre-defined buttons can be focused on even when disabled. This behaviour can be changed by setting the button prop `allowDisabledFocus` to `false`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:AllButtonsControlBarExampleText,children:Object(jsx_runtime.jsx)(AllButtonsControlBar_snippet_AllButtonsControlBarExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: In the example above, `menuProps` is a property of `Button`. The property type is [IContextualMenuProps](https://developer.microsoft.com/fluentui#/controls/web/contextualmenu#IContextualMenuProps), an interface for defining dropdown menu items."}),Object(jsx_runtime.jsx)(esm.e,{children:"Layouts"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can change the layout of `ControlBar` by providing a preset layout to the `layout` prop. Preset layouts are `horizontal`, `vertical`, `dockedTop`, `dockedBottom`, `dockedLeft`, `dockedRight`, `floatingTop`, `floatingBottom`, `floatingLeft` and `floatingRight`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ControlBarLayoutExampleText,children:Object(jsx_runtime.jsx)(ControlBarLayout_snippet_ControlBarLayoutExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom ControlBar Styles"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can change the styles of the `ControlBar` by customizing its `styles` prop like in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomControlBarStylesExampleText,children:Object(jsx_runtime.jsx)(CustomControlBarStyles_snippet_CustomControlBarStylesExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom Buttons"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can also easily change the styles of included button components. They are built on Fluent UI `DefaultButton` and accept all the same props. In the example below we import `CameraButton` and `MicrophoneButton` for the 1st and 2nd buttons and style our own hang up button for the 3rd button. Learn more about styling [here](./?path=/docs/styling--page)."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomButtonsExampleText,children:Object(jsx_runtime.jsx)(CustomButtons_snippet_CustomButtonsExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Dropdown Devices Button"}),Object(jsx_runtime.jsx)(esm.d,{children:"The `DevicesButton` can be used for any dropdown items defined through `menuProps`. For more information, check out the [official Fluent UI documentation](https://developer.microsoft.com/fluentui#/controls/web/button)"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DevicesButtonExampleText,children:Object(jsx_runtime.jsx)(DevicesButton_snippet_DevicesButtonExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ControlBar Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.p})]})}()}}}};ControlBar.parameters=Object.assign({storySource:{source:"(args, { globals: { theme } }) => {\n  // This is code to set the color of the background div to show contrast to the control bar based on the theme like shown in the Figma design.\n  let background = '#f8f8f8';\n  if (theme === 'Dark') {\n    if (args.layout.startsWith('floating')) {\n      background = '#252423';\n    } else {\n      background = '#161514';\n    }\n  }\n\n  const onMuteAll = (): void => {\n    // your implementation to mute all participants\n  };\n\n  return (\n    <div\n      style={{\n        width: '100%',\n        height: '100%',\n        alignItems: 'center',\n        justifyContent: 'center',\n        display: 'inherit',\n        background: background\n      }}\n    >\n      <ControlBarComponent layout={args.layout}>\n        <CameraButton showLabel={args.showLabel} checked={args.checked} />\n        <MicrophoneButton showLabel={args.showLabel} checked={args.checked} />\n        <ScreenShareButton showLabel={args.showLabel} checked={args.checked} />\n        <ParticipantsButton\n          showLabel={args.showLabel}\n          participants={mockParticipants}\n          myUserId={'user1'}\n          callInvitationURL={'URL to copy'}\n          onMuteAll={onMuteAll}\n        />\n        <DevicesButtonWithKnobs {...args} />\n        <EndCallButton showLabel={args.showLabel} />\n      </ControlBarComponent>\n    </div>\n  );\n}"}},ControlBar.parameters)},1480:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,"parameters",(function(){return parameters})),__webpack_require__.d(preview_namespaceObject,"decorators",(function(){return decorators})),__webpack_require__.d(preview_namespaceObject,"globalTypes",(function(){return globalTypes}));__webpack_require__(36),__webpack_require__(9),__webpack_require__(62),__webpack_require__(768),__webpack_require__(125),__webpack_require__(70),__webpack_require__(1248),__webpack_require__(1249),__webpack_require__(97);var client_api=__webpack_require__(1748),esm=__webpack_require__(35),theming=(__webpack_require__(7),__webpack_require__(15),__webpack_require__(77)),src=__webpack_require__(21),lib=__webpack_require__(22),font_icons_mdl2_lib=__webpack_require__(1730),Open20Regular=__webpack_require__(1699),People20Regular=__webpack_require__(894),Record20Regular=__webpack_require__(1700),HandRight20Regular=__webpack_require__(1701),blocks=__webpack_require__(451),react=__webpack_require__(1),react_default=__webpack_require__.n(react),constants=__webpack_require__(14),THEMES={Light:{name:"Light",theme:theming.d},Dark:{name:"Dark",theme:theming.c}},locales=__webpack_require__(436),LOCALES={en_US:{locale:locales.c,englishName:"English (US)"},en_GB:{locale:locales.b,englishName:"English (British)"},de_DE:{locale:locales.a,englishName:"German (Germany)"},es_ES:{locale:locales.d,englishName:"Spanish (Spain)"},fr_FR:{locale:locales.e,englishName:"French (France)"},it_IT:{locale:locales.f,englishName:"Italian (Italy)"},ja_JP:{locale:locales.g,englishName:"Japanese (Japan)"},ko_KR:{locale:locales.h,englishName:"Korean (South Korea)"},nl_NL:{locale:locales.i,englishName:"Dutch (Netherlands)"},pt_BR:{locale:locales.j,englishName:"Portuguese (Brazil)"},ru_RU:{locale:locales.k,englishName:"Russian (Russia)"},tr_TR:{locale:locales.l,englishName:"Turkish (Turkey)"},zh_CN:{locale:locales.m,englishName:"Chinese (Mainland China)"},zh_TW:{locale:locales.n,englishName:"Chinese (Taiwan)"}},dist=(__webpack_require__(40),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(28),__webpack_require__(604)),jsx_runtime=__webpack_require__(2);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TOC_TOC=function TOC(props){var _useState2=_slicedToArray(Object(react.useState)(window.matchMedia("(max-width: 900px)").matches),2),hideToc=_useState2[0],setHideToc=_useState2[1];Object(react.useEffect)((function(){var setHideTocHandler=function setHideTocHandler(e){return setHideToc(e.matches)};return window.matchMedia("(max-width: 900px)").addEventListener("change",setHideTocHandler),function(){window.matchMedia("(max-width: 900px)").removeEventListener("change",setHideTocHandler)}}));var tocStyles=Object(lib.H)({display:hideToc?"none":"block",fontFamily:"Segoe UI",fontSize:"12px","& nav":{top:0,width:"10rem",left:"calc(100% - 11.25rem)","div > ol > li.toc-list-item":{padding:"0 0.5rem"},"div > ol > li > a.toc-link":{whiteSpace:"break-spaces !important",marginBottom:"0.25rem",marginTop:"0.25rem"},"a.toc-link":{whiteSpace:"break-spaces !important",marginBottom:"0.125rem",marginTop:"0.125rem"}}});return Object(jsx_runtime.jsxs)(react_default.a.Fragment,{children:[Object(jsx_runtime.jsx)("div",{className:tocStyles,children:Object(jsx_runtime.jsx)(dist.TableOfContents,{})}),Object(jsx_runtime.jsx)("div",{style:hideToc?{maxWidth:"48rem"}:{maxWidth:"calc(100% - 11.25rem)"},children:props.children}),Object(jsx_runtime.jsx)("div",{className:Object(lib.H)({"> button":{right:16}}),children:Object(jsx_runtime.jsx)(dist.BackToTop,{})})]})};TOC_TOC.displayName="TOC",TOC_TOC.__docgenInfo={description:"Table Of Contents component used for displaying a floating table of content\ninside Storybook Docs.\n@param props \n@returns",methods:[],displayName:"TOC",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES[".storybook/TOC.tsx"]={name:"TOC",docgenInfo:TOC_TOC.__docgenInfo,path:".storybook/TOC.tsx"});var storyIcons={Open:Object(jsx_runtime.jsx)(Open20Regular.a,{}),Participants:Object(jsx_runtime.jsx)(People20Regular.a,{}),Record:Object(jsx_runtime.jsx)(Record20Regular.a,{}),RightHand:Object(jsx_runtime.jsx)(HandRight20Regular.a,{})};Object(lib.F)({}),Object(font_icons_mdl2_lib.a)(),Object(lib.L)({icons:Object.assign({},theming.a,storyIcons)});var parameters={layout:"fullscreen",docs:{container:function container(props){return Object(jsx_runtime.jsx)(TOC_TOC,{children:Object(jsx_runtime.jsxs)(blocks.DocsContainer,{context:props.context,children:[Object(jsx_runtime.jsx)(blocks.Anchor,{storyId:props.context.id}),props.children]})})}},options:{storySort:{order:["Overview","Use Cases","Feedback",constants.b,["Get Started","CallComposite","ChatComposite","CallWithChatComposite","Adapters","Cross-Framework Support"],constants.a,["Get Started","Video Gallery","Video Tile","Grid Layout","Control Bar","Message Thread","Send Box","Message Status Indicator","Typing Indicator","Participant Item","Participant List"],constants.c,["Styling","Theming","Icons","Localization","Accessibility","Custom User Data Model","Error Handling","Troubleshooting","Identity"],constants.d,constants.g,["Overview","Get Started (Call)","Get Started (Chat)","Best Practices","React Hooks",["Setting up","UsePropsFor","UseSelector"]]]}},viewMode:"docs",previewTabs:{"storybook/docs/panel":{index:-1},canvas:{title:"Preview"}}},preview_withCenterStory=function withCenterStory(Story){return Object(jsx_runtime.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:Object(jsx_runtime.jsx)(Story,{})})};preview_withCenterStory.displayName="withCenterStory";var decorators=[preview_withCenterStory,function withThemeProvider(Story,context){var _THEMES$themeName,themeName=context.globals.theme,theme=null===(_THEMES$themeName=THEMES[themeName])||void 0===_THEMES$themeName?void 0:_THEMES$themeName.theme;if(context.globals.customTheme)try{theme=JSON.parse(context.globals.customTheme)}catch(e){console.log("Could not parse the following theme JSON: "+context.globals.customTheme)}var rtl="rtl"===context.globals.rtl;return void 0!==context?Object(jsx_runtime.jsx)(theming.b,{fluentTheme:theme,rtl:rtl,children:Object(jsx_runtime.jsx)(Story,Object.assign({},context,{theme:theme}))}):Object(jsx_runtime.jsx)(Story,Object.assign({},context))},function withLocalization(Story,context){var localeKey=context.globals.locale;return void 0!==context?Object(jsx_runtime.jsx)(src.y,{locale:LOCALES[localeKey].locale,children:Object(jsx_runtime.jsx)(Story,Object.assign({},context))}):Object(jsx_runtime.jsx)(Story,Object.assign({},context))}],globalTypes={theme:{name:"Theme",description:"Global theme for components",defaultValue:THEMES.Light.name},customTheme:{name:"Custom theme",description:"Custom global theme for components",defaultValue:""},locale:{name:"Locale",description:"Locale for components",defaultValue:"en_US"},rtl:{name:"RTL",description:"Whether the direction of components is right-to-left or left-to-right",defaultValue:"ltr"}};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":case"argTypes":return esm.a.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(value));case"decorators":return value.forEach((function(decorator){return Object(client_api.c)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return Object(client_api.d)(loader,!1)}));case"parameters":return Object(client_api.e)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return Object(client_api.a)(enhancer)}));case"argsEnhancers":return value.forEach((function(enhancer){return Object(client_api.b)(enhancer)}));case"render":return Object(client_api.g)(value);case"globals":case"globalTypes":var v={};return v[key]=value,Object(client_api.e)(v,!1);default:return console.log(key+" was not supported :( !")}}))},1481:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Camera",(function(){return Camera}));__webpack_require__(7),__webpack_require__(39),__webpack_require__(12),__webpack_require__(47),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var src=__webpack_require__(21),esm=__webpack_require__(4),react=__webpack_require__(1),SingleLineBetaBanner=__webpack_require__(201),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(884),Label=__webpack_require__(1742),jsx_runtime=__webpack_require__(2),Custom_snippet_CustomCameraButtonExample=function CustomCameraButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Camera",style:{color:"green",fontSize:"25px"}},"CameraIconKey"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Camera",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"CameraIconKey")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Label.a,{style:{fontStyle:"italic"},children:"Turn off"},"CameraLabelKey"):Object(jsx_runtime.jsx)(Label.a,{children:"Turn on"},"CameraLabelKey")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.o,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"camera 1"),Object(jsx_runtime.jsx)(src.o,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"camera 2")]})};Custom_snippet_CustomCameraButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomCameraButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/Custom.snippet.tsx"]={name:"CustomCameraButtonExample",docgenInfo:Custom_snippet_CustomCameraButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/Custom.snippet.tsx"});var theming=__webpack_require__(77),Default_snippet_CameraButtonExample=function CameraButtonExample(){return Object(jsx_runtime.jsxs)(theming.b,{children:[Object(jsx_runtime.jsx)(src.o,{checked:!0},"camBtn1"),Object(jsx_runtime.jsx)(src.o,{},"camBtn2")]})};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}Default_snippet_CameraButtonExample.displayName="CameraButtonExample",Default_snippet_CameraButtonExample.__docgenInfo={description:"",methods:[],displayName:"CameraButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/Default.snippet.tsx"]={name:"CameraButtonExample",docgenInfo:Default_snippet_CameraButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/Default.snippet.tsx"});var WithDevicesMenu_snippet_CameraButtonWithDevicesMenuExample=function CameraButtonWithDevicesMenuExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.o,{enableDeviceSelectionMenu:!0,cameras:[{id:"camera1",name:"Front Camera"},{id:"camera2",name:"Back Camera"}],selectedCamera:{id:"camera1",name:"Front Camera"},onClick:function onClick(){},onSelectCamera:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:case"end":return _context.stop()}}),_callee)}))),styles:{splitButtonContainer:{border:"1px solid"}}})})};WithDevicesMenu_snippet_CameraButtonWithDevicesMenuExample.displayName="CameraButtonWithDevicesMenuExample",WithDevicesMenu_snippet_CameraButtonWithDevicesMenuExample.__docgenInfo={description:"",methods:[],displayName:"CameraButtonWithDevicesMenuExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/WithDevicesMenu.snippet.tsx"]={name:"CameraButtonWithDevicesMenuExample",docgenInfo:WithDevicesMenu_snippet_CameraButtonWithDevicesMenuExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/WithDevicesMenu.snippet.tsx"});var WithLabel_snippet_CameraButtonWithLabelExample=function CameraButtonWithLabelExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.o,{showLabel:!0,checked:!0})})};function Camera_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function Camera_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){Camera_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){Camera_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}WithLabel_snippet_CameraButtonWithLabelExample.displayName="CameraButtonWithLabelExample",WithLabel_snippet_CameraButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"CameraButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/WithLabel.snippet.tsx"]={name:"CameraButtonWithLabelExample",docgenInfo:WithLabel_snippet_CameraButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/WithLabel.snippet.tsx"});var CustomButtonExampleText=__webpack_require__(1380).default,DefaultButtonExampleText=__webpack_require__(1381).default,ButtonWithDevicesMenuExampleText=__webpack_require__(1382).default,ButtonWithLabelExampleText=__webpack_require__(1383).default,Camera_stories_CameraStory=function CameraStory(args){return Object(jsx_runtime.jsx)(Camera_stories_CameraButtonWithDevices,Object.assign({},args))};Camera_stories_CameraStory.displayName="CameraStory";var Camera_stories_CameraButtonWithDevices=function CameraButtonWithDevices(props){var _onToggleCamera,_onSelectCamera,_useState2=_slicedToArray(Object(react.useState)(controlsUtils.e[0]),2),selectedCamera=_useState2[0],setSelectedCamera=_useState2[1],deviceProps={selectedCamera:selectedCamera,onSelectCamera:(_onSelectCamera=Camera_stories_asyncToGenerator(regeneratorRuntime.mark((function _callee(device){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:setSelectedCamera(device);case 1:case"end":return _context.stop()}}),_callee)}))),function onSelectCamera(_x){return _onSelectCamera.apply(this,arguments)}),onToggleCamera:(_onToggleCamera=Camera_stories_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:case"end":return _context2.stop()}}),_callee2)}))),function onToggleCamera(){return _onToggleCamera.apply(this,arguments)})};return Object(jsx_runtime.jsx)(src.o,Object.assign({},props,deviceProps))};Camera_stories_CameraButtonWithDevices.displayName="CameraButtonWithDevices";var Camera=Camera_stories_CameraStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-camera",title:constants.a+"/Control Bar/Buttons/Camera",component:src.o,argTypes:{checked:controlsUtils.a.checked,showLabel:controlsUtils.a.showLabel,cameras:controlsUtils.a.cameras,onToggleCamera:controlsUtils.j,localVideoViewOptions:controlsUtils.j,selectedCamera:controlsUtils.j,onSelectCamera:controlsUtils.j,strings:controlsUtils.j,styles:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"CameraButton"}),Object(jsx_runtime.jsx)(esm.d,{children:"A button to toggle the user's camera on and off. For use with the [Control Bar](./?path=/docs/ui-components-controlbar--control-bar)."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note that for accessibility purposes, this button can be focused on even when disabled. This behaviour can be changed by setting the button prop `allowDisabledFocus` to `false`."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { CameraButton } from '@azure/communication-ui';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.d,{children:"The default `CameraButton` component shows a Camera icon with no label. The following example displays the `CameraButton` with camera turned on and off."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DefaultButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_CameraButtonExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Camera with default label"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can display the button label which, by default, will show below the icon as `Turn on` or `Turn off`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_CameraButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Camera with device selection menu"}),Object(jsx_runtime.jsx)(SingleLineBetaBanner.b,{}),Object(jsx_runtime.jsx)(esm.d,{children:"`CameraButton` can be optionally rendered as a split button. The secondary button in this mode opens a menu where users can select the camera to use. To render `CameraButton` in this mode, set the `enableDeviceSelectionMenu` prop to `true`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ButtonWithDevicesMenuExampleText,children:Object(jsx_runtime.jsx)(WithDevicesMenu_snippet_CameraButtonWithDevicesMenuExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom CameraButton Styles"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can change the styles of the `CameraButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, do not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomCameraButtonExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"CameraButton Props"}),Object(jsx_runtime.jsx)(esm.d,{children:"`CameraButton` features all props a [FluentUI Button](https://developer.microsoft.com/fluentui#/controls/web/button) offers, with the following additional properties:"}),Object(jsx_runtime.jsx)(esm.g,{of:src.o})]})}()}},storyshots:{disable:!0}}};Camera.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <CameraButtonWithDevices {...args} />;\n}"}},Camera.parameters)},1482:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Microphone",(function(){return Microphone}));__webpack_require__(7),__webpack_require__(39),__webpack_require__(12),__webpack_require__(47),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var src=__webpack_require__(21),esm=__webpack_require__(4),react=__webpack_require__(1),SingleLineBetaBanner=__webpack_require__(201),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(884),Text=__webpack_require__(499),Label=__webpack_require__(1742),jsx_runtime=__webpack_require__(2),Custom_snippet_CustomMicrophoneButtonExample=function CustomMicrophoneButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Microphone",style:{color:"green",fontSize:"25px"}},"micCustomIcon1"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Microphone",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"micCustomIcon2")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Text.a,{style:{fontStyle:"italic"},children:"unmuted"},"micCustomText"):Object(jsx_runtime.jsx)(Label.a,{children:"muted"},"micCustomLabel")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.B,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"micCustomBtn1"),Object(jsx_runtime.jsx)(src.B,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"micCustomBtn2")]})};Custom_snippet_CustomMicrophoneButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomMicrophoneButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/Custom.snippet.tsx"]={name:"CustomMicrophoneButtonExample",docgenInfo:Custom_snippet_CustomMicrophoneButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/Custom.snippet.tsx"});var theming=__webpack_require__(77),Default_snippet_MicrophoneButtonExample=function MicrophoneButtonExample(){return Object(jsx_runtime.jsxs)(theming.b,{children:[Object(jsx_runtime.jsx)(src.B,{checked:!0},"micBtn1"),Object(jsx_runtime.jsx)(src.B,{},"micBtn2")]})};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}Default_snippet_MicrophoneButtonExample.displayName="MicrophoneButtonExample",Default_snippet_MicrophoneButtonExample.__docgenInfo={description:"",methods:[],displayName:"MicrophoneButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/Default.snippet.tsx"]={name:"MicrophoneButtonExample",docgenInfo:Default_snippet_MicrophoneButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/Default.snippet.tsx"});var WithDevicesMenu_snippet_MicrophoneButtonWithDevicesMenuExample=function MicrophoneButtonWithDevicesMenuExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.B,{onClick:function onClick(){},enableDeviceSelectionMenu:!0,speakers:[{id:"speaker1",name:"Internal Speakers"},{id:"speaker2",name:"Headphones"}],selectedSpeaker:{id:"speaker2",name:"Headphones"},onSelectSpeaker:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:case"end":return _context.stop()}}),_callee)}))),microphones:[{id:"microphone1",name:"Internal Microphone"}],selectedMicrophone:{id:"microphone1",name:"Internal Microphone"},onSelectMicrophone:_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:case"end":return _context2.stop()}}),_callee2)}))),styles:{splitButtonContainer:{border:"1px solid"}}})})};WithDevicesMenu_snippet_MicrophoneButtonWithDevicesMenuExample.displayName="MicrophoneButtonWithDevicesMenuExample",WithDevicesMenu_snippet_MicrophoneButtonWithDevicesMenuExample.__docgenInfo={description:"",methods:[],displayName:"MicrophoneButtonWithDevicesMenuExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/WithDevicesMenu.snippet.tsx"]={name:"MicrophoneButtonWithDevicesMenuExample",docgenInfo:WithDevicesMenu_snippet_MicrophoneButtonWithDevicesMenuExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/WithDevicesMenu.snippet.tsx"});var WithLabel_snippet_MicrophoneButtonWithLabelExample=function MicrophoneButtonWithLabelExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.B,{showLabel:!0,checked:!0})})};function Microphone_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function Microphone_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){Microphone_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){Microphone_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}WithLabel_snippet_MicrophoneButtonWithLabelExample.displayName="MicrophoneButtonWithLabelExample",WithLabel_snippet_MicrophoneButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"MicrophoneButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/WithLabel.snippet.tsx"]={name:"MicrophoneButtonWithLabelExample",docgenInfo:WithLabel_snippet_MicrophoneButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/WithLabel.snippet.tsx"});var CustomMicrophoneButtonExampleText=__webpack_require__(1393).default,MicrophoneButtonExampleText=__webpack_require__(1394).default,ButtonWithDevicesMenuExampleText=__webpack_require__(1395).default,MicrophoneButtonWithLabelExampleText=__webpack_require__(1396).default,Microphone_stories_MicrophoneStory=function MicrophoneStory(args){return Object(jsx_runtime.jsx)(Microphone_stories_MicrophoneButtonWithDevices,Object.assign({},args))};Microphone_stories_MicrophoneStory.displayName="MicrophoneStory";var Microphone_stories_MicrophoneButtonWithDevices=function MicrophoneButtonWithDevices(props){var _onToggleMicrophone,_onSelectSpeaker,_onSelectMicrophone,_useState2=_slicedToArray(Object(react.useState)(controlsUtils.f[0]),2),selectedMicrophone=_useState2[0],setSelectedMicrophone=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(controlsUtils.g[0]),2),selectedSpeaker=_useState4[0],setSelectedSpeaker=_useState4[1],deviceProps={selectedMicrophone:selectedMicrophone,selectedSpeaker:selectedSpeaker,onSelectMicrophone:(_onSelectMicrophone=Microphone_stories_asyncToGenerator(regeneratorRuntime.mark((function _callee(device){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:setSelectedMicrophone(device);case 1:case"end":return _context.stop()}}),_callee)}))),function onSelectMicrophone(_x){return _onSelectMicrophone.apply(this,arguments)}),onSelectSpeaker:(_onSelectSpeaker=Microphone_stories_asyncToGenerator(regeneratorRuntime.mark((function _callee2(device){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:setSelectedSpeaker(device);case 1:case"end":return _context2.stop()}}),_callee2)}))),function onSelectSpeaker(_x2){return _onSelectSpeaker.apply(this,arguments)}),onToggleMicrophone:(_onToggleMicrophone=Microphone_stories_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:case"end":return _context3.stop()}}),_callee3)}))),function onToggleMicrophone(){return _onToggleMicrophone.apply(this,arguments)})};return Object(jsx_runtime.jsx)(src.B,Object.assign({},props,deviceProps))};Microphone_stories_MicrophoneButtonWithDevices.displayName="MicrophoneButtonWithDevices";var Microphone=Microphone_stories_MicrophoneStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-microphone",title:constants.a+"/Control Bar/Buttons/Microphone",component:src.B,argTypes:{checked:controlsUtils.a.checked,showLabel:controlsUtils.a.showLabel,microphones:controlsUtils.a.microphones,speakers:controlsUtils.a.speakers,onToggleMicrophone:controlsUtils.j,selectedMicrophone:controlsUtils.j,selectedSpeaker:controlsUtils.j,onSelectMicrophone:controlsUtils.j,onSelectSpeaker:controlsUtils.j,strings:controlsUtils.j,styles:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"MicrophoneButton"}),Object(jsx_runtime.jsx)(esm.d,{children:"A button to toggle the user's microphone on and off. For use with the [Control Bar](./?path=/docs/ui-components-controlbar--control-bar)."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note that for accessibility purposes, this button can be focused on even when disabled. This behaviour can be changed by setting the button prop `allowDisabledFocus` to `false`."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { MicrophoneButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.d,{children:"The default `MicrophoneButton` component shows a microphone icon with no label. The following example displays an unmuted `MicrophoneButton` and a muted `MicrophoneButton`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MicrophoneButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_MicrophoneButtonExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Microphone with default label"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can display the button label which, by default, will show below the icon as `Mute` or `Unmute`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:MicrophoneButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_MicrophoneButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Microphone with device selection menu"}),Object(jsx_runtime.jsx)(SingleLineBetaBanner.b,{}),Object(jsx_runtime.jsx)(esm.d,{children:"`MicrophoneButton` can be optionally rendered as a split button. The secondary button in this mode opens a menu where users can select the audio devices to use. To render `MicrophoneButton` in this mode, set the `enableDeviceSelectionMenu` prop to `true`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ButtonWithDevicesMenuExampleText,children:Object(jsx_runtime.jsx)(WithDevicesMenu_snippet_MicrophoneButtonWithDevicesMenuExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom MicrophoneButton Styles"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can change the styles of the `MicrophoneButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, do not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomMicrophoneButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomMicrophoneButtonExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"MicrophoneButton Props"}),Object(jsx_runtime.jsx)(esm.d,{children:"`MicrophoneButton` features all props a [FluentUI Button](https://developer.microsoft.com/fluentui#/controls/web/button) offers, with the additional following properties."}),Object(jsx_runtime.jsx)(esm.g,{of:src.B})]})}()}}}};Microphone.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <MicrophoneButtonWithDevices {...args} />;\n}"}},Microphone.parameters)},1483:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ParticipantList",(function(){return ParticipantList}));__webpack_require__(45),__webpack_require__(34),__webpack_require__(15),__webpack_require__(47),__webpack_require__(7),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(28),__webpack_require__(23);var src=__webpack_require__(21),Stack=__webpack_require__(69),esm=__webpack_require__(4),react=__webpack_require__(1),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),theming=__webpack_require__(77),jsx_runtime=__webpack_require__(2),DefaultCall_snippet_DefaultCallParticipantListExample=function DefaultCallParticipantListExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.D,{participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],myUserId:"user1"})]})})};DefaultCall_snippet_DefaultCallParticipantListExample.displayName="DefaultCallParticipantListExample",DefaultCall_snippet_DefaultCallParticipantListExample.__docgenInfo={description:"",methods:[],displayName:"DefaultCallParticipantListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/DefaultCall.snippet.tsx"]={name:"DefaultCallParticipantListExample",docgenInfo:DefaultCall_snippet_DefaultCallParticipantListExample.__docgenInfo,path:"stories/ParticipantList/snippets/DefaultCall.snippet.tsx"});var DefaultChat_snippet_DefaultChatParticipantListExample=function DefaultChatParticipantListExample(){return Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.D,{participants:[{userId:"user 1",displayName:"You",isRemovable:!0},{userId:"user 2",displayName:"Hal Jordan",isRemovable:!0},{userId:"user 3",displayName:"Barry Allen",isRemovable:!0},{userId:"user 4",displayName:"Bruce Wayne",isRemovable:!0}]})]})};DefaultChat_snippet_DefaultChatParticipantListExample.displayName="DefaultChatParticipantListExample",DefaultChat_snippet_DefaultChatParticipantListExample.__docgenInfo={description:"",methods:[],displayName:"DefaultChatParticipantListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/DefaultChat.snippet.tsx"]={name:"DefaultChatParticipantListExample",docgenInfo:DefaultChat_snippet_DefaultChatParticipantListExample.__docgenInfo,path:"stories/ParticipantList/snippets/DefaultChat.snippet.tsx"});__webpack_require__(74);var Persona_types=__webpack_require__(27),Icon=__webpack_require__(884);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var InteractiveCall_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isRemovable:!0},{userId:"user2",displayName:"Peter Parker",state:"Connected",isMuted:!1,isRemovable:!0},{userId:"user3",displayName:"Matthew Murdock",state:"Idle",isMuted:!1,isRemovable:!0},{userId:"user4",displayName:"Frank Castiglione",state:"Connecting",isMuted:!1,isRemovable:!1}],InteractiveCall_snippet_InteractiveCallParticipantListExample=function InteractiveCallParticipantListExample(){var _useState2=_slicedToArray(Object(react.useState)(InteractiveCall_snippet_mockParticipants),2),participants=_useState2[0],setParticpants=_useState2[1];return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.D,{participants:participants,myUserId:"user1",onRenderParticipant:function onRenderParticipant(participant){var participantIndex=participants.map((function(p){return p.userId})).indexOf(participant.userId),callingParticipant=participants[participantIndex],presence=void 0;callingParticipant&&("Connected"===callingParticipant.state?presence=Persona_types.b.online:"Idle"===callingParticipant.state?presence=Persona_types.b.away:"Connecting"===callingParticipant.state&&(presence=Persona_types.b.offline));var menuItems=[{key:"mute",text:callingParticipant.isMuted?"Unmute":"Mute",onClick:function onClick(){var newParticipants=_toConsumableArray(participants);newParticipants[participantIndex].isMuted=!participants[participantIndex].isMuted,setParticpants(newParticipants)}}],onRenderIcon=null!=callingParticipant&&callingParticipant.isMuted?function(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"MicOff2"})}:function(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})};return participant.displayName?Object(jsx_runtime.jsx)(src.C,{displayName:participant.displayName,me:"user1"===participant.userId,menuItems:menuItems,presence:presence,onRenderIcon:onRenderIcon}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}})]})})};InteractiveCall_snippet_InteractiveCallParticipantListExample.displayName="InteractiveCallParticipantListExample",InteractiveCall_snippet_InteractiveCallParticipantListExample.__docgenInfo={description:"",methods:[],displayName:"InteractiveCallParticipantListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/InteractiveCall.snippet.tsx"]={name:"InteractiveCallParticipantListExample",docgenInfo:InteractiveCall_snippet_InteractiveCallParticipantListExample.__docgenInfo,path:"stories/ParticipantList/snippets/InteractiveCall.snippet.tsx"});var WithExcludedUser_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1,isRemovable:!0},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0,isRemovable:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1,isRemovable:!0},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1,isRemovable:!1}],WithExcludedUser_snippet_ParticipantListWithExcludedUserExample=function ParticipantListWithExcludedUserExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.D,{participants:WithExcludedUser_snippet_mockParticipants,myUserId:"user1",excludeMe:!0})]})})};function ParticipantList_stories_toConsumableArray(arr){return function ParticipantList_stories_arrayWithoutHoles(arr){if(Array.isArray(arr))return ParticipantList_stories_arrayLikeToArray(arr)}(arr)||function ParticipantList_stories_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function ParticipantList_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantList_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantList_stories_arrayLikeToArray(o,minLen)}(arr)||function ParticipantList_stories_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ParticipantList_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}WithExcludedUser_snippet_ParticipantListWithExcludedUserExample.displayName="ParticipantListWithExcludedUserExample",WithExcludedUser_snippet_ParticipantListWithExcludedUserExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantListWithExcludedUserExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/WithExcludedUser.snippet.tsx"]={name:"ParticipantListWithExcludedUserExample",docgenInfo:WithExcludedUser_snippet_ParticipantListWithExcludedUserExample.__docgenInfo,path:"stories/ParticipantList/snippets/WithExcludedUser.snippet.tsx"});var DefaultCallParticipantListExampleText=__webpack_require__(1437).default,DefaultChatParticipantListExampleText=__webpack_require__(1438).default,InteractiveCallParticipantListExampleText=__webpack_require__(1439).default,ParticipantListWithExcludedUserExampleText=__webpack_require__(1440).default,ParticipantList_stories_ParticipantListStory=function ParticipantListStory(args){var mockParticipants=[].concat(ParticipantList_stories_toConsumableArray(args.remoteParticipants),ParticipantList_stories_toConsumableArray(args.localParticipant)).map((function(p,i){return{userId:"userId "+i,displayName:p.name,state:p.status,isMuted:p.isMuted,isScreenSharing:p.isScreenSharing,isRemovable:!0}})),myUserId=mockParticipants[mockParticipants.length-1].userId;return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(src.D,{participants:mockParticipants,myUserId:myUserId,excludeMe:args.excludeMe,onRemoveParticipant:function onParticipantRemove(_userId){}})})};ParticipantList_stories_ParticipantListStory.displayName="ParticipantListStory";var ParticipantList=ParticipantList_stories_ParticipantListStory.bind({});__webpack_exports__.default={id:constants.a+"-participantlist",title:constants.a+"/Participant List",component:src.D,argTypes:{excludeMe:controlsUtils.a.excludeMeFromList,localParticipant:controlsUtils.a.localParticipant,remoteParticipants:controlsUtils.a.remoteParticipants,participants:controlsUtils.j,myUserId:controlsUtils.j,onRenderParticipant:controlsUtils.j,onRenderAvatar:controlsUtils.j,onParticipantRemove:controlsUtils.j,onRemoveParticipant:controlsUtils.j,onFetchParticipantMenuItems:controlsUtils.j,styles:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ParticipantList"}),Object(jsx_runtime.jsx)(esm.d,{children:"Component that renders a list of all calling or chat participants."}),Object(jsx_runtime.jsx)(esm.e,{children:"Default example for Chat"}),Object(jsx_runtime.jsx)(esm.d,{children:"The ParticipantList for chat is by default a list of [PartipantItem](./?path=/docs/ui-components-participantitem--participant-item) components linked with state around each chat participant."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DefaultChatParticipantListExampleText,children:Object(jsx_runtime.jsx)(DefaultChat_snippet_DefaultChatParticipantListExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Default example for Calling"}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticipantList for calling is by default a list of [PartipantItem](./?path=/docs/ui-components-participantitem--participant-item) components with presence linked to the participant call state, as well as icons for microphone and screen sharing states"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DefaultCallParticipantListExampleText,children:Object(jsx_runtime.jsx)(DefaultCall_snippet_DefaultCallParticipantListExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ParticipantList with local user excluded from the list"}),Object(jsx_runtime.jsx)(esm.d,{children:"Local user can be excluded from the participant list like shown in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ParticipantListWithExcludedUserExampleText,children:Object(jsx_runtime.jsx)(WithExcludedUser_snippet_ParticipantListWithExcludedUserExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Interactive Call example"}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticpantList is designed with a rendering override, `onRenderParticipant`, which allows you to have your own design or use the your own [PartipantItem](./?path=/docs/ui-components-participantitem--participant-item) components with their context menu style enabling interaction with this participant. For example, let us add menu items and icons to the participants using `menuItems` and `onRenderIcon` properties of [ParticipantItem](./?path=/docs/ui-components-participantitem--participant-item#props) like in the code below."}),Object(jsx_runtime.jsx)(esm.d,{children:"For simplicity, we are using React `useState` to keep the state of every participant to decide which menu items and icons to show. You can now mute and unmute by clicking a participant in the rendered example below."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: Each `ParticipantItem` needs a unique key to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:InteractiveCallParticipantListExampleText,children:Object(jsx_runtime.jsx)(InteractiveCall_snippet_InteractiveCallParticipantListExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.D})]})}()}}}};ParticipantList.parameters=Object.assign({storySource:{source:"(args) => {\n  const participantsControls = [...args.remoteParticipants, ...args.localParticipant];\n\n  const mockParticipants: ParticipantListParticipant[] = participantsControls.map((p, i) => {\n    return {\n      userId: `userId ${i}`,\n      displayName: p.name,\n      state: p.status,\n      isMuted: p.isMuted,\n      isScreenSharing: p.isScreenSharing,\n      isRemovable: true\n    };\n  });\n\n  const myUserId = mockParticipants[mockParticipants.length - 1].userId;\n\n  \n  const onParticipantRemove = (_userId: string): void => {\n    // Do something when remove a participant from list\n  };\n\n  return (\n    <Stack>\n      <ParticipantListComponent\n        participants={mockParticipants}\n        myUserId={myUserId}\n        excludeMe={args.excludeMe}\n        onRemoveParticipant={onParticipantRemove}\n      />\n    </Stack>\n  );\n}"}},ParticipantList.parameters)},1484:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var esm=__webpack_require__(0),dist_esm=__webpack_require__(4),Stack=__webpack_require__(69),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.f,{id:"quickstarts-statefulcallclient",title:"Stateful Client/Get Started (Call)",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(esm.b)("h1",{id:"quickstart-get-started-with-call-stateful-client"},"Quickstart: Get started with Call Stateful Client"),Object(esm.b)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications.\nIn this quickstart, you'll learn how to integrate UI Library stateful clients into your application to build communication experiences.\nTo learn more about how to build applications with UI Library UI Components, see ",Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/quickstarts-uicomponents--page"},"Get started with UI Components"),"\nStateful clients make it easier for developers to build UI applications on top of Azure Communication Services by providing built-in state that UI components can use to render.\nFind more information about ",Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/statefulclient-overview--page"},"Stateful client here."),"."),Object(esm.b)("h2",{id:"download-the-code"},"Download the code"),Object(esm.b)("p",null,"You can find the completed code for this quickstart here: ",Object(esm.b)("a",{parentName:"p",href:"https://github.com/Azure-Samples/communication-services-javascript-quickstarts/tree/main/ui-library-starting-with-calling-stateful",target:"_blank",rel:"nofollow noopener noreferrer"},"Get started with Call Stateful Client")),Object(esm.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.b)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 14.19.0 and above)."),Object(esm.b)("li",{parentName:"ul"},"An active Communication Services resource. ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create a Communication Services resource"),"."),Object(esm.b)("li",{parentName:"ul"},"An identity with Call scope. Generate an identity using the ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/identity/quick-create-identity",target:"_blank",rel:"nofollow noopener noreferrer"},"Azure Portal"),".")),Object(esm.b)("p",null,Object(esm.b)("strong",{parentName:"p"},"Recommended:")),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"Knowledge of ",Object(esm.b)("a",{parentName:"li",href:"./?path=/story/quickstarts-uicomponents--page"},"UI Library Components"),". We will be using the UI Components in this quickstart."),Object(esm.b)("li",{parentName:"ul"},"Knowledge of Azure Communication Services ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/concepts/voice-video-calling/about-call-types",target:"_blank",rel:"nofollow noopener noreferrer"},"Call Concepts"),".")),Object(esm.b)("h2",{id:"generate-access-token"},"Generate Access Token"),Object(esm.b)("p",null,"For setting up adapters that power the composites, we need to generate an access token to allow the adapters to interact with the Azure Communication Services back-end."),Object(esm.b)("p",null,"Access Tokens can be generated using this ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/quickstarts/identity/quick-create-identity",target:"_blank",rel:"nofollow noopener noreferrer"},"Azure Portal quickstart")," inside your Azure Communication Services dashboard as shown below."),Object(esm.b)(Stack.a,{style:{width:"100%"},mdxType:"Stack"},Object(esm.b)("video",{style:{width:"100%"},src:"videos/generate-access-token.mp4",autoPlay:!0,loop:!0,muted:!0})),Object(esm.b)("br",null),Object(esm.b)("h2",{id:"setting-up"},"Setting Up"),Object(esm.b)("p",null,"UI Library requires a React environment to be setup as described below. If you already have a React App, you can skip this section."),Object(esm.b)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.b)("p",null,"We'll use the ",Object(esm.b)("inlineCode",{parentName:"p"},"create-react-app")," template for this quickstart. For more information, see: ",Object(esm.b)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-library-starting-with-call-stateful --template typescript\n\ncd ui-library-starting-with-call-stateful\n\n")),Object(esm.b)("p",null,"At the end of this process, you should have a full application inside the folder ",Object(esm.b)("inlineCode",{parentName:"p"},"ui-library-starting-with-call-stateful"),".\nFor this quickstart, we'll be modifying files inside the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.b)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.b)("p",null,"Use the ",Object(esm.b)("inlineCode",{parentName:"p"},"npm install")," command to install the Azure Communication Services UI Library for JavaScript."),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-react\n\n")),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," specifies core Azure Communication Services as ",Object(esm.b)("inlineCode",{parentName:"p"},"peerDependencies")," so that\nyou can most consistently use the API from the core libraries in your application. You need to install those libraries as well:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-calling@1.3.2\nnpm install @azure/communication-chat@1.1.0\n\n")),Object(esm.b)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.b)("p",null,"Let's test the Create React App installation by running:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.b)("p",null,"At this stage you should see a browser tab open with the default state of the create react app."),Object(esm.b)("h2",{id:"object-model"},"Object Model"),Object(esm.b)("p",null,"The following classes and interfaces from the Azure Communication Services UI client library are referenced in this quickstart:"),Object(esm.b)("table",null,Object(esm.b)("thead",{parentName:"table"},Object(esm.b)("tr",{parentName:"thead"},Object(esm.b)("th",{parentName:"tr",align:null},"Name"),Object(esm.b)("th",{parentName:"tr",align:null},"Description"))),Object(esm.b)("tbody",{parentName:"table"},Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"https://docs.microsoft.com/javascript/api/azure-communication-services/@azure/communication-calling/callclient?view=azure-communication-services-js",target:"_blank",rel:"nofollow noopener noreferrer"},"CallClient")),Object(esm.b)("td",{parentName:"tr",align:null},"Low-level call library client.")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"https://docs.microsoft.com/javascript/api/azure-communication-services/@azure/communication-calling/callagent?view=azure-communication-services-js",target:"_blank",rel:"nofollow noopener noreferrer"},"CallAgent")),Object(esm.b)("td",{parentName:"tr",align:null},"Low-level call agent for calling client.")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"https://docs.microsoft.com/javascript/api/azure-communication-services/@azure/communication-calling/call?view=azure-communication-services-js",target:"_blank",rel:"nofollow noopener noreferrer"},"Call")),Object(esm.b)("td",{parentName:"tr",align:null},"Low-level call object for calling client")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/statefulclient-overview--page"},"createStatefulCallClient")),Object(esm.b)("td",{parentName:"tr",align:null},"Method to translate low-level library client into a stateful client for the UI Library")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/statefulclient-reacthooks-setup--page"},"CallClientProvider")),Object(esm.b)("td",{parentName:"tr",align:null},"Provider allows access to the Stateful Call Client to the components inside of it")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/statefulclient-reacthooks-setup--page"},"CallAgentProvider")),Object(esm.b)("td",{parentName:"tr",align:null},"Provider allows access to the Stateful Call Agent to the components inside of it")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/statefulclient-reacthooks-setup--page"},"CallProvider")),Object(esm.b)("td",{parentName:"tr",align:null},"Provider allows access to the Stateful Call object to the components inside of it")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor")),Object(esm.b)("td",{parentName:"tr",align:null},"Hook to generate required props to enable UI Components")))),Object(esm.b)("h2",{id:"instantiate-stateful-call-client-call-agent-and-call"},"Instantiate Stateful Call Client, Call Agent and Call"),Object(esm.b)("p",null,"Update the ",Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")," file to create a ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulCallClient")," off the low-level ",Object(esm.b)("inlineCode",{parentName:"p"},"CallClient")," using the method ",Object(esm.b)("inlineCode",{parentName:"p"},"createStatefulCallClient"),".\nMake sure to populate the constants at the top of the App code with information from your Azure Communication Services Resource.\nThese properties will be used to instantiate the ",Object(esm.b)("inlineCode",{parentName:"p"},"CallClient"),", ",Object(esm.b)("inlineCode",{parentName:"p"},"CallAgent")," and ",Object(esm.b)("inlineCode",{parentName:"p"},"Call"),"."),Object(esm.b)("p",null,"As part of the constants that need to be populated is the ",Object(esm.b)("inlineCode",{parentName:"p"},"groupId")," which is a GUID generated by the developer."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { Call, CallAgent } from '@azure/communication-calling';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport { DEFAULT_COMPONENT_ICONS, createStatefulCallClient, StatefulCallClient } from '@azure/communication-react';\nimport { registerIcons } from '@fluentui/react';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nfunction App(): JSX.Element {\n  registerIcons({ icons: DEFAULT_COMPONENT_ICONS });\n\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = useMemo(() => {\n    return new AzureCommunicationTokenCredential(userAccessToken);\n  }, [userAccessToken]);\n  const groupId = '<Generated GUID groupd id>';\n  const displayName = '<Display Name>';\n\n  const [statefulCallClient, setStatefulCallClient] = useState<StatefulCallClient>();\n  const [callAgent, setCallAgent] = useState<CallAgent>();\n  const [call, setCall] = useState<Call>();\n\n  useEffect(() => {\n    setStatefulCallClient(\n      createStatefulCallClient({\n        userId: { communicationUserId: userId }\n      })\n    );\n  }, [userId]);\n\n  useEffect(() => {\n    if (callAgent === undefined && statefulCallClient) {\n      const createUserAgent = async (): Promise<void> => {\n        setCallAgent(await statefulCallClient.createCallAgent(tokenCredential, { displayName: displayName }));\n      };\n      createUserAgent();\n    }\n  }, [callAgent, statefulCallClient, tokenCredential, displayName]);\n\n  useEffect(() => {\n    if (callAgent !== undefined) {\n      setCall(callAgent.join({ groupId }));\n    }\n  }, [callAgent]);\n\n  return <>{statefulCallClient && callAgent && call && <h1>Hooray! You set up chat client </h1>}</>;\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"add-providers"},"Add Providers"),Object(esm.b)("p",null,"Next we will add four providers that will encapsulate our UI components."),Object(esm.b)("ol",null,Object(esm.b)("li",{parentName:"ol"},"The ",Object(esm.b)("inlineCode",{parentName:"li"},"FluentThemeProvider")," which provides visual theme to the underlying components."),Object(esm.b)("li",{parentName:"ol"},"The ",Object(esm.b)("inlineCode",{parentName:"li"},"CallClientProvider")," which provides state from the ",Object(esm.b)("inlineCode",{parentName:"li"},"statefulCallClient")," to the components.\nFor this provider, we will pass the ",Object(esm.b)("inlineCode",{parentName:"li"},"statefulCallClient")," as a prop to the provider."),Object(esm.b)("li",{parentName:"ol"},"The ",Object(esm.b)("inlineCode",{parentName:"li"},"CallAgentProvider")," which provides state from the ",Object(esm.b)("inlineCode",{parentName:"li"},"CallAgent")," to the components.\nFor this provider, we will pass the ",Object(esm.b)("inlineCode",{parentName:"li"},"CallAgent")," as a prop to the provider."),Object(esm.b)("li",{parentName:"ol"},"we will add the 'CallProvider' which provides the ",Object(esm.b)("inlineCode",{parentName:"li"},"Call")," objects state down to the components.\nFor this provider, we will pass the ",Object(esm.b)("inlineCode",{parentName:"li"},"Call")," as a prop to the provider.")),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { Call, CallAgent } from '@azure/communication-calling';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  FluentThemeProvider,\n  DEFAULT_COMPONENT_ICONS,\n  CallClientProvider,\n  CallAgentProvider,\n  CallProvider,\n  createStatefulCallClient,\n  StatefulCallClient\n} from '@azure/communication-react';\nimport { registerIcons } from '@fluentui/react';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nfunction App(): JSX.Element {\n  registerIcons({ icons: DEFAULT_COMPONENT_ICONS });\n\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = useMemo(() => {\n    return new AzureCommunicationTokenCredential(userAccessToken);\n  }, [userAccessToken]);\n  const groupId = '<Generated GUID groupd id>';\n  const displayName = '<Display Name>';\n\n  const [statefulCallClient, setStatefulCallClient] = useState<StatefulCallClient>();\n  const [callAgent, setCallAgent] = useState<CallAgent>();\n  const [call, setCall] = useState<Call>();\n\n  useEffect(() => {\n    setStatefulCallClient(\n      createStatefulCallClient({\n        userId: { communicationUserId: userId }\n      })\n    );\n  }, [userId]);\n\n  useEffect(() => {\n    if (callAgent === undefined && statefulCallClient) {\n      const createUserAgent = async (): Promise<void> => {\n        setCallAgent(await statefulCallClient.createCallAgent(tokenCredential, { displayName: displayName }));\n      };\n      createUserAgent();\n    }\n  }, [callAgent, statefulCallClient, tokenCredential, displayName]);\n\n  useEffect(() => {\n    if (callAgent !== undefined) {\n      setCall(callAgent.join({ groupId }));\n    }\n  }, [callAgent]);\n\n  return (\n    <>\n      <FluentThemeProvider>\n        {statefulCallClient && (\n          <CallClientProvider callClient={statefulCallClient}>\n            {callAgent && (\n              <CallAgentProvider callAgent={callAgent}>\n                {call && (\n                  <CallProvider call={call}>\n                    <h1>Hooray! You set up providers </h1>\n                  </CallProvider>\n                )}\n              </CallAgentProvider>\n            )}\n          </CallClientProvider>\n        )}\n      </FluentThemeProvider>\n    </>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"compose-call-components"},"Compose Call Components"),Object(esm.b)("p",null,"Now that we have our structure ready, we will now create our call experience using UI Components.\nFor Call, we will use the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/ui-components-videogallery--video-gallery"},"VideoGallery")," and ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/ui-components-controlbar--control-bar"},"ControlBar")," components.\nTo start add the code below to a new file ",Object(esm.b)("inlineCode",{parentName:"p"},"CallComponentsStateful.tsx"),".\nFor more information on getting started with UI Components follow the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/quickstarts-uicomponents--page"},"quickstart"),"\nHere we will use the ",Object(esm.b)("inlineCode",{parentName:"p"},"usePropsFor")," hook to connect our components to the stateful clients.\nThe ",Object(esm.b)("inlineCode",{parentName:"p"},"usePropsFor")," method takes in the component for which we want props generated, in this case ",Object(esm.b)("inlineCode",{parentName:"p"},"VideoGallery")," and ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar"),"."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"CallComponentsStateful.tsx")),Object(esm.b)(dist_esm.h,{code:"import {\n  usePropsFor,\n  VideoGallery,\n  ControlBar,\n  CameraButton,\n  MicrophoneButton,\n  ScreenShareButton,\n  EndCallButton\n} from '@azure/communication-react';\nimport { mergeStyles, Stack } from '@fluentui/react';\nimport React from 'react';\n\nfunction CallingComponents(): JSX.Element {\n  const videoGalleryProps = usePropsFor(VideoGallery);\n  const cameraProps = usePropsFor(CameraButton);\n  const microphoneProps = usePropsFor(MicrophoneButton);\n  const screenShareProps = usePropsFor(ScreenShareButton);\n  const endCallProps = usePropsFor(EndCallButton);\n\n  return (\n    <Stack className={mergeStyles({ height: '100%' })}>\n      <div style={{ width: '100vw', height: '100vh' }}>\n        {videoGalleryProps && <VideoGallery {...videoGalleryProps} />}\n      </div>\n\n      <ControlBar layout=\"floatingBottom\">\n        {cameraProps && <CameraButton {...cameraProps} />}\n        {microphoneProps && <MicrophoneButton {...microphoneProps} />}\n        {screenShareProps && <ScreenShareButton {...screenShareProps} />}\n        {endCallProps && <EndCallButton {...endCallProps} />}\n      </ControlBar>\n    </Stack>\n  );\n}\n\nexport default CallingComponents;\n",mdxType:"Source"}),Object(esm.b)("p",null,"Similarly to how we used ",Object(esm.b)("inlineCode",{parentName:"p"},"usePropsFor")," with chat UI Components, it can be used for calling UI Components.\nFor more information on ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor"),"."),Object(esm.b)("h2",{id:"add-components-to-app"},"Add Components to App"),Object(esm.b)("p",null,"Now that we have configured our providers and the call components we can put them together."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { Call, CallAgent } from '@azure/communication-calling';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  FluentThemeProvider,\n  DEFAULT_COMPONENT_ICONS,\n  CallClientProvider,\n  CallAgentProvider,\n  CallProvider,\n  createStatefulCallClient,\n  StatefulCallClient\n} from '@azure/communication-react';\nimport { registerIcons } from '@fluentui/react';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport CallingComponents from './CallComponentsStateful.snippet';\n\nfunction App(): JSX.Element {\n  registerIcons({ icons: DEFAULT_COMPONENT_ICONS });\n\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = useMemo(() => {\n    return new AzureCommunicationTokenCredential(userAccessToken);\n  }, [userAccessToken]);\n  const groupId = '<Generated GUID groupd id>';\n  const displayName = '<Display Name>';\n\n  const [statefulCallClient, setStatefulCallClient] = useState<StatefulCallClient>();\n  const [callAgent, setCallAgent] = useState<CallAgent>();\n  const [call, setCall] = useState<Call>();\n\n  useEffect(() => {\n    setStatefulCallClient(\n      createStatefulCallClient({\n        userId: { communicationUserId: userId }\n      })\n    );\n  }, [userId]);\n\n  useEffect(() => {\n    if (callAgent === undefined && statefulCallClient) {\n      const createUserAgent = async (): Promise<void> => {\n        setCallAgent(await statefulCallClient.createCallAgent(tokenCredential, { displayName: displayName }));\n      };\n      createUserAgent();\n    }\n  }, [callAgent, statefulCallClient, tokenCredential, displayName]);\n\n  useEffect(() => {\n    if (callAgent !== undefined) {\n      setCall(callAgent.join({ groupId }));\n    }\n  }, [callAgent]);\n\n  return (\n    <>\n      <FluentThemeProvider>\n        {statefulCallClient && (\n          <CallClientProvider callClient={statefulCallClient}>\n            {callAgent && (\n              <CallAgentProvider callAgent={callAgent}>\n                {call && (\n                  <CallProvider call={call}>\n                    <CallingComponents />\n                  </CallProvider>\n                )}\n              </CallAgentProvider>\n            )}\n          </CallClientProvider>\n        )}\n      </FluentThemeProvider>\n    </>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.b)("p",null,"At this point your app should have two UI Components hooked up to\nTo run the code above use the command:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-console"},"\nnpm run start\n\n")),Object(esm.b)("p",null,Object(esm.b)("img",{parentName:"p",src:"images/StatefulEnd.png",alt:"End state of stateful calling quickstart"})),Object(esm.b)("h2",{id:"troubleshooting"},"Troubleshooting"),Object(esm.b)("p",null,"See the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/troubleshooting--page"},"troubleshooting page")," for some common problems and recommended solutions."),Object(esm.b)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.b)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.b)("h2",{id:"next-steps"},"Next Steps"),Object(esm.b)("p",null,Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/quickstarts-composites--page"},"Try UI Library Composites")),Object(esm.b)("p",null,"For more information, see the following resources:"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/styling--page"},"UI Library Styling")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/theming--page"},"UI Library Theming"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/Get Started (Call)",id:"quickstarts-statefulcallclient",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1485:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var esm=__webpack_require__(0),dist_esm=__webpack_require__(4),Stack=__webpack_require__(69),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.f,{id:"quickstarts-statefulchatclient",title:"Stateful Client/Get Started (Chat)",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(esm.b)("h1",{id:"quickstart-get-started-with-chat-stateful-client"},"Quickstart: Get started with Chat Stateful Client"),Object(esm.b)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications.\nIn this quickstart, you'll learn how to integrate UI Library stateful clients into your application to build communication experiences.\nTo learn more about how to build applications with UI Library UI Components, see ",Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/quickstarts-uicomponents--page"},"Get started with UI Components"),"\nStateful clients make it easier for developers to build UI applications on top of Azure Communication Services by providing built-in state that UI components can use to render.\nFind more information about ",Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/statefulclient-overview--page"},"Stateful client here."),"."),Object(esm.b)("h2",{id:"download-the-code"},"Download the code"),Object(esm.b)("p",null,"You can find the completed code for this quickstart here: ",Object(esm.b)("a",{parentName:"p",href:"https://github.com/Azure-Samples/communication-services-javascript-quickstarts/tree/main/ui-library-starting-with-chat-stateful",target:"_blank",rel:"nofollow noopener noreferrer"},"Get started with Chat Stateful Client")),Object(esm.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.b)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 14.19.0 and above)."),Object(esm.b)("li",{parentName:"ul"},"An active Communication Services resource. ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create a Communication Services resource"),"."),Object(esm.b)("li",{parentName:"ul"},"An identity with Chat scope. Generate an identity using the ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/identity/quick-create-identity",target:"_blank",rel:"nofollow noopener noreferrer"},"Azure Portal"),".")),Object(esm.b)("p",null,Object(esm.b)("strong",{parentName:"p"},"Recommended:")),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"Knowledge of ",Object(esm.b)("a",{parentName:"li",href:"./?path=/story/quickstarts-uicomponents--page"},"UI Library Components"),". We will be using the UI Components in this quickstart."),Object(esm.b)("li",{parentName:"ul"},"Knowledge of Azure Communication Services ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts",target:"_blank",rel:"nofollow noopener noreferrer"},"Chat patterns"),".\nYou will need to create a thread and a user to that thread to use the UI Library. Look at the ",Object(esm.b)("a",{parentName:"li",href:"./?path=/docs/usecases--page#recommended-architecture"},"recommended architecture for the UI Library"))),Object(esm.b)("h2",{id:"generate-access-token"},"Generate Access Token"),Object(esm.b)("p",null,"For setting up adapters that power the composites, we need to generate an access token to allow the adapters to interact with the Azure Communication Services back-end."),Object(esm.b)("p",null,"Access Tokens can be generated using this ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/quickstarts/identity/quick-create-identity",target:"_blank",rel:"nofollow noopener noreferrer"},"Azure Portal quickstart")," inside your Azure Communication Services dashboard as shown below."),Object(esm.b)(Stack.a,{style:{width:"100%"},mdxType:"Stack"},Object(esm.b)("video",{style:{width:"100%"},src:"videos/generate-access-token.mp4",autoPlay:!0,loop:!0,muted:!0})),Object(esm.b)("br",null),Object(esm.b)("h2",{id:"setting-up"},"Setting Up"),Object(esm.b)("p",null,"UI Library requires a React environment to be setup as described below. If you already have a React App, you can skip this section."),Object(esm.b)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.b)("p",null,"We'll use the ",Object(esm.b)("inlineCode",{parentName:"p"},"create-react-app")," template for this quickstart. For more information, see: ",Object(esm.b)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-library-starting-with-chat-stateful --template typescript\n\ncd ui-library-starting-with-chat-stateful\n\n")),Object(esm.b)("p",null,"At the end of this process, you should have a full application inside the folder ",Object(esm.b)("inlineCode",{parentName:"p"},"ui-library-starting-with-chat-stateful"),".\nFor this quickstart, we'll be modifying files inside the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.b)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.b)("p",null,"Use the ",Object(esm.b)("inlineCode",{parentName:"p"},"npm install")," command to install the Azure Communication Services UI Library for JavaScript."),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-react\n\n")),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," specifies core Azure Communication Services as ",Object(esm.b)("inlineCode",{parentName:"p"},"peerDependencies")," so that\nyou can most consistently use the API from the core libraries in your application. You need to install those libraries as well:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-calling@1.3.2\nnpm install @azure/communication-chat@1.1.0\n\n")),Object(esm.b)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.b)("p",null,"Let's test the Create React App installation by running:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"object-model"},"Object Model"),Object(esm.b)("p",null,"The following classes and interfaces from the Azure Communication Services UI client library are referenced in this quickstart:"),Object(esm.b)("table",null,Object(esm.b)("thead",{parentName:"table"},Object(esm.b)("tr",{parentName:"thead"},Object(esm.b)("th",{parentName:"tr",align:null},"Name"),Object(esm.b)("th",{parentName:"tr",align:null},"Description"))),Object(esm.b)("tbody",{parentName:"table"},Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"https://azuresdkdocs.blob.core.windows.net/$web/javascript/azure-communication-chat/1.0.0/classes/chatclient.html",target:"_blank",rel:"nofollow noopener noreferrer"},"ChatClient")),Object(esm.b)("td",{parentName:"tr",align:null},"Low-level chat library client.")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/statefulclient-overview--page"},"createStatefulChatClient")),Object(esm.b)("td",{parentName:"tr",align:null},"Method to translate low-level library client into a stateful client for the UI Library")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/statefulclient-reacthooks-setup--page"},"ChatClientProvider")),Object(esm.b)("td",{parentName:"tr",align:null},"Provider allows access to the Stateful Chat Client to the components inside of it")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/statefulclient-reacthooks-setup--page"},"ChatThreadClientProvider")),Object(esm.b)("td",{parentName:"tr",align:null},"Provider allows access to the Stateful Chat Thread Client to the components inside of it")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor")),Object(esm.b)("td",{parentName:"tr",align:null},"Hook to generate required props to enable UI Components")))),Object(esm.b)("h2",{id:"instantiate-stateful-chat-client-and-chat-thread-client"},"Instantiate Stateful Chat Client and Chat Thread Client"),Object(esm.b)("p",null,"Update the ",Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")," file to create a ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient")," off the low-level ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatClient")," using the method ",Object(esm.b)("inlineCode",{parentName:"p"},"createStatefulChatClient"),".\nMake sure to populate the constants at the top of the App code with information from your Azure Communication Services Resource.\nThese properties will be used to instantiate the ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatClient")," and ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient"),". Review ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts",target:"_blank",rel:"nofollow noopener noreferrer"},"Chat patterns")," for questions on these properties."),Object(esm.b)("p",null,"Once the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient")," is instantiated, we will then generate the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatThreadClient")," off it to join the desired chat thread."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { ChatThreadClient } from '@azure/communication-chat';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport { createStatefulChatClient, DEFAULT_COMPONENT_ICONS } from '@azure/communication-react';\nimport { registerIcons } from '@fluentui/react';\nimport React from 'react';\n\nfunction App(): JSX.Element {\n  registerIcons({ icons: DEFAULT_COMPONENT_ICONS });\n\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n  const threadId = '<Get thread id from chat service>';\n  const displayName = '<Display Name>';\n\n  // Instantiate the statefulChatClient\n  const statefulChatClient = createStatefulChatClient({\n    userId: { communicationUserId: userId },\n    displayName: displayName,\n    endpoint: endpointUrl,\n    credential: tokenCredential\n  });\n\n  // Listen to notifications\n  statefulChatClient.startRealtimeNotifications();\n\n  const chatThreadClient = statefulChatClient.getChatThreadClient(threadId);\n  // Fetch thread properties, participants etc.\n  // Past messages are fetched as needed when the user scrolls to them.\n  initializeThreadState(chatThreadClient);\n\n  return <>{chatThreadClient && <h1>Hooray! You set up chat client </h1>};</>;\n}\n\nasync function initializeThreadState(chatThreadClient: ChatThreadClient): Promise<void> {\n  await chatThreadClient.getProperties();\n  for await (const _page of chatThreadClient.listParticipants().byPage()) {\n    // Simply fetching participants updates the cached state in client.\n  }\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"add-providers"},"Add Providers"),Object(esm.b)("p",null,"Next we will add three providers that will encapsulate our UI components.\nFirst, the ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," which provides visual theme to the underlying components.\nSecond, the ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatClientProvider")," which provides state from the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient")," to the components. For this provider, we will pass the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient")," as a prop to the provider.\nThird, the ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatThreadClientProvider")," which provides state from the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatThreadClient")," to the components. For this provider, we will pass the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatThreadClient")," as a prop to the provider."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { ChatThreadClient } from '@azure/communication-chat';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  createStatefulChatClient,\n  FluentThemeProvider,\n  ChatClientProvider,\n  ChatThreadClientProvider,\n  DEFAULT_COMPONENT_ICONS\n} from '@azure/communication-react';\nimport { registerIcons } from '@fluentui/react';\nimport React from 'react';\n\nfunction App(): JSX.Element {\n  registerIcons({ icons: DEFAULT_COMPONENT_ICONS });\n\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n  const threadId = '<Get thread id from chat service>';\n  const displayName = '<Display Name>';\n\n  // Instantiate the statefulChatClient\n  const statefulChatClient = createStatefulChatClient({\n    userId: { communicationUserId: userId },\n    displayName: displayName,\n    endpoint: endpointUrl,\n    credential: tokenCredential\n  });\n\n  // Listen to notifications\n  statefulChatClient.startRealtimeNotifications();\n\n  const chatThreadClient = statefulChatClient.getChatThreadClient(threadId);\n  // Fetch thread properties, participants etc.\n  // Past messages are fetched as needed when the user scrolls to them.\n  initializeThreadState(chatThreadClient);\n\n  return (\n    <FluentThemeProvider>\n      <ChatClientProvider chatClient={statefulChatClient}>\n        <ChatThreadClientProvider chatThreadClient={chatThreadClient}>\n          <h1>Hooray! You set up providers </h1>\n        </ChatThreadClientProvider>\n      </ChatClientProvider>\n    </FluentThemeProvider>\n  );\n}\n\nasync function initializeThreadState(chatThreadClient: ChatThreadClient): Promise<void> {\n  await chatThreadClient.getProperties();\n  for await (const _page of chatThreadClient.listParticipants().byPage()) {\n    // Simply fetching participants updates the cached state in client.\n  }\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("p",null,"Similarly to how we used chat providers for this example, you can use calling providers.\nFor more information on ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/statefulclient-reacthooks-setup--page"},"Calling Providers"),"."),Object(esm.b)("h2",{id:"compose-chat-components"},"Compose Chat Components"),Object(esm.b)("p",null,"Now that we have our structure ready, we will now create our chat experience using UI Components.\nFor Chat, we will use the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/ui-components-messagethread--message-thread"},"MessageThread")," and ",Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/ui-components-sendbox--send-box"},"SendBox")," components.\nTo start add the code below to a new file ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatComponentsStateful.tsx"),".\nFor more information on getting started with UI Components follow the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/quickstarts-uicomponents--page"},"quickstart"),"\nHere we will use the ",Object(esm.b)("inlineCode",{parentName:"p"},"usePropsFor")," hook to connect our components to the stateful clients.\nThe ",Object(esm.b)("inlineCode",{parentName:"p"},"usePropsFor")," method takes in the component for which we want props generated, in this case ",Object(esm.b)("inlineCode",{parentName:"p"},"MessageThread")," and ",Object(esm.b)("inlineCode",{parentName:"p"},"SendBox"),"."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"ChatComponentsStateful.tsx")),Object(esm.b)(dist_esm.h,{code:"import { usePropsFor, MessageThread, SendBox } from '@azure/communication-react';\nimport React from 'react';\n\nfunction ChatComponents(): JSX.Element {\n  const messageThreadProps = usePropsFor(MessageThread);\n  const sendBoxProps = usePropsFor(SendBox);\n\n  return (\n    <div style={{ height: '50rem', width: '50rem' }}>\n      {/*Props are updated asynchronously, so only render the component once props are populated.*/}\n      {messageThreadProps && <MessageThread {...messageThreadProps} />}\n      {sendBoxProps && <SendBox {...sendBoxProps} />}\n    </div>\n  );\n}\n\nexport default ChatComponents;\n",mdxType:"Source"}),Object(esm.b)("p",null,"Similarly to how we used ",Object(esm.b)("inlineCode",{parentName:"p"},"usePropsFor")," with chat UI Components, it can be used for calling UI Components.\nFor more information on ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor"),"."),Object(esm.b)("h2",{id:"add-components-to-app"},"Add Components to App"),Object(esm.b)("p",null,"Now that we have configured our providers and the chat components we can put them together."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { ChatThreadClient } from '@azure/communication-chat';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  createStatefulChatClient,\n  FluentThemeProvider,\n  ChatClientProvider,\n  ChatThreadClientProvider,\n  DEFAULT_COMPONENT_ICONS\n} from '@azure/communication-react';\nimport { registerIcons } from '@fluentui/react';\nimport React from 'react';\nimport ChatComponents from './ChatComponentsStateful';\n\nfunction App(): JSX.Element {\n  registerIcons({ icons: DEFAULT_COMPONENT_ICONS });\n\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n  const threadId = '<Get thread id from chat service>';\n  const displayName = '<Display Name>';\n\n  // Instantiate the statefulChatClient\n  const statefulChatClient = createStatefulChatClient({\n    userId: { communicationUserId: userId },\n    displayName: displayName,\n    endpoint: endpointUrl,\n    credential: tokenCredential\n  });\n\n  // Listen to notifications\n  statefulChatClient.startRealtimeNotifications();\n\n  const chatThreadClient = statefulChatClient.getChatThreadClient(threadId);\n  // Fetch thread properties, participants etc.\n  // Past messages are fetched as needed when the user scrolls to them.\n  initializeThreadState(chatThreadClient);\n\n  return (\n    <FluentThemeProvider>\n      <ChatClientProvider chatClient={statefulChatClient}>\n        <ChatThreadClientProvider chatThreadClient={chatThreadClient}>\n          <ChatComponents />\n        </ChatThreadClientProvider>\n      </ChatClientProvider>\n    </FluentThemeProvider>\n  );\n}\n\nasync function initializeThreadState(chatThreadClient: ChatThreadClient): Promise<void> {\n  await chatThreadClient.getProperties();\n  for await (const _page of chatThreadClient.listParticipants().byPage()) {\n    // Simply fetching participants updates the cached state in client.\n  }\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.b)("p",null,"At this point your app should have two UI Components hooked up to\nTo run the code above use the command:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-console"},"\nnpm run start\n\n")),Object(esm.b)("p",null,Object(esm.b)("img",{parentName:"p",src:"images/ChatEndState.png",alt:"End state of stateful chat quickstart"})),Object(esm.b)("h2",{id:"troubleshooting"},"Troubleshooting"),Object(esm.b)("p",null,"See the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/troubleshooting--page"},"troubleshooting page")," for some common problems and recommended solutions."),Object(esm.b)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.b)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.b)("h2",{id:"next-steps"},"Next Steps"),Object(esm.b)("p",null,Object(esm.b)("a",{parentName:"p",href:"./?path=/docs/quickstarts-composites--page"},"Try UI Library Composite Components")),Object(esm.b)("p",null,"For more information, see the following resources:"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/styling--page"},"UI Library Styling")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/theming--page"},"UI Library Theming"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/Get Started (Chat)",id:"quickstarts-statefulchatclient",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1486:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SendBox",(function(){return SendBox}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(47),__webpack_require__(7);var src=__webpack_require__(21),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),theming=__webpack_require__(77),Icon=__webpack_require__(884),jsx_runtime=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var CustomIcon_snippet_CustomIconExample=function CustomIconExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.G,{onSendMessage:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)}))),styles:{sendMessageIconContainer:{marginTop:"0.65rem"}},onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"AirplaneSolid"})}})})})};function CustomStyling_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomStyling_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomStyling_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomStyling_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}CustomIcon_snippet_CustomIconExample.displayName="CustomIconExample",CustomIcon_snippet_CustomIconExample.__docgenInfo={description:"",methods:[],displayName:"CustomIconExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/CustomIcon.snippet.tsx"]={name:"CustomIconExample",docgenInfo:CustomIcon_snippet_CustomIconExample.__docgenInfo,path:"stories/SendBox/snippets/CustomIcon.snippet.tsx"});var CustomStyling_snippet_CustomStylingExample=function CustomStylingExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.G,{onSendMessage:CustomStyling_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:CustomStyling_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)}))),styles:{root:{border:"2px solid gray",borderRadius:"10px",padding:"10px"},systemMessage:{border:"1px solid darkred",background:"lightpink"},textField:{background:"ghostwhite"}},systemMessage:"This is a system message"})})})};function SendBox_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SendBox_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SendBox_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SendBox_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}CustomStyling_snippet_CustomStylingExample.displayName="CustomStylingExample",CustomStyling_snippet_CustomStylingExample.__docgenInfo={description:"",methods:[],displayName:"CustomStylingExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/CustomStyling.snippet.tsx"]={name:"CustomStylingExample",docgenInfo:CustomStyling_snippet_CustomStylingExample.__docgenInfo,path:"stories/SendBox/snippets/CustomStyling.snippet.tsx"});var SendBox_snippet_SendBoxExample=function SendBoxExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.G,{onSendMessage:SendBox_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:SendBox_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)})))})})})};function SendBoxWithSystemMessage_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SendBoxWithSystemMessage_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SendBoxWithSystemMessage_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SendBoxWithSystemMessage_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}SendBox_snippet_SendBoxExample.displayName="SendBoxExample",SendBox_snippet_SendBoxExample.__docgenInfo={description:"",methods:[],displayName:"SendBoxExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/SendBox.snippet.tsx"]={name:"SendBoxExample",docgenInfo:SendBox_snippet_SendBoxExample.__docgenInfo,path:"stories/SendBox/snippets/SendBox.snippet.tsx"});var SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample=function SendBoxWithSystemMessageExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.G,{onSendMessage:SendBoxWithSystemMessage_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:SendBoxWithSystemMessage_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)}))),systemMessage:"Please wait 30 seconds to send new messages"})})})};function SendBox_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample.displayName="SendBoxWithSystemMessageExample",SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample.__docgenInfo={description:"",methods:[],displayName:"SendBoxWithSystemMessageExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/SendBoxWithSystemMessage.snippet.tsx"]={name:"SendBoxWithSystemMessageExample",docgenInfo:SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample.__docgenInfo,path:"stories/SendBox/snippets/SendBoxWithSystemMessage.snippet.tsx"});var CustomIconExampleText=__webpack_require__(1441).default,CustomStylingExampleText=__webpack_require__(1442).default,SendBoxExampleText=__webpack_require__(1443).default,SendBoxWithSystemMessageExampleText=__webpack_require__(1444).default,SendBox_stories_SendBoxStory=function SendBoxStory(args){return Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.G,{disabled:args.disabled,onSendMessage:function(){var _ref=function SendBox_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SendBox_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SendBox_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(message){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",alert("sent message: "+message+" "));case 1:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),onTyping:function onTyping(){return console.log("sending typing notifications"),Promise.resolve()},systemMessage:args.hasWarning?args.warningMessage:void 0})})};SendBox_stories_SendBoxStory.displayName="SendBoxStory";var SendBox=SendBox_stories_SendBoxStory.bind({});__webpack_exports__.default={id:constants.a+"-sendbox",title:constants.a+"/Send Box",component:src.G,argTypes:{disabled:controlsUtils.a.disabled,hasWarning:controlsUtils.a.isSendBoxWithWarning,warningMessage:controlsUtils.a.sendBoxWarningMessage,systemMessage:controlsUtils.j,onSendMessage:controlsUtils.j,onTyping:controlsUtils.j,onRenderSystemMessage:controlsUtils.j,supportNewline:controlsUtils.j,onRenderIcon:controlsUtils.j,styles:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"SendBox"}),Object(jsx_runtime.jsx)(esm.d,{children:"Component for typing and sending messages. SendBox has a callback for sending typing notification when user starts entering text. It also supports an optional message below the text input field."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"import { SendBox } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:SendBoxExampleText,children:Object(jsx_runtime.jsx)(SendBox_snippet_SendBoxExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Add a system message"}),Object(jsx_runtime.jsx)(esm.d,{children:"To add a system message, use the systemMessage property like in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:SendBoxWithSystemMessageExampleText,children:Object(jsx_runtime.jsx)(SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Customize send icon"}),Object(jsx_runtime.jsx)(esm.d,{children:"To customize the send icon, use the `onRenderIcon` property like in the example below. A Fluent UI [Icon](https://developer.microsoft.com/fluentui#/controls/web/icon) is used in this example but you can use any `JSX.Element`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomIconExampleText,children:Object(jsx_runtime.jsx)(CustomIcon_snippet_CustomIconExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Customize styling"}),Object(jsx_runtime.jsx)(esm.d,{children:"To customize the style of SendBox, use the `styles` property like in the example below. Notice that the keys of `styles` property are the root and sub-components of `SendBox`, each of which can be styled independently."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomStylingExampleText,children:Object(jsx_runtime.jsx)(CustomStyling_snippet_CustomStylingExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.G})]})}()}}}};SendBox.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return (\n    <div style={{ width: '31.25rem' }}>\n      <SendBoxComponent\n        disabled={args.disabled}\n        onSendMessage={async (message) => alert(`sent message: ${message} `)}\n        onTyping={(): Promise<void> => {\n          console.log(`sending typing notifications`);\n          return Promise.resolve();\n        }}\n        systemMessage={args.hasWarning ? args.warningMessage : undefined}\n      />\n    </div>\n  );\n}"}},SendBox.parameters)},1488:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Default",(function(){return Default}));__webpack_require__(7),__webpack_require__(47);var src=__webpack_require__(21),Airplane20Filled=__webpack_require__(1726),VehicleBus20Filled=__webpack_require__(1728),VehicleShip20Filled=__webpack_require__(1727),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(884),Text=__webpack_require__(499),Label=__webpack_require__(1742),jsx_runtime=__webpack_require__(2),Custom_snippet_CustomControlBarButtonExample=function CustomControlBarButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Airplane",style:{color:"green",fontSize:"25px"}},"customIcon1"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Bus",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"customIcon2")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Text.a,{style:{fontStyle:"italic"},children:"unmuted"},"customText"):Object(jsx_runtime.jsx)(Label.a,{children:"muted"},"customLabel")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.q,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"customBtn1"),Object(jsx_runtime.jsx)(src.q,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"customBtn2")]})};Custom_snippet_CustomControlBarButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomControlBarButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ControlBarButton/snippets/Custom.snippet.tsx"]={name:"CustomControlBarButtonExample",docgenInfo:Custom_snippet_CustomControlBarButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ControlBarButton/snippets/Custom.snippet.tsx"});var theming=__webpack_require__(77),Default_snippet_ControlBarButtonExample=function ControlBarButtonExample(){return Object(jsx_runtime.jsxs)(theming.b,{children:[Object(jsx_runtime.jsx)(src.q,{onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Airplane20Filled.a,{primaryFill:"currentColor"},"airplaneIconKey")}},"btn1"),Object(jsx_runtime.jsx)(src.q,{onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(VehicleShip20Filled.a,{primaryFill:"currentColor"},"shipIconKey")}},"btn1")]})};Default_snippet_ControlBarButtonExample.displayName="ControlBarButtonExample",Default_snippet_ControlBarButtonExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ControlBarButton/snippets/Default.snippet.tsx"]={name:"ControlBarButtonExample",docgenInfo:Default_snippet_ControlBarButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ControlBarButton/snippets/Default.snippet.tsx"});var WithLabel_snippet_ControlBarButtonWithLabelExample=function ControlBarButtonWithLabelExample(){return Object(jsx_runtime.jsxs)(theming.b,{children:[Object(jsx_runtime.jsx)(src.q,{onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Airplane20Filled.a,{primaryFill:"currentColor"},"airplaneIconKey")},strings:{label:"airplane"},labelKey:"airplaneButtonLabel",showLabel:!0},"btn1"),Object(jsx_runtime.jsx)(src.q,{onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(VehicleShip20Filled.a,{primaryFill:"currentColor"},"shipIconKey")},strings:{label:"ship"},labelKey:"shipButtonLabel",showLabel:!0},"btn1")]})};WithLabel_snippet_ControlBarButtonWithLabelExample.displayName="ControlBarButtonWithLabelExample",WithLabel_snippet_ControlBarButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ControlBarButton/snippets/WithLabel.snippet.tsx"]={name:"ControlBarButtonWithLabelExample",docgenInfo:WithLabel_snippet_ControlBarButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/ControlBarButton/snippets/WithLabel.snippet.tsx"});var CustomControlBarButtonExampleText=__webpack_require__(1384).default,ControlBarButtonExampleText=__webpack_require__(1385).default,ControlBarButtonWithLabelExampleText=__webpack_require__(1386).default,iconDict={airplane:Object(jsx_runtime.jsx)(Airplane20Filled.a,{primaryFill:"currentColor"},"airplaneIconKey"),bus:Object(jsx_runtime.jsx)(VehicleBus20Filled.a,{primaryFill:"currentColor"},"busIconKey"),ship:Object(jsx_runtime.jsx)(VehicleShip20Filled.a,{primaryFill:"currentColor"},"shipIconKey")},ControlBarButton_stories_ControlBarButtonStory=function ControlBarButtonStory(args){var icon=iconDict[args.icons];return Object(jsx_runtime.jsx)(src.q,Object.assign({},args,{onRenderIcon:function onRenderIcon(){return icon},strings:{label:args.icons},labelKey:args.icons}))};ControlBarButton_stories_ControlBarButtonStory.displayName="ControlBarButtonStory";var Default=ControlBarButton_stories_ControlBarButtonStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-base",title:constants.a+"/Control Bar/Buttons/Default",component:src.q,argTypes:{showLabel:controlsUtils.a.showLabel,icons:controlsUtils.a.controlBarDefaultIcons,labelKey:controlsUtils.j,strings:controlsUtils.j,onRenderOnIcon:controlsUtils.j,onRenderOffIcon:controlsUtils.j,tooltipId:controlsUtils.j,styles:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ControlBarButton"}),Object(jsx_runtime.jsx)(esm.d,{children:"Default button styled for use with the [Control Bar](./?path=/docs/ui-components-controlbar--control-bar)."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note that for accessibility purposes, this button can be focused on even when disabled. This behaviour can be changed by setting the button prop `allowDisabledFocus` to `false`."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { ControlBarButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.d,{children:"Here we see a `ControlBarButton` with some custom icons set:"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ControlBarButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_ControlBarButtonExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ControlBar with default label"}),Object(jsx_runtime.jsx)(esm.d,{children:"Here we see the same icons but with labels set to show:"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ControlBarButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_ControlBarButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom ControlBarButton Styles"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can override the styles of the `ControlBarButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, do not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomControlBarButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomControlBarButtonExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ControlBarButton Props"}),Object(jsx_runtime.jsx)(esm.d,{children:"`ControlBarButton` features all props a [FluentUI Button](https://developer.microsoft.com/fluentui#/controls/web/button) offers, with the additional following properties."}),Object(jsx_runtime.jsx)(esm.g,{of:src.q})]})}()}}}};Default.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const icon = iconDict[args.icons];\n\n  return <ControlBarButton {...args} onRenderIcon={() => icon} strings={{ label: args.icons }} labelKey={args.icons} />;\n}"}},Default.parameters)},1489:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Devices",(function(){return Devices}));__webpack_require__(7),__webpack_require__(47);var src=__webpack_require__(21),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(884),Label=__webpack_require__(1742),jsx_runtime=__webpack_require__(2),exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"Camera"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},Custom_snippet_DevicesButtonCustomExample=function DevicesButtonCustomExample(){return Object(jsx_runtime.jsx)(src.s,{showLabel:!0,menuProps:exampleOptionsMenuProps,onRenderIcon:function customOnRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"CircleAddition",style:{color:"orange",fontSize:"20px"}},"optionsCustomIconKey")},onRenderText:function customOnRenderText(){return Object(jsx_runtime.jsx)(Label.a,{style:{color:"darkviolet",fontStyle:"italic"},children:"More"},"optionsCustomLabelKey")}},"optionsCustomBtnKey")};Custom_snippet_DevicesButtonCustomExample.displayName="DevicesButtonCustomExample",Custom_snippet_DevicesButtonCustomExample.__docgenInfo={description:"",methods:[],displayName:"DevicesButtonCustomExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Devices/snippets/Custom.snippet.tsx"]={name:"DevicesButtonCustomExample",docgenInfo:Custom_snippet_DevicesButtonCustomExample.__docgenInfo,path:"stories/ControlBar/Buttons/Devices/snippets/Custom.snippet.tsx"});var theming=__webpack_require__(77),Default_snippet_exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},Default_snippet_DevicesButtonDefaultExample=function DevicesButtonDefaultExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.s,{menuProps:Default_snippet_exampleOptionsMenuProps})})};Default_snippet_DevicesButtonDefaultExample.displayName="DevicesButtonDefaultExample",Default_snippet_DevicesButtonDefaultExample.__docgenInfo={description:"",methods:[],displayName:"DevicesButtonDefaultExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Devices/snippets/Default.snippet.tsx"]={name:"DevicesButtonDefaultExample",docgenInfo:Default_snippet_DevicesButtonDefaultExample.__docgenInfo,path:"stories/ControlBar/Buttons/Devices/snippets/Default.snippet.tsx"});var DevicesButtonWithKnobs_snippet=__webpack_require__(481),WithLabel_snippet_exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},WithLabel_snippet_DevicesButtonWithLabelExample=function DevicesButtonWithLabelExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.s,{showLabel:!0,menuProps:WithLabel_snippet_exampleOptionsMenuProps})})};WithLabel_snippet_DevicesButtonWithLabelExample.displayName="DevicesButtonWithLabelExample",WithLabel_snippet_DevicesButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"DevicesButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Devices/snippets/WithLabel.snippet.tsx"]={name:"DevicesButtonWithLabelExample",docgenInfo:WithLabel_snippet_DevicesButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Devices/snippets/WithLabel.snippet.tsx"});var DevicesButtonCustomExampleText=__webpack_require__(1387).default,DevicesButtonDefaultExampleText=__webpack_require__(1388).default,DevicesButtonWithLabelExampleText=__webpack_require__(1389).default,Devices_stories_DevicesStory=function DevicesStory(args){return Object(jsx_runtime.jsx)(DevicesButtonWithKnobs_snippet.a,Object.assign({},args))};Devices_stories_DevicesStory.displayName="DevicesStory";var Devices=Devices_stories_DevicesStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-devices",title:constants.a+"/Control Bar/Buttons/Devices",component:src.s,argTypes:{showLabel:controlsUtils.a.showLabel,cameras:controlsUtils.a.cameras,microphones:controlsUtils.a.microphones,speakers:controlsUtils.a.speakers,selectedMicrophone:controlsUtils.j,selectedSpeaker:controlsUtils.j,selectedCamera:controlsUtils.j,onSelectCamera:controlsUtils.j,onSelectMicrophone:controlsUtils.j,onSelectSpeaker:controlsUtils.j,strings:controlsUtils.j,styles:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"DevicesButton"}),Object(jsx_runtime.jsx)(esm.d,{children:"A button to open a menu that allows for device selection. For use with the [Control Bar](./?path=/docs/ui-components-controlbar--control-bar)."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note that for accessibility purposes, this button can be focused on even when disabled. This behaviour can be changed by setting the button prop `allowDisabledFocus` to `false`."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { DevicesButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.d,{children:"The default `DevicesButton` component shows an horizontal `More` icon with no label as in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DevicesButtonDefaultExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_DevicesButtonDefaultExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"DevicesButton with default label"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can display the button label which, by default, will show below the icon as `Devices`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DevicesButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_DevicesButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom DevicesButton Styles"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can change the styles of the `DevicesButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, do not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DevicesButtonCustomExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_DevicesButtonCustomExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"DevicesButton Props"}),Object(jsx_runtime.jsx)(esm.d,{children:"`DevicesButton` features all props a [FluentUI Button](https://developer.microsoft.com/fluentui#/controls/web/button) offers, with the following additional properties."}),Object(jsx_runtime.jsx)(esm.g,{of:src.s})]})}()}}}};Devices.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <DevicesButtonWithKnobs {...args} />;\n}"}},Devices.parameters)},1490:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"EndCall",(function(){return EndCall}));__webpack_require__(7),__webpack_require__(47);var src=__webpack_require__(21),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(884),Label=__webpack_require__(1742),jsx_runtime=__webpack_require__(2),Custom_snippet_EndCallButtonCustomExample=function EndCallButtonCustomExample(){return Object(jsx_runtime.jsx)(src.t,{style:{background:"cyan"},showLabel:!0,onRenderIcon:function customOnRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"DeclineCall",style:{color:"black",fontSize:"25px"}},"endCallCustomIconKey")},onRenderText:function customOnRenderText(){return Object(jsx_runtime.jsx)(Label.a,{style:{color:"blue",fontStyle:"italic"},children:"end call"},"endCallCustomLabelKey")}},"endCallCustomBtnKey")};Custom_snippet_EndCallButtonCustomExample.displayName="EndCallButtonCustomExample",Custom_snippet_EndCallButtonCustomExample.__docgenInfo={description:"",methods:[],displayName:"EndCallButtonCustomExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/EndCall/snippets/Custom.snippet.tsx"]={name:"EndCallButtonCustomExample",docgenInfo:Custom_snippet_EndCallButtonCustomExample.__docgenInfo,path:"stories/ControlBar/Buttons/EndCall/snippets/Custom.snippet.tsx"});var theming=__webpack_require__(77),Default_snippet_EndCallButtonDefaultExample=function EndCallButtonDefaultExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.t,{})})};Default_snippet_EndCallButtonDefaultExample.displayName="EndCallButtonDefaultExample",Default_snippet_EndCallButtonDefaultExample.__docgenInfo={description:"",methods:[],displayName:"EndCallButtonDefaultExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/EndCall/snippets/Default.snippet.tsx"]={name:"EndCallButtonDefaultExample",docgenInfo:Default_snippet_EndCallButtonDefaultExample.__docgenInfo,path:"stories/ControlBar/Buttons/EndCall/snippets/Default.snippet.tsx"});var WithLabel_snippet_EndCallButtonWithLabelExample=function EndCallButtonWithLabelExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.t,{showLabel:!0})})};WithLabel_snippet_EndCallButtonWithLabelExample.displayName="EndCallButtonWithLabelExample",WithLabel_snippet_EndCallButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"EndCallButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/EndCall/snippets/WithLabel.snippet.tsx"]={name:"EndCallButtonWithLabelExample",docgenInfo:WithLabel_snippet_EndCallButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/EndCall/snippets/WithLabel.snippet.tsx"});var EndCallButtonCustomExampleText=__webpack_require__(1390).default,EndCallButtonDefaultExampleText=__webpack_require__(1391).default,EndCallButtonWithLabelExampleText=__webpack_require__(1392).default,EndCall_stories_EndCallStory=function EndCallStory(args){return Object(jsx_runtime.jsx)(src.t,Object.assign({},args))};EndCall_stories_EndCallStory.displayName="EndCallStory";var EndCall=EndCall_stories_EndCallStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-endcall",title:constants.a+"/Control Bar/Buttons/End Call",component:src.t,argTypes:{showLabel:controlsUtils.a.showLabel,onHangUp:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"EndCallButton"}),Object(jsx_runtime.jsx)(esm.d,{children:"A button to end an ongoing call. For use with the [Control Bar](./?path=/docs/ui-components-controlbar--control-bar)."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note that for accessibility purposes, this button can be focused on even when disabled. This behaviour can be changed by setting the button prop `allowDisabledFocus` to `false`."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { EndCallButton, FluentThemeProvider } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.d,{children:"The default `EndCallButton` component shows a hangup icon with no label as in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:EndCallButtonDefaultExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_EndCallButtonDefaultExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"EndCallButton with default label"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can display the button label which, by default, will show below the icon as `Hangup`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:EndCallButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_EndCallButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom EndCallButton Styles"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can change the styles of the `EndCallButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, do not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:EndCallButtonCustomExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_EndCallButtonCustomExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"EndCallButton Props"}),Object(jsx_runtime.jsx)(esm.d,{children:"`EndCallButton` features all props a [FluentUI Button](https://developer.microsoft.com/fluentui#/controls/web/button) offers, with the following additional properties."}),Object(jsx_runtime.jsx)(esm.g,{of:src.t})]})}()}}}};EndCall.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <EndCallButton {...args} />;\n}"}},EndCall.parameters)},1491:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ScreenShare",(function(){return ScreenShare}));__webpack_require__(7),__webpack_require__(47);var src=__webpack_require__(21),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(884),Label=__webpack_require__(1742),jsx_runtime=__webpack_require__(2),Custom_snippet_CustomScreenShareButtonExample=function CustomScreenShareButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Presentation",style:{color:"green",fontSize:"25px"}},"screenShareIconKey"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Presentation",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"screenShareIconKey")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Label.a,{style:{fontStyle:"italic"},children:"sharing screen"},"screenShareLabelKey"):Object(jsx_runtime.jsx)(Label.a,{children:"not sharing screen"},"screenShareLabelKey")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.F,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText}),Object(jsx_runtime.jsx)(src.F,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText})]})};Custom_snippet_CustomScreenShareButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomScreenShareButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ScreenShare/snippets/Custom.snippet.tsx"]={name:"CustomScreenShareButtonExample",docgenInfo:Custom_snippet_CustomScreenShareButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ScreenShare/snippets/Custom.snippet.tsx"});var theming=__webpack_require__(77),Default_snippet_ScreenShareButtonExample=function ScreenShareButtonExample(){return Object(jsx_runtime.jsxs)(theming.b,{children:[Object(jsx_runtime.jsx)(src.F,{checked:!0},"micBtn1"),Object(jsx_runtime.jsx)(src.F,{},"micBtn2")]})};Default_snippet_ScreenShareButtonExample.displayName="ScreenShareButtonExample",Default_snippet_ScreenShareButtonExample.__docgenInfo={description:"",methods:[],displayName:"ScreenShareButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ScreenShare/snippets/Default.snippet.tsx"]={name:"ScreenShareButtonExample",docgenInfo:Default_snippet_ScreenShareButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ScreenShare/snippets/Default.snippet.tsx"});var WithLabel_snippet_ScreenShareButtonWithLabelExample=function ScreenShareButtonWithLabelExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.F,{showLabel:!0,checked:!0})})};WithLabel_snippet_ScreenShareButtonWithLabelExample.displayName="ScreenShareButtonWithLabelExample",WithLabel_snippet_ScreenShareButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"ScreenShareButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ScreenShare/snippets/WithLabel.snippet.tsx"]={name:"ScreenShareButtonWithLabelExample",docgenInfo:WithLabel_snippet_ScreenShareButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/ScreenShare/snippets/WithLabel.snippet.tsx"});var CustomButtonExampleText=__webpack_require__(1404).default,DefaultButtonExampleText=__webpack_require__(1405).default,ButtonWithLabelExampleText=__webpack_require__(1406).default,ScreenShare_stories_ScreenShareStory=function ScreenShareStory(args){return Object(jsx_runtime.jsx)(src.F,Object.assign({},args))};ScreenShare_stories_ScreenShareStory.displayName="ScreenShareStory";var ScreenShare=ScreenShare_stories_ScreenShareStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-screenshare",title:constants.a+"/Control Bar/Buttons/Screen Share",component:src.F,argTypes:{checked:controlsUtils.a.checked,showLabel:controlsUtils.a.showLabel,onToggleScreenShare:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ScreenShareButton"}),Object(jsx_runtime.jsx)(esm.d,{children:"A button to toggle the user's screen sharing on and off. For use with the [Control Bar](./?path=/docs/ui-components-controlbar--control-bar)."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note that for accessibility purposes, this button can be focused on even when disabled. This behaviour can be changed by setting the button prop `allowDisabledFocus` to `false`."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { ScreenShareButton } from '@azure/communication-ui';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.d,{children:"The default `ScreenShareButton` component shows a ScreenShare icon with no label. The following example displays the `ScreenShareButton` with screen sharing enabled and disabled."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DefaultButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_ScreenShareButtonExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ScreenShare with default label"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can display the button label which, by default, will show below the icon as `Share` or `Stop`."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_ScreenShareButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom ScreenShareButton Styles"}),Object(jsx_runtime.jsx)(esm.d,{children:"You can change the styles of the `ScreenShareButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, do not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomScreenShareButtonExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"ScreenShareButton Props"}),Object(jsx_runtime.jsx)(esm.d,{children:"`ScreenShareButton` features all props a [FluentUI Button](https://developer.microsoft.com/fluentui#/controls/web/button) offers, with the following additional properties:"}),Object(jsx_runtime.jsx)(esm.g,{of:src.F})]})}()}}}};ScreenShare.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <ScreenShareButton {...args} />;\n}"}},ScreenShare.parameters)},1492:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ParticipantItem",(function(){return ParticipantItem}));__webpack_require__(74),__webpack_require__(34),__webpack_require__(62),__webpack_require__(113),__webpack_require__(56),__webpack_require__(256),__webpack_require__(47),__webpack_require__(7);var src=__webpack_require__(21),lib=__webpack_require__(22),Stack=__webpack_require__(69),ShareScreenStart20Filled=__webpack_require__(1677),MicOff16Regular=__webpack_require__(1694),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),Persona_types=__webpack_require__(27),jsx_runtime=__webpack_require__(2),CustomAvatar_snippet_CustomAvatarExample=function CustomAvatarExample(){var avatarStyle={borderRadius:20,display:"block"};return Object(jsx_runtime.jsx)(src.C,{displayName:"Annie Lindqvist",presence:Persona_types.b.online,onRenderAvatar:function onRenderAvatar(){return Object(jsx_runtime.jsx)("img",{src:"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png",width:"32px",height:"32px",style:avatarStyle})}})};CustomAvatar_snippet_CustomAvatarExample.displayName="CustomAvatarExample",CustomAvatar_snippet_CustomAvatarExample.__docgenInfo={description:"",methods:[],displayName:"CustomAvatarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantItem/snippets/CustomAvatar.snippet.tsx"]={name:"CustomAvatarExample",docgenInfo:CustomAvatar_snippet_CustomAvatarExample.__docgenInfo,path:"stories/ParticipantItem/snippets/CustomAvatar.snippet.tsx"});var Icon=__webpack_require__(884),CustomIcon_snippet_CustomIconExample=function CustomIconExample(){var onRenderIcon=function onRenderIcon(props){return"Patrick"===(null==props?void 0:props.displayName)?Object(jsx_runtime.jsx)(Icon.a,{iconName:"FavoriteStar",style:{cursor:"inherit"}}):null!=props&&props.me?null:Object(jsx_runtime.jsx)(Icon.a,{iconName:"AddFriend"})},containerStyle=Object(lib.H)({width:"15rem"});return Object(jsx_runtime.jsxs)(Stack.a,{className:containerStyle,children:[Object(jsx_runtime.jsx)(src.C,{displayName:"Spongebob",presence:Persona_types.b.online,me:!0,onRenderIcon:onRenderIcon}),Object(jsx_runtime.jsx)(src.C,{displayName:"Patrick",presence:Persona_types.b.online,onRenderIcon:onRenderIcon}),Object(jsx_runtime.jsx)(src.C,{displayName:"Sandy",presence:Persona_types.b.online,onRenderIcon:onRenderIcon})]})};CustomIcon_snippet_CustomIconExample.displayName="CustomIconExample",CustomIcon_snippet_CustomIconExample.__docgenInfo={description:"",methods:[],displayName:"CustomIconExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantItem/snippets/CustomIcon.snippet.tsx"]={name:"CustomIconExample",docgenInfo:CustomIcon_snippet_CustomIconExample.__docgenInfo,path:"stories/ParticipantItem/snippets/CustomIcon.snippet.tsx"});var ParticipantItem_snippet_ParticipantItemExample=function ParticipantItemExample(){var menuItems=[{key:"Mute",text:"Mute",onClick:function onClick(){return alert("Mute")}},{key:"Remove",text:"Remove",onClick:function onClick(){return alert("Remove")}}];return Object(jsx_runtime.jsx)(src.C,{displayName:"Johnny Bravo",menuItems:menuItems,presence:Persona_types.b.online})};ParticipantItem_snippet_ParticipantItemExample.displayName="ParticipantItemExample",ParticipantItem_snippet_ParticipantItemExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantItemExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantItem/snippets/ParticipantItem.snippet.tsx"]={name:"ParticipantItemExample",docgenInfo:ParticipantItem_snippet_ParticipantItemExample.__docgenInfo,path:"stories/ParticipantItem/snippets/ParticipantItem.snippet.tsx"});var CustomAvatarExampleText=__webpack_require__(1434).default,CustomIconExampleText=__webpack_require__(1435).default,ParticipantItemExampleText=__webpack_require__(1436).default,onlyUnique=function onlyUnique(value,index,self){return self.indexOf(value)===index},ParticipantItem_stories_ParticipantItemStory=function ParticipantItemStory(args){var menuItems=args.menuItemsStr.split(",").map((function(menuItem){return menuItem.trim()})).filter(onlyUnique).map((function(menuItem){return{key:menuItem,text:menuItem}})),iconStyles=Object(lib.H)({display:"flex",alignItems:"center"}),tokenProps={childrenGap:"0.5rem"};return Object(jsx_runtime.jsx)("div",{style:{width:"15rem"},children:Object(jsx_runtime.jsx)(src.C,{displayName:args.displayName,me:args.me,menuItems:menuItems,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:tokenProps,children:[args.isScreenSharing&&Object(jsx_runtime.jsx)(ShareScreenStart20Filled.a,{className:iconStyles,primaryFill:"currentColor"}),args.isMuted&&Object(jsx_runtime.jsx)(MicOff16Regular.a,{className:iconStyles,primaryFill:"currentColor"})]})}})})};ParticipantItem_stories_ParticipantItemStory.displayName="ParticipantItemStory";var ParticipantItem=ParticipantItem_stories_ParticipantItemStory.bind({});__webpack_exports__.default={id:constants.a+"-participantitem",title:constants.a+"/Participant Item",component:src.C,argTypes:{displayName:Object.assign({},controlsUtils.a.displayName,{defaultValue:"August Manning"}),isScreenSharing:Object.assign({},controlsUtils.a.isScreenSharing,{defaultValue:!0}),isMuted:Object.assign({},controlsUtils.a.isMuted,{defaultValue:!0}),me:controlsUtils.a.isMe,menuItemsStr:controlsUtils.a.participantItemMenuItemsStr,onRenderAvatar:controlsUtils.j,menuItems:controlsUtils.j,onRenderIcon:controlsUtils.j,presence:controlsUtils.j,styles:controlsUtils.j,strings:controlsUtils.j,userId:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ParticipantItem"}),Object(jsx_runtime.jsx)(esm.d,{children:"Component to render a calling or chat participant. This component can display the participant's avatar, displayName, online presence as well as optional icons and context menu."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { ParticipantItem, ParticipantItemProps } from '@azure/communication-react';\nimport { IContextualMenuItem, PersonaPresence } from '@fluentui/react';"}),Object(jsx_runtime.jsx)(esm.e,{children:"Usage"}),Object(jsx_runtime.jsx)(esm.d,{children:"Here is an example of how to use `ParticipantItem.` In this example, the `menuItems` property is used to add a context menu. The type of `menuItems` is an array of [IContextualMenuItem](https://developer.microsoft.com/fluentui#/controls/web/contextualmenu#IContextualMenuItem). Click on the rendered participant below to see the menu items."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ParticipantItemExampleText,children:Object(jsx_runtime.jsx)(ParticipantItem_snippet_ParticipantItemExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Custom avatar"}),Object(jsx_runtime.jsx)(esm.d,{children:"To customize the avatar, use the `onRenderAvatar` property like in the example below. We recommend the avatar element to be within 32 by 32 pixels."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomAvatarExampleText,children:Object(jsx_runtime.jsx)(CustomAvatar_snippet_CustomAvatarExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Add icon"}),Object(jsx_runtime.jsx)(esm.d,{children:"To add an icon, use the `onRenderIcon` property like in the example below."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomIconExampleText,children:Object(jsx_runtime.jsx)(CustomIcon_snippet_CustomIconExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.C})]})}()}}}};ParticipantItem.parameters=Object.assign({storySource:{source:"(args) => {\n  const menuItems = args.menuItemsStr\n    .split(',')\n    .map((menuItem) => menuItem.trim())\n    .filter(onlyUnique)\n    .map((menuItem) => {\n      return {\n        key: menuItem,\n        text: menuItem\n      };\n    });\n\n  const containerStyle = { width: '15rem' };\n  const iconStyles = mergeStyles({ display: 'flex', alignItems: 'center' });\n  const tokenProps = { childrenGap: '0.5rem' };\n\n  return (\n    <div style={containerStyle}>\n      <ParticipantItemComponent\n        displayName={args.displayName}\n        me={args.me}\n        menuItems={menuItems}\n        onRenderIcon={() => (\n          <Stack horizontal tokens={tokenProps}>\n            {args.isScreenSharing && <ShareScreenStart20Filled className={iconStyles} primaryFill=\"currentColor\" />}\n            {args.isMuted && <MicOff16Regular className={iconStyles} primaryFill=\"currentColor\" />}\n          </Stack>\n        )}\n      />\n    </div>\n  );\n}"}},ParticipantItem.parameters)},1493:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TypingIndicator",(function(){return TypingIndicator}));__webpack_require__(47),__webpack_require__(7);var src=__webpack_require__(21),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),jsx_runtime=__webpack_require__(2),CustomStyling_snippet_CustomStylingSnippet=function CustomStylingSnippet(){return Object(jsx_runtime.jsx)(src.I,{typingUsers:[{userId:"1",displayName:"User1"},{userId:"2",displayName:"User2"}],styles:{root:{border:"1px solid darkblue",width:"400px",padding:"5px"},typingUserDisplayName:{font:"15px Tahoma , sans-serif;"},typingString:{color:"slategrey"}}})};CustomStyling_snippet_CustomStylingSnippet.displayName="CustomStylingSnippet",CustomStyling_snippet_CustomStylingSnippet.__docgenInfo={description:"",methods:[],displayName:"CustomStylingSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/TypingIndicator/snippets/CustomStyling.snippet.tsx"]={name:"CustomStylingSnippet",docgenInfo:CustomStyling_snippet_CustomStylingSnippet.__docgenInfo,path:"stories/TypingIndicator/snippets/CustomStyling.snippet.tsx"});var CustomUserRender_snippet_CustomUserRenderSnippet=function CustomUserRenderSnippet(){var _imageMap,avatarStyle={borderRadius:20,display:"inline-block",width:"2rem",height:"2rem"},imageMap=((_imageMap={})[1]="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png",_imageMap[2]="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-male.png",_imageMap);return Object(jsx_runtime.jsx)(src.I,{typingUsers:[{userId:"1",displayName:"Annie Lindqvist"},{userId:"2",displayName:"Ted Randall"}],onRenderUser:function onRenderUser(user){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("img",{src:imageMap[user.userId],style:avatarStyle})," ",user.displayName]})}})};CustomUserRender_snippet_CustomUserRenderSnippet.displayName="CustomUserRenderSnippet",CustomUserRender_snippet_CustomUserRenderSnippet.__docgenInfo={description:"",methods:[],displayName:"CustomUserRenderSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/TypingIndicator/snippets/CustomUserRender.snippet.tsx"]={name:"CustomUserRenderSnippet",docgenInfo:CustomUserRender_snippet_CustomUserRenderSnippet.__docgenInfo,path:"stories/TypingIndicator/snippets/CustomUserRender.snippet.tsx"});var TypingIndicator_snippet_TypingIndicatorSnippet=function TypingIndicatorSnippet(){for(var oneTypingUsers=[{userId:"1",displayName:"User1"}],twentyUsers=[],idx=0;idx<20;idx++)twentyUsers.push({userId:""+idx,displayName:"User"+idx});return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.I,{typingUsers:oneTypingUsers}),Object(jsx_runtime.jsx)(src.I,{typingUsers:[{userId:"1",displayName:"User1"},{userId:"2",displayName:"User2"}]}),Object(jsx_runtime.jsx)(src.I,{typingUsers:twentyUsers}),Object(jsx_runtime.jsx)(src.I,{typingUsers:oneTypingUsers})]})};TypingIndicator_snippet_TypingIndicatorSnippet.__docgenInfo={description:"",methods:[],displayName:"TypingIndicatorSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/TypingIndicator/snippets/TypingIndicator.snippet.tsx"]={name:"TypingIndicatorSnippet",docgenInfo:TypingIndicator_snippet_TypingIndicatorSnippet.__docgenInfo,path:"stories/TypingIndicator/snippets/TypingIndicator.snippet.tsx"});var CustomStylingSnippetText=__webpack_require__(1450).default,CustomUserRenderSnippetText=__webpack_require__(1451).default,TypingIndicatorSnippetText=__webpack_require__(1452).default,TypingIndicator_stories_TypingIndicatorStory=function TypingIndicatorStory(args){return Object(jsx_runtime.jsx)(src.I,{typingUsers:args.typingUsers})};TypingIndicator_stories_TypingIndicatorStory.displayName="TypingIndicatorStory";var TypingIndicator=TypingIndicator_stories_TypingIndicatorStory.bind({});__webpack_exports__.default={id:constants.a+"-typingindicator",title:constants.a+"/Typing Indicator",component:src.I,argTypes:{typingUsers:controlsUtils.a.typingUsers,onRenderUser:controlsUtils.j,styles:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"TypingIndicator"}),Object(jsx_runtime.jsx)(esm.d,{children:"Component to notify the local user when one or more participants in the chat thread are typing."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"import { TypingIndicator } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:TypingIndicatorSnippetText,children:Object(jsx_runtime.jsx)(TypingIndicator_snippet_TypingIndicatorSnippet,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Customize style"}),Object(jsx_runtime.jsx)(esm.d,{children:"To customize the style of `TypingIndicator`, use the `styles` property like in the example below. Notice that the keys of `styles` property are the root and sub-components of `TypingIndicator`, each of which can be styled independently."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomStylingSnippetText,children:Object(jsx_runtime.jsx)(CustomStyling_snippet_CustomStylingSnippet,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Customize user rendering"}),Object(jsx_runtime.jsx)(esm.d,{children:"To customize user rendering of `TypingIndicator`, use the `onRenderUsers` property like in the example below. Note when this property is assigned you must apply style directly. The `styles` property will not apply."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:CustomUserRenderSnippetText,children:Object(jsx_runtime.jsx)(CustomUserRender_snippet_CustomUserRenderSnippet,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.I})]})}()}}}};TypingIndicator.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <TypingIndicatorComponent typingUsers={args.typingUsers} />;\n}"}},TypingIndicator.parameters)},1494:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var esm=__webpack_require__(0),dist_esm=__webpack_require__(4),Stack=__webpack_require__(69),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.f,{id:"quickstarts-composites",title:"Composites/Get Started",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(esm.b)("h1",{id:"quickstart-get-started-with-composites"},"Quickstart: Get started with Composites"),Object(esm.b)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications. In this quickstart, you'll learn how to integrate UI Library composites into your application to build communication experiences."),Object(esm.b)("p",null,"UI Library components come in two flavors: UI and Composite."),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("strong",{parentName:"li"},"UI components")," represent discrete communication capabilities; they're the basic building blocks that can be used to build complex communication experiences."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("strong",{parentName:"li"},"Composite components")," are turn-key experiences for common communication scenarios that have been built using ",Object(esm.b)("strong",{parentName:"li"},"base components")," as building blocks and packaged to be easily integrated into applications.")),Object(esm.b)("h2",{id:"download-the-code"},"Download the code"),Object(esm.b)("p",null,"You can find the completed code for this quickstart here: ",Object(esm.b)("a",{parentName:"p",href:"https://github.com/Azure-Samples/communication-services-javascript-quickstarts/tree/main/ui-library-quickstart-composites",target:"_blank",rel:"nofollow noopener noreferrer"},"Get started with Composites")),Object(esm.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.b)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 14.19.0 and above)."),Object(esm.b)("li",{parentName:"ul"},"An active Communication Services resource. ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create a Communication Services resource"),"."),Object(esm.b)("li",{parentName:"ul"},"An identity with both VoIP and Chat scopes. Generate an identity using the ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/identity/quick-create-identity",target:"_blank",rel:"nofollow noopener noreferrer"},"Azure Portal"),".")),Object(esm.b)("h2",{id:"generate-access-token"},"Generate Access Token"),Object(esm.b)("p",null,"For setting up adapters that power the composites, we need to generate an access token to allow the adapters to interact with the Azure Communication Services back-end."),Object(esm.b)("p",null,"Access Tokens can be generated using this ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/quickstarts/identity/quick-create-identity",target:"_blank",rel:"nofollow noopener noreferrer"},"Azure Portal quickstart")," inside your Azure Communication Services dashboard as shown below."),Object(esm.b)(Stack.a,{style:{width:"100%"},mdxType:"Stack"},Object(esm.b)("video",{style:{width:"100%"},src:"videos/generate-access-token.mp4",autoPlay:!0,loop:!0,muted:!0})),Object(esm.b)("br",null),Object(esm.b)("h2",{id:"setting-up"},"Setting Up"),Object(esm.b)("p",null,"UI Library requires a React environment to be setup. Next we will do that. If you already have a React App, you can skip this section."),Object(esm.b)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.b)("p",null,"We'll use the create-react-app template for this quickstart. For more information, see: ",Object(esm.b)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-library-quickstart-composites --template typescript\n\ncd ui-library-quickstart-composites\n\n")),Object(esm.b)("p",null,"At the end of this process, you should have a full application inside of the folder ",Object(esm.b)("inlineCode",{parentName:"p"},"ui-library-quickstart-composites"),".\nFor this quickstart, we'll be modifying files inside of the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.b)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.b)("p",null,"Use the ",Object(esm.b)("inlineCode",{parentName:"p"},"npm install")," command to install the Azure Communication Services UI Library for JavaScript."),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-react\n\n")),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," specifies core Azure Communication Services as ",Object(esm.b)("inlineCode",{parentName:"p"},"peerDependencies")," so that\nyou can most consistently use the API from the core libraries in your application. You need to install those libraries as well:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install @azure/communication-calling@1.3.2\nnpm install @azure/communication-chat@1.1.0\n\n")),Object(esm.b)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.b)("p",null,"Let's test the Create React App installation by running:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"object-model"},"Object Model"),Object(esm.b)("p",null,"The following classes and interfaces handle some of the major features of the Azure Communication Services UI client library:"),Object(esm.b)("table",null,Object(esm.b)("thead",{parentName:"table"},Object(esm.b)("tr",{parentName:"thead"},Object(esm.b)("th",{parentName:"tr",align:null},"Name"),Object(esm.b)("th",{parentName:"tr",align:null},"Description"))),Object(esm.b)("tbody",{parentName:"table"},Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/composites-call-basicexample--basic-example"},"CallComposite")),Object(esm.b)("td",{parentName:"tr",align:null},"Composite component that renders a calling experience with participant gallery and controls.")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"./?path=/story/composites-chat-basicexample--basic-example"},"ChatComposite")),Object(esm.b)("td",{parentName:"tr",align:null},"Composite component that renders a chat experience with chat thread and input")))),Object(esm.b)("h2",{id:"set-up-adapters"},"Set Up Adapters"),Object(esm.b)("p",null,"Before we initialize the actual composite components, we need to set up the adapters that will power them.\nThese adapters take care of the entire state of the composites truly making them a turn-key solution.\nTo setup the adapters, developers needs to pass information on the call or chat they want to join."),Object(esm.b)("p",null,"The adapters require access tokens, group IDs, or thread IDs to be setup.\nFor this quickstart, the access tokens required need to have both ",Object(esm.b)("inlineCode",{parentName:"p"},"chat")," and ",Object(esm.b)("inlineCode",{parentName:"p"},"VoIP")," scopes.\nFor more information on access tokens see: ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/identity-model#access-tokens",target:"_blank",rel:"nofollow noopener noreferrer"},"Identity Model"),"\nThese elements come from services that go through the proper steps to generate these IDs and pass them to the client application.\nFor more information, see: ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/client-and-server-architecture",target:"_blank",rel:"nofollow noopener noreferrer"},"Client Server Architecture"),".\nFor Example: The Group Chat composite expects that the ",Object(esm.b)("inlineCode",{parentName:"p"},"userId")," associated to the ",Object(esm.b)("inlineCode",{parentName:"p"},"token")," being used to initialize it has already been joined to the ",Object(esm.b)("inlineCode",{parentName:"p"},"threadId")," being provided.\nIf the token hasn't been joined to the thread ID, then the Group Chat composite will fail.\nFor more information on chat, see: ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/chat/get-started?pivots=programming-language-csharp",target:"_blank",rel:"nofollow noopener noreferrer"},"Getting Started with Chat")),Object(esm.b)("p",null,"Go to the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder inside of ",Object(esm.b)("inlineCode",{parentName:"p"},"ui-library-quickstart-composites")," and look for the file ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx"),"."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  CallAdapter,\n  createAzureCommunicationCallAdapter,\n  ChatAdapter,\n  createAzureCommunicationChatAdapter,\n  fromFlatCommunicationIdentifier\n} from '@azure/communication-react';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userId = '<Azure Communication Services Identifier>';\n  const displayName = '<Display Name>';\n  const token = '<Azure Communication Services Access Token>';\n\n  //Calling Variables\n  //For Group Id, developers can pass any GUID they can generate\n  const groupId = '<Developer generated GUID>';\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\n\n  //Chat Variables\n  const threadId = '<Get thread id from chat service>';\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\n\n  // We can't even initialize the Chat and Call adapters without a well-formed token.\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [token]);\n\n  useEffect(() => {\n    if (credential !== undefined) {\n      const createAdapter = async (credential: AzureCommunicationTokenCredential): Promise<void> => {\n        setChatAdapter(\n          await createAzureCommunicationChatAdapter({\n            endpoint: endpointUrl,\n            userId: fromFlatCommunicationIdentifier(userId) as CommunicationUserIdentifier,\n            displayName,\n            credential,\n            threadId\n          })\n        );\n        setCallAdapter(\n          await createAzureCommunicationCallAdapter({\n            userId: fromFlatCommunicationIdentifier(userId) as CommunicationUserIdentifier,\n            displayName,\n            credential,\n            locator: { groupId }\n          })\n        );\n      };\n      createAdapter(credential);\n    }\n  }, [credential]);\n\n  if (!!callAdapter && !!chatAdapter) {\n    return <h1>Hooray! You set up adapters </h1>;\n  }\n  if (credential === undefined) {\n    return <h3>Failed to construct credential. Provided token is malformed.</h3>;\n  }\n  return <h3>Initializing...</h3>;\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("p",null,"Next we will initialize the composite components with the adapters."),Object(esm.b)("h2",{id:"initialize-composites"},"Initialize Composites"),Object(esm.b)("p",null,"Go to the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder inside of ",Object(esm.b)("inlineCode",{parentName:"p"},"ui-library-quickstart-composites")," and look for the file ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx"),".\nHere we'll drop the following code to initialize our Composite Components for Chat and Calling using the adapters we set up above.\nYou can choose which one to use depending on the type of communication experience you're building.\nIf needed, you can use both at the same time."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.h,{code:"import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  CallComposite,\n  CallAdapter,\n  createAzureCommunicationCallAdapter,\n  ChatComposite,\n  ChatAdapter,\n  createAzureCommunicationChatAdapter,\n  fromFlatCommunicationIdentifier\n} from '@azure/communication-react';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userId = '<Azure Communication Services Identifier>';\n  const displayName = '<Display Name>';\n  const token = '<Azure Communication Services Access Token>';\n\n  //Calling Variables\n  //For Group Id, developers can pass any GUID they can generate\n  const groupId = '<Developer generated GUID>';\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\n\n  //Chat Variables\n  const threadId = '<Get thread id from chat service>';\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\n\n  // We can't even initialize the Chat and Call adapters without a well-formed token.\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [token]);\n\n  useEffect(() => {\n    const createAdapter = async (): Promise<void> => {\n      setChatAdapter(\n        await createAzureCommunicationChatAdapter({\n          endpoint: endpointUrl,\n          userId: fromFlatCommunicationIdentifier(userId) as CommunicationUserIdentifier,\n          displayName,\n          credential: new AzureCommunicationTokenCredential(token),\n          threadId\n        })\n      );\n      setCallAdapter(\n        await createAzureCommunicationCallAdapter({\n          userId: fromFlatCommunicationIdentifier(userId) as CommunicationUserIdentifier,\n          displayName,\n          credential: new AzureCommunicationTokenCredential(token),\n          locator: { groupId }\n        })\n      );\n    };\n    createAdapter();\n  }, []);\n\n  if (!!callAdapter && !!chatAdapter) {\n    return (\n      <div style={{ height: '100vh', display: 'flex' }}>\n        <div style={{ width: '50vw' }}>\n          <ChatComposite adapter={chatAdapter} />\n        </div>\n        <div style={{ width: '50vw' }}>\n          <CallComposite adapter={callAdapter} />\n        </div>\n      </div>\n    );\n  }\n  if (credential === undefined) {\n    return <h3>Failed to construct credential. Provided token is malformed.</h3>;\n  }\n  return <h3>Initializing...</h3>;\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.b)("p",null,"To run the code above use the command:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.b)("p",null,Object(esm.b)("img",{parentName:"p",src:"images/CompositeEnd.png",alt:"End state of composite quickstart"})),Object(esm.b)("h2",{id:"troubleshooting"},"Troubleshooting"),Object(esm.b)("p",null,"See the ",Object(esm.b)("a",{parentName:"p",href:"./?path=/story/troubleshooting--page"},"troubleshooting page")," for some common problems and recommended solutions."),Object(esm.b)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.b)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.b)("h2",{id:"next-steps"},"Next Steps"),Object(esm.b)("p",null,Object(esm.b)("a",{parentName:"p",href:"./?path=/story/quickstarts-uicomponents--page"},"Try UI Library UI Components")),Object(esm.b)("p",null,"For more information, see the following resources:"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/styling--page"},"UI Library Styling")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/theming--page"},"UI Library Theming")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"./?path=/story/localization--page#composites"},"UI Library Localization"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Composites/Get Started",id:"quickstarts-composites",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1495:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7),__webpack_require__(1);var esm=__webpack_require__(0),dist_esm=__webpack_require__(4),theming=__webpack_require__(77),src=__webpack_require__(21),jsx_runtime=__webpack_require__(2),styles={root:{background:"white",border:"2px solid firebrick","& button":{":hover":{background:"black",color:"white"}}}},StylingControlBar_snippet_ControlBarExample=function ControlBarExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsxs)(src.p,{styles:styles,children:[Object(jsx_runtime.jsx)(src.o,{}),Object(jsx_runtime.jsx)(src.B,{}),Object(jsx_runtime.jsx)(src.t,{})]})})};StylingControlBar_snippet_ControlBarExample.displayName="ControlBarExample",StylingControlBar_snippet_ControlBarExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Styling/snippets/StylingControlBar.snippet.tsx"]={name:"ControlBarExample",docgenInfo:StylingControlBar_snippet_ControlBarExample.__docgenInfo,path:"stories/Styling/snippets/StylingControlBar.snippet.tsx"});var StylingVideoTile_snippet=__webpack_require__(484),snippets_StylingVideoTile_snippet=__webpack_require__(592),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.f,{id:"styling",title:"Concepts/Styling",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},mdxType:"Meta"}),Object(esm.b)("h1",{id:"styling"},"Styling"),Object(esm.b)("p",null,"The ability to style components using custom CSS is an important feature of Azure Communication UI Library.\nAll the UI Components have complete CSS support and provide complex styling capabilities."),Object(esm.b)("h2",{id:"overview"},"Overview"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("p",{parentName:"li"},"UI Components expose a ",Object(esm.b)("inlineCode",{parentName:"p"},"prop")," named ",Object(esm.b)("inlineCode",{parentName:"p"},"styles")," that accepts an Object containing custom CSS for the component root as well as it's child components.")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("p",{parentName:"li"},"Users can always provide the ",Object(esm.b)("inlineCode",{parentName:"p"},"root")," property in ",Object(esm.b)("inlineCode",{parentName:"p"},"styles")," object and apply custom CSS to the component root.")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("p",{parentName:"li"},"Properties in ",Object(esm.b)("inlineCode",{parentName:"p"},"styles")," object will vary from component to component."))),Object(esm.b)("h2",{id:"example---controlbar"},"Example - ControlBar"),Object(esm.b)("p",null,"Let's style the ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar")," component and components inside it using the ",Object(esm.b)("inlineCode",{parentName:"p"},"root")," styles property."),Object(esm.b)(dist_esm.h,{code:"import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton\n} from '@azure/communication-react';\nimport React from 'react';\n\n// ControlBar component accepts a `styles` prop with only the `root` key as a valid property.\nconst styles = {\n  root: {\n    background: 'white',\n    border: '2px solid firebrick',\n    '& button': {\n      ':hover': {\n        background: 'black',\n        color: 'white'\n      }\n    }\n  }\n};\n\nexport const ControlBarExample = (): JSX.Element => {\n  return (\n    <FluentThemeProvider>\n      <ControlBar styles={styles}>\n        <CameraButton />\n        <MicrophoneButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CControlBarExample%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(StylingControlBar_snippet_ControlBarExample,{mdxType:"ControlBarExample"})),Object(esm.b)("h2",{id:"example---videotile"},"Example - VideoTile"),Object(esm.b)("p",null,"Let's style the ",Object(esm.b)("inlineCode",{parentName:"p"},"VideoTile")," component.\n",Object(esm.b)("inlineCode",{parentName:"p"},"VideoTile")," component allows you to style its ",Object(esm.b)("inlineCode",{parentName:"p"},"root")," element, the ",Object(esm.b)("inlineCode",{parentName:"p"},"Video Container")," and the ",Object(esm.b)("inlineCode",{parentName:"p"},"Overlay Container")," (Content rendered in front of the Video Container)."),Object(esm.b)(dist_esm.h,{code:snippets_StylingVideoTile_snippet.default,mdxType:"Source"}),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CVideoTileExample%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(StylingVideoTile_snippet.a,{mdxType:"VideoTileExample"})))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Concepts/Styling",id:"styling",parameters:{previewTabs:{canvas:{disable:!0,hidden:!0}}},includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1496:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"VideoTile",(function(){return VideoTile}));__webpack_require__(47),__webpack_require__(7);var src=__webpack_require__(21),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),StylingVideoTile_snippet=__webpack_require__(484),utils=__webpack_require__(178),theming=__webpack_require__(77),jsx_runtime=__webpack_require__(2),VideoTile_snippet_VideoTileExample=function VideoTileExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.K,{styles:{root:{height:"300px",width:"400px",border:"1px solid #999"}},displayName:"Maximus Aurelius",showMuteIndicator:!0,isMuted:!0,renderElement:null,isMirrored:!0})})};VideoTile_snippet_VideoTileExample.displayName="VideoTileExample",VideoTile_snippet_VideoTileExample.__docgenInfo={description:"",methods:[],displayName:"VideoTileExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoTile/snippets/VideoTile.snippet.tsx"]={name:"VideoTileExample",docgenInfo:VideoTile_snippet_VideoTileExample.__docgenInfo,path:"stories/VideoTile/snippets/VideoTile.snippet.tsx"});var Stack=__webpack_require__(69),VideoTilePlaceholder_snippet_onRenderPlaceholder=function onRenderPlaceholder(){return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif",style:{borderRadius:"150px",width:"150px",position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0}})})};VideoTilePlaceholder_snippet_onRenderPlaceholder.displayName="onRenderPlaceholder";var VideoTilePlaceholder_snippet_VideoTilePlaceholderExample=function VideoTilePlaceholderExample(){return Object(jsx_runtime.jsx)(theming.b,{children:Object(jsx_runtime.jsx)(src.K,{userId:"UserIdPlaceholder",styles:{root:{height:"300px",width:"400px",border:"1px solid #999"}},displayName:"Maximus Aurelius",renderElement:null,isMirrored:!0,onRenderPlaceholder:VideoTilePlaceholder_snippet_onRenderPlaceholder})})};VideoTilePlaceholder_snippet_VideoTilePlaceholderExample.displayName="VideoTilePlaceholderExample",VideoTilePlaceholder_snippet_VideoTilePlaceholderExample.__docgenInfo={description:"",methods:[],displayName:"VideoTilePlaceholderExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoTile/snippets/VideoTilePlaceholder.snippet.tsx"]={name:"VideoTilePlaceholderExample",docgenInfo:VideoTilePlaceholder_snippet_VideoTilePlaceholderExample.__docgenInfo,path:"stories/VideoTile/snippets/VideoTilePlaceholder.snippet.tsx"});var VideoTileStylineExampleText=__webpack_require__(592).default,VideoTileExampleText=__webpack_require__(1461).default,VideoTilePlaceholderText=__webpack_require__(1462).default,VideoTile_stories_VideoTileStory=function VideoTileStory(args){var videoTileStyles={root:{height:args.height+"px",width:args.width+"px"}},videoStreams=Object(utils.a)(1),videoStreamElement=args.isVideoReady?videoStreams[0]:null,videoStyles=args.isSpeaking?{root:{"& video":{borderRadius:"0rem"}}}:{};return Object(jsx_runtime.jsx)(src.K,{renderElement:args.isVideoReady?Object(jsx_runtime.jsx)(src.H,{styles:videoStyles,videoStreamElement:videoStreamElement}):void 0,displayName:args.displayName,showMuteIndicator:args.showMuteIndicator,isMirrored:args.isMirrored,isMuted:args.isMuted,isSpeaking:args.isSpeaking,styles:videoTileStyles})};VideoTile_stories_VideoTileStory.displayName="VideoTileStory";var VideoTile=VideoTile_stories_VideoTileStory.bind({});__webpack_exports__.default={id:constants.a+"-videotile",title:constants.a+"/Video Tile",component:src.K,argTypes:{displayName:controlsUtils.a.displayName,showMuteIndicator:controlsUtils.a.showMuteIndicator,isVideoReady:controlsUtils.a.isVideoReady,isMirrored:controlsUtils.a.isVideoMirrored,isMuted:controlsUtils.a.isMuted,isSpeaking:controlsUtils.a.isSpeaking,width:controlsUtils.a.videoTileWidth,height:controlsUtils.a.videoTileHeight,userId:controlsUtils.j,noVideoAvailableAriaLabel:controlsUtils.j,children:controlsUtils.j,styles:controlsUtils.j,renderElement:controlsUtils.j,onRenderPlaceholder:controlsUtils.j,showLabel:controlsUtils.j,initialsName:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"VideoTile"}),Object(jsx_runtime.jsx)(esm.d,{children:"The VideoTile component displays a static component or the available video stream of a participant."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"import { VideoTile } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.i,{children:"Default Usage"}),Object(jsx_runtime.jsx)(esm.d,{children:"The default VideoTile component shows a displayName and a Persona with the initials of `displayName` when no video is available."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:VideoTileExampleText,children:Object(jsx_runtime.jsx)(VideoTile_snippet_VideoTileExample,{})}),Object(jsx_runtime.jsx)(esm.i,{children:"Custom Placeholder"}),Object(jsx_runtime.jsx)(esm.d,{children:"A custom placeholder can be provided to override the default Persona avatar by providing a JSX element to the `placeholder` prop."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:VideoTilePlaceholderText,children:Object(jsx_runtime.jsx)(VideoTilePlaceholder_snippet_VideoTilePlaceholderExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Styling"}),Object(jsx_runtime.jsx)(esm.d,{children:"A VideoTile component can be styled just like other components using the `styles` property."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:VideoTileStylineExampleText,children:Object(jsx_runtime.jsx)(StylingVideoTile_snippet.a,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.K})]})}()}}}};VideoTile.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const videoTileStyles = {\n    root: {\n      height: `${args.height}px`,\n      width: `${args.width}px`\n    }\n  };\n\n  const videoStreams = useVideoStreams(1);\n  const videoStreamElement = args.isVideoReady ? videoStreams[0] : null;\n  const videoStyles = args.isSpeaking ? { root: { '& video': { borderRadius: '0rem' } } } : {};\n\n  return (\n    <VideoTileComponent\n      renderElement={\n        args.isVideoReady ? <StreamMedia styles={videoStyles} videoStreamElement={videoStreamElement} /> : undefined\n      }\n      displayName={args.displayName}\n      showMuteIndicator={args.showMuteIndicator}\n      isMirrored={args.isMirrored}\n      isMuted={args.isMuted}\n      isSpeaking={args.isSpeaking}\n      styles={videoTileStyles}\n    />\n  );\n}"}},VideoTile.parameters)},1498:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CustomDataModelExample",(function(){return CustomDataModelExample}));__webpack_require__(7),__webpack_require__(47);var src=__webpack_require__(80),Stack=__webpack_require__(69),react=__webpack_require__(1),v1=__webpack_require__(897),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),localizationUtils=__webpack_require__(116),CallCompositeDocs=__webpack_require__(245),communicationTokenCredential=(__webpack_require__(39),__webpack_require__(12),__webpack_require__(45),__webpack_require__(195),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28),__webpack_require__(253)),jsx_runtime=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer=function CustomDataModelExampleContainer(props){var _useState2=_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];Object(react.useEffect)((function(){if(props.token&&props.locator){var callLocator=isTeamsMeetingLink(props.locator)?{meetingLink:props.locator}:{groupId:props.locator};(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(src.createAzureCommunicationCallAdapter)({userId:props.userId,displayName:props.displayName,credential:new communicationTokenCredential.a(props.token),locator:callLocator});case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(){return _ref.apply(this,arguments)}})()()}}),[props]),Object(react.useEffect)((function(){return function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(adapter){_context2.next=2;break}return _context2.abrupt("return");case 2:return _context2.next=4,adapter.leaveCall().catch((function(e){console.error("Failed to leave call",e)}));case 4:adapter.dispose();case 5:case"end":return _context2.stop()}}),_callee2)})))()}}),[adapter]);var onFetchAvatarPersonaData=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",{text:props.avatarInitials?props.avatarInitials:props.displayName});case 1:case"end":return _context3.stop()}}),_callee3)})));return function onFetchAvatarPersonaData(){return _ref3.apply(this,arguments)}}();return Object(jsx_runtime.jsx)("div",{style:{height:"100vh",width:"100vw"},children:adapter&&Object(jsx_runtime.jsx)(src.CallComposite,{fluentTheme:props.fluentTheme,adapter:adapter,onFetchAvatarPersonaData:onFetchAvatarPersonaData,onFetchParticipantMenuItems:function onFetchParticipantMenuItems(participantId,userId,defaultMenuItems){var customMenuItems=[{key:"Custom Menu Item",text:"Custom Menu Item",onClick:function onClick(){return console.log("Custom Menu Item Clicked")}}];return defaultMenuItems&&(customMenuItems=customMenuItems.concat(defaultMenuItems)),customMenuItems},callInvitationUrl:null==props?void 0:props.callInvitationURL,locale:null==props?void 0:props.locale,formFactor:null==props?void 0:props.formFactor,options:null==props?void 0:props.options})})};CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.displayName="CustomDataModelExampleContainer";var isTeamsMeetingLink=function isTeamsMeetingLink(link){return link.startsWith("https://teams.microsoft.com/l/meetup-join")};CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo={description:"",methods:[],displayName:"CustomDataModelExampleContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},locator:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},avatarInitials:{required:!0,tsType:{name:"string"},description:""},callInvitationURL:{required:!1,tsType:{name:"string"},description:""},formFactor:{required:!1,tsType:{name:"union",raw:"'desktop' | 'mobile'",elements:[{name:"literal",value:"'desktop'"},{name:"literal",value:"'mobile'"}]},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},locale:{required:!1,tsType:{name:"CompositeLocale"},description:""},options:{required:!1,tsType:{name:"CallCompositeOptions"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"]={name:"CustomDataModelExampleContainer",docgenInfo:CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo,path:"stories/CallComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"});var Utils=__webpack_require__(246),CustomDataModelExample_stories_CustomDataModelStory=function CustomDataModelStory(args,context){var locale=context.globals.locale,containerProps=Object(react.useMemo)((function(){if(args.userId&&args.token)return{userId:args.userId,token:args.token,locator:Object(v1.a)()}}),[args.token,args.userId]);return Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:constants.h,children:containerProps?Object(jsx_runtime.jsx)(CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer,Object.assign({fluentTheme:context.theme,displayName:args.displayName,avatarInitials:args.avatarInitials},containerProps,{callInvitationURL:args.callInvitationURL,locale:Object(localizationUtils.a)(locale),formFactor:args.formFactor})):Object(jsx_runtime.jsx)(Utils.a,{})})};CustomDataModelExample_stories_CustomDataModelStory.displayName="CustomDataModelStory";var CustomDataModelExample=CustomDataModelExample_stories_CustomDataModelStory.bind({});__webpack_exports__.default={id:constants.b+"-call-customdatamodelexample",title:constants.b+"/CallComposite/Custom Data Model Example",component:src.CallComposite,argTypes:Object.assign({userId:controlsUtils.a.userId,token:controlsUtils.a.token,displayName:controlsUtils.a.displayName,avatarInitials:controlsUtils.a.avatarInitials,formFactor:controlsUtils.a.formFactor,callInvitationURL:controlsUtils.a.callInvitationURL},controlsUtils.b),parameters:{docs:{page:function page(){return Object(CallCompositeDocs.a)()}}}};CustomDataModelExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const {\n    globals: { locale }\n  } = context;\n\n  const containerProps = useMemo(() => {\n    if (args.userId && args.token) {\n      const containerProps = {\n        userId: args.userId,\n        token: args.token,\n        locator: createGUID()\n      };\n      return containerProps;\n    }\n    return undefined;\n  }, [args.token, args.userId]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <CustomDataModelExampleContainer\n          fluentTheme={context.theme}\n          displayName={args.displayName}\n          avatarInitials={args.avatarInitials}\n          {...containerProps}\n          callInvitationURL={args.callInvitationURL}\n          locale={compositeLocale(locale)}\n          formFactor={args.formFactor}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},CustomDataModelExample.parameters)},1499:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BasicExample",(function(){return BasicExample}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(7),__webpack_require__(47),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var src=__webpack_require__(80),Stack=__webpack_require__(69),react=__webpack_require__(1),SingleLineBetaBanner=__webpack_require__(201),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),CallWithChatCompositeDocs=__webpack_require__(477),CallWithChat_snippet=__webpack_require__(479),src_chatClient=__webpack_require__(615),communicationTokenCredential=__webpack_require__(253),v1=__webpack_require__(897);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var createNewChatThread=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(chatClient,participants){var chatThreadResponse,chatThread;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,chatClient.createChatThread({topic:"Meeting with a friendly bot"},{participants:participants});case 2:if(!((chatThreadResponse=_context.sent).invalidParticipants&&chatThreadResponse.invalidParticipants.length>0)){_context.next=5;break}throw"Server could not add participants to the chat thread";case 5:if((chatThread=chatThreadResponse.chatThread)&&chatThread.id){_context.next=8;break}throw"Server could not create chat thread";case 8:return _context.abrupt("return",chatThread.id);case 9:case"end":return _context.stop()}}),_callee)})));return function createNewChatThread(_x,_x2){return _ref.apply(this,arguments)}}(),createCallWithChat=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(token,userId,endpointUrl,displayName){var locator,chatClient,threadId;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return locator={groupId:Object(v1.a)()},chatClient=new src_chatClient.a(endpointUrl,new communicationTokenCredential.a(token)),_context2.next=4,createNewChatThread(chatClient,[{id:{communicationUserId:userId},displayName:displayName}]);case 4:return threadId=_context2.sent,_context2.abrupt("return",{callLocator:locator,chatThreadId:threadId});case 6:case"end":return _context2.stop()}}),_callee2)})));return function createCallWithChat(_x3,_x4,_x5,_x6){return _ref2.apply(this,arguments)}}(),Utils=__webpack_require__(480),jsx_runtime=__webpack_require__(2);function BasicExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var BasicExample=function BasicStory(args,context){var _useState2=_slicedToArray(Object(react.useState)(),2),callWithChatProps=_useState2[0],setCallWithChatProps=_useState2[1];return Object(react.useEffect)((function(){(function(){var _ref=function BasicExample_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){BasicExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){BasicExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var _yield$createCallWith,callLocator,chatThreadId;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(args.token&&args.userId&&args.endpointUrl&&args.displayName)){_context.next=9;break}return _context.next=3,createCallWithChat(args.token,args.userId,args.endpointUrl,args.displayName);case 3:_yield$createCallWith=_context.sent,callLocator=_yield$createCallWith.callLocator,chatThreadId=_yield$createCallWith.chatThreadId,setCallWithChatProps({userId:{communicationUserId:args.userId},token:args.token,displayName:args.displayName,endpointUrl:args.endpointUrl,locator:{callLocator:callLocator,chatThreadId:chatThreadId},callWithChatControlOptions:args.callWithChatControlOptions}),_context.next=10;break;case 9:setCallWithChatProps(void 0);case 10:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.token,args.userId,args.endpointUrl,args.displayName,args.callWithChatControlOptions]),Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(SingleLineBetaBanner.a,{}),Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:constants.h,children:callWithChatProps?Object(jsx_runtime.jsx)(CallWithChat_snippet.a,Object.assign({fluentTheme:context.theme},callWithChatProps)):Object(jsx_runtime.jsx)(Utils.a,{})})]})}.bind({});__webpack_exports__.default={id:constants.b+"-call-with-chat-basicexample",title:constants.b+"/CallWithChatComposite/Basic Example",component:src.CallWithChatComposite,argTypes:Object.assign({token:controlsUtils.a.token,userId:controlsUtils.a.userId,endpointUrl:controlsUtils.a.endpointUrl,displayName:controlsUtils.a.displayName,callWithChatControlOptions:controlsUtils.a.callWithChatControlOptions},controlsUtils.c),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(CallWithChatCompositeDocs.a)()}}}};BasicExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const [callWithChatProps, setCallWithChatProps] = useState<CallWithChatExampleProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.token && args.userId && args.endpointUrl && args.displayName) {\n        const { callLocator, chatThreadId } = await createCallWithChat(\n          args.token,\n          args.userId,\n          args.endpointUrl,\n          args.displayName\n        );\n        setCallWithChatProps({\n          userId: { communicationUserId: args.userId },\n          token: args.token,\n          displayName: args.displayName,\n          endpointUrl: args.endpointUrl,\n          locator: {\n            callLocator,\n            chatThreadId\n          },\n          callWithChatControlOptions: args.callWithChatControlOptions\n        });\n      } else {\n        setCallWithChatProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.token, args.userId, args.endpointUrl, args.displayName, args.callWithChatControlOptions]);\n\n  return (\n    <>\n      <FloatingSingleLineBetaBanner />\n      <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n        {callWithChatProps ? (\n          <CallWithChatExperience fluentTheme={context.theme} {...callWithChatProps} />\n        ) : (\n          <ConfigHintBanner />\n        )}\n      </Stack>\n    </>\n  );\n}'}},BasicExample.parameters)},1500:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CustomBehaviorExample",(function(){return CustomBehaviorExample}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(7),__webpack_require__(47),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var src=__webpack_require__(80),Stack=__webpack_require__(69),react=__webpack_require__(1),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),localizationUtils=__webpack_require__(116),ChatCompositeDocs=__webpack_require__(202),communicationTokenCredential=__webpack_require__(253),jsx_runtime=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CustomBehaviorExampleContainer_ContosoChatContainer=function ContosoChatContainer(props){var _useState2=_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];return Object(react.useEffect)((function(){props&&function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var newAdapter,superSendMessage;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(src.createAzureCommunicationChatAdapter)({endpoint:props.endpointUrl,userId:props.userId,displayName:props.displayName,credential:new communicationTokenCredential.a(props.token),threadId:props.threadId});case 2:newAdapter=_context2.sent,superSendMessage=newAdapter.sendMessage.bind(newAdapter),newAdapter.sendMessage=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(content){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,superSendMessage(content.toUpperCase());case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),setAdapter(newAdapter);case 6:case"end":return _context2.stop()}}),_callee2)})));return function createAdapter(){return _ref.apply(this,arguments)}}()()}),[props]),Object(jsx_runtime.jsx)("div",{style:{height:"100vh",width:"100vw"},children:adapter?Object(jsx_runtime.jsx)(src.ChatComposite,{fluentTheme:props.fluentTheme,locale:props.locale,adapter:adapter,options:{participantPane:!0}}):Object(jsx_runtime.jsx)("h3",{children:"Loading..."})})};CustomBehaviorExampleContainer_ContosoChatContainer.displayName="ContosoChatContainer",CustomBehaviorExampleContainer_ContosoChatContainer.__docgenInfo={description:"",methods:[],displayName:"ContosoChatContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},threadId:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},locale:{required:!1,tsType:{name:"CompositeLocale"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/CustomBehaviorExampleContainer.tsx"]={name:"ContosoChatContainer",docgenInfo:CustomBehaviorExampleContainer_ContosoChatContainer.__docgenInfo,path:"stories/ChatComposite/CustomBehaviorExampleContainer.tsx"});var Utils=__webpack_require__(121);function CustomBehavior_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomBehavior_stories_slicedToArray(arr,i){return function CustomBehavior_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomBehavior_stories_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomBehavior_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomBehavior_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomBehavior_stories_arrayLikeToArray(o,minLen)}(arr,i)||function CustomBehavior_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomBehavior_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var messageArray=["Welcome to an example on how to add powerful customizations to the ChatComposite","In this example, Contoso intercepts the messages being sent by the local user and CAPITALIZES THEM ALL.","The adapter pattern allows for very powerful customizations, should you need them.","Have fun!"],CustomBehavior_stories_CustomBehaviorStory=function CustomBehaviorStory(args,context){var locale=context.globals.locale,_useState2=CustomBehavior_stories_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];return Object(react.useEffect)((function(){(function(){var _ref=function CustomBehavior_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomBehavior_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomBehavior_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(args.token&&args.userId&&args.botId&&args.botToken&&args.endpointUrl&&args.displayName)){_context.next=9;break}return _context.next=3,Object(Utils.d)(args.userId,args.token,args.endpointUrl,args.displayName);case 3:return newProps=_context.sent,_context.next=6,Object(Utils.c)(args.token,args.botId,args.botToken,args.endpointUrl,newProps.threadId,messageArray);case 6:setContainerProps(newProps),_context.next=10;break;case 9:setContainerProps(void 0);case 10:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.userId,args.token,args.botId,args.botToken,args.endpointUrl,args.displayName]),Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:constants.h,children:containerProps?Object(jsx_runtime.jsx)(CustomBehaviorExampleContainer_ContosoChatContainer,Object.assign({fluentTheme:context.theme,locale:Object(localizationUtils.a)(locale)},containerProps)):Object(jsx_runtime.jsx)(Utils.a,{})})};CustomBehavior_stories_CustomBehaviorStory.displayName="CustomBehaviorStory";var CustomBehaviorExample=CustomBehavior_stories_CustomBehaviorStory.bind({});__webpack_exports__.default={id:constants.b+"-chat-custombehaviorexample",title:constants.b+"/ChatComposite/Custom Behavior Example",component:src.ChatComposite,argTypes:Object.assign({userId:controlsUtils.a.userId,token:controlsUtils.a.token,botId:controlsUtils.a.botUserId,botToken:controlsUtils.a.botToken,endpointUrl:controlsUtils.a.endpointUrl,displayName:controlsUtils.a.displayName},controlsUtils.d),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(ChatCompositeDocs.a)()}}}};CustomBehaviorExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const {\n    globals: { locale }\n  } = context;\n  const [containerProps, setContainerProps] = useState<ContainerProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.token && args.userId && args.botId && args.botToken && args.endpointUrl && args.displayName) {\n        const newProps = await createThreadAndAddUser(args.userId, args.token, args.endpointUrl, args.displayName);\n        await addParrotBotToThread(\n          args.token,\n          args.botId,\n          args.botToken,\n          args.endpointUrl,\n          newProps.threadId,\n          messageArray\n        );\n        setContainerProps(newProps);\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.userId, args.token, args.botId, args.botToken, args.endpointUrl, args.displayName]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <ContosoChatContainer fluentTheme={context.theme} locale={compositeLocale(locale)} {...containerProps} />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},CustomBehaviorExample.parameters)},1501:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CustomDataModelExample",(function(){return CustomDataModelExample}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(7),__webpack_require__(47),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var src=__webpack_require__(32),react_composites_src=__webpack_require__(80),Stack=__webpack_require__(69),react=__webpack_require__(1),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),localizationUtils=__webpack_require__(116),ChatCompositeDocs=__webpack_require__(202),communicationTokenCredential=(__webpack_require__(45),__webpack_require__(253)),jsx_runtime=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer=function CustomDataModelExampleContainer(props){var _useState2=_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];Object(react.useEffect)((function(){props&&function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(react_composites_src.createAzureCommunicationChatAdapter)({endpoint:props.endpointUrl,userId:props.userId,displayName:props.displayName,credential:new communicationTokenCredential.a(props.token),threadId:props.threadId});case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(){return _ref.apply(this,arguments)}}()()}),[props]);return Object(jsx_runtime.jsx)("div",{style:{height:"100vh",width:"100vw"},children:adapter?Object(jsx_runtime.jsx)(react_composites_src.ChatComposite,{fluentTheme:props.fluentTheme,adapter:adapter,onFetchAvatarPersonaData:function onFetchAvatarPersonaData(userId){return new Promise((function(resolve){if(userId===props.botUserId)return resolve({imageInitials:props.botAvatar,initialsColor:"white"})}))},onFetchParticipantMenuItems:function onFetchParticipantMenuItems(participantId,userId,defaultMenuItems){console.log("Remote Participant",participantId),console.log("Current Participant",userId);var customMenuItems=[{key:"Custom Menu Item",text:"Custom Menu Item",onClick:function onClick(){return console.log("Custom Menu Item Clicked")}}];return defaultMenuItems&&(customMenuItems=customMenuItems.concat(defaultMenuItems)),customMenuItems},locale:props.locale,options:{participantPane:!0}}):Object(jsx_runtime.jsx)("h3",{children:"Loading..."})})};CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.displayName="CustomDataModelExampleContainer",CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo={description:"",methods:[],displayName:"CustomDataModelExampleContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},threadId:{required:!0,tsType:{name:"string"},description:""},botUserId:{required:!0,tsType:{name:"string"},description:""},botAvatar:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},locale:{required:!1,tsType:{name:"CompositeLocale"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"]={name:"CustomDataModelExampleContainer",docgenInfo:CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo,path:"stories/ChatComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"});var Utils=__webpack_require__(121);function CustomDataModelExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomDataModelExample_stories_slicedToArray(arr,i){return function CustomDataModelExample_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomDataModelExample_stories_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomDataModelExample_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomDataModelExample_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomDataModelExample_stories_arrayLikeToArray(o,minLen)}(arr,i)||function CustomDataModelExample_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomDataModelExample_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var messageArray=["Welcome to the custom data model example!","Your display name is shown in the participant list, so is mine: A simple bot.","Additionally, you can change my avatar from the default Robot symbol to furrier creatures.","Have fun!"],CustomDataModelExample_stories_CustomDataModelStory=function CustomDataModelStory(args,context){var locale=context.globals.locale,_useState2=CustomDataModelExample_stories_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];return Object(react.useEffect)((function(){(function(){var _ref=function CustomDataModelExample_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomDataModelExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomDataModelExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newPrerequisites,botUser;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(args.userId&&args.token&&args.botId&&args.botToken&&args.endpointUrl&&args.displayName)){_context.next=10;break}return _context.next=3,Object(Utils.d)(args.userId,args.token,args.endpointUrl,args.displayName);case 3:return newPrerequisites=_context.sent,_context.next=6,Object(Utils.c)(args.token,args.botId,args.botToken,args.endpointUrl,newPrerequisites.threadId,messageArray);case 6:botUser=_context.sent,setContainerProps(Object.assign({},newPrerequisites,{botUserId:Object(src.g)(botUser),botAvatar:args.avatar})),_context.next=11;break;case 10:setContainerProps(void 0);case 11:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.avatar,args.botId,args.botToken,args.connectionString,args.displayName,args.endpointUrl,args.token,args.userId]),Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:constants.h,children:containerProps?Object(jsx_runtime.jsx)(CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer,Object.assign({fluentTheme:context.theme,locale:Object(localizationUtils.a)(locale)},containerProps,{botAvatar:Object(controlsUtils.h)(args.avatar)})):Object(jsx_runtime.jsx)(Utils.a,{})})};CustomDataModelExample_stories_CustomDataModelStory.displayName="CustomDataModelStory";var CustomDataModelExample=CustomDataModelExample_stories_CustomDataModelStory.bind({});__webpack_exports__.default={id:constants.b+"-chat-customdatamodelexample",title:constants.b+"/ChatComposite/Custom Data Model Example",component:react_composites_src.ChatComposite,argTypes:Object.assign({userId:controlsUtils.a.userId,token:controlsUtils.a.token,botId:controlsUtils.a.botUserId,botToken:controlsUtils.a.botToken,endpointUrl:controlsUtils.a.endpointUrl,displayName:controlsUtils.a.displayName,avatar:controlsUtils.a.botAvatar},controlsUtils.d),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(ChatCompositeDocs.a)()}}}};CustomDataModelExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const {\n    globals: { locale }\n  } = context;\n  const [containerProps, setContainerProps] = useState<CustomDataModelExampleContainerProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.userId && args.token && args.botId && args.botToken && args.endpointUrl && args.displayName) {\n        const newPrerequisites = await createThreadAndAddUser(\n          args.userId,\n          args.token,\n          args.endpointUrl,\n          args.displayName\n        );\n        const botUser = await addParrotBotToThread(\n          args.token,\n          args.botId,\n          args.botToken,\n          args.endpointUrl,\n          newPrerequisites.threadId,\n          messageArray\n        );\n        setContainerProps({\n          ...newPrerequisites,\n          botUserId: toFlatCommunicationIdentifier(botUser),\n          botAvatar: args.avatar\n        });\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [\n    args.avatar,\n    args.botId,\n    args.botToken,\n    args.connectionString,\n    args.displayName,\n    args.endpointUrl,\n    args.token,\n    args.userId\n  ]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <CustomDataModelExampleContainer\n          fluentTheme={context.theme}\n          locale={compositeLocale(locale)}\n          {...containerProps}\n          botAvatar={getControlledBotAvatarSymbol(args.avatar)}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},CustomDataModelExample.parameters)},1502:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(36),__webpack_require__(74),__webpack_require__(9),__webpack_require__(7);var react=__webpack_require__(1),esm=__webpack_require__(0),dist_esm=__webpack_require__(4),src=__webpack_require__(80),theming=__webpack_require__(77),Stack=(__webpack_require__(426),__webpack_require__(62),__webpack_require__(130),__webpack_require__(159),__webpack_require__(34),__webpack_require__(40),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28),__webpack_require__(69)),lib=__webpack_require__(22),TextField=__webpack_require__(1737),jsx_runtime=__webpack_require__(2);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var IconGrid_IconGrid=function IconGrid(props){var allIcons=props.allIcons,searchText=props.searchText,allIconKeys=Object.keys(allIcons).sort(),filteredKeys=searchText?allIconKeys.filter((function(k){return k.toLowerCase().includes(searchText.toLowerCase())})):allIconKeys;return Object(jsx_runtime.jsx)("div",{style:{display:"grid",gridTemplateColumns:"auto auto auto",padding:"1rem 0"},children:filteredKeys.map((function(key,idx){return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,style:{padding:"0.5rem 0"},verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"start",className:Object(lib.H)({span:{fontSize:"1rem",lineHeight:0}}),children:allIcons[key]}),Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"start",style:{paddingLeft:"0.5rem",fontSize:"0.75rem",fontFamily:"consolas"},children:key})]},idx)}))})};IconGrid_IconGrid.displayName="IconGrid";var IconGrid_SearchBar=function SearchBar(props){var _onChange=props.onChange;return Object(jsx_runtime.jsx)(Stack.a,{style:{padding:"1rem 0"},horizontalAlign:"start",children:Object(jsx_runtime.jsx)(TextField.a,{label:"Search Icons:",underlined:!0,onChange:function onChange(e,val){_onChange(val)}})})};IconGrid_SearchBar.displayName="SearchBar";var IconGrid_IconGridWithSearch=function IconGridWithSearch(props){var icons=props.icons,_useState2=_slicedToArray(Object(react.useState)(void 0),2),searchText=_useState2[0],setSearchText=_useState2[1];return Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)(IconGrid_SearchBar,{onChange:function onChange(val){return setSearchText(val)}}),Object(jsx_runtime.jsx)(IconGrid_IconGrid,{allIcons:icons,searchText:searchText})]})};IconGrid_IconGridWithSearch.displayName="IconGridWithSearch",IconGrid_IconGridWithSearch.__docgenInfo={description:"",methods:[],displayName:"IconGridWithSearch",props:{icons:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"JSX.Element"}],raw:"Record<string, JSX.Element>"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CustomIcons/IconGrid.tsx"]={name:"IconGridWithSearch",docgenInfo:IconGrid_IconGridWithSearch.__docgenInfo,path:"stories/CustomIcons/IconGrid.tsx"});var _excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.f,{id:"icons",title:"Concepts/Icons",mdxType:"Meta"}),Object(esm.b)("h1",{id:"icons"},"Icons"),Object(esm.b)("p",null,"Both the Composites and the Components use a set of default icons from the Fluent UI library. All the icons used in Components and Composites are displayed below with their names."),Object(esm.b)("p",null,Object(esm.b)("strong",{parentName:"p"},"All the default icons can be replaced with a custom icon by providing a custom JSX element."),"\nThe method for providing custom icons differs between composites and components. Please read below for more details about each."),Object(esm.b)("h2",{id:"composites"},"Composites"),Object(esm.b)("p",null,"There is no setup required for rendering icons inside the Composites."),Object(esm.b)("h3",{id:"custom-icons"},"Custom Icons"),Object(esm.b)("p",null,"All Composites expose a prop ",Object(esm.b)("inlineCode",{parentName:"p"},"icons")," that allows you to override the default icons used inside Composites."),Object(esm.b)("p",null,"Here is a sample code showcasing how you can override an icon used inside Composites with custom icons."),Object(esm.b)(dist_esm.h,{language:"tsx",code:"\n<CallComposite\n  adapter={adapter}\n  icons={{\n    LocalDeviceSettingsCamera: <p>My Custom Icon</p>\n  }}\n/>\n  ",mdxType:"Source"}),Object(esm.b)("h3",{id:"default-composite-icons"},"Default Composite Icons"),Object(esm.b)("p",null,"Below is a list of all the default icons you can override in Composites with their names."),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CIconGridWithSearch%20icons=%7BDEFAULT_COMPOSITE_ICONS%7D%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(IconGrid_IconGridWithSearch,{icons:src.DEFAULT_COMPOSITE_ICONS,mdxType:"IconGridWithSearch"})),Object(esm.b)("h2",{id:"components"},"Components"),Object(esm.b)("p",null,"Before you can render icons in Components, you will need to setup the icons using the ",Object(esm.b)("inlineCode",{parentName:"p"},"registerIcons")," method as shown below."),Object(esm.b)(dist_esm.h,{language:"tsx",code:"\nimport { registerIcons } from '@fluentui/react';\nimport { DEFAULT_COMPONENT_ICONS } from '@azure/communication-react';\n//\n// If you don't want to provide custom icons, you can register the default ones included with the library.\n// This will ensure that all the icons are rendered correctly.\n//\nregisterIcons({ icons: DEFAULT_COMPONENT_ICONS });\n  ",mdxType:"Source"}),Object(esm.b)("h3",{id:"custom-icons-1"},"Custom Icons"),Object(esm.b)("p",null,"For overriding a default icon, you can provide a custom react element as shown in the example below."),Object(esm.b)(dist_esm.h,{language:"tsx",code:"\nimport { registerIcons } from '@fluentui/react';\nimport { DEFAULT_COMPONENT_ICONS } from '@azure/communication-react';\nconst customIcons = {...DEFAULT_COMPONENT_ICONS, {\n  ControlButtonCameraOff: <p>My Custom Icon</p>\n}};\nregisterIcons({ icons: customIcons });\n  ",mdxType:"Source"}),Object(esm.b)("h3",{id:"default-component-icons"},"Default Component Icons"),Object(esm.b)("p",null,"Below is a list of all the default icons you can override in Components with their names."),Object(esm.b)(dist_esm.c,{withSource:"none",mdxSource:"%0A%3CIconGridWithSearch%20icons=%7BDEFAULT_COMPONENT_ICONS%7D%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(IconGrid_IconGridWithSearch,{icons:theming.a,mdxType:"IconGridWithSearch"})))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Concepts/Icons",id:"icons",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1503:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ErrorBar",(function(){return ErrorBar}));__webpack_require__(34),__webpack_require__(98),__webpack_require__(266),__webpack_require__(47),__webpack_require__(7);var src=__webpack_require__(21),theming=__webpack_require__(77),lib=__webpack_require__(22),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),jsx_runtime=__webpack_require__(2),ExampleErrorBar_snippet_ExampleErrorBar=function ExampleErrorBar(){return Object(jsx_runtime.jsx)(src.u,{activeErrorMessages:[{type:"callCameraAccessDenied",timestamp:new Date}]})};ExampleErrorBar_snippet_ExampleErrorBar.displayName="ExampleErrorBar",ExampleErrorBar_snippet_ExampleErrorBar.__docgenInfo={description:"",methods:[],displayName:"ExampleErrorBar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ErrorBar/snippets/ExampleErrorBar.snippet.tsx"]={name:"ExampleErrorBar",docgenInfo:ExampleErrorBar_snippet_ExampleErrorBar.__docgenInfo,path:"stories/ErrorBar/snippets/ExampleErrorBar.snippet.tsx"});var ExampleErrorBarText=__webpack_require__(1412).default,ErrorBar_stories_ErrorBarStory=function ErrorBarStory(args){var theme=Object(theming.e)();return Object(jsx_runtime.jsx)("div",{className:Object(lib.H)({background:theme.palette.neutralLighterAlt,padding:"2em",width:"75%",height:"50%"}),children:Object(jsx_runtime.jsx)(src.u,{activeErrorMessages:args.errorTypes.map((function(t){return{type:t,timestamp:new Date(Date.now())}}))})})};ErrorBar_stories_ErrorBarStory.displayName="ErrorBarStory";var ErrorBar=ErrorBar_stories_ErrorBarStory.bind({});__webpack_exports__.default={title:constants.a+"/Error Bar",component:src.u,argTypes:{errorTypes:controlsUtils.a.errorTypes,strings:controlsUtils.j,activeErrorMessages:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ErrorBar"}),Object(jsx_runtime.jsx)(esm.d,{children:"`ErrorBar` is a wrapper on fluent UI's `MessageBar` with additional features for surfacing Azure Communication Services errors on the UI consistently."}),Object(jsx_runtime.jsx)(esm.d,{children:"Set the `showErrorBar` feature for `ChatComposite` to use an `ErrorBar` to show errors."}),Object(jsx_runtime.jsx)(esm.e,{children:"Example ErrorBar"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:ExampleErrorBarText,children:Object(jsx_runtime.jsx)(ExampleErrorBar_snippet_ExampleErrorBar,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Localization"}),Object(jsx_runtime.jsx)(esm.d,{children:"Similar to other UI components in this library, `ErrorBarProps` accepts all strings shown on the UI as a `strings` field. The `activeErrorMessages` field selects from these strings to show in the `ErrorBar` UI."}),Object(jsx_runtime.jsx)(esm.e,{children:"Dismissed messages"}),Object(jsx_runtime.jsx)(esm.d,{children:"User can dismiss the errors shown via `ErrorBar`. The `ErrorBar` component internally tracks dismissed errors and only shows a `MessageBar` for errors that have not been dismissed. When `activeErrorMessages` include a timestamp, errors that occur after the latest dismissal are shown on the UI. When `activeErrorMessages` do not include a timestamp a dismissed error is only shown on the UI if it is removed from the active errors and then occurs again."}),Object(jsx_runtime.jsx)(esm.d,{children:"This way, `ErrorBar` separates the tracking of active errors from the purely UI related state of `ErrorBar` dismissals."}),Object(jsx_runtime.jsx)(esm.e,{children:"Multiple errors"}),Object(jsx_runtime.jsx)(esm.d,{children:"More than one error can occur at the same time. The `ErrorBar` component can show multiple active errors. To avoid confusing the user, it is important to be mindful to limit the total number of errors that are shown together."}),Object(jsx_runtime.jsx)(esm.e,{children:"ErrorBar Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.u})]})}()}}}};ErrorBar.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const theme = useTheme();\n\n  return (\n    <div\n      className={mergeStyles({\n        background: theme.palette.neutralLighterAlt,\n        padding: '2em',\n        width: '75%',\n        height: '50%'\n      })}\n    >\n      <ErrorBarComponent\n        activeErrorMessages={args.errorTypes.map((t) => ({ type: t, timestamp: new Date(Date.now()) }))}\n      />\n    </div>\n  );\n}"}},ErrorBar.parameters)},1504:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"DeviceSettings",(function(){return DeviceSettings}));__webpack_require__(47),__webpack_require__(7);var Stack=__webpack_require__(69),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),theming=(__webpack_require__(34),__webpack_require__(77)),Dropdown=__webpack_require__(1731),jsx_runtime=__webpack_require__(2),DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample=function DeviceSettingDropdownExample(_ref){var devices=_ref.devices,onChange=_ref.onChange,theme=Object(theming.e)();return Object(jsx_runtime.jsx)(theming.b,{fluentTheme:theme,children:Object(jsx_runtime.jsx)(Dropdown.a,{style:{width:"15rem",overflow:"hidden"},placeholder:"Select an option",onChange:onChange,options:devices.map((function(device){return{selected:!1,key:device,text:device}}))})})};DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample.displayName="DeviceSettingDropdownExample",DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample.__docgenInfo={description:"",methods:[],displayName:"DeviceSettingDropdownExample",props:{devices:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(event: React.FormEvent<HTMLDivElement>, option?: IDropdownOption, index?: number) => void",signature:{arguments:[{name:"event",type:{name:"ReactFormEvent",raw:"React.FormEvent<HTMLDivElement>",elements:[{name:"HTMLDivElement"}]}},{name:"option",type:{name:"IDropdownOption"}},{name:"index",type:{name:"number"}}],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/DevicesDropdown/snippets/DeviceSettingsDropdown.snippet.tsx"]={name:"DeviceSettingDropdownExample",docgenInfo:DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample.__docgenInfo,path:"stories/Examples/DevicesDropdown/snippets/DeviceSettingsDropdown.snippet.tsx"});var DevicesDropdownExampleText=__webpack_require__(1413).default,cameraOptions=["Logitech C920S HD Pro Webcam","Lenovo Essential FHD Webcam","Aukey PC-LM1E Full HD Webcam","AVerMedia PW315","Razer Kiyo"],DeviceSettingsDropDown_stories_DeviceSettingsStory=function DeviceSettingsStory(){return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample,{devices:cameraOptions,onChange:function onChange(_,option){alert(null==option?void 0:option.text)}})})};DeviceSettingsDropDown_stories_DeviceSettingsStory.displayName="DeviceSettingsStory";var DeviceSettings=DeviceSettingsDropDown_stories_DeviceSettingsStory.bind({});__webpack_exports__.default={id:constants.d+"-devicesettings",title:constants.d+"/Device Settings",component:DeviceSettings,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"Device Setting"}),Object(jsx_runtime.jsx)(esm.e,{children:"Create a dropdown of cameras to select"}),Object(jsx_runtime.jsx)(esm.d,{children:"To build a UI component for device settings, we recommend using the Fluent UI [Dropdown](https://developer.microsoft.com/fluentui#/controls/web/dropdown). Using the retrieved devices from the calling sdk, apply the devices as options in the dropdown. When a user selects an element from the dropdown, use the `onChange` callback to save the result. For this case we are just going to use an array of placeholder cameras (strings) and we are going to demonstrate how to use a FluentUI `Dropdown` to create a list of devices for a user to select."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DevicesDropdownExampleText,children:Object(jsx_runtime.jsx)(DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample,{devices:cameraOptions,onChange:function onChange(_,option){alert(null==option?void 0:option.text)}})})]})}()}}}};DeviceSettings.parameters=Object.assign({storySource:{source:"() => {\n  return (\n    <Stack>\n      <DeviceSettingDropdownExample\n        devices={cameraOptions}\n        onChange={(_, option) => {\n          alert(option?.text);\n        }}\n      />\n    </Stack>\n  );\n}"}},DeviceSettings.parameters)},1505:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"LocalPreview",(function(){return LocalPreview}));__webpack_require__(7),__webpack_require__(47);var esm=__webpack_require__(4),react=__webpack_require__(1),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),theming=(__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28),__webpack_require__(77)),src=__webpack_require__(21),lib=__webpack_require__(22),Stack=__webpack_require__(69),Text=__webpack_require__(499),VideoOff20Filled=__webpack_require__(1518),utils=__webpack_require__(178),jsx_runtime=__webpack_require__(2);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var LocalPreviewExample_snippet_LocalPreviewExample=function LocalPreviewExample(_ref){var isVideoAvailable=_ref.isVideoAvailable,isCameraEnabled=_ref.isCameraEnabled,isMicrophoneEnabled=_ref.isMicrophoneEnabled,_useState2=_slicedToArray(Object(react.useState)(!0),2),microphone=_useState2[0],setMicrophone=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(!0),2),camera=_useState4[0],setCamera=_useState4[1],theme=Object(theming.e)(),palette=theme.palette,localPreviewContainerStyle=Object(lib.H)({minWidth:"25rem",width:"100%",height:"100%",maxHeight:"18.75rem",minHeight:"16.875rem",margin:"0 auto",background:palette.neutralLighter,color:palette.neutralTertiary}),cameraOffLabelStyle=Object(lib.H)({fontFamily:"Segoe UI Regular",fontSize:"0.625rem",color:palette.neutralTertiary}),renderCameraOffPlaceholder=Object(react.useCallback)((function(){return Object(jsx_runtime.jsxs)(Stack.a,{style:{width:"100%",height:"100%"},verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(VideoOff20Filled.a,{primaryFill:"currentColor"})}),Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(Text.a,{className:cameraOffLabelStyle,children:"Your camera is turned off"})})]})}),[cameraOffLabelStyle]),videoStreams=Object(utils.a)(1),videoStreamElement=isVideoAvailable?videoStreams[0]:null;return Object(jsx_runtime.jsx)(theming.b,{fluentTheme:theme,children:Object(jsx_runtime.jsx)(Stack.a,{style:{width:"100%",height:"100%"},verticalAlign:"center",children:Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(Stack.a,{className:localPreviewContainerStyle,children:Object(jsx_runtime.jsx)(src.K,{styles:{root:{minHeight:"14rem"}},renderElement:isVideoAvailable&&isCameraEnabled&&camera?Object(jsx_runtime.jsx)(src.H,{videoStreamElement:videoStreamElement}):void 0,onRenderPlaceholder:renderCameraOffPlaceholder,children:Object(jsx_runtime.jsxs)(src.p,{layout:"floatingBottom",children:[Object(jsx_runtime.jsx)(src.o,{disabled:!isCameraEnabled,checked:!!isCameraEnabled&&camera,onClick:function onClick(){return setCamera(!camera)}}),Object(jsx_runtime.jsx)(src.B,{disabled:!isMicrophoneEnabled,checked:!!isMicrophoneEnabled&&microphone,onClick:function onClick(){return setMicrophone(!microphone)}})]})})})})})})};LocalPreviewExample_snippet_LocalPreviewExample.displayName="LocalPreviewExample",LocalPreviewExample_snippet_LocalPreviewExample.__docgenInfo={description:"",methods:[],displayName:"LocalPreviewExample",props:{isVideoAvailable:{required:!0,tsType:{name:"boolean"},description:""},isCameraEnabled:{required:!0,tsType:{name:"boolean"},description:""},isMicrophoneEnabled:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/LocalPreview/snippets/LocalPreviewExample.snippet.tsx"]={name:"LocalPreviewExample",docgenInfo:LocalPreviewExample_snippet_LocalPreviewExample.__docgenInfo,path:"stories/Examples/LocalPreview/snippets/LocalPreviewExample.snippet.tsx"});var LocalPreviewExampleText=__webpack_require__(1416).default,LocalPreview_stories_LocalPreviewStory=function LocalPreviewStory(args){return Object(jsx_runtime.jsx)(LocalPreviewExample_snippet_LocalPreviewExample,Object.assign({},args))};LocalPreview_stories_LocalPreviewStory.displayName="LocalPreviewStory";var LocalPreview=LocalPreview_stories_LocalPreviewStory.bind({});__webpack_exports__.default={id:constants.d+"-localpreview",title:constants.d+"/Local Preview",component:LocalPreview,argTypes:{isVideoAvailable:controlsUtils.a.isVideoAvailable,isCameraEnabled:controlsUtils.a.isCameraEnabled,isMicrophoneEnabled:controlsUtils.a.isMicrophoneEnabled},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"Local Preview"}),Object(jsx_runtime.jsx)(esm.e,{children:"Basic example"}),Object(jsx_runtime.jsx)(esm.d,{children:"To build a local preview, we recommend using the Fluent UI [Stack](https://developer.microsoft.com/fluentui#/controls/web/stack) as a container as shown in the code below. For enabling and disabling the camera or microphone we suggest using the [Toggle](https://developer.microsoft.com/fluentui#/controls/web/toggle) component. The area for showing your local preview is a [VideoTile](./?path=/docs/ui-components-videotile--video-tile) which can also be used in our video grid layouts."}),Object(jsx_runtime.jsx)(esm.d,{children:"Note: In the code example, all `%` characters were replaced by their unicode value `\\u0025` due to URI malformed issue when loading the storybook snippets"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:LocalPreviewExampleText,children:Object(jsx_runtime.jsx)("div",{style:{height:"17.188rem"},children:Object(jsx_runtime.jsx)(LocalPreviewExample_snippet_LocalPreviewExample,{isVideoAvailable:!0,isCameraEnabled:!0,isMicrophoneEnabled:!0})})})]})}()}}}};LocalPreview.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <LocalPreviewExample {...args} />;\n}"}},LocalPreview.parameters)},1506:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ComplianceBanner",(function(){return ComplianceBanner_stories_ComplianceBanner}));__webpack_require__(47),__webpack_require__(7),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var Stack=__webpack_require__(69),PrimaryButton=__webpack_require__(1721),react=__webpack_require__(1),constants=__webpack_require__(14),MessageBar=__webpack_require__(616),Link=__webpack_require__(898),jsx_runtime=__webpack_require__(2);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ComplianceBanner_snippet_ComplianceBanner=function ComplianceBanner(props){var cachedProps=Object(react.useRef)({latest:{callTranscribeState:!1,callRecordState:!1},previous:{callTranscribeState:!1,callRecordState:!1}});props.callRecordState===cachedProps.current.latest.callRecordState&&props.callTranscribeState===cachedProps.current.latest.callTranscribeState||(cachedProps.current={latest:props,previous:cachedProps.current.latest});var variant=function computeVariant(previousCallRecordState,previousCallTranscribeState,callRecordState,callTranscribeState){if(previousCallRecordState&&previousCallTranscribeState)return callRecordState&&!callTranscribeState?1:!callRecordState&&callTranscribeState?2:callRecordState||callTranscribeState?NO_STATE:3;if(previousCallRecordState&&!previousCallTranscribeState)return callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?5:callRecordState||callTranscribeState?NO_STATE:6;if(!previousCallRecordState&&previousCallTranscribeState)return callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?7:callRecordState||callTranscribeState?NO_STATE:8;if(!previousCallRecordState&&!previousCallTranscribeState)return callRecordState&&callTranscribeState?4:callRecordState&&!callTranscribeState?7:!callRecordState&&callTranscribeState?5:NO_STATE;return NO_STATE}(cachedProps.current.previous.callRecordState,cachedProps.current.previous.callTranscribeState,cachedProps.current.latest.callRecordState,cachedProps.current.latest.callTranscribeState);return Object(jsx_runtime.jsx)(DismissableMessageBar,{variant:variant})};function DismissableMessageBar(props){var newVariant=props.variant,_useState2=_slicedToArray(Object(react.useState)(0),2),variant=_useState2[0],setVariant=_useState2[1];return Object(react.useEffect)((function(){setVariant(newVariant)}),[newVariant,setVariant]),variant===NO_STATE?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Object(jsx_runtime.jsx)(MessageBar.a,{onDismiss:function onDismiss(){setVariant(NO_STATE)},dismissButtonAriaLabel:"Close",children:Object(jsx_runtime.jsx)(BannerMessage,{variant:variant})})}ComplianceBanner_snippet_ComplianceBanner.displayName="ComplianceBanner";var NO_STATE=0;function BannerMessage(props){switch(props.variant){case 1:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has stopped."})," You are now only recording this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 2:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has stopped."})," You are now only transcribing this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 3:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription are being saved. "})," Recording and transcription have stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 4:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription have started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 5:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 6:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording is being saved."})," Recording has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 7:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 8:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription is being saved."})," Transcription has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}function PrivacyPolicy(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://privacy.microsoft.com/privacystatement#mainnoticetoendusersmodule",target:"_blank",underline:!0,children:"Privacy policy"})}function LearnMore(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://support.microsoft.com/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24",target:"_blank",underline:!0,children:"Learn more"})}PrivacyPolicy.displayName="PrivacyPolicy",LearnMore.displayName="LearnMore",ComplianceBanner_snippet_ComplianceBanner.__docgenInfo={description:"",methods:[],displayName:"ComplianceBanner",props:{callTranscribeState:{required:!1,tsType:{name:"boolean"},description:""},callRecordState:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/TeamsInterop/snippets/ComplianceBanner.snippet.tsx"]={name:"ComplianceBanner",docgenInfo:ComplianceBanner_snippet_ComplianceBanner.__docgenInfo,path:"stories/Examples/TeamsInterop/snippets/ComplianceBanner.snippet.tsx"});var TeamsInteropDocs=__webpack_require__(483);function ComplianceBanner_stories_slicedToArray(arr,i){return function ComplianceBanner_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ComplianceBanner_stories_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ComplianceBanner_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ComplianceBanner_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ComplianceBanner_stories_arrayLikeToArray(o,minLen)}(arr,i)||function ComplianceBanner_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ComplianceBanner_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ComplianceBanner_stories_ComplianceBannerStory=function ComplianceBannerStory(){var _useState2=ComplianceBanner_stories_slicedToArray(Object(react.useState)({recordingEnabled:!1,transcriptionEnabled:!1}),2),teamsInterop=_useState2[0],setTeamsInterop=_useState2[1];return Object(jsx_runtime.jsxs)(Stack.a,{tokens:{childrenGap:"1rem"},style:{minWidth:"50%",minHeight:"50%"},children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:{childrenGap:"1rem"},children:[Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Toggle Recording",onClick:function toggleRecording(){setTeamsInterop({recordingEnabled:!teamsInterop.recordingEnabled,transcriptionEnabled:teamsInterop.transcriptionEnabled})}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Toggle Transcription",onClick:function toggleTranscription(){setTeamsInterop({recordingEnabled:teamsInterop.recordingEnabled,transcriptionEnabled:!teamsInterop.transcriptionEnabled})}})]}),Object(jsx_runtime.jsx)(ComplianceBanner_snippet_ComplianceBanner,{callRecordState:teamsInterop.recordingEnabled,callTranscribeState:teamsInterop.transcriptionEnabled})]})};ComplianceBanner_stories_ComplianceBannerStory.displayName="ComplianceBannerStory";var ComplianceBanner_stories_ComplianceBanner=ComplianceBanner_stories_ComplianceBannerStory.bind({});__webpack_exports__.default={id:constants.d+"-teamsinterop-compliancebanner",title:constants.d+"/Teams Interop/Compliance Banner",component:ComplianceBanner_stories_ComplianceBanner,parameters:{docs:{page:function page(){return Object(TeamsInteropDocs.a)()}}}};ComplianceBanner_stories_ComplianceBanner.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  const [teamsInterop, setTeamsInterop] = useState({\n    recordingEnabled: false,\n    transcriptionEnabled: false\n  });\n\n  const toggleRecording = (): void => {\n    setTeamsInterop({\n      recordingEnabled: !teamsInterop.recordingEnabled,\n      transcriptionEnabled: teamsInterop.transcriptionEnabled\n    });\n  };\n\n  const toggleTranscription = (): void => {\n    setTeamsInterop({\n      recordingEnabled: teamsInterop.recordingEnabled,\n      transcriptionEnabled: !teamsInterop.transcriptionEnabled\n    });\n  };\n\n  // TODO: Fix dark theming.\n  // Once https://github.com/Azure/communication-ui-library/pull/169 lands, same fix should be applied here.\n  return (\n    <Stack tokens={{ childrenGap: '1rem' }} style={{ minWidth: '50%', minHeight: '50%' }}>\n      {/* We need to use these two buttons here to toggle recording and transcription.\n    Using storybook controls would trigger the whole story to do a fresh re-render, not just components inside the story. */}\n      <Stack horizontal tokens={{ childrenGap: '1rem' }}>\n        <PrimaryButton text=\"Toggle Recording\" onClick={toggleRecording} />\n        <PrimaryButton text=\"Toggle Transcription\" onClick={toggleTranscription} />\n      </Stack>\n      <Banner callRecordState={teamsInterop.recordingEnabled} callTranscribeState={teamsInterop.transcriptionEnabled} />\n    </Stack>\n  );\n}"}},ComplianceBanner_stories_ComplianceBanner.parameters)},1507:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Lobby",(function(){return Lobby_stories_Lobby}));__webpack_require__(7),__webpack_require__(47),__webpack_require__(1);var constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),theming=__webpack_require__(77),src=__webpack_require__(21),utils=__webpack_require__(178),jsx_runtime=__webpack_require__(2),Lobby_snippet_Lobby=function Lobby(props){var theme=Object(theming.e)(),palette=theme.palette,ControlBarStyles={root:{background:theme.palette.white,minHeight:"4.25rem",alignItems:"center"}},videoStreams=Object(utils.a)(1),videoStreamElement=props.isVideoReady?videoStreams[0]:void 0,videoRenderElement=videoStreamElement?Object(jsx_runtime.jsx)(src.H,{videoStreamElement:videoStreamElement}):void 0;return Object(jsx_runtime.jsxs)(src.K,{styles:{root:{height:"100%",width:"100%"},overlayContainer:{}},isMirrored:!0,onRenderPlaceholder:function onRenderPlaceholder(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},renderElement:videoRenderElement,children:[Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",background:props.isVideoReady?"#201f1e":palette.neutralLight,opacity:.75}}),Object(jsx_runtime.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",marginTop:"-2.125rem"},children:[Object(jsx_runtime.jsxs)("p",{style:{fontSize:"1.75rem",color:props.isVideoReady?"white":palette.neutralPrimary,textAlign:"center",margin:"0"},children:[" ",Object(jsx_runtime.jsx)("br",{})," ",props.callStateText," ",Object(jsx_runtime.jsx)("br",{})]}),Object(jsx_runtime.jsx)("p",{style:{fontSize:"0.75rem",color:props.isVideoReady?"white":palette.neutralPrimary,textAlign:"center",margin:"0"},children:props.callStateSubText})]}),Object(jsx_runtime.jsxs)(src.p,{layout:"dockedBottom",styles:ControlBarStyles,children:[Object(jsx_runtime.jsx)(src.o,{showLabel:!0,checked:!0}),Object(jsx_runtime.jsx)(src.B,{showLabel:!0,checked:!0}),Object(jsx_runtime.jsx)(src.s,{showLabel:!0}),Object(jsx_runtime.jsx)(src.t,{showLabel:!0,style:{borderRadius:"0.25rem",marginLeft:"0.25rem"}})]})]})};Lobby_snippet_Lobby.displayName="Lobby",Lobby_snippet_Lobby.__docgenInfo={description:"",methods:[],displayName:"Lobby",props:{isVideoReady:{required:!0,tsType:{name:"boolean"},description:""},callStateText:{required:!0,tsType:{name:"string"},description:""},callStateSubText:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/TeamsInterop/snippets/Lobby.snippet.tsx"]={name:"Lobby",docgenInfo:Lobby_snippet_Lobby.__docgenInfo,path:"stories/Examples/TeamsInterop/snippets/Lobby.snippet.tsx"});var TeamsInteropDocs=__webpack_require__(483),Lobby_stories_LobbyStory=function LobbyStory(args){return Object(jsx_runtime.jsx)(Lobby_snippet_Lobby,Object.assign({},args))};Lobby_stories_LobbyStory.displayName="LobbyStory";var Lobby_stories_Lobby=Lobby_stories_LobbyStory.bind({});__webpack_exports__.default={id:constants.d+"-teamsinterop-lobby",title:constants.d+"/Teams Interop/Lobby",component:Lobby_stories_Lobby,argTypes:{callStateText:controlsUtils.a.callStateText,callStateSubText:controlsUtils.a.callStateSubText,isVideoReady:controlsUtils.a.isVideoReady},parameters:{docs:{page:function page(){return Object(TeamsInteropDocs.a)()}}}};Lobby_stories_Lobby.parameters=Object.assign({storySource:{source:"(args) => {\n  return <LobbyComponent {...args} />;\n}"}},Lobby_stories_Lobby.parameters)},1508:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Teams",(function(){return Teams}));__webpack_require__(47),__webpack_require__(7);var esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),theming=__webpack_require__(77),src=__webpack_require__(21),lib=__webpack_require__(22),Stack=__webpack_require__(69),jsx_runtime=__webpack_require__(2),teamsTheme={palette:{themePrimary:"#4b53bc",themeLighterAlt:"#030308",themeLighter:"#0c0d1e",themeLight:"#171939",themeTertiary:"#2d3271",themeSecondary:"#4249a6",themeDarkAlt:"#5a61c3",themeDark:"#6f76cd",themeDarker:"#9196da",neutralLighterAlt:"#1e1e1e",neutralLighter:"#1d1d1d",neutralLight:"#1c1c1c",neutralQuaternaryAlt:"#1a1a1a",neutralQuaternary:"#191919",neutralTertiaryAlt:"#181818",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#1f1f1f"}},TeamsTheme_snippet_TeamsTheme=function TeamsTheme(){return Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",maxWidth:"50rem",maxHeight:"30rem"},children:Object(jsx_runtime.jsx)(theming.b,{fluentTheme:teamsTheme,children:Object(jsx_runtime.jsx)(TeamsTheme_snippet_App,{})})})};TeamsTheme_snippet_TeamsTheme.displayName="TeamsTheme";var TeamsTheme_snippet_App=function App(){var theme=Object(theming.e)(),headerContainer=Object(lib.H)({width:"100%",height:"3.875rem",overflow:"hidden",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginBottom:2,background:theme.palette.white}),teamsButtonStyle={root:{minWidth:"2.75rem"},rootHovered:{color:theme.palette.themePrimary,background:"none"}},videoTileStyle={root:{background:theme.palette.white}};return Object(jsx_runtime.jsxs)(Stack.a,{style:{height:"100%",width:"100%",background:theme.palette.neutralQuaternaryAlt},children:[Object(jsx_runtime.jsx)(Stack.a,{className:headerContainer,children:Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsxs)(src.p,{styles:{root:{marginRight:".5rem",alignItems:"center"}},children:[Object(jsx_runtime.jsx)(src.o,{onClick:function onClick(){},styles:teamsButtonStyle}),Object(jsx_runtime.jsx)(src.B,{onClick:function onClick(){},styles:teamsButtonStyle}),Object(jsx_runtime.jsx)(src.F,{onClick:function onClick(){},styles:teamsButtonStyle}),Object(jsx_runtime.jsx)(src.t,{onClick:function onClick(){},showLabel:!0,onRenderText:function onRenderText(){return Object(jsx_runtime.jsx)("span",{style:{marginLeft:"0.5rem"},children:"Leave"},"endCallBtnTextKey")},styles:{root:{height:"2rem",minHeight:"2rem",width:"6.5rem",borderRadius:"0.125rem"}}})]})})}),Object(jsx_runtime.jsx)(src.w,{children:Object(jsx_runtime.jsx)(src.K,{displayName:"Michael",styles:videoTileStyle})})]})};TeamsTheme_snippet_App.displayName="App",TeamsTheme_snippet_TeamsTheme.__docgenInfo={description:"",methods:[],displayName:"TeamsTheme"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Themes/snippets/TeamsTheme.snippet.tsx"]={name:"TeamsTheme",docgenInfo:TeamsTheme_snippet_TeamsTheme.__docgenInfo,path:"stories/Examples/Themes/snippets/TeamsTheme.snippet.tsx"});var exampleTeamsTheme=__webpack_require__(1420).default,TeamsTheme_stories_TeamsStory=function TeamsStory(){return Object(jsx_runtime.jsx)(TeamsTheme_snippet_TeamsTheme,{})};TeamsTheme_stories_TeamsStory.displayName="TeamsStory";var Teams=TeamsTheme_stories_TeamsStory.bind({});__webpack_exports__.default={id:constants.d+"-themes-teams",title:constants.d+"/Themes/Teams",parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"Themes"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example Themes that can be leveraged by developers to provide color schemes to UI Components"}),Object(jsx_runtime.jsx)(esm.e,{children:"Teams-Like Theme"}),Object(jsx_runtime.jsx)(esm.h,{code:exampleTeamsTheme})]})}()}}}};Teams.parameters=Object.assign({storySource:{source:"() => {\n  return <TeamsTheme />;\n}"}},Teams.parameters)},1509:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"GridLayout",(function(){return GridLayout}));__webpack_require__(62),__webpack_require__(34),__webpack_require__(47),__webpack_require__(7);var src=__webpack_require__(21),esm=__webpack_require__(4),react=__webpack_require__(1),constants=__webpack_require__(14),controlsUtils=__webpack_require__(6),utils=__webpack_require__(178),jsx_runtime=__webpack_require__(2),GridLayout_snippet_GridLayoutExample=function GridLayoutExample(){var videoTileStyles={root:{padding:"10px",border:"1px solid #999"}};return Object(jsx_runtime.jsx)("div",{style:{height:"530px",width:"830px"},children:Object(jsx_runtime.jsxs)(src.w,{children:[Object(jsx_runtime.jsx)(src.K,{styles:videoTileStyles,displayName:"Michael"}),Object(jsx_runtime.jsx)(src.K,{styles:videoTileStyles,displayName:"Jim"}),Object(jsx_runtime.jsx)(src.K,{styles:videoTileStyles,displayName:"Pam"}),Object(jsx_runtime.jsx)(src.K,{styles:videoTileStyles,displayName:"Dwight"})]})})};GridLayout_snippet_GridLayoutExample.displayName="GridLayoutExample",GridLayout_snippet_GridLayoutExample.__docgenInfo={description:"",methods:[],displayName:"GridLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/GridLayout/snippets/GridLayout.snippet.tsx"]={name:"GridLayoutExample",docgenInfo:GridLayout_snippet_GridLayoutExample.__docgenInfo,path:"stories/GridLayout/snippets/GridLayout.snippet.tsx"});var GridLayoutExampleText=__webpack_require__(1421).default,GridLayout_stories_GridLayoutStory=function GridLayoutStory(args){var videoStreamElements=Object(utils.a)(args.participants.filter((function(participant){return participant.isVideoReady})).length),participantsComponents=Object(react.useMemo)((function(){var videoStreamElementIndex=0;return args.participants.map((function(participant,index){var videoRenderElement=void 0;if(participant.isVideoReady){var videoStreamElement=videoStreamElements[videoStreamElementIndex];videoStreamElementIndex++,videoRenderElement=Object(jsx_runtime.jsx)(src.H,{videoStreamElement:videoStreamElement})}return Object(jsx_runtime.jsx)(src.K,{renderElement:videoRenderElement,displayName:participant.displayName},index)}))}),[args.participants,videoStreamElements]);return Object(jsx_runtime.jsx)("div",{style:{height:args.height+"px",width:args.width+"px"},children:Object(jsx_runtime.jsx)(src.w,{children:participantsComponents})})};GridLayout_stories_GridLayoutStory.displayName="GridLayoutStory";var GridLayout=GridLayout_stories_GridLayoutStory.bind({});__webpack_exports__.default={id:constants.a+"-gridlayout",title:constants.a+"/Grid Layout",component:src.w,argTypes:{width:controlsUtils.a.layoutWidth,height:controlsUtils.a.layoutHeight,participants:controlsUtils.a.gridParticipants,children:controlsUtils.j,layout:controlsUtils.j,styles:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"GridLayout"}),Object(jsx_runtime.jsx)(esm.d,{children:"The `GridLayout` organizes components passed to it as children in a grid layout. It can display a grid of call participants through the use of `VideoTile` component."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"\nimport { GridLayout, VideoTile } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.d,{children:"The following example shows how you can render `VideoTile` components inside a grid layout. For styling the children video tiles, please read the [VideoTile component docs](./?path=/docs/ui-components-videotile--video-tile)."}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:GridLayoutExampleText,children:Object(jsx_runtime.jsx)(GridLayout_snippet_GridLayoutExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.w})]})}()}}}};GridLayout.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const videoStreamElements = useVideoStreams(\n    args.participants.filter((participant) => {\n      return participant.isVideoReady;\n    }).length\n  );\n\n  const participantsComponents = useMemo(() => {\n    let videoStreamElementIndex = 0;\n    return args.participants.map((participant, index) => {\n      let videoRenderElement: JSX.Element | undefined = undefined;\n      if (participant.isVideoReady) {\n        const videoStreamElement = videoStreamElements[videoStreamElementIndex];\n        videoStreamElementIndex++;\n        videoRenderElement = <StreamMedia videoStreamElement={videoStreamElement} />;\n      }\n      return <VideoTile renderElement={videoRenderElement} displayName={participant.displayName} key={index} />;\n    });\n  }, [args.participants, videoStreamElements]);\n\n  return (\n    <div\n      style={{\n        height: `${args.height}px`,\n        width: `${args.width}px`\n      }}\n    >\n      <GridLayoutComponent>{participantsComponents}</GridLayoutComponent>\n    </div>\n  );\n}"}},GridLayout.parameters)},1510:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"MessageStatusIndicator",(function(){return MessageStatusIndicator}));__webpack_require__(47),__webpack_require__(7);var src=__webpack_require__(21),esm=__webpack_require__(4),constants=(__webpack_require__(1),__webpack_require__(14)),controlsUtils=__webpack_require__(6),Stack=__webpack_require__(69),jsx_runtime=__webpack_require__(2),AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample=function DefaultMessageStatusIndicatorsExample(){return Object(jsx_runtime.jsxs)(Stack.a,{horizontalAlign:"start",children:[Object(jsx_runtime.jsx)(src.z,{status:"delivered"}),Object(jsx_runtime.jsx)(src.z,{status:"seen"}),Object(jsx_runtime.jsx)(src.z,{status:"sending"}),Object(jsx_runtime.jsx)(src.z,{status:"failed"})]})};AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample.displayName="DefaultMessageStatusIndicatorsExample",AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample.__docgenInfo={description:"",methods:[],displayName:"DefaultMessageStatusIndicatorsExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageStatusIndicator/snippets/AllDefaultIndicators.snippet.tsx"]={name:"DefaultMessageStatusIndicatorsExample",docgenInfo:AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample.__docgenInfo,path:"stories/MessageStatusIndicator/snippets/AllDefaultIndicators.snippet.tsx"});var DefaultMessageStatusIndicatorsExampleText=__webpack_require__(1422).default,MessageStatusIndicator_stories_MessageStatusIndicatorStory=function MessageStatusIndicatorStory(args){return Object(jsx_runtime.jsx)(src.z,{status:args.status,strings:{deliveredTooltipText:args.deliveredTooltipText,sendingTooltipText:args.sendingTooltipText,seenTooltipText:args.seenTooltipText,readByTooltipText:args.readByTooltipText,failedToSendTooltipText:args.failedToSendTooltipText}})};MessageStatusIndicator_stories_MessageStatusIndicatorStory.displayName="MessageStatusIndicatorStory";var MessageStatusIndicator=MessageStatusIndicator_stories_MessageStatusIndicatorStory.bind({});__webpack_exports__.default={id:constants.a+"-messagestatusindicator",title:constants.a+"/Message Status Indicator",component:src.z,argTypes:{status:controlsUtils.a.messageStatus,deliveredTooltipText:controlsUtils.a.messageDeliveredTooltipText,sendingTooltipText:controlsUtils.a.messageSendingTooltipText,seenTooltipText:controlsUtils.a.messageSeenTooltipText,readByTooltipText:controlsUtils.a.messageReadByTooltipText,failedToSendTooltipText:controlsUtils.a.messageFailedToSendTooltipText,styles:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"MessageStatusIndicator"}),Object(jsx_runtime.jsx)(esm.d,{children:"MessageStatusIndicator is used to indicate whether a message has been read, delivered, currently sending, or failed to send."}),Object(jsx_runtime.jsx)(esm.e,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.h,{code:"import { MessageStatus, MessageStatusIndicator } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.e,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{mdxSource:DefaultMessageStatusIndicatorsExampleText,children:Object(jsx_runtime.jsx)(AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample,{})}),Object(jsx_runtime.jsx)(esm.e,{children:"Props"}),Object(jsx_runtime.jsx)(esm.g,{of:src.z})]})}()}}}};MessageStatusIndicator.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return (\n    <MessageStatusIndicatorComponent\n      status={args.status as MessageStatus}\n      strings={{\n        deliveredTooltipText: args.deliveredTooltipText,\n        sendingTooltipText: args.sendingTooltipText,\n        seenTooltipText: args.seenTooltipText,\n        readByTooltipText: args.readByTooltipText,\n        failedToSendTooltipText: args.failedToSendTooltipText\n      }}\n    />\n  );\n}"}},MessageStatusIndicator.parameters)},163:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ChatAdapterProvider})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useAdapter})),__webpack_require__.d(__webpack_exports__,"c",(function(){return useFileUploadAdapter}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),ChatAdapterContext=Object(react__WEBPACK_IMPORTED_MODULE_0__.createContext)(void 0),ChatAdapterProvider=function ChatAdapterProvider(props){var adapter=props.adapter;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(ChatAdapterContext.Provider,{value:adapter,children:props.children})};ChatAdapterProvider.displayName="ChatAdapterProvider";var useAdapter=function useAdapter(){var adapter=Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(ChatAdapterContext);if(!adapter)throw"Cannot find adapter please initialize before usage.";return adapter},useFileUploadAdapter=function useFileUploadAdapter(){return useAdapter()};ChatAdapterProvider.__docgenInfo={description:"@private",methods:[],displayName:"ChatAdapterProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},adapter:{required:!0,tsType:{name:"ChatAdapter"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/adapter/ChatAdapterProvider.tsx"]={name:"ChatAdapterProvider",docgenInfo:ChatAdapterProvider.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/adapter/ChatAdapterProvider.tsx"})},178:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useVideoStreams}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28),__webpack_require__(16),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(17),__webpack_require__(18),__webpack_require__(40);var react__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var renderVideoStream=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(scalingMode){var _navigator$mediaDevic,video;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(null===(_navigator$mediaDevic=navigator.mediaDevices)||void 0===_navigator$mediaDevic||!_navigator$mediaDevic.getUserMedia){_context.next=16;break}return(video=document.createElement("video")).autoplay=!0,video.style.height="100%",video.style.width="100%",video.style.objectFit=null!=scalingMode?scalingMode:"cover",_context.prev=6,_context.next=9,navigator.mediaDevices.getUserMedia({video:!0});case 9:video.srcObject=_context.sent,_context.next=15;break;case 12:_context.prev=12,_context.t0=_context.catch(6),console.log("Unable to get stream for video",_context.t0);case 15:return _context.abrupt("return",video);case 16:return _context.abrupt("return",null);case 17:case"end":return _context.stop()}}),_callee,null,[[6,12]])})));return function renderVideoStream(_x){return _ref.apply(this,arguments)}}(),stopRenderVideoStream=function stopRenderVideoStream(video){if(video){var mediaProvider=video.srcObject;if(mediaProvider){var stream=mediaProvider;if(stream.getVideoTracks){var _step,_iterator=_createForOfIteratorHelper(stream.getVideoTracks());try{for(_iterator.s();!(_step=_iterator.n()).done;){_step.value.stop()}}catch(err){_iterator.e(err)}finally{_iterator.f()}}}}},useVideoStreams=function useVideoStreams(numberOfStreams){var mounted=Object(react__WEBPACK_IMPORTED_MODULE_12__.useRef)(!1);Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){return mounted.current=!0,function(){mounted.current=!1}}));var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_12__.useState)([]),2),videoStreamElements=_useState2[0],setVideoStreamElements=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){var newVideoStreamElements=[];(function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var i,videoStreamElement,_iterator2,_step2,_videoStreamElement;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:i=0;case 1:if(!(i<numberOfStreams)){_context2.next=9;break}return _context2.next=4,renderVideoStream();case 4:videoStreamElement=_context2.sent,newVideoStreamElements.push(videoStreamElement);case 6:i++,_context2.next=1;break;case 9:if(mounted.current)setVideoStreamElements(newVideoStreamElements);else{_iterator2=_createForOfIteratorHelper(newVideoStreamElements);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)_videoStreamElement=_step2.value,stopRenderVideoStream(_videoStreamElement)}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}case 10:case"end":return _context2.stop()}}),_callee2)})));return function loadVideos(){return _ref2.apply(this,arguments)}})()()}),[numberOfStreams]),Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){return function(){var _step3,_iterator3=_createForOfIteratorHelper(videoStreamElements);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var videoStreamElement=_step3.value;stopRenderVideoStream(videoStreamElement)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}),[videoStreamElements]),videoStreamElements}},179:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return Utils_isCameraOn})),__webpack_require__.d(__webpack_exports__,"d",(function(){return reduceCallControlsForMobile})),__webpack_require__.d(__webpack_exports__,"b",(function(){return Utils_getCallCompositePage})),__webpack_require__.d(__webpack_exports__,"a",(function(){return computeVariant}));__webpack_require__(115),__webpack_require__(130);var CallEndReasons,src=__webpack_require__(88),REMOVED_FROM_CALL_SUB_CODES=[5e3,5300],Utils_isCameraOn=function isCameraOn(state){return state.call?!!state.call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})):!!state.devices.selectedCamera&&Object(src.d)(state.devices)},reduceCallControlsForMobile=function reduceCallControlsForMobile(callControlOptions){if(!1===callControlOptions)return!1;var reduceCallControlOptions=!0===callControlOptions?{}:callControlOptions||{};return reduceCallControlOptions.displayType="compact",!0!==reduceCallControlOptions.screenShareButton&&(reduceCallControlOptions.screenShareButton=!1),reduceCallControlOptions};!function(CallEndReasons){CallEndReasons[CallEndReasons.LEFT_CALL=0]="LEFT_CALL",CallEndReasons[CallEndReasons.ACCESS_DENIED=1]="ACCESS_DENIED",CallEndReasons[CallEndReasons.REMOVED_FROM_CALL=2]="REMOVED_FROM_CALL"}(CallEndReasons||(CallEndReasons={}));var Utils_getCallCompositePage=function getCallCompositePage(call,previousCall){if(call)return Object(src.c)(null==call?void 0:call.state)?"lobby":Object(src.b)(null==call?void 0:call.state)?"call":"configuration";if(previousCall)switch(function getCallEndReason(call){var _call$callEndReason,_call$callEndReason2;if(null!==(_call$callEndReason=call.callEndReason)&&void 0!==_call$callEndReason&&_call$callEndReason.subCode&&5854===call.callEndReason.subCode)return CallEndReasons.ACCESS_DENIED;if(null!==(_call$callEndReason2=call.callEndReason)&&void 0!==_call$callEndReason2&&_call$callEndReason2.subCode&&REMOVED_FROM_CALL_SUB_CODES.includes(call.callEndReason.subCode))return CallEndReasons.REMOVED_FROM_CALL;if(call.callEndReason)return CallEndReasons.LEFT_CALL;throw new Error("No matching call end reason")}(previousCall)){case CallEndReasons.ACCESS_DENIED:return"accessDeniedTeamsMeeting";case CallEndReasons.REMOVED_FROM_CALL:return"removedFromCall";case CallEndReasons.LEFT_CALL:return previousCall.diagnostics.network.latest.noNetwork?"joinCallFailedDueToNoNetwork":"leftCall"}return"configuration"},computeVariant=function computeVariant(callRecordState,callTranscribeState){return"on"===callRecordState&&"on"===callTranscribeState?"RECORDING_AND_TRANSCRIPTION_STARTED":"on"===callRecordState&&"off"===callTranscribeState?"RECORDING_STARTED":"off"===callRecordState&&"on"===callTranscribeState?"TRANSCRIPTION_STARTED":"on"===callRecordState&&"stopped"===callTranscribeState?"TRANSCRIPTION_STOPPED_STILL_RECORDING":"stopped"===callRecordState&&"on"===callTranscribeState?"RECORDING_STOPPED_STILL_TRANSCRIBING":"off"===callRecordState&&"stopped"===callTranscribeState?"TRANSCRIPTION_STOPPED":"stopped"===callRecordState&&"off"===callTranscribeState?"RECORDING_STOPPED":"stopped"===callRecordState&&"stopped"===callTranscribeState?"RECORDING_AND_TRANSCRIPTION_STOPPED":"NO_STATE"}},191:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return COMPOSITE_STRING_CONNECTIONSTRING})),__webpack_require__.d(__webpack_exports__,"b",(function(){return CompositeConnectionParamsErrMessage}));__webpack_require__(34),__webpack_require__(1);var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2),COMPOSITE_STRING_CONNECTIONSTRING="Connection String",CompositeConnectionParamsErrMessage=function CompositeConnectionParamsErrMessage(errors){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:errors.map((function(error,idx){return error?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{children:error},idx):null}))})};CompositeConnectionParamsErrMessage.__docgenInfo={description:"",methods:[],displayName:"CompositeConnectionParamsErrMessage"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CompositeStringUtils.tsx"]={name:"CompositeConnectionParamsErrMessage",docgenInfo:CompositeConnectionParamsErrMessage.__docgenInfo,path:"stories/CompositeStringUtils.tsx"})},200:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return FluentThemeProvider})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useTheme}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_fluentui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(22),_fluentui_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(376),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1543),_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(498),_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1540),_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1541),_themes__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(103),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2),wrapper=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.H)({height:"100%",width:"100%",overflow:"auto"}),defaultTheme=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.a)(Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.C)(),_themes__WEBPACK_IMPORTED_MODULE_7__.b),ThemeContext=Object(react__WEBPACK_IMPORTED_MODULE_0__.createContext)(defaultTheme),initialFluentNorthstarTheme=Object(_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_4__.f)(_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_5__.a,{componentVariables:{ChatMessage:{linkColor:void 0,linkColorMine:void 0}},componentStyles:{ChatMessage:{root:{lineHeight:"1.4286"}}},fontFaces:[],siteVariables:{bodyPadding:void 0,bodyFontSize:void 0,bodyFontFamily:void 0,bodyBackground:void 0,bodyColor:void 0,bodyLineHeight:void 0}}),FluentThemeProvider=function FluentThemeProvider(props){var fluentTheme=props.fluentTheme,rtl=props.rtl,children=props.children,fluentUITheme=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.a)(defaultTheme,fluentTheme);fluentUITheme=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.a)(fluentUITheme,{rtl:rtl});var fluentNorthstarTheme=Object(_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_4__.f)(initialFluentNorthstarTheme,{componentVariables:{Chat:{backgroundColor:fluentUITheme.palette.white},ChatMessage:{authorColor:fluentUITheme.palette.neutralPrimary,contentColor:fluentUITheme.palette.neutralPrimary,backgroundColor:fluentUITheme.palette.neutralLighter,backgroundColorMine:fluentUITheme.palette.themeLight}},componentStyles:{ChatMessage:{timestamp:{WebkitTextFillColor:fluentUITheme.palette.neutralSecondary}}}});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(ThemeContext.Provider,{value:fluentUITheme,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.a,{theme:fluentUITheme,className:wrapper,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_6__.a,{theme:fluentNorthstarTheme,className:wrapper,rtl:rtl,children:children})})})};FluentThemeProvider.displayName="FluentThemeProvider";var useTheme=function useTheme(){return Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(ThemeContext)};FluentThemeProvider.__docgenInfo={description:"Provider to apply a Fluent theme across this library's react components.\n\n@remarks Components in this library are composed primarily from [Fluent UI](https://developer.microsoft.com/fluentui#/controls/web),\ncontrols, and also from [Fluent React Northstar](https://fluentsite.z22.web.core.windows.net/0.53.0) controls.\nThis provider handles applying any theme provided to both the underlying Fluent UI controls, as well as the Fluent React Northstar controls.\n\n@public",methods:[],displayName:"FluentThemeProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Children to be themed."},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Theme for components. Defaults to a light theme if not provided."},rtl:{required:!1,tsType:{name:"boolean"},description:"Whether components are displayed right-to-left\n@defaultValue `false`"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/theming/FluentThemeProvider.tsx"]={name:"FluentThemeProvider",docgenInfo:FluentThemeProvider.__docgenInfo,path:"../react-components/src/theming/FluentThemeProvider.tsx"})},201:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return SingleLineBetaBanner})),__webpack_require__.d(__webpack_exports__,"a",(function(){return FloatingSingleLineBetaBanner}));__webpack_require__(802),__webpack_require__(7);var _fluentui_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(69),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(499),_fluentui_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(898),_fluentui_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(22),_constants__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__(1),__webpack_require__(14)),_BannerPalettes__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(475),_ImportantBannerHeading__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(476),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2),SingleLineBetaBanner=function SingleLineBetaBanner(props){var _props$palette,palette=null!==(_props$palette=props.palette)&&void 0!==_props$palette?_props$palette:_BannerPalettes__WEBPACK_IMPORTED_MODULE_8__.a;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.a,{className:bannerContainerStyles(palette.background),children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.a.Item,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_ImportantBannerHeading__WEBPACK_IMPORTED_MODULE_9__.a,{color:palette.header})," - ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.a,{children:"This feature is currently in public preview and not recommended for production use."})," ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_4__.a,{className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_5__.H)({color:palette.link}),underline:!0,href:_constants__WEBPACK_IMPORTED_MODULE_7__.f,target:"_blank",children:"More info."})]})})};SingleLineBetaBanner.displayName="SingleLineBetaBanner";var FloatingSingleLineBetaBanner=function FloatingSingleLineBetaBanner(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.a,{className:floatingStyles,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(SingleLineBetaBanner,Object.assign({},props))})};FloatingSingleLineBetaBanner.displayName="FloatingSingleLineBetaBanner";var bannerContainerStyles=function bannerContainerStyles(backgroundColor){return Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_5__.H)({background:backgroundColor,padding:"1rem"})},floatingStyles=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_5__.H)({position:"absolute",top:"0",width:"100%",textAlign:"center"});SingleLineBetaBanner.__docgenInfo={description:"@private",methods:[],displayName:"SingleLineBetaBanner",props:{palette:{required:!1,tsType:{name:"BannerPalette"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/BetaBanners/SingleLineBetaBanner.tsx"]={name:"SingleLineBetaBanner",docgenInfo:SingleLineBetaBanner.__docgenInfo,path:"stories/BetaBanners/SingleLineBetaBanner.tsx"}),FloatingSingleLineBetaBanner.__docgenInfo={description:"@private",methods:[],displayName:"FloatingSingleLineBetaBanner",props:{palette:{required:!1,tsType:{name:"BannerPalette"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/BetaBanners/SingleLineBetaBanner.tsx"]={name:"FloatingSingleLineBetaBanner",docgenInfo:FloatingSingleLineBetaBanner.__docgenInfo,path:"stories/BetaBanners/SingleLineBetaBanner.tsx"})},202:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _azure_communication_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(80),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4),_BetaBanners_SingleLineBetaBanner__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(1),__webpack_require__(201)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2),containerText=__webpack_require__(1375).default,customDataModelExampleContainerText=__webpack_require__(1376).default,customBehaviorExampleText=__webpack_require__(1377).default,getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.j,{children:"ChatComposite"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"ChatComposite brings together key components to provide a full chat experience out of the box."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"Note that ChatComposite has a min width and height of respectively 19.5rem and 20rem (312px x 320px, with default rem at 16px)."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Basic usage"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"There are two parts to the composite - a `ChatComposite` react component and a `ChatAdapter` that connects the react component to the backend APIs."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"The key thing to note is that initialization of `ChatAdapter` is asynchronous. Thus, the initialization step requires special handling, as the example code below shows."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.h,{code:containerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Prerequisites"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"ChatComposite provides the UI for an *existing user* in an *existing thread*. Thus, the user and thread must be created beforehand. Typically, the user and thread are created on a Contoso-owned service and authentication tokens are served to the client application that then passes it to the ChatComposite."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Theming"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"ChatComposite can be themed with Fluent UI themes, just like the base components. Look at the [ChatComposite themes canvas](./?path=/story/composites-chat-themeexample--theme-example) to see theming in action or the [overall theming example](./?path=/story/theming--page) to see how theming works for all the components in this UI library."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Fonts"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"Custom fonts can be applied to the ChatComposite using the in built theming mechanism. Look at the [ChatComposite themes canvas](./?path=/story/composites-chat-themeexample--theme-example) to see custom fonts in action or the [overall theming example](./?path=/story/theming--page) to see how theming works for all the components in this UI library. Read more about fonts in [Fluent UI Typography here](https://developer.microsoft.com/fluentui#/styles/web/typography)."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Icons"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"Custom icons can be applied to the Composite using `icons` prop exposed by the Composite. The `icons` prop accepts an object where you can provide a custom JSX element against an icon name key."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Hiding/Showing UI Elements"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"Some UI elements of the composite can be hidden if desired using the ChatAdapter `options` interface. Currently we support hiding the `Topic Header`:"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.h,{code:"\n<ChatComposite options={{ topic: false}}>\n"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Participant Pane"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_BetaBanners_SingleLineBetaBanner__WEBPACK_IMPORTED_MODULE_3__.b,{}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"You can also show a `Participant Pane` to the right hand side of the chat that has support for removing users. The Participant pane is a `beta` feature. Currently it does not support mobile views and is subject to breaking changes."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.h,{code:"\n// Caution: the Participant Pane is a beta feature\n<ChatComposite options={{ participantPane: true}}>\n"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Running in a Mobile browser"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"Unlike the CallComposite and CallWithChatComposite, the ChatComposite has no `formFactor` property. Instead the composite is responsive to the container it is in and should perform optimally on mobile and desktop automatically."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Custom Data Model"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"It is a primary tenet of Azure Communication Services that customers bring their own user identities. Customers then use the Azure Communication Services identity service to create corresponding authentication tokens for their users. The ChatComposite allows developers to easily inject custom data associated with these user identities. Look at the [example canvas](./?path=/story/composites-chat-customdatamodelexample--custom-data-model-example) to see how the name and avatar displayed for users can be provided by Contoso."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"Note that, by default, the initials text color is setup to `white`"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.h,{code:customDataModelExampleContainerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"See the [Custom data model example documentation](./?path=/docs/customuserdatamodel--page) to understand how custom data model can be injected for all the components in this UI library."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Customize Behavior"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"The `ChatAdapter` makes it possible to arbitrarily modify the communication between the `ChatComposite` component and the Azure Communication Services backend. This adds powerful customization possibilities. The [Customized Behavior Example](./?path=/story/composites-chat-custombehaviorexample--custom-behavior-example) shows a way to intercept messages entered by the user and modify them before sending them on to the backend."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.h,{code:customBehaviorExampleText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Joining existing Chat"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"The [join existing chat thread](./?path=/story/composites-chat-joinexistingchatthread--join-existing-chat-thread) provides an easy playground to join an existing Azure Communication Services chat thread. This is useful if you want to explore the composite with multiple users."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Chat Composite Props"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.g,{of:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.ChatComposite})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/ChatCompositeDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/ChatComposite/ChatCompositeDocs.tsx"})},21:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"I",(function(){return TypingIndicator_TypingIndicator})),__webpack_require__.d(__webpack_exports__,"u",(function(){return ErrorBar_ErrorBar})),__webpack_require__.d(__webpack_exports__,"w",(function(){return GridLayout_GridLayout})),__webpack_require__.d(__webpack_exports__,"G",(function(){return SendBox_SendBox})),__webpack_require__.d(__webpack_exports__,"z",(function(){return MessageStatusIndicator_MessageStatusIndicator})),__webpack_require__.d(__webpack_exports__,"A",(function(){return MessageThread_MessageThread})),__webpack_require__.d(__webpack_exports__,"H",(function(){return StreamMedia_StreamMedia})),__webpack_require__.d(__webpack_exports__,"C",(function(){return ParticipantItem_ParticipantItem})),__webpack_require__.d(__webpack_exports__,"D",(function(){return ParticipantList_ParticipantList})),__webpack_require__.d(__webpack_exports__,"J",(function(){return VideoGallery_VideoGallery})),__webpack_require__.d(__webpack_exports__,"x",(function(){return LocalVideoCameraButton_LocalVideoCameraCycleButton})),__webpack_require__.d(__webpack_exports__,"o",(function(){return CameraButton_CameraButton})),__webpack_require__.d(__webpack_exports__,"p",(function(){return ControlBar_ControlBar})),__webpack_require__.d(__webpack_exports__,"q",(function(){return ControlBarButton_ControlBarButton})),__webpack_require__.d(__webpack_exports__,"t",(function(){return EndCallButton_EndCallButton})),__webpack_require__.d(__webpack_exports__,"B",(function(){return MicrophoneButton_MicrophoneButton})),__webpack_require__.d(__webpack_exports__,"s",(function(){return DevicesButton_DevicesButton})),__webpack_require__.d(__webpack_exports__,"E",(function(){return ParticipantsButton_ParticipantsButton})),__webpack_require__.d(__webpack_exports__,"F",(function(){return ScreenShareButton_ScreenShareButton})),__webpack_require__.d(__webpack_exports__,"K",(function(){return VideoTile_VideoTile})),__webpack_require__.d(__webpack_exports__,"L",(function(){return DrawerMenu_DrawerMenu})),__webpack_require__.d(__webpack_exports__,"c",(function(){return locales.c})),__webpack_require__.d(__webpack_exports__,"b",(function(){return locales.b})),__webpack_require__.d(__webpack_exports__,"a",(function(){return locales.a})),__webpack_require__.d(__webpack_exports__,"d",(function(){return locales.d})),__webpack_require__.d(__webpack_exports__,"e",(function(){return locales.e})),__webpack_require__.d(__webpack_exports__,"f",(function(){return locales.f})),__webpack_require__.d(__webpack_exports__,"g",(function(){return locales.g})),__webpack_require__.d(__webpack_exports__,"h",(function(){return locales.h})),__webpack_require__.d(__webpack_exports__,"i",(function(){return locales.i})),__webpack_require__.d(__webpack_exports__,"j",(function(){return locales.j})),__webpack_require__.d(__webpack_exports__,"k",(function(){return locales.k})),__webpack_require__.d(__webpack_exports__,"l",(function(){return locales.l})),__webpack_require__.d(__webpack_exports__,"m",(function(){return locales.m})),__webpack_require__.d(__webpack_exports__,"n",(function(){return locales.n})),__webpack_require__.d(__webpack_exports__,"y",(function(){return LocalizationProvider_LocalizationProvider})),__webpack_require__.d(__webpack_exports__,"v",(function(){return theming.b})),__webpack_require__.d(__webpack_exports__,"M",(function(){return theming.e})),__webpack_require__.d(__webpack_exports__,"r",(function(){return theming.a}));__webpack_require__(125),__webpack_require__(70),__webpack_require__(114),__webpack_require__(104),__webpack_require__(56),__webpack_require__(62),__webpack_require__(7),__webpack_require__(900),__webpack_require__(123),__webpack_require__(23),__webpack_require__(12),__webpack_require__(15),__webpack_require__(28),__webpack_require__(16),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(17),__webpack_require__(18),__webpack_require__(40);var lib=__webpack_require__(22),typingIndicatorContainerStyle=Object(lib.H)({minHeight:"2.125rem",flexFlow:"column-reverse"}),typingIndicatorStringStyle=Object(lib.H)({fontWeight:400,width:"100%",alignSelf:"center",wordBreak:"break-word"}),react=__webpack_require__(1),react_default=__webpack_require__.n(react),Text=__webpack_require__(499),Stack=__webpack_require__(69),locales=__webpack_require__(436),jsx_runtime=__webpack_require__(2),LocaleContext=Object(react.createContext)(locales.c),LocalizationProvider_LocalizationProvider=function LocalizationProvider(props){var locale=props.locale,children=props.children;return Object(jsx_runtime.jsx)(LocaleContext.Provider,{value:locale,children:children})};LocalizationProvider_LocalizationProvider.displayName="LocalizationProvider";var LocalizationProvider_useLocale=function useLocale(){return Object(react.useContext)(LocaleContext)};LocalizationProvider_LocalizationProvider.__docgenInfo={description:"Provider to provide localized strings for this library's react components.\n\n@remarks Components will be provided localized strings in English (US) by default if this\nprovider is not used.\n\n@public",methods:[],displayName:"LocalizationProvider",props:{locale:{required:!0,tsType:{name:"ComponentLocale"},description:"Locale context to provide components"},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Children to provide locale context."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/localization/LocalizationProvider.tsx"]={name:"LocalizationProvider",docgenInfo:LocalizationProvider_LocalizationProvider.__docgenInfo,path:"../react-components/src/localization/LocalizationProvider.tsx"});var defaultIdentifiers={sendboxTextField:"sendbox-textfield",participantButtonPeopleMenuItem:"participant-button-people-menu-item",participantItemMenuButton:"participant-item-menu-button",participantList:"participant-list",participantListPeopleButton:"participant-list-people-button",participantListRemoveParticipantButton:"participant-list-remove-participant-button",messageContent:"message-content",messageTimestamp:"message-timestamp",typingIndicator:"typing-indicator",videoGallery:"video-gallery",videoTile:"video-tile",horizontalGalleryLeftNavButton:"horizontal-gallery-left-nav-button",horizontalGalleryRightNavButton:"horizontal-gallery-right-nav-button"},IdentifierContext=Object(react.createContext)(defaultIdentifiers),IdentifierProvider_IdentifierProvider=function _IdentifierProvider(props){var identifiers=props.identifiers,children=props.children;return Object(jsx_runtime.jsx)(IdentifierContext.Provider,{value:null!=identifiers?identifiers:defaultIdentifiers,children:children})};IdentifierProvider_IdentifierProvider.displayName="_IdentifierProvider";var IdentifierProvider_useIdentifiers=function useIdentifiers(){return Object(react.useContext)(IdentifierContext)};function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}IdentifierProvider_IdentifierProvider.__docgenInfo={description:"React Context provider for {@link _Identifiers}.\n\n@experimental\n\nSee documentation for {@link _Identifiers}.\n\n@internal",methods:[],displayName:"_IdentifierProvider",props:{identifiers:{required:!1,tsType:{name:"_Identifiers"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/identifiers/IdentifierProvider.tsx"]={name:"_IdentifierProvider",docgenInfo:IdentifierProvider_IdentifierProvider.__docgenInfo,path:"../react-components/src/identifiers/IdentifierProvider.tsx"});var TypingIndicator_IndicatorComponent=function IndicatorComponent(typingUsers,strings,onRenderUser,styles){var _step,typingUsersMentioned=[],totalCharacterCount=0,ids=IdentifierProvider_useIdentifiers(),_iterator=_createForOfIteratorHelper(typingUsers);try{for(_iterator.s();!(_step=_iterator.n()).done;){var typingUser=_step.value;if(typingUser.displayName){var additionalCharCount=typingUser.displayName.length;if(typingUsersMentioned.length>0&&(additionalCharCount+=strings.delimiter.length),!(totalCharacterCount+additionalCharCount<=35||0===typingUsersMentioned.length))break;typingUsersMentioned.push(typingUser),totalCharacterCount+=additionalCharCount}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var usersElement=function getUsersElement(typingUsers,delimiter,onRenderUser,userDisplayNameStyles){var userElements=[];return typingUsers.forEach((function(user,index){userElements.push(onRenderUser?onRenderUser(user):Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(userDisplayNameStyles),children:user.displayName},"user-"+index)),userElements.push(Object(jsx_runtime.jsx)(Text.a,{children:""+delimiter},"comma-"+index))})),userElements.pop(),Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:userElements})}(typingUsersMentioned,strings.delimiter,onRenderUser,null==styles?void 0:styles.typingUserDisplayName),numUserNotMentioned=typingUsers.length-typingUsersMentioned.length,spanElements=function getSpanElements(strings,usersElement,numTypingUsers,numTypingUsersAbbreviated){var variables={},typingString="";return 1===numTypingUsers?(typingString=strings.singleUser,variables={user:usersElement}):numTypingUsers>1&&0===numTypingUsersAbbreviated?(typingString=strings.multipleUsers,variables={users:usersElement}):numTypingUsers>1&&1===numTypingUsersAbbreviated?(typingString=strings.multipleUsersAbbreviateOne,variables={users:usersElement}):numTypingUsers>1&&numTypingUsersAbbreviated>1&&(typingString=strings.multipleUsersAbbreviateMany,variables={users:usersElement,numOthers:Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:numTypingUsersAbbreviated})}),TypingIndicator_formatInlineElements(typingString,variables)}(strings,usersElement,typingUsers.length,numUserNotMentioned),labelString=function getIndicatorString(strings,namesString,numTypingUsers,numTypingUsersAbbreviated){return 1===numTypingUsers?strings.singleUser.replace("{user}",namesString):numTypingUsers>1&&0===numTypingUsersAbbreviated?strings.multipleUsers.replace("{users}",namesString):numTypingUsers>1&&1===numTypingUsersAbbreviated?strings.multipleUsersAbbreviateOne.replace("{users}",namesString):numTypingUsers>1&&numTypingUsersAbbreviated>1?strings.multipleUsersAbbreviateMany.replace("{users}",namesString).replace("{numOthers}",""+numTypingUsersAbbreviated):void 0}(strings,function getNamesString(typingUsers,delimiter){var userNames=[];return typingUsers.forEach((function(user){user.displayName&&userNames.push(user.displayName)})),userNames.join(delimiter)}(typingUsersMentioned,strings.delimiter),typingUsers.length,numUserNotMentioned);return Object(jsx_runtime.jsx)("div",{"data-ui-id":ids.typingIndicator,className:Object(lib.H)(typingIndicatorStringStyle,null==styles?void 0:styles.typingString),role:"status","aria-label":labelString,children:spanElements},"typingStringKey")};TypingIndicator_IndicatorComponent.displayName="IndicatorComponent";var TypingIndicator_TypingIndicator=function TypingIndicator(props){var typingUsers=props.typingUsers,onRenderUser=props.onRenderUser,styles=props.styles,strings=LocalizationProvider_useLocale().strings,typingUsersToRender=typingUsers.filter((function(typingUser){return void 0!==typingUser.displayName})),indicatorComponent=TypingIndicator_IndicatorComponent(typingUsersToRender,Object.assign({},strings.typingIndicator,props.strings),onRenderUser,styles);return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)(typingIndicatorContainerStyle,null==styles?void 0:styles.root),children:indicatorComponent})};TypingIndicator_TypingIndicator.displayName="TypingIndicator";var TypingIndicator_formatInlineElements=function formatInlineElements(str,vars){if(!str)return[];if(!vars)return[];for(var elements=[],regex=RegExp(/{(\w+)}/g),array=regex.exec(str),prev=0;null!==array;)prev!==array.index&&elements.push(Object(jsx_runtime.jsx)(Text.a,{children:str.substring(prev,array.index)},elements.length)),elements.push(Object(jsx_runtime.jsx)(Text.a,{children:vars[array[0].substring(1,array[0].length-1)]},elements.length)),prev=regex.lastIndex,array=regex.exec(str);return elements.push(Object(jsx_runtime.jsx)(Text.a,{children:str.substring(prev)},elements.length)),elements};TypingIndicator_TypingIndicator.__docgenInfo={description:"Component to notify local user when one or more participants in the chat thread are typing.\n\n@public",methods:[],displayName:"TypingIndicator",props:{typingUsers:{required:!0,tsType:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"},description:"List of the typing users."},onRenderUser:{required:!1,tsType:{name:"signature",type:"function",raw:"(users: CommunicationParticipant) => JSX.Element",signature:{arguments:[{name:"users",type:{name:"CommunicationParticipant"}}],return:{name:"JSX.Element"}}},description:"Callback to render typing users"},styles:{required:!1,tsType:{name:"TypingIndicatorStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<TypingIndicator styles={{ root: { background: 'blue' } }} />\n```"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"TypingIndicatorStrings"}],raw:"Partial<TypingIndicatorStrings>"},description:"Optional strings to override in component"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/TypingIndicator.tsx"]={name:"TypingIndicator",docgenInfo:TypingIndicator_TypingIndicator.__docgenInfo,path:"../react-components/src/components/TypingIndicator.tsx"});__webpack_require__(34),__webpack_require__(98),__webpack_require__(266),__webpack_require__(45),__webpack_require__(147),__webpack_require__(355);var MessageBar=__webpack_require__(616),MessageBar_types=__webpack_require__(59);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return ErrorBar_arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||ErrorBar_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ErrorBar_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=ErrorBar_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||ErrorBar_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ErrorBar_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return ErrorBar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ErrorBar_arrayLikeToArray(o,minLen):void 0}}function ErrorBar_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ErrorBar_ErrorBar=function ErrorBar(props){var _props$strings,localeStrings=LocalizationProvider_useLocale().strings.errorBar,strings=null!==(_props$strings=props.strings)&&void 0!==_props$strings?_props$strings:localeStrings,_useState2=_slicedToArray(Object(react.useState)([]),2),dismissedErrors=_useState2[0],setDismissedErrors=_useState2[1];Object(react.useEffect)((function(){return setDismissedErrors(dropDismissalsForInactiveErrors(props.activeErrorMessages,dismissedErrors))}),[props.activeErrorMessages,dismissedErrors]);var toShow=errorsToShow(props.activeErrorMessages,dismissedErrors);return Object(jsx_runtime.jsx)(Stack.a,{"data-ui-id":"error-bar-stack",children:toShow.map((function(error){return Object(react.createElement)(MessageBar.a,Object.assign({},props,{key:error.type,messageBarType:ErrorBar_messageBarType(error.type),messageBarIconProps:messageBarIconProps(error.type),onDismiss:function onDismiss(){return setDismissedErrors(dismissError(dismissedErrors,error))}}),strings[error.type])}))})};ErrorBar_ErrorBar.displayName="ErrorBar";var dismissError=function dismissError(dismissedErrors,toDismiss){var _step,now=new Date(Date.now()),_iterator=ErrorBar_createForOfIteratorHelper(dismissedErrors);try{for(_iterator.s();!(_step=_iterator.n()).done;){var error=_step.value;if(error.type===toDismiss.type)return error.dismissedAt=now,error.activeSince=toDismiss.timestamp,Array.from(dismissedErrors)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return[].concat(_toConsumableArray(dismissedErrors),[{type:toDismiss.type,dismissedAt:now,activeSince:toDismiss.timestamp}])},dropDismissalsForInactiveErrors=function dropDismissalsForInactiveErrors(activeErrorMessages,dismissedErrors){var _step2,active=new Map,_iterator2=ErrorBar_createForOfIteratorHelper(activeErrorMessages);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var message=_step2.value;active.set(message.type,message)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var shouldDeleteDismissal=function shouldDeleteDismissal(dismissed){return void 0===dismissed.activeSince&&void 0===active.get(dismissed.type)};return dismissedErrors.some((function(dismissed){return shouldDeleteDismissal(dismissed)}))?dismissedErrors.filter((function(dismissed){return!shouldDeleteDismissal(dismissed)})):dismissedErrors},errorsToShow=function errorsToShow(activeErrorMessages,dismissedErrors){var _step3,dismissed=new Map,_iterator3=ErrorBar_createForOfIteratorHelper(dismissedErrors);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var error=_step3.value;dismissed.set(error.type,error)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return activeErrorMessages.filter((function(error){var dismissal=dismissed.get(error.type);return!dismissal||!!error.timestamp&&error.timestamp>dismissal.dismissedAt}))},ErrorBar_messageBarType=function messageBarType(errorType){switch(errorType){case"callNetworkQualityLow":case"callNoSpeakerFound":case"callNoMicrophoneFound":case"callMicrophoneAccessDenied":case"callMicrophoneMutedBySystem":case"callMacOsMicrophoneAccessDenied":case"callLocalVideoFreeze":case"callCameraAccessDenied":case"callCameraAlreadyInUse":case"callMacOsCameraAccessDenied":case"callMacOsScreenShareAccessDenied":return MessageBar_types.a.warning;default:return MessageBar_types.a.error}},messageBarIconProps=function messageBarIconProps(errorType){var iconName=customIconName[errorType];return iconName?{iconName:iconName}:void 0},customIconName={callNetworkQualityLow:"ErrorBarCallNetworkQualityLow",callNoSpeakerFound:"ErrorBarCallNoSpeakerFound",callNoMicrophoneFound:"ErrorBarCallNoMicrophoneFound",callMicrophoneAccessDenied:"ErrorBarCallMicrophoneAccessDenied",callMicrophoneMutedBySystem:"ErrorBarCallMicrophoneMutedBySystem",callMacOsMicrophoneAccessDenied:"ErrorBarCallMacOsMicrophoneAccessDenied",callLocalVideoFreeze:"ErrorBarCallLocalVideoFreeze",callCameraAccessDenied:"ErrorBarCallCameraAccessDenied",callCameraAlreadyInUse:"ErrorBarCallCameraAlreadyInUse",callMacOsCameraAccessDenied:"ErrorBarCallMacOsCameraAccessDenied"};ErrorBar_ErrorBar.__docgenInfo={description:"A component to show error messages on the UI.\nAll strings that can be shown are accepted as the {@link ErrorBarProps.strings} so that they can be localized.\nActive errors are selected by {@link ErrorBarProps.activeErrorMessages}.\n\nThis component internally tracks dismissed by the user.\n  * Errors that have an associated timestamp: The error is shown on the UI again if it occurs after being dismissed.\n  * Errors that do not have a timestamp: The error is dismissed until it disappears from the props.\n        If the error recurs, it is shown in the UI.\n\nUses {@link @fluentui/react#MessageBar} UI element.\n\n@public",methods:[],displayName:"ErrorBar",props:{strings:{required:!1,tsType:{name:"ErrorBarStrings"},description:"Strings shown on the UI on errors."},activeErrorMessages:{required:!0,tsType:{name:"Array",elements:[{name:"ActiveErrorMessage"}],raw:"ActiveErrorMessage[]"},description:"Currently active errors."}},composes:["IMessageBarProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ErrorBar.tsx"]={name:"ErrorBar",docgenInfo:ErrorBar_ErrorBar.__docgenInfo,path:"../react-components/src/components/ErrorBar.tsx"});var gridLayoutStyle=Object(lib.H)({width:"100%",height:"100%",display:"grid",gridGap:"0.5rem"});function GridLayout_slicedToArray(arr,i){return function GridLayout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function GridLayout_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function GridLayout_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return GridLayout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GridLayout_arrayLikeToArray(o,minLen)}(arr,i)||function GridLayout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GridLayout_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var GridLayout_GridLayout=function GridLayout(props){var children=props.children,styles=props.styles,numberOfChildren=react_default.a.Children.count(children),_useState2=GridLayout_slicedToArray(Object(react.useState)(0),2),currentWidth=_useState2[0],setCurrentWidth=_useState2[1],_useState4=GridLayout_slicedToArray(Object(react.useState)(0),2),currentHeight=_useState4[0],setCurrentHeight=_useState4[1],containerRef=Object(react.useRef)(null),observer=Object(react.useRef)(new ResizeObserver((function(entries){var _entries$0$contentRec=entries[0].contentRect,width=_entries$0$contentRec.width,height=_entries$0$contentRec.height;setCurrentWidth(width),setCurrentHeight(height)})));Object(react.useEffect)((function(){containerRef.current&&observer.current.observe(containerRef.current);var currentObserver=observer.current;return function(){return currentObserver.disconnect()}}),[observer,containerRef]);var gridProps=Object(react.useMemo)((function(){return calculateGridProps(numberOfChildren,currentWidth,currentHeight)}),[numberOfChildren,currentWidth,currentHeight]),cssGridStyles=Object(react.useMemo)((function(){return GridLayout_createGridStyles(numberOfChildren,gridProps)}),[numberOfChildren,gridProps]);return Object(jsx_runtime.jsx)("div",{ref:containerRef,className:Object(lib.H)(gridLayoutStyle,cssGridStyles,null==styles?void 0:styles.root),children:children})};GridLayout_GridLayout.displayName="GridLayout";var isCloserThan=function isCloserThan(a,b,target){return Math.abs(target-a)<Math.abs(target-b)},calculateGridProps=function calculateGridProps(numberOfItems,width,height){if(numberOfItems<=0)return{fillDirection:"horizontal",rows:0,columns:0};if(width<=0||height<=0)return{fillDirection:"horizontal",rows:Math.ceil(Math.sqrt(numberOfItems)),columns:Math.ceil(Math.sqrt(numberOfItems))};var aspectRatio=width/height,rows=Math.floor(Math.sqrt(1.7777777777777777/aspectRatio*numberOfItems))||1;rows=Math.min(rows,numberOfItems);for(var columns=Math.ceil(numberOfItems/rows),fillDirection="horizontal";rows<numberOfItems;){if(!(rows/columns*aspectRatio<.8888888888888888)){if(numberOfItems<rows*columns){var canStretchVertically=numberOfItems>=rows+(columns-1)*(rows-1),canStretchHorizontally=numberOfItems>=columns+(rows-1)*(columns-1);if(!canStretchVertically&&!canStretchHorizontally){rows+=1,columns=Math.ceil(numberOfItems/rows);continue}if(!canStretchVertically)break;if(!canStretchHorizontally){fillDirection="vertical";break}var verticallyStretchedCellRatio=(rows-1)/columns*aspectRatio;verticallyStretchedCellRatio>=.8888888888888888&&isCloserThan(verticallyStretchedCellRatio,rows/(columns-1)*aspectRatio,1.7777777777777777)&&(fillDirection="vertical")}break}rows+=1,columns=Math.ceil(numberOfItems/rows)}return{fillDirection:fillDirection,rows:rows,columns:columns}},GridLayout_createGridStyles=function createGridStyles(numberOfItems,gridProps){var _ref,isHorizontal="horizontal"===gridProps.fillDirection,blocks=isHorizontal?gridProps.rows:gridProps.columns,smallCellsPerBlock=Math.ceil(numberOfItems/blocks),bigCellsPerBlock=Math.floor(numberOfItems/blocks),numBigCells=(gridProps.rows*gridProps.columns-numberOfItems)*bigCellsPerBlock,units=smallCellsPerBlock*bigCellsPerBlock,gridStyles=isHorizontal?{gridTemplateColumns:"repeat("+units+", minmax(0, 1fr))",gridTemplateRows:"repeat("+blocks+", minmax(0, 1fr))",gridAutoFlow:"row"}:{gridTemplateColumns:"repeat("+blocks+", minmax(0, 1fr))",gridTemplateRows:"repeat("+units+", minmax(0, 1fr))",gridAutoFlow:"column"},smallCellStyle=isHorizontal?{"> *":{gridColumn:"auto / span "+units/smallCellsPerBlock}}:{"> *":{gridRow:"auto / span "+units/smallCellsPerBlock}},bigCellStyle=numBigCells?((_ref={})["> *:nth-last-child(-n + "+numBigCells+")"]=isHorizontal?{gridColumn:"auto / span "+units/bigCellsPerBlock}:{gridRow:"auto / span "+units/bigCellsPerBlock},_ref):{};return Object(lib.H)(gridStyles,smallCellStyle,bigCellStyle)};GridLayout_GridLayout.__docgenInfo={description:"A component to lay out audio / video participants tiles in a call.\n\n@public",methods:[],displayName:"GridLayout",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},styles:{required:!1,tsType:{name:"BaseCustomStyles"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<GridLayout styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/GridLayout.tsx"]={name:"GridLayout",docgenInfo:GridLayout_GridLayout.__docgenInfo,path:"../react-components/src/components/GridLayout.tsx"});var Icon_Icon=__webpack_require__(884),sendBoxWrapperStyles=Object(lib.H)({margin:"0.25rem",overflow:"hidden",":not(:first-child)":{marginTop:"0.25rem"}}),sendBoxStyle=Object(lib.H)({paddingRight:"2rem"}),sendButtonStyle=Object(lib.H)({height:"1.25rem",width:"1.25rem",marginRight:"0.313rem"}),sendIconStyle=Object(lib.H)({width:"1.25rem",height:"1.25rem",margin:"auto"}),SendBox_styles_borderAndBoxShadowStyle=(Object(lib.H)({width:"100%",padding:"0.50rem"}),function borderAndBoxShadowStyle(props){var theme=props.theme,errorColor=props.errorColor,hasErrorMessage=props.hasErrorMessage,disabled=props.disabled,borderColor=hasErrorMessage?errorColor:theme.palette.neutralSecondary,borderColorActive=hasErrorMessage?errorColor:theme.palette.themePrimary,borderThickness=disabled?0:.0625,borderActiveThickness=disabled?0:.125;return{borderRadius:theme.effects.roundedCorner4,border:borderThickness+"rem solid "+borderColor,margin:.125-borderThickness+"rem",":hover, :active, :focus, :focus-within":{border:borderActiveThickness+"rem solid "+borderColorActive,margin:.125-borderActiveThickness+"rem"}}}),theming=__webpack_require__(77),TextField=__webpack_require__(1737),TooltipHost=__webpack_require__(1734),IconButton=__webpack_require__(1752),inputBoxWrapperStyle=Object(lib.H)({padding:"0"}),inputBoxStyle=Object(lib.H)({overflow:"auto",minHeight:"2.25rem",maxHeight:"8.25rem",outline:"red 5px",fontWeight:lib.e.regular,fontSize:"0.875rem",width:"100%",height:"2.25rem",lineHeight:"1.5rem","::-webkit-input-placeholder":{fontSize:"0.875rem"},"::-moz-placeholder":{fontSize:"0.875rem"},":-moz-placeholder":{fontSize:"0.875rem"}}),inputBoxNewLineSpaceAffordance={marginBottom:"2rem"},textContainerStyle={alignSelf:"center",position:"relative",width:"100%"},inputButtonStyle=Object(lib.H)({color:"grey",margin:"auto",width:"1.0625rem",height:"1.0625rem","&:hover":{backgroundColor:"transparent"}}),inlineButtonsContainerStyle={position:"absolute",right:"0.3rem",top:"0",bottom:"0",gap:"0.25rem",alignItems:"center"},newLineButtonsContainerStyle={position:"absolute",right:"0.8rem",bottom:"0.8rem",gap:"1rem"},inputButtonTooltipStyle=Object(lib.H)({display:"flex"}),isDarkThemed=(__webpack_require__(1286),__webpack_require__(255),__webpack_require__(769),function isDarkThemed(theme){var themeBlackBrightness=getPerceptualBrightnessOfHexColor(theme.palette.black),themeWhiteBrightness=getPerceptualBrightnessOfHexColor(theme.palette.white);return!Number.isNaN(themeBlackBrightness)&&!Number.isNaN(themeWhiteBrightness)&&themeBlackBrightness>themeWhiteBrightness}),getPerceptualBrightnessOfHexColor=function getPerceptualBrightnessOfHexColor(hexColor){return/^#[0-9A-Fa-f]{6}$/i.test(hexColor)?(parseInt(hexColor.substring(1,3),16)+parseInt(hexColor.substring(3,5),16)+parseInt(hexColor.substring(5,7),16))/3:NaN};function InputBoxComponent_slicedToArray(arr,i){return function InputBoxComponent_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function InputBoxComponent_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function InputBoxComponent_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return InputBoxComponent_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return InputBoxComponent_arrayLikeToArray(o,minLen)}(arr,i)||function InputBoxComponent_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function InputBoxComponent_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var InputBoxComponent_InputBoxComponent=function InputBoxComponent(props){var styles=props.styles,id=props.id,dataUiId=props["data-ui-id"],textValue=props.textValue,onChange=props.onChange,textFieldRef=props.textFieldRef,placeholderText=props.placeholderText,onKeyDown=props.onKeyDown,onEnterKeyDown=props.onEnterKeyDown,supportNewline=props.supportNewline,inputClassName=props.inputClassName,errorMessage=props.errorMessage,disabled=props.disabled,children=props.children,theme=Object(theming.e)(),mergedRootStyle=Object(lib.H)(inputBoxWrapperStyle,null==styles?void 0:styles.root),mergedTextFiledStyle=Object(lib.H)(inputBoxStyle,inputClassName,props.inlineChildren?{}:inputBoxNewLineSpaceAffordance),mergedTextContainerStyle=Object(lib.H)(textContainerStyle,null==styles?void 0:styles.textFieldContainer),mergedTextFieldStyle=Object(lib.r)(function textFieldStyle(errorColor){return{root:{width:"100%",minHeight:"0",fontSize:"8.25rem"},wrapper:{},fieldGroup:{outline:"none",border:"none",height:"auto",minHeight:"0",":after":{border:"none"}},field:{borderRadius:"0.25rem"},errorMessage:{color:errorColor}}}(isDarkThemed(theme)?"#f1707b":"#a80000"),{fieldGroup:null==styles?void 0:styles.textField,errorMessage:null==styles?void 0:styles.systemMessage}),onTexFieldKeyDown=Object(react.useCallback)((function(ev){ev.nativeEvent.isComposing||229===ev.nativeEvent.keyCode||229===ev.nativeEvent.which||("Enter"!==ev.key||!1!==ev.shiftKey&&supportNewline||(ev.preventDefault(),onEnterKeyDown&&onEnterKeyDown()),onKeyDown&&onKeyDown(ev))}),[onEnterKeyDown,onKeyDown,supportNewline]);return Object(jsx_runtime.jsx)(Stack.a,{className:mergedRootStyle,children:Object(jsx_runtime.jsxs)("div",{className:mergedTextContainerStyle,children:[Object(jsx_runtime.jsx)(TextField.a,{autoFocus:"sendBoxTextField"===props.autoFocus,"data-ui-id":dataUiId,multiline:!0,autoAdjustHeight:!0,multiple:!1,resizable:!1,componentRef:textFieldRef,id:id,inputClassName:mergedTextFiledStyle,placeholder:placeholderText,value:textValue,onChange:onChange,autoComplete:"off",onKeyDown:onTexFieldKeyDown,styles:mergedTextFieldStyle,disabled:disabled,errorMessage:errorMessage}),Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,className:Object(lib.H)(props.inlineChildren?inlineButtonsContainerStyle:newLineButtonsContainerStyle),children:children})]})})};InputBoxComponent_InputBoxComponent.displayName="InputBoxComponent";var InputBoxComponent_InputBoxButton=function InputBoxButton(props){var _onRenderIcon=props.onRenderIcon,onClick=props.onClick,ariaLabel=props.ariaLabel,className=props.className,id=props.id,tooltipContent=props.tooltipContent,_useState2=InputBoxComponent_slicedToArray(Object(react.useState)(!1),2),isHover=_useState2[0],setIsHover=_useState2[1],mergedButtonStyle=Object(lib.H)(inputButtonStyle,className);return Object(jsx_runtime.jsx)(TooltipHost.a,{hostClassName:inputButtonTooltipStyle,content:tooltipContent,children:Object(jsx_runtime.jsx)(IconButton.a,{className:mergedButtonStyle,ariaLabel:ariaLabel,onClick:onClick,id:id,onMouseEnter:function onMouseEnter(){setIsHover(!0)},onMouseLeave:function onMouseLeave(){setIsHover(!1)},onRenderIcon:function onRenderIcon(){return _onRenderIcon(isHover)}})})};function SendBox_slicedToArray(arr,i){return function SendBox_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function SendBox_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function SendBox_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return SendBox_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SendBox_arrayLikeToArray(o,minLen)}(arr,i)||function SendBox_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SendBox_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}InputBoxComponent_InputBoxButton.displayName="InputBoxButton",InputBoxComponent_InputBoxComponent.__docgenInfo={description:"@private",methods:[],displayName:"InputBoxComponent",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""},inlineChildren:{required:!0,tsType:{name:"boolean"},description:"Inline child elements passed in. Setting to false will mean they are on a new line."},"data-ui-id":{required:!1,tsType:{name:"string"},description:""},id:{required:!1,tsType:{name:"string"},description:""},textValue:{required:!0,tsType:{name:"string"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(event: FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string | undefined) => void",signature:{arguments:[{name:"event",type:{name:"FormEvent",elements:[{name:"union",raw:"HTMLInputElement | HTMLTextAreaElement",elements:[{name:"HTMLInputElement"},{name:"HTMLTextAreaElement"}]}],raw:"FormEvent<HTMLInputElement | HTMLTextAreaElement>"}},{name:"newValue",type:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}}],return:{name:"void"}}},description:""},textFieldRef:{required:!1,tsType:{name:"ReactRefObject",raw:"React.RefObject<ITextField>",elements:[{name:"ITextField"}]},description:""},inputClassName:{required:!1,tsType:{name:"string"},description:""},placeholderText:{required:!1,tsType:{name:"string"},description:""},supportNewline:{required:!1,tsType:{name:"boolean"},description:""},maxLength:{required:!0,tsType:{name:"number"},description:""},onKeyDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(ev: React.KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>) => void",signature:{arguments:[{name:"ev",type:{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>",elements:[{name:"union",raw:"HTMLInputElement | HTMLTextAreaElement",elements:[{name:"HTMLInputElement"},{name:"HTMLTextAreaElement"}]}]}}],return:{name:"void"}}},description:""},onEnterKeyDown:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},errorMessage:{required:!1,tsType:{name:"union",raw:"string | React.ReactElement",elements:[{name:"string"},{name:"ReactReactElement",raw:"React.ReactElement"}]},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},styles:{required:!1,tsType:{name:"InputBoxStylesProps"},description:""},autoFocus:{required:!1,tsType:{name:"literal",value:"'sendBoxTextField'"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/InputBoxComponent.tsx"]={name:"InputBoxComponent",docgenInfo:InputBoxComponent_InputBoxComponent.__docgenInfo,path:"../react-components/src/components/InputBoxComponent.tsx"}),InputBoxComponent_InputBoxButton.__docgenInfo={description:"@private",methods:[],displayName:"InputBoxButton",props:{onRenderIcon:{required:!0,tsType:{name:"signature",type:"function",raw:"(isHover: boolean) => JSX.Element",signature:{arguments:[{name:"isHover",type:{name:"boolean"}}],return:{name:"JSX.Element"}}},description:""},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void",signature:{arguments:[{name:"e",type:{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLDivElement, MouseEvent>",elements:[{name:"HTMLDivElement"},{name:"MouseEvent"}]}}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""},id:{required:!1,tsType:{name:"string"},description:""},ariaLabel:{required:!1,tsType:{name:"string"},description:""},tooltipContent:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/InputBoxComponent.tsx"]={name:"InputBoxButton",docgenInfo:InputBoxComponent_InputBoxButton.__docgenInfo,path:"../react-components/src/components/InputBoxComponent.tsx"});var EMPTY_MESSAGE_REGEX=/^\s*$/,SendBox_SendBox=function SendBox(props){var disabled=props.disabled,systemMessage=props.systemMessage,supportNewline=props.supportNewline,onSendMessage=props.onSendMessage,onTyping=props.onTyping,onRenderIcon=props.onRenderIcon,onRenderSystemMessage=props.onRenderSystemMessage,styles=props.styles,autoFocus=props.autoFocus,theme=Object(theming.e)(),localeStrings=LocalizationProvider_useLocale().strings.sendBox,strings=Object.assign({},localeStrings,props.strings),ids=IdentifierProvider_useIdentifiers(),_useState2=SendBox_slicedToArray(Object(react.useState)(""),2),textValue=_useState2[0],setTextValue=_useState2[1],_useState4=SendBox_slicedToArray(Object(react.useState)(!1),2),textValueOverflow=_useState4[0],setTextValueOverflow=_useState4[1],sendTextFieldRef=react_default.a.useRef(null),sendMessageOnClick=function sendMessageOnClick(){var _sendTextFieldRef$cur;disabled||textValueOverflow||(EMPTY_MESSAGE_REGEX.test(textValue)||(onSendMessage&&onSendMessage(textValue),setTextValue("")),null===(_sendTextFieldRef$cur=sendTextFieldRef.current)||void 0===_sendTextFieldRef$cur||_sendTextFieldRef$cur.focus())},textTooLongMessage=textValueOverflow?strings.textTooLong:void 0,errorMessage=null!=systemMessage?systemMessage:textTooLongMessage,mergedSendButtonStyle=Object(react.useMemo)((function(){return Object(lib.H)(sendButtonStyle,null==styles?void 0:styles.sendMessageIconContainer)}),[null==styles?void 0:styles.sendMessageIconContainer]),mergedStyles=Object(react.useMemo)((function(){return Object(lib.r)(styles)}),[styles]),hasText=!!textValue,mergedSendIconStyle=Object(react.useMemo)((function(){return Object(lib.H)(sendIconStyle,{color:errorMessage||!hasText?theme.palette.neutralTertiary:theme.palette.themePrimary},null==styles?void 0:styles.sendMessageIcon)}),[errorMessage,hasText,theme,null==styles?void 0:styles.sendMessageIcon]),onRenderSendIcon=Object(react.useCallback)((function(isHover){return onRenderIcon?onRenderIcon(isHover):Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:isHover?"SendBoxSendHovered":"SendBoxSend",className:mergedSendIconStyle})}),[mergedSendIconStyle,onRenderIcon]);return Object(jsx_runtime.jsx)(Stack.a,{className:sendBoxWrapperStyles,children:Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.H)(SendBox_styles_borderAndBoxShadowStyle({theme:theme,errorColor:isDarkThemed(theme)?"#f1707b":"#a80000",hasErrorMessage:!!errorMessage,disabled:!!disabled})),children:[Object(jsx_runtime.jsx)(InputBoxComponent_InputBoxComponent,{autoFocus:autoFocus,"data-ui-id":ids.sendboxTextField,inlineChildren:!0,disabled:disabled,errorMessage:onRenderSystemMessage?onRenderSystemMessage(errorMessage):errorMessage,textFieldRef:sendTextFieldRef,id:"sendbox",inputClassName:sendBoxStyle,placeholderText:strings.placeholderText,textValue:textValue,onChange:function setText(event,newValue){void 0!==newValue&&(newValue.length>8e3?setTextValueOverflow(!0):setTextValueOverflow(!1),setTextValue(newValue))},onKeyDown:function onKeyDown(){onTyping&&onTyping()},onEnterKeyDown:function onEnterKeyDown(){sendMessageOnClick()},styles:mergedStyles,supportNewline:supportNewline,maxLength:8e3,children:Object(jsx_runtime.jsx)(InputBoxComponent_InputBoxButton,{onRenderIcon:onRenderSendIcon,onClick:function onClick(e){textValueOverflow||sendMessageOnClick(),e.stopPropagation()},id:"sendIconWrapper",className:mergedSendButtonStyle,ariaLabel:localeStrings.sendButtonAriaLabel,tooltipContent:localeStrings.sendButtonAriaLabel})}),props.onRenderFileUploads&&props.onRenderFileUploads()]})})};SendBox_SendBox.displayName="SendBox",SendBox_SendBox.__docgenInfo={description:"Component for typing and sending messages.\n\nSupports sending typing notification when user starts entering text.\nSupports an optional message below the text input field.\n\n@public",methods:[],displayName:"SendBox",props:{disabled:{required:!1,tsType:{name:"boolean"},description:"Optional boolean to disable text box\n@defaultValue false"},systemMessage:{required:!1,tsType:{name:"string"},description:"Optional text for system message below text box"},onSendMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(content: string) => Promise<void>",signature:{arguments:[{name:"content",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback called when message is sent"},onTyping:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback called when user is typing"},onRenderSystemMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(systemMessage: string | undefined) => React.ReactElement",signature:{arguments:[{name:"systemMessage",type:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}}],return:{name:"ReactReactElement",raw:"React.ReactElement"}}},description:"Optional callback to render system message below the SendBox.\n@defaultValue MessageBar"},supportNewline:{required:!1,tsType:{name:"boolean"},description:"Optional boolean to support new line in SendBox.\n@defaultValue false"},onRenderIcon:{required:!1,tsType:{name:"signature",type:"function",raw:"(isHover: boolean) => JSX.Element",signature:{arguments:[{name:"isHover",type:{name:"boolean"}}],return:{name:"JSX.Element"}}},description:"Optional callback to render send button icon to the right of the SendBox.\n@defaultValue SendBoxSendHovered icon when mouse over icon and SendBoxSend icon otherwise"},styles:{required:!1,tsType:{name:"SendBoxStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<SendBox styles={{ root: { background: 'blue' } }} />\n```"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"SendBoxStrings"}],raw:"Partial<SendBoxStrings>"},description:"Optional strings to override in component"},autoFocus:{required:!1,tsType:{name:"literal",value:"'sendBoxTextField'"},description:"enumerable to determine if the input box has focus on render or not.\nWhen undefined nothing has focus on render"},onRenderFileUploads:{required:!1,tsType:{name:"signature",type:"function",raw:"() => JSX.Element",signature:{arguments:[],return:{name:"JSX.Element"}}},description:"Optional callback to render uploaded files in the SendBox. The sendbox will expand\nveritcally to accomodate the uploaded files. File uploads will\nbe rendered below the text area in sendbox.\n@beta"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/SendBox.tsx"]={name:"SendBox",docgenInfo:SendBox_SendBox.__docgenInfo,path:"../react-components/src/components/SendBox.tsx"});var src=__webpack_require__(32),MessageStatusIndicatorErrorIconStyle=Object(lib.H)({marginRight:"-0.06rem",fontSize:"1.06rem"}),MessageStatusIndicatorIconStyle=Object(lib.H)({fontSize:"1rem",width:"1rem",height:"1rem"}),MessageStatusIndicator_MessageStatusIndicator=function MessageStatusIndicator(props){var status=props.status,styles=props.styles,messageThreadReadCount=props.messageThreadReadCount,remoteParticipantsCount=props.remoteParticipantsCount,localeStrings=LocalizationProvider_useLocale().strings.messageStatusIndicator,strings=Object.assign({},localeStrings,props.strings),theme=Object(theming.e)();switch(status){case"failed":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:strings.failedToSendTooltipText,children:Object(jsx_runtime.jsx)(Icon_Icon.a,{role:"status","aria-label":strings.failedToSendAriaLabel,iconName:"MessageFailed",className:Object(lib.H)(MessageStatusIndicatorErrorIconStyle,{color:theme.palette.redDark},null==styles?void 0:styles.root)})});case"sending":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:strings.sendingTooltipText,children:Object(jsx_runtime.jsx)(Icon_Icon.a,{role:"status","aria-label":strings.sendingAriaLabel,iconName:"MessageSending",className:Object(lib.H)(MessageStatusIndicatorIconStyle,{color:theme.palette.themePrimary},null==styles?void 0:styles.root)})});case"seen":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:1===messageThreadReadCount&&1===remoteParticipantsCount||0===messageThreadReadCount||remoteParticipantsCount&&remoteParticipantsCount<=0||!messageThreadReadCount||!remoteParticipantsCount||void 0===strings.readByTooltipText?strings.seenTooltipText:Object(src.b)(strings.readByTooltipText,{messageThreadReadCount:""+messageThreadReadCount,remoteParticipantsCount:""+remoteParticipantsCount}),children:Object(jsx_runtime.jsx)(Icon_Icon.a,{role:"status","aria-label":strings.seenAriaLabel,iconName:"MessageSeen",className:Object(lib.H)({color:theme.palette.themePrimary},null==styles?void 0:styles.root)})});case"delivered":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:strings.deliveredTooltipText,children:Object(jsx_runtime.jsx)(Icon_Icon.a,{role:"status","aria-label":strings.deliveredAriaLabel,iconName:"MessageDelivered",className:Object(lib.H)(MessageStatusIndicatorIconStyle,{color:theme.palette.themePrimary},null==styles?void 0:styles.root)})});default:return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}};MessageStatusIndicator_MessageStatusIndicator.__docgenInfo={description:"Component to display the status of a sent message.\n\nAdds an icon and tooltip corresponding to the message status.\n\n@public",methods:[],displayName:"MessageStatusIndicator",props:{status:{required:!1,tsType:{name:"MessageStatus"},description:"Message status that determines the icon to display."},messageThreadReadCount:{required:!1,tsType:{name:"number"},description:"how many people have read the message"},remoteParticipantsCount:{required:!1,tsType:{name:"number"},description:"number of participants not including myself"},styles:{required:!1,tsType:{name:"BaseCustomStyles"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<MessageStatus styles={{ root: { background: 'blue' } }} />\n```"},strings:{required:!1,tsType:{name:"MessageStatusIndicatorStrings"},description:"Optional strings to override in component"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/MessageStatusIndicator.tsx"]={name:"MessageStatusIndicator",docgenInfo:MessageStatusIndicator_MessageStatusIndicator.__docgenInfo,path:"../react-components/src/components/MessageStatusIndicator.tsx"});__webpack_require__(39);var Flex=__webpack_require__(886),Chat=__webpack_require__(1740),Ref=__webpack_require__(1741),messageThreadContainerStyle=Object(lib.H)({height:"100%",width:"100%",maxHeight:"100%",overflow:"auto",position:"relative",alignSelf:"center"}),noMessageStatusStyle=Object(lib.H)({width:"1rem"}),chatStyle={paddingBottom:"0.5rem",paddingTop:"0.8rem",border:"none",overflow:"auto"},newMessageButtonContainerStyle=Object(lib.H)({position:"absolute",zIndex:1,bottom:0,right:"1.5rem"}),defaultMyChatMessageContainer={maxWidth:"100%",minWidth:"6.25rem",marginLeft:"0rem"},defaultChatMessageContainer={maxWidth:"100%",minWidth:"6.25rem",marginRight:"0rem"," img":{maxWidth:"100% !important",height:"auto !important"}," p":{marginBlock:"0.125rem"}},gutterWithAvatar={width:"2",position:"relative",float:"left",display:"block",visibility:"visible",zIndex:2},gutterWithHiddenAvatar=Object.assign({},gutterWithAvatar,{visibility:"hidden",height:0}),MessageThread_styles_messageStatusContainerStyle=function messageStatusContainerStyle(mine){return Object(lib.H)({marginLeft:mine?"0.25rem":"0rem"})},newMessageButtonStyle=Object(lib.H)({float:"right",width:"fit-content"}),buttonWithIconStyles={textContainer:{display:"contents"}},DownIconStyle=(Object(lib.H)({border:"none",minHeight:"1.5rem","&:hover":{background:"none"},"&:active":{background:"none"}}),Object(lib.H)({marginRight:"0.5em"})),PrimaryButton=__webpack_require__(1721),Persona_types=__webpack_require__(27),Persona=__webpack_require__(1542),es=__webpack_require__(372),delay=(__webpack_require__(576),function delay(_delay){return new Promise((function(resolve){setTimeout(resolve,_delay)}))}),FontIcon=__webpack_require__(229),systemMessageIconStyle=Object(lib.H)({margin:"0 0.688rem 0 0"}),SystemMessage_SystemMessage=function SystemMessage(props){var iconName=props.iconName,content=props.content,Icon=Object(jsx_runtime.jsx)(FontIcon.a,{iconName:iconName,className:Object(lib.H)(systemMessageIconStyle)});return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.H)(null==props?void 0:props.containerStyle),children:[Icon,Object(jsx_runtime.jsx)(Text.a,{style:{wordBreak:"break-word"},role:"status",title:content,children:content})]})};SystemMessage_SystemMessage.displayName="SystemMessage",SystemMessage_SystemMessage.__docgenInfo={description:"@private",methods:[],displayName:"SystemMessage",props:{iconName:{required:!0,tsType:{name:"union",raw:"'PeopleAdd' | 'PeopleBlock' | 'Edit'",elements:[{name:"literal",value:"'PeopleAdd'"},{name:"literal",value:"'PeopleBlock'"},{name:"literal",value:"'Edit'"}]},description:"Icon name for the system message."},content:{required:!0,tsType:{name:"string"},description:"Content string for the system message."},containerStyle:{required:!1,tsType:{name:"ComponentSlotStyle"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/SystemMessage.tsx"]={name:"SystemMessage",docgenInfo:SystemMessage_SystemMessage.__docgenInfo,path:"../react-components/src/components/SystemMessage.tsx"});var FluentThemeProvider=__webpack_require__(200),EditBox_styles_editBoxStyle=function editBoxStyle(inlineEditButtons){return Object(lib.H)({marginTop:"0.0875rem",marginBottom:"0.0875rem",paddingRight:inlineEditButtons?"3.25rem":"0.5rem"})},editingButtonStyle=Object(lib.H)({margin:"auto .3rem"}),inputBoxIcon=Object(lib.H)({margin:"auto","&:hover svg":{stroke:"currentColor"}}),editBoxStyleSet={root:{width:"100%"}};function ChatMessageComponentAsEditBox_slicedToArray(arr,i){return function ChatMessageComponentAsEditBox_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ChatMessageComponentAsEditBox_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ChatMessageComponentAsEditBox_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ChatMessageComponentAsEditBox_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ChatMessageComponentAsEditBox_arrayLikeToArray(o,minLen)}(arr,i)||function ChatMessageComponentAsEditBox_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ChatMessageComponentAsEditBox_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ChatMessageComponentAsEditBox_onRenderCancelIcon=function onRenderCancelIcon(color){var className=Object(lib.H)(inputBoxIcon,{color:color});return Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"EditBoxCancel",className:className})};ChatMessageComponentAsEditBox_onRenderCancelIcon.displayName="onRenderCancelIcon";var ChatMessageComponentAsEditBox_onRenderSubmitIcon=function onRenderSubmitIcon(color){var className=Object(lib.H)(inputBoxIcon,{color:color});return Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"EditBoxSubmit",className:className})};ChatMessageComponentAsEditBox_onRenderSubmitIcon.displayName="onRenderSubmitIcon";var ChatMessageComponentAsEditBox_ChatMessageComponentAsEditBox=function ChatMessageComponentAsEditBox(props){var onCancel=props.onCancel,onSubmit=props.onSubmit,initialValue=props.initialValue,strings=props.strings,_useState2=ChatMessageComponentAsEditBox_slicedToArray(Object(react.useState)(initialValue),2),textValue=_useState2[0],setTextValue=_useState2[1],_useState4=ChatMessageComponentAsEditBox_slicedToArray(Object(react.useState)(!1),2),textValueOverflow=_useState4[0],setTextValueOverflow=_useState4[1],editTextFieldRef=react_default.a.useRef(null),theme=Object(FluentThemeProvider.b)();Object(react.useEffect)((function(){var _editTextFieldRef$cur;null===(_editTextFieldRef$cur=editTextFieldRef.current)||void 0===_editTextFieldRef$cur||_editTextFieldRef$cur.focus()}),[]);var textTooLongMessage=textValueOverflow?Object(src.b)(strings.editBoxTextLimit,{limitNumber:"8000"}):void 0,onRenderThemedCancelIcon=Object(react.useCallback)((function(){return ChatMessageComponentAsEditBox_onRenderCancelIcon(theme.palette.neutralSecondary)}),[theme.palette.neutralSecondary]),onRenderThemedSubmitIcon=Object(react.useCallback)((function(){return ChatMessageComponentAsEditBox_onRenderSubmitIcon(theme.palette.neutralSecondary)}),[theme.palette.neutralSecondary]),editBoxStyles=Object(react.useMemo)((function(){return Object(lib.r)(editBoxStyleSet,{textField:{borderColor:theme.palette.themePrimary}})}),[theme.palette.themePrimary]);return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)(SendBox_styles_borderAndBoxShadowStyle({theme:theme,errorColor:isDarkThemed(theme)?"#f1707b":"#a80000",hasErrorMessage:!1,disabled:!1})),children:Object(jsx_runtime.jsxs)(InputBoxComponent_InputBoxComponent,{inlineChildren:props.inlineEditButtons,id:"editbox",textFieldRef:editTextFieldRef,inputClassName:EditBox_styles_editBoxStyle(props.inlineEditButtons),placeholderText:strings.editBoxPlaceholderText,textValue:textValue,onChange:function setText(event,newValue){void 0!==newValue&&(newValue.length>8e3?setTextValueOverflow(!0):setTextValueOverflow(!1),setTextValue(newValue))},onEnterKeyDown:function onEnterKeyDown(){onSubmit(textValue)},supportNewline:!1,maxLength:8e3,errorMessage:textTooLongMessage,styles:editBoxStyles,children:[Object(jsx_runtime.jsx)(InputBoxComponent_InputBoxButton,{className:editingButtonStyle,ariaLabel:strings.editBoxCancelButton,tooltipContent:strings.editBoxCancelButton,onRenderIcon:onRenderThemedCancelIcon,onClick:function onClick(){onCancel&&onCancel()},id:"dismissIconWrapper"}),Object(jsx_runtime.jsx)(InputBoxComponent_InputBoxButton,{className:editingButtonStyle,ariaLabel:strings.editBoxSubmitButton,tooltipContent:strings.editBoxSubmitButton,onRenderIcon:onRenderThemedSubmitIcon,onClick:function onClick(e){textValueOverflow||""===textValue||onSubmit(textValue),e.stopPropagation()},id:"submitIconWrapper"})]})})};ChatMessageComponentAsEditBox_ChatMessageComponentAsEditBox.displayName="ChatMessageComponentAsEditBox",ChatMessageComponentAsEditBox_ChatMessageComponentAsEditBox.__docgenInfo={description:"@private",methods:[],displayName:"ChatMessageComponentAsEditBox",props:{onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(text: string) => void",signature:{arguments:[{name:"text",type:{name:"string"}}],return:{name:"void"}}},description:""},initialValue:{required:!0,tsType:{name:"string"},description:""},strings:{required:!0,tsType:{name:"MessageThreadStrings"},description:""},inlineEditButtons:{required:!0,tsType:{name:"boolean"},description:"Inline the accept and reject edit buttons when editing a message.\nSetting to false will mean they are on a new line inside the editable chat message."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ChatMessage/ChatMessageComponentAsEditBox.tsx"]={name:"ChatMessageComponentAsEditBox",docgenInfo:ChatMessageComponentAsEditBox_ChatMessageComponentAsEditBox.__docgenInfo,path:"../react-components/src/components/ChatMessage/ChatMessageComponentAsEditBox.tsx"});var Text_Text=__webpack_require__(272),chatActionsCSS={"ul&":{right:"0",left:"auto",top:"-1.625rem",bottom:"auto",position:"absolute"},"& a":{margin:"0",padding:"0",border:"0"}},iconWrapperStyle=Object(lib.H)({padding:"0.375rem",webkitBoxPack:"center",justifyContent:"center"}),ChatMessageComponent_styles_chatMessageDateStyle=Object(lib.H)({fontWeight:lib.e.semibold}),ChatMessageComponent_styles_chatMessageEditedTagStyle=function chatMessageEditedTagStyle(theme){return Object(lib.H)({fontWeight:lib.e.semibold,color:theme.palette.neutralSecondary})},chatMessageMenuStyle=Object(lib.H)({minWidth:"8.5rem",cursor:"pointer"}),menuItemIncreasedSizeStyles={root:{height:"3rem",lineHeight:"3rem",maxHeight:"unset"},linkContent:{height:"3rem",lineHeight:"3rem",maxHeight:"unset"},icon:{maxHeight:"unset"}},menuIconStyleSet={root:{height:"calc(100% - 8px)",width:"1.25rem"}},formatTimeForChatMessage=function formatTimeForChatMessage(messageDate){var hours=messageDate.getHours(),minutes=messageDate.getMinutes().toString(),isAm=hours<12;return hours>12&&(hours-=12),0===hours&&(hours=12),minutes.length<2&&(minutes="0"+minutes),hours.toString()+":"+minutes+" "+(isAm?"a.m.":"p.m.")},formatDateForChatMessage=function formatDateForChatMessage(messageDate){var year=messageDate.getFullYear().toString(),month=(messageDate.getMonth()+1).toString(),day=messageDate.getDate().toString();return 1===month.length&&(month="0"+month),1===day.length&&(day="0"+day),year+"-"+month+"-"+day},formatTimestampForChatMessage=function formatTimestampForChatMessage(messageDate,todayDate,dateStrings){if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()))return formatTimeForChatMessage(messageDate);if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-1))return dateStrings.yesterday+" "+formatTimeForChatMessage(messageDate);var weekDay=todayDate.getDay();return 0===weekDay?formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate):messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-weekDay)?dayToDayName(messageDate.getDay(),dateStrings)+" "+formatTimeForChatMessage(messageDate):formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate)},dayToDayName=function dayToDayName(day,dateStrings){switch(day){case 0:return dateStrings.sunday;case 1:return dateStrings.monday;case 2:return dateStrings.tuesday;case 3:return dateStrings.wednesday;case 4:return dateStrings.thursday;case 5:return dateStrings.friday;case 6:return dateStrings.saturday;default:throw new Error("Invalid day ["+day+"] passed")}},useTheme=__webpack_require__(369),ContextualMenu=__webpack_require__(1732),DirectionalHint=__webpack_require__(71),ChatMessageActionsFlyout_ChatMessageActionFlyout=function ChatMessageActionFlyout(props){var _props$messageReadBy,_props$messageReadBy2,theme=Object(useTheme.a)(),messageReadByCount=null===(_props$messageReadBy=props.messageReadBy)||void 0===_props$messageReadBy?void 0:_props$messageReadBy.length,messageReadByList=null===(_props$messageReadBy2=props.messageReadBy)||void 0===_props$messageReadBy2?void 0:_props$messageReadBy2.map((function(person){var personaOptions={hidePersonaDetails:!0,size:Persona_types.c.size24,text:person.name,styles:{root:{margin:"0.25rem"}}},onRenderAvatar=props.onRenderAvatar;return{key:person.name,text:person.name,itemProps:{styles:props.increaseFlyoutItemSize?menuItemIncreasedSizeStyles:void 0},onRenderIcon:function onRenderIcon(){var _person$id;return onRenderAvatar?onRenderAvatar(null!==(_person$id=person.id)&&void 0!==_person$id?_person$id:"",personaOptions):Object(jsx_runtime.jsx)(Persona.a,Object.assign({},personaOptions))},iconProps:{styles:menuIconStyleSet}}})),menuItems=Object(react.useMemo)((function(){var items=[{key:"Edit",text:props.strings.editMessage,itemProps:{styles:props.increaseFlyoutItemSize?menuItemIncreasedSizeStyles:void 0},iconProps:{iconName:"MessageEdit",styles:menuIconStyleSet},onClick:props.onEditClick},{key:"Remove",text:props.strings.removeMessage,itemProps:{styles:props.increaseFlyoutItemSize?menuItemIncreasedSizeStyles:void 0},iconProps:{iconName:"MessageRemove",styles:menuIconStyleSet},onClick:props.onRemoveClick}];return props.remoteParticipantsCount&&void 0!==messageReadByCount&&props.remoteParticipantsCount>=2&&props.strings.messageReadCount&&items.push({key:"Read Count",text:Object(src.b)(props.strings.messageReadCount,{messageReadByCount:""+messageReadByCount,remoteParticipantsCount:""+props.remoteParticipantsCount}),itemProps:{styles:Object(lib.r)({linkContent:{color:messageReadByCount>0?theme.palette.neutralPrimary:theme.palette.neutralTertiary},root:{borderTop:"1px solid "+theme.palette.neutralLighter}},props.increaseFlyoutItemSize?menuItemIncreasedSizeStyles:void 0)},subMenuProps:{items:null!=messageReadByList?messageReadByList:[]},iconProps:{iconName:"MessageSeen",styles:{root:{color:messageReadByCount>0?theme.palette.themeDarkAlt:theme.palette.neutralTertiary}}},submenuIconProps:{iconName:"HorizontalGalleryRightButton",styles:menuIconStyleSet},disabled:messageReadByCount<=0}),items}),[props.increaseFlyoutItemSize,props.onEditClick,props.onRemoveClick,props.strings.editMessage,props.strings.removeMessage,props.remoteParticipantsCount,messageReadByList,messageReadByCount]);return Object(jsx_runtime.jsx)(ContextualMenu.a,{alignTargetEdge:!0,gapSpace:5,isBeakVisible:!1,items:menuItems,hidden:props.hidden,target:props.target,onDismiss:props.onDismiss,directionalHint:DirectionalHint.a.topRightEdge,className:chatMessageMenuStyle})};ChatMessageActionsFlyout_ChatMessageActionFlyout.displayName="ChatMessageActionFlyout",ChatMessageActionsFlyout_ChatMessageActionFlyout.__docgenInfo={description:"Chat message actions flyout that contains actions such as Edit Message, or Remove Message.\n\n@private",methods:[],displayName:"ChatMessageActionFlyout",props:{target:{required:!1,tsType:{name:"Target"},description:""},hidden:{required:!0,tsType:{name:"boolean"},description:""},strings:{required:!0,tsType:{name:"MessageThreadStrings"},description:""},onEditClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onRemoveClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onDismiss:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},messageReadBy:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ id: string; name: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}}]}}],raw:"{ id: string; name: string }[]"},description:""},remoteParticipantsCount:{required:!1,tsType:{name:"number"},description:""},increaseFlyoutItemSize:{required:!0,tsType:{name:"boolean"},description:"Increase the height of the flyout items.\nRecommended when interacting with the chat message using touch."},onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:"Optional callback to override render of the avatar.\n\n@param userId - user Id"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ChatMessage/ChatMessageActionsFlyout.tsx"]={name:"ChatMessageActionFlyout",docgenInfo:ChatMessageActionsFlyout_ChatMessageActionFlyout.__docgenInfo,path:"../react-components/src/components/ChatMessage/ChatMessageActionsFlyout.tsx"});var html_to_react=__webpack_require__(864),dist=__webpack_require__(865),dist_default=__webpack_require__.n(dist),Link=__webpack_require__(898),ChatMessageContent_ChatMessageContent=function ChatMessageContent(props){switch(props.message.contentType){case"text":return ChatMessageContent_MessageContentAsText(props.message,props.liveAuthorIntro,props.userId,props.onRenderFileDownloads);case"html":case"richtext/html":return ChatMessageContent_MessageContentAsRichTextHTML(props.message,props.liveAuthorIntro,props.userId,props.onRenderFileDownloads);default:return console.warn("unknown message content type"),Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}},ChatMessageContent_MessageContentAsRichTextHTML=function MessageContentAsRichTextHTML(message,liveAuthorIntro,userId,onRenderFileDownloads){var htmlToReactParser=new html_to_react.Parser,liveAuthor=Object(src.b)(liveAuthorIntro,{author:""+message.senderDisplayName});return Object(jsx_runtime.jsxs)("div",{"data-ui-status":message.status,children:[Object(jsx_runtime.jsx)(es.b,{message:(message.mine?"":liveAuthor)+" "+extractContent(message.content||""),"aria-live":"polite"}),htmlToReactParser.parse(message.content),onRenderFileDownloads&&onRenderFileDownloads(userId,message)]})};ChatMessageContent_MessageContentAsRichTextHTML.displayName="MessageContentAsRichTextHTML";var ChatMessageContent_MessageContentAsText=function MessageContentAsText(message,liveAuthorIntro,userId,onRenderFileDownloads){var liveAuthor=Object(src.b)(liveAuthorIntro,{author:""+message.senderDisplayName});return Object(jsx_runtime.jsxs)("div",{"data-ui-status":message.status,children:[Object(jsx_runtime.jsx)(es.b,{message:(message.mine?"":liveAuthor)+" "+message.content,"aria-live":"polite"}),Object(jsx_runtime.jsxs)(dist_default.a,{componentDecorator:function componentDecorator(decoratedHref,decoratedText,key){return Object(jsx_runtime.jsx)(Link.a,{target:"_blank",href:decoratedHref,children:decoratedText},key)},children:[message.content,onRenderFileDownloads&&onRenderFileDownloads(userId,message)]})]})};ChatMessageContent_MessageContentAsText.displayName="MessageContentAsText";var extractContent=function extractContent(s){var span=document.createElement("span");return span.innerHTML=s,span.textContent||span.innerText};ChatMessageContent_ChatMessageContent.__docgenInfo={description:"@private",methods:[],displayName:"ChatMessageContent",props:{message:{required:!0,tsType:{name:"ChatMessage"},description:""},liveAuthorIntro:{required:!0,tsType:{name:"string"},description:""},userId:{required:!0,tsType:{name:"string"},description:""},onRenderFileDownloads:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, message: ChatMessage) => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"message",type:{name:"ChatMessage"}}],return:{name:"JSX.Element"}}},description:"Optional callback to render uploaded files in the message component.\n@beta"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ChatMessage/ChatMessageContent.tsx"]={name:"ChatMessageContent",docgenInfo:ChatMessageContent_ChatMessageContent.__docgenInfo,path:"../react-components/src/components/ChatMessage/ChatMessageContent.tsx"});var MoreIcon=__webpack_require__(1720);function ChatMessageComponentAsMessageBubble_slicedToArray(arr,i){return function ChatMessageComponentAsMessageBubble_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ChatMessageComponentAsMessageBubble_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ChatMessageComponentAsMessageBubble_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ChatMessageComponentAsMessageBubble_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ChatMessageComponentAsMessageBubble_arrayLikeToArray(o,minLen)}(arr,i)||function ChatMessageComponentAsMessageBubble_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ChatMessageComponentAsMessageBubble_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ChatMessageComponentAsMessageBubble_ChatMessageComponentAsMessageBubble=function ChatMessageComponentAsMessageBubble(props){var _message$readBy,ids=IdentifierProvider_useIdentifiers(),theme=Object(theming.e)(),message=props.message,onRemoveClick=props.onRemoveClick,disableEditing=props.disableEditing,showDate=props.showDate,messageContainerStyle=props.messageContainerStyle,strings=props.strings,onEditClick=props.onEditClick,_props$remoteParticip=props.remoteParticipantsCount,remoteParticipantsCount=void 0===_props$remoteParticip?0:_props$remoteParticip,onRenderAvatar=props.onRenderAvatar,_useState2=ChatMessageComponentAsMessageBubble_slicedToArray(Object(react.useState)(!1),2),wasInteractionByTouch=_useState2[0],setWasInteractionByTouch=_useState2[1],messageRef=Object(react.useRef)(null),messageActionButtonRef=Object(react.useRef)(null),_useState4=ChatMessageComponentAsMessageBubble_slicedToArray(Object(react.useState)(void 0),2),chatMessageActionFlyoutTarget=_useState4[0],setChatMessageActionFlyoutTarget=_useState4[1],chatActionsEnabled=!disableEditing&&"sending"!==message.status&&!!message.mine,actionMenuProps=wasInteractionByTouch?void 0:function chatMessageActionMenuProps(menuProps){if(menuProps.enabled){var menuClass=Object(lib.H)(chatActionsCSS,{"ul&":{boxShadow:menuProps.theme.effects.elevation4,backgroundColor:menuProps.theme.palette.white}});return{showActionMenu:!0===menuProps.forceShow||void 0,iconOnly:!0,activeIndex:-1,className:menuClass,onItemClick:function onItemClick(){return menuProps.onActionButtonClick()},items:[{children:Object(jsx_runtime.jsx)(Ref.a,{innerRef:menuProps.menuButtonRef,children:Object(jsx_runtime.jsx)(MoreIcon.a,{className:iconWrapperStyle,outline:!0})}),key:"menuButton",indicator:!1}]}}}({enabled:chatActionsEnabled,menuButtonRef:messageActionButtonRef,forceShow:chatMessageActionFlyoutTarget===messageActionButtonRef,onActionButtonClick:function onActionButtonClick(){setChatMessageActionFlyoutTarget(messageActionButtonRef)},theme:theme}),onActionFlyoutDismiss=Object(react.useCallback)((function(){setChatMessageActionFlyoutTarget(void 0)}),[setChatMessageActionFlyoutTarget]);return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("div",{ref:messageRef,children:Object(jsx_runtime.jsx)(Chat.a.Message,{className:Object(lib.H)(messageContainerStyle),styles:messageContainerStyle,content:Object(jsx_runtime.jsx)(ChatMessageContent_ChatMessageContent,{message:message,liveAuthorIntro:strings.liveAuthorIntro,onRenderFileDownloads:props.onRenderFileDownloads,userId:props.userId}),author:Object(jsx_runtime.jsx)(Text_Text.a,{className:ChatMessageComponent_styles_chatMessageDateStyle,children:message.senderDisplayName}),mine:message.mine,timestamp:Object(jsx_runtime.jsx)(Text_Text.a,{"data-ui-id":ids.messageTimestamp,children:message.createdOn?showDate?formatTimestampForChatMessage(message.createdOn,new Date,strings):formatTimeForChatMessage(message.createdOn):void 0}),details:message.editedOn?Object(jsx_runtime.jsx)("div",{className:ChatMessageComponent_styles_chatMessageEditedTagStyle(theme),children:strings.editedTag}):void 0,positionActionMenu:!1,actionMenu:actionMenuProps,onTouchStart:function onTouchStart(){return setWasInteractionByTouch(!0)},onPointerDown:function onPointerDown(){return setWasInteractionByTouch(!1)},onKeyDown:function onKeyDown(){return setWasInteractionByTouch(!1)},onClick:function onClick(){return wasInteractionByTouch&&setChatMessageActionFlyoutTarget(messageRef)}})}),chatActionsEnabled&&Object(jsx_runtime.jsx)(ChatMessageActionsFlyout_ChatMessageActionFlyout,{hidden:!chatMessageActionFlyoutTarget,target:chatMessageActionFlyoutTarget,increaseFlyoutItemSize:wasInteractionByTouch,onDismiss:onActionFlyoutDismiss,onEditClick:onEditClick,onRemoveClick:onRemoveClick,strings:strings,messageReadBy:null!==(_message$readBy=message.readBy)&&void 0!==_message$readBy?_message$readBy:[],remoteParticipantsCount:remoteParticipantsCount,onRenderAvatar:onRenderAvatar})]})};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function ChatMessageComponent_slicedToArray(arr,i){return function ChatMessageComponent_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ChatMessageComponent_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ChatMessageComponent_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ChatMessageComponent_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ChatMessageComponent_arrayLikeToArray(o,minLen)}(arr,i)||function ChatMessageComponent_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ChatMessageComponent_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}ChatMessageComponentAsMessageBubble_ChatMessageComponentAsMessageBubble.__docgenInfo={description:"@private",methods:[],displayName:"ChatMessageComponentAsMessageBubble",props:{message:{required:!0,tsType:{name:"ChatMessage"},description:""},messageContainerStyle:{required:!1,tsType:{name:"ComponentSlotStyle"},description:""},showDate:{required:!1,tsType:{name:"boolean"},description:""},disableEditing:{required:!1,tsType:{name:"boolean"},description:""},onEditClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onRemoveClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},strings:{required:!0,tsType:{name:"MessageThreadStrings"},description:""},userId:{required:!0,tsType:{name:"string"},description:""},onRenderFileDownloads:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, message: ChatMessage) => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"message",type:{name:"ChatMessage"}}],return:{name:"JSX.Element"}}},description:"Optional callback to render uploaded files in the message component."},remoteParticipantsCount:{required:!1,tsType:{name:"number"},description:""},onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:"Optional callback to override render of the avatar.\n\n@param userId - user Id"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ChatMessage/ChatMessageComponentAsMessageBubble.tsx"]={name:"ChatMessageComponentAsMessageBubble",docgenInfo:ChatMessageComponentAsMessageBubble_ChatMessageComponentAsMessageBubble.__docgenInfo,path:"../react-components/src/components/ChatMessage/ChatMessageComponentAsMessageBubble.tsx"});var ChatMessageComponent_ChatMessageComponent=function ChatMessageComponent(props){var _props$message$conten,_useState2=ChatMessageComponent_slicedToArray(Object(react.useState)(!1),2),isEditing=_useState2[0],setIsEditing=_useState2[1],onEditClick=Object(react.useCallback)((function(){return setIsEditing(!0)}),[setIsEditing]),onDeleteMessage=props.onDeleteMessage,message=props.message,onRemoveClick=Object(react.useCallback)((function(){onDeleteMessage&&message.messageId&&onDeleteMessage(message.messageId)}),[message.messageId,onDeleteMessage]);return"chat"!==props.message.messageType?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):isEditing?Object(jsx_runtime.jsx)(ChatMessageComponentAsEditBox_ChatMessageComponentAsEditBox,{initialValue:null!==(_props$message$conten=props.message.content)&&void 0!==_props$message$conten?_props$message$conten:"",inlineEditButtons:props.inlineAcceptRejectEditButtons,strings:props.strings,onSubmit:function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(text){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.t0=props.onUpdateMessage&&props.message.messageId,!_context.t0){_context.next=4;break}return _context.next=4,props.onUpdateMessage(props.message.messageId,text);case 4:setIsEditing(!1);case 5:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),onCancel:function onCancel(){setIsEditing(!1)}}):Object(jsx_runtime.jsx)(ChatMessageComponentAsMessageBubble_ChatMessageComponentAsMessageBubble,Object.assign({},props,{onRemoveClick:onRemoveClick,onEditClick:onEditClick,onRenderAvatar:props.onRenderAvatar}))};ChatMessageComponent_ChatMessageComponent.__docgenInfo={description:"@private",methods:[],displayName:"ChatMessageComponent",props:{message:{required:!0,tsType:{name:"ChatMessage"},description:""},userId:{required:!0,tsType:{name:"string"},description:""},messageContainerStyle:{required:!1,tsType:{name:"ComponentSlotStyle"},description:""},showDate:{required:!1,tsType:{name:"boolean"},description:""},disableEditing:{required:!1,tsType:{name:"boolean"},description:""},onUpdateMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageId: string, content: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}},{name:"content",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onDeleteMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageId: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},strings:{required:!0,tsType:{name:"MessageThreadStrings"},description:""},inlineAcceptRejectEditButtons:{required:!0,tsType:{name:"boolean"},description:"Inline the accept and reject edit buttons when editing a message.\nSetting to false will mean they are on a new line inside the editable chat message."},onRenderFileDownloads:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, message: ChatMessage) => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"message",type:{name:"ChatMessage"}}],return:{name:"JSX.Element"}}},description:"Optional callback to render uploaded files in the message component."},remoteParticipantsCount:{required:!1,tsType:{name:"number"},description:""},onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:"Optional callback to override render of the avatar.\n\n@param userId - user Id"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ChatMessage/ChatMessageComponent.tsx"]={name:"ChatMessageComponent",docgenInfo:ChatMessageComponent_ChatMessageComponent.__docgenInfo,path:"../react-components/src/components/ChatMessage/ChatMessageComponent.tsx"});__webpack_require__(795);var convertRemToPx=function convertRemToPx(rem){return rem*parseFloat(getComputedStyle(document.documentElement).fontSize)};function responsive_slicedToArray(arr,i){return function responsive_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function responsive_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function responsive_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return responsive_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return responsive_arrayLikeToArray(o,minLen)}(arr,i)||function responsive_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function responsive_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var responsive_useContainerWidth=function useContainerWidth(containerRef){var _useState2=responsive_slicedToArray(Object(react.useState)(0),2),width=_useState2[0],setWidth=_useState2[1],observer=Object(react.useRef)(new ResizeObserver((function(entries){var width=entries[0].contentRect.width;setWidth(width)})));return Object(react.useEffect)((function(){containerRef.current&&observer.current.observe(containerRef.current);var currentObserver=observer.current;return function(){currentObserver.disconnect()}}),[containerRef,observer]),width},responsive_isNarrowWidth=function isNarrowWidth(containerWidthRem){return containerWidthRem<=convertRemToPx(30)};function MessageThread_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function MessageThread_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){MessageThread_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){MessageThread_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function MessageThread_slicedToArray(arr,i){return function MessageThread_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MessageThread_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MessageThread_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MessageThread_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MessageThread_arrayLikeToArray(o,minLen)}(arr,i)||function MessageThread_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MessageThread_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var isMessageSame=function isMessageSame(first,second){return first.messageId===second.messageId&&first.content===second.content&&first.contentType===second.contentType&&JSON.stringify(first.createdOn)===JSON.stringify(second.createdOn)&&first.senderId===second.senderId&&first.senderDisplayName===second.senderDisplayName&&first.status===second.status},getLatestChatMessage=function getLatestChatMessage(messages){for(var i=messages.length-1;i>=0;i--){var _message=messages[i];if("chat"===_message.messageType&&_message.createdOn)return _message}},MessageThread_DefaultJumpToNewMessageButton=function DefaultJumpToNewMessageButton(props){var text=props.text,onClick=props.onClick;return Object(jsx_runtime.jsx)(PrimaryButton.a,{className:newMessageButtonStyle,styles:buttonWithIconStyles,text:text,onClick:onClick,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"Down",className:DownIconStyle})}})};MessageThread_DefaultJumpToNewMessageButton.displayName="DefaultJumpToNewMessageButton";var MessageThread_ParticipantSystemMessageComponent=function ParticipantSystemMessageComponent(_ref){var message=_ref.message,style=_ref.style,defaultName=_ref.defaultName,strings=LocalizationProvider_useLocale().strings,participantsStr=function generateParticipantsStr(participants,defaultName){return participants.map((function(participant){return""+(participant.displayName&&""!==participant.displayName?participant.displayName:defaultName)})).join(", ")}(message.participants,defaultName),messageSuffix="participantAdded"===message.systemMessageType?strings.messageThread.participantJoined:strings.messageThread.participantLeft;return""!==participantsStr?Object(jsx_runtime.jsx)(SystemMessage_SystemMessage,{iconName:message.iconName?message.iconName:"",content:participantsStr+" "+messageSuffix,containerStyle:style}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},MessageThread_DefaultSystemMessage=function DefaultSystemMessage(props){var _message$content,message=props.message;switch(message.messageType){case"system":switch(message.systemMessageType){case"content":return Object(jsx_runtime.jsx)(SystemMessage_SystemMessage,{iconName:message.iconName?message.iconName:"",content:null!==(_message$content=message.content)&&void 0!==_message$content?_message$content:"",containerStyle:null==props?void 0:props.messageContainerStyle});case"participantAdded":case"participantRemoved":return Object(jsx_runtime.jsx)(MessageThread_ParticipantSystemMessageComponent,{message:message,style:props.messageContainerStyle,defaultName:props.strings.noDisplayNameSub})}}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},memoizeAllMessages=Object(src.f)((function(_messageKey,message,showMessageDate,showMessageStatus,onRenderAvatar,shouldOverlapAvatarAndMessage,styles,onRenderMessageStatus,defaultStatusRenderer,defaultChatMessageRenderer,strings,_attached,statusToRender,messageThreadReadCount,messageThreadParticipantCount,onRenderMessage,onUpdateMessage,onDeleteMessage){var messageProps={message:message,strings:strings,showDate:showMessageDate,onUpdateMessage:onUpdateMessage,onDeleteMessage:onDeleteMessage};switch(message.messageType){case"chat":var _message$senderId,_message$mine,_message$mine2,myChatMessageStyle=(null==styles?void 0:styles.myChatMessageContainer)||defaultMyChatMessageContainer,chatMessageStyle=(null==styles?void 0:styles.chatMessageContainer)||defaultChatMessageContainer;messageProps.messageContainerStyle=message.mine?myChatMessageStyle:chatMessageStyle;var chatMessageComponent=void 0===onRenderMessage?defaultChatMessageRenderer(messageProps):onRenderMessage(messageProps,defaultChatMessageRenderer),personaOptions={hidePersonaDetails:!0,size:Persona_types.c.size32,text:message.senderDisplayName},chatItemMessageStyle=(message.mine?null==styles?void 0:styles.myChatItemMessageContainer:null==styles?void 0:styles.chatItemMessageContainer)||function defaultChatItemMessageContainer(overlapAvatarAndMessage){var messageAvatarGap=overlapAvatarAndMessage?-.425:.5;return{marginRight:"0rem",marginLeft:messageAvatarGap+"rem",width:"calc(100% - "+(4+messageAvatarGap)+"rem)",zIndex:1}}(shouldOverlapAvatarAndMessage);return{gutter:{styles:"top"===message.attached||!1===message.attached?gutterWithAvatar:gutterWithHiddenAvatar,content:message.mine?"":onRenderAvatar?onRenderAvatar(null!==(_message$senderId=message.senderId)&&void 0!==_message$senderId?_message$senderId:"",personaOptions):Object(jsx_runtime.jsx)(Persona.a,Object.assign({},personaOptions))},contentPosition:message.mine?"end":"start",message:{styles:chatItemMessageStyle,content:Object(jsx_runtime.jsxs)(Flex.a,{hAlign:message.mine?"end":void 0,vAlign:"end",children:[chatMessageComponent,Object(jsx_runtime.jsx)("div",{className:Object(lib.H)(MessageThread_styles_messageStatusContainerStyle(null!==(_message$mine=message.mine)&&void 0!==_message$mine&&_message$mine),null!=styles&&styles.messageStatusContainer?styles.messageStatusContainer(null!==(_message$mine2=message.mine)&&void 0!==_message$mine2&&_message$mine2):""),children:showMessageStatus&&statusToRender?onRenderMessageStatus?onRenderMessageStatus({status:statusToRender}):defaultStatusRenderer(statusToRender,messageThreadReadCount||0,messageThreadParticipantCount||0):Object(jsx_runtime.jsx)("div",{className:Object(lib.H)(noMessageStatusStyle)})})]})},attached:message.attached,key:_messageKey};case"system":return messageProps.messageContainerStyle=null==styles?void 0:styles.systemMessageContainer,{children:void 0===onRenderMessage?Object(jsx_runtime.jsx)(MessageThread_DefaultSystemMessage,Object.assign({},messageProps)):onRenderMessage(messageProps,(function(props){return Object(jsx_runtime.jsx)(MessageThread_DefaultSystemMessage,Object.assign({},props))})),key:_messageKey};default:return{children:void 0===onRenderMessage?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):onRenderMessage(messageProps),key:_messageKey}}})),getLastChatMessageIdWithStatus=function getLastChatMessageIdWithStatus(messages,status){for(var i=messages.length-1;i>=0;i--){var _message2=messages[i];if("chat"===_message2.messageType&&_message2.status===status&&_message2.mine)return _message2.messageId}},MessageThread_MessageThread=function MessageThread(props){var _chatThreadRef$curren,newMessages=props.messages,userId=props.userId,messageThreadParticipantCount=props.messageThreadParticipantCount,styles=props.styles,_props$disableJumpToN=props.disableJumpToNewMessageButton,disableJumpToNewMessageButton=void 0!==_props$disableJumpToN&&_props$disableJumpToN,_props$showMessageDat=props.showMessageDate,showMessageDate=void 0!==_props$showMessageDat&&_props$showMessageDat,_props$showMessageSta=props.showMessageStatus,showMessageStatus=void 0!==_props$showMessageSta&&_props$showMessageSta,_props$numberOfChatMe=props.numberOfChatMessagesToReload,numberOfChatMessagesToReload=void 0===_props$numberOfChatMe?5:_props$numberOfChatMe,onMessageSeen=props.onMessageSeen,onRenderMessageStatus=props.onRenderMessageStatus,onRenderAvatar=props.onRenderAvatar,onLoadPreviousChatMessages=props.onLoadPreviousChatMessages,onRenderJumpToNewMessageButton=props.onRenderJumpToNewMessageButton,onRenderMessage=props.onRenderMessage,onUpdateMessage=props.onUpdateMessage,onDeleteMessage=props.onDeleteMessage,_useState2=MessageThread_slicedToArray(Object(react.useState)([]),2),messages=_useState2[0],setMessages=_useState2[1],_useState4=MessageThread_slicedToArray(Object(react.useState)(!1),2),chatMessagesInitialized=_useState4[0],setChatMessagesInitialized=_useState4[1],_useState6=MessageThread_slicedToArray(Object(react.useState)(!0),2),isAtBottomOfScroll=_useState6[0],setIsAtBottomOfScroll=_useState6[1],_useState8=MessageThread_slicedToArray(Object(react.useState)(0),2),forceUpdate=_useState8[0],setForceUpdate=_useState8[1],_useState10=MessageThread_slicedToArray(Object(react.useState)(void 0),2),latestPreviousChatMessage=_useState10[0],setLatestPreviousChatMessage=_useState10[1],_useState12=MessageThread_slicedToArray(Object(react.useState)(void 0),2),latestCurrentChatMessage=_useState12[0],setLatestCurrentChatMessage=_useState12[1],_useState14=MessageThread_slicedToArray(Object(react.useState)(!1),2),existsNewChatMessage=_useState14[0],setExistsNewChatMessage=_useState14[1],_useState16=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastSeenChatMessage=_useState16[0],setLastSeenChatMessage=_useState16[1],_useState18=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastDeliveredChatMessage=_useState18[0],setLastDeliveredChatMessage=_useState18[1],_useState20=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastSendingChatMessage=_useState20[0],setLastSendingChatMessage=_useState20[1],isAllChatMessagesLoadedRef=Object(react.useRef)(!1),previousTopRef=Object(react.useRef)(-1),previousHeightRef=Object(react.useRef)(-1),messageIdSeenByMeRef=Object(react.useRef)(""),chatScrollDivRef=Object(react.useRef)(null),chatThreadRef=Object(react.useRef)(null),isLoadingChatMessagesRef=Object(react.useRef)(!1),chatThreadWidth=responsive_useContainerWidth(chatThreadRef),isNarrow=responsive_isNarrowWidth(chatThreadWidth),messagesRef=Object(react.useRef)(messages),isAtBottomOfScrollRef=Object(react.useRef)(isAtBottomOfScroll),setIsAtBottomOfScrollRef=function setIsAtBottomOfScrollRef(isAtBottomOfScrollValue){isAtBottomOfScrollRef.current=isAtBottomOfScrollValue,setIsAtBottomOfScroll(isAtBottomOfScrollValue)},chatMessagesInitializedRef=Object(react.useRef)(chatMessagesInitialized),sendMessageStatusIfAtBottom=Object(react.useCallback)(MessageThread_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var messagesWithId,lastMessage;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(isAtBottomOfScrollRef.current&&document.hasFocus()&&messagesRef.current&&0!==messagesRef.current.length&&showMessageStatus){_context.next=2;break}return _context.abrupt("return");case 2:if(0!==(messagesWithId=messagesRef.current.filter((function(message){return"chat"===message.messageType&&!message.mine&&!!message.messageId}))).length){_context.next=5;break}return _context.abrupt("return");case 5:if(lastMessage=messagesWithId[messagesWithId.length-1],_context.prev=6,!(onMessageSeen&&lastMessage&&lastMessage.messageId&&lastMessage.messageId!==messageIdSeenByMeRef.current)){_context.next=11;break}return _context.next=10,onMessageSeen(lastMessage.messageId);case 10:messageIdSeenByMeRef.current=lastMessage.messageId;case 11:_context.next=16;break;case 13:_context.prev=13,_context.t0=_context.catch(6),console.log("onMessageSeen Error",lastMessage,_context.t0);case 16:case"end":return _context.stop()}}),_callee,null,[[6,13]])}))),[showMessageStatus,onMessageSeen]),scrollToBottom=Object(react.useCallback)((function(){chatScrollDivRef.current&&(chatScrollDivRef.current.scrollTop=chatScrollDivRef.current.scrollHeight),setExistsNewChatMessage(!1),setIsAtBottomOfScrollRef(!0),sendMessageStatusIfAtBottom()}),[sendMessageStatusIfAtBottom]),handleScrollToTheBottom=Object(react.useCallback)((function(){if(chatScrollDivRef.current){var atBottom=Math.ceil(chatScrollDivRef.current.scrollTop)>=chatScrollDivRef.current.scrollHeight-chatScrollDivRef.current.clientHeight;atBottom&&(sendMessageStatusIfAtBottom(),isAtBottomOfScrollRef.current||scrollToBottom()),setIsAtBottomOfScrollRef(atBottom)}}),[scrollToBottom,sendMessageStatusIfAtBottom]),fetchNewMessageWhenAtTop=Object(react.useCallback)(MessageThread_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!chatScrollDivRef.current||isLoadingChatMessagesRef.current){_context2.next=12;break}if(!onLoadPreviousChatMessages){_context2.next=12;break}isLoadingChatMessagesRef.current=!0;case 3:if(isAllChatMessagesLoadedRef.current||!(chatScrollDivRef.current.scrollTop<=500)){_context2.next=11;break}return _context2.next=6,onLoadPreviousChatMessages(numberOfChatMessagesToReload);case 6:return isAllChatMessagesLoadedRef.current=_context2.sent,_context2.next=9,delay(200);case 9:_context2.next=3;break;case 11:isLoadingChatMessagesRef.current=!1;case 12:case"end":return _context2.stop()}}),_callee2)}))),[numberOfChatMessagesToReload,onLoadPreviousChatMessages]),handleInfiniteScroll=Object(react.useCallback)((function(){chatScrollDivRef.current&&fetchNewMessageWhenAtTop()}),[fetchNewMessageWhenAtTop]);Object(react.useEffect)((function(){chatScrollDivRef.current&&(previousTopRef.current=chatScrollDivRef.current.scrollTop,previousHeightRef.current=chatScrollDivRef.current.scrollHeight)}),[newMessages]),Object(react.useEffect)((function(){if(chatScrollDivRef.current&&0===previousTopRef.current){var currentHeight=chatScrollDivRef.current.scrollHeight;chatScrollDivRef.current.scrollTop=chatScrollDivRef.current.scrollTop+currentHeight-previousHeightRef.current}}),[messages]),Object(react.useEffect)((function(){fetchNewMessageWhenAtTop()}),[fetchNewMessageWhenAtTop]),Object(react.useEffect)((function(){return window&&window.addEventListener("click",sendMessageStatusIfAtBottom),window&&window.addEventListener("focus",sendMessageStatusIfAtBottom),function(){window&&window.removeEventListener("click",sendMessageStatusIfAtBottom),window&&window.removeEventListener("focus",sendMessageStatusIfAtBottom)}}),[sendMessageStatusIfAtBottom]),Object(react.useEffect)((function(){var chatScrollDiv=chatScrollDivRef.current;return null==chatScrollDiv||chatScrollDiv.addEventListener("scroll",handleScrollToTheBottom),null==chatScrollDiv||chatScrollDiv.addEventListener("scroll",handleInfiniteScroll),function(){null==chatScrollDiv||chatScrollDiv.removeEventListener("scroll",handleScrollToTheBottom),null==chatScrollDiv||chatScrollDiv.removeEventListener("scroll",handleInfiniteScroll)}}),[handleInfiniteScroll,handleScrollToTheBottom]);var clientHeight=null===(_chatThreadRef$curren=chatThreadRef.current)||void 0===_chatThreadRef$curren?void 0:_chatThreadRef$curren.clientHeight;Object(react.useEffect)((function(){void 0!==clientHeight?isAtBottomOfScrollRef.current&&scrollToBottom():setForceUpdate(forceUpdate+1)}),[clientHeight,forceUpdate,scrollToBottom,chatMessagesInitialized]),Object(react.useEffect)((function(){setLatestPreviousChatMessage(getLatestChatMessage(messagesRef.current)),setLatestCurrentChatMessage(getLatestChatMessage(newMessages)),function setMessagesRef(messagesWithAttachedValue){messagesRef.current=messagesWithAttachedValue,setMessages(messagesWithAttachedValue)}(newMessages),!chatMessagesInitializedRef.current&&function setChatMessagesInitializedRef(chatMessagesInitialized){chatMessagesInitializedRef.current=chatMessagesInitialized,setChatMessagesInitialized(chatMessagesInitialized)}(!0),setLastDeliveredChatMessage(getLastChatMessageIdWithStatus(newMessages,"delivered")),setLastSeenChatMessage(getLastChatMessageIdWithStatus(newMessages,"seen")),setLastSendingChatMessage(getLastChatMessageIdWithStatus(newMessages,"sending"))}),[newMessages]),Object(react.useEffect)((function(){!function isThereNewMessageNotFromCurrentUser(userId,latestMessageFromPreviousMessages,latestMessageFromNewMessages){return void 0!==latestMessageFromNewMessages&&(void 0===latestMessageFromPreviousMessages||!isMessageSame(latestMessageFromNewMessages,latestMessageFromPreviousMessages))&&latestMessageFromNewMessages.senderId!==userId}(userId,latestPreviousChatMessage,latestCurrentChatMessage)||isAtBottomOfScrollRef.current?(function didUserSendTheLatestMessage(userId,latestMessageFromPreviousMessages,latestMessageFromNewMessages){return void 0!==latestMessageFromNewMessages&&(void 0===latestMessageFromPreviousMessages||!isMessageSame(latestMessageFromNewMessages,latestMessageFromPreviousMessages))&&latestMessageFromNewMessages.senderId===userId}(userId,latestPreviousChatMessage,latestCurrentChatMessage)||isAtBottomOfScrollRef.current)&&scrollToBottom():setExistsNewChatMessage(!0)}),[messages]);var defaultChatMessageRenderer=Object(react.useCallback)((function(messageProps){return"chat"===messageProps.message.messageType?Object(jsx_runtime.jsx)(ChatMessageComponent_ChatMessageComponent,Object.assign({},messageProps,{onRenderFileDownloads:props.onRenderFileDownloads,message:messageProps.message,userId:props.userId,remoteParticipantsCount:messageThreadParticipantCount?messageThreadParticipantCount-1:0,inlineAcceptRejectEditButtons:!isNarrow,onRenderAvatar:onRenderAvatar})):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}),[(new Date).toDateString(),isNarrow,messageThreadParticipantCount,onRenderAvatar]),localeStrings=LocalizationProvider_useLocale().strings.messageThread,strings=Object(react.useMemo)((function(){return Object.assign({},localeStrings,props.strings)}),[localeStrings,props.strings]),defaultStatusRenderer=Object(react.useCallback)((function(status,messageThreadReadCount,messageThreadParticipantCount){return Object(jsx_runtime.jsx)(MessageStatusIndicator_MessageStatusIndicator,{status:status,messageThreadReadCount:messageThreadReadCount,remoteParticipantsCount:messageThreadParticipantCount?messageThreadParticipantCount-1:0})}),[]),messagesToDisplay=Object(react.useMemo)((function(){return memoizeAllMessages((function(memoizedMessageFn){return messages.map((function(message,index){var _key,key=message.messageId,statusToRender=void 0,readNumber=0;if("chat"===message.messageType){if(message.messageId&&""!==message.messageId||(key=message.clientMessageId),showMessageStatus&&message.mine)switch(message.messageId){case lastSeenChatMessage:statusToRender="seen",readNumber=message.readNumber?message.readNumber:0;break;case lastSendingChatMessage:statusToRender="sending";break;case lastDeliveredChatMessage:statusToRender="delivered"}message.mine&&"failed"===message.status&&(statusToRender="failed")}return memoizedMessageFn(null!==(_key=key)&&void 0!==_key?_key:"id_"+index,message,showMessageDate,showMessageStatus,onRenderAvatar,isNarrow,styles,onRenderMessageStatus,defaultStatusRenderer,defaultChatMessageRenderer,strings,"chat"===message.messageType?message.attached:void 0,statusToRender,readNumber,messageThreadParticipantCount,onRenderMessage,onUpdateMessage,onDeleteMessage)}))}))}),[messages,showMessageDate,showMessageStatus,onRenderAvatar,isNarrow,styles,onRenderMessageStatus,defaultStatusRenderer,defaultChatMessageRenderer,lastSeenChatMessage,lastSendingChatMessage,lastDeliveredChatMessage,messageThreadParticipantCount,onRenderMessage,onUpdateMessage,onDeleteMessage,strings]),chatBody=Object(react.useMemo)((function(){var _styles$chatContainer;return Object(jsx_runtime.jsx)(es.a,{children:Object(jsx_runtime.jsx)(Chat.a,{styles:null!==(_styles$chatContainer=null==styles?void 0:styles.chatContainer)&&void 0!==_styles$chatContainer?_styles$chatContainer:chatStyle,items:messagesToDisplay})})}),[null==styles?void 0:styles.chatContainer,messagesToDisplay]);return Object(jsx_runtime.jsx)(Ref.a,{innerRef:chatThreadRef,children:Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.H)(messageThreadContainerStyle,null==styles?void 0:styles.root),grow:!0,children:[Object(jsx_runtime.jsx)(Ref.a,{innerRef:chatScrollDivRef,children:chatBody}),existsNewChatMessage&&!disableJumpToNewMessageButton&&Object(jsx_runtime.jsx)("div",{className:Object(lib.H)(newMessageButtonContainerStyle,null==styles?void 0:styles.newMessageButtonContainer),children:onRenderJumpToNewMessageButton?onRenderJumpToNewMessageButton({text:strings.newMessagesIndicator,onClick:scrollToBottom}):Object(jsx_runtime.jsx)(MessageThread_DefaultJumpToNewMessageButton,{text:strings.newMessagesIndicator,onClick:scrollToBottom})})]})})};MessageThread_MessageThread.displayName="MessageThread",MessageThread_MessageThread.__docgenInfo={description:"`MessageThread` allows you to easily create a component for rendering chat messages, handling scrolling behavior of new/old messages and customizing icons & controls inside the chat thread.\n@param props - of type MessageThreadProps\n\nUsers will need to provide at least chat messages and userId to render the `MessageThread` component.\nUsers can also customize `MessageThread` by passing in their own Avatar, `MessageStatusIndicator` icon, `JumpToNewMessageButton`, `LoadPreviousMessagesButton` and the behavior of these controls.\n\n`MessageThread` internally uses the `Chat` & `Chat.Message` component from `@fluentui/react-northstar`. You can checkout the details about these [two components](https://fluentsite.z22.web.core.windows.net/0.53.0/components/chat/props).\n\n@public",methods:[],displayName:"MessageThread",props:{userId:{required:!0,tsType:{name:"string"},description:"UserId of the current user."},messages:{required:!0,tsType:{name:"Array",elements:[{name:"unknown"}],raw:"(ChatMessage | SystemMessage | CustomMessage)[]"},description:"Messages to render in message thread. A message can be of type `ChatMessage`, `SystemMessage` or `CustomMessage`."},messageThreadParticipantCount:{required:!1,tsType:{name:"number"},description:"number of participants in the thread"},styles:{required:!1,tsType:{name:"MessageThreadStyles"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<MessageThread styles={{ root: { background: 'blue' } }} />\n```"},disableJumpToNewMessageButton:{required:!1,tsType:{name:"boolean"},description:"Whether the new message button is disabled or not.\n\n@defaultValue `false`"},showMessageDate:{required:!1,tsType:{name:"boolean"},description:"Whether the date of each message is displayed or not.\n\n@defaultValue `false`"},showMessageStatus:{required:!1,tsType:{name:"boolean"},description:"Whether the status indicator for each message is displayed or not.\n\n@defaultValue `false`"},numberOfChatMessagesToReload:{required:!1,tsType:{name:"number"},description:"Number of chat messages to reload each time onLoadPreviousChatMessages is called.\n\n@defaultValue 0"},onMessageSeen:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageId: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback to override actions on message being seen.\n\n@param messageId - message Id"},onRenderMessageStatus:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageStatusIndicatorProps: MessageStatusIndicatorProps) => JSX.Element | null",signature:{arguments:[{name:"messageStatusIndicatorProps",type:{name:"MessageStatusIndicatorProps"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to override render of the message status indicator.\n\n@param messageStatusIndicatorProps - props of type MessageStatusIndicatorProps"},onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:"Optional callback to override render of the avatar.\n\n@param userId - user Id"},onRenderJumpToNewMessageButton:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMessageButtonProps: JumpToNewMessageButtonProps) => JSX.Element",signature:{arguments:[{name:"newMessageButtonProps",type:{name:"JumpToNewMessageButtonProps"}}],return:{name:"JSX.Element"}}},description:"Optional callback to override render of the button for jumping to the new message.\n\n@param newMessageButtonProps - button props of type JumpToNewMessageButtonProps"},onLoadPreviousChatMessages:{required:!1,tsType:{name:"signature",type:"function",raw:"(messagesToLoad: number) => Promise<boolean>",signature:{arguments:[{name:"messagesToLoad",type:{name:"number"}}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:"Optional callback to override loading of previous messages.\nIt accepts the number of history chat messages that we want to load and return a boolean Promise indicating if we have got all the history messages.\nIf the promise resolves to `true`, we have load all chat messages into the message thread and `loadPreviousMessagesButton` will not be rendered anymore."},onRenderMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageProps: MessageProps, messageRenderer?: MessageRenderer) => JSX.Element",signature:{arguments:[{name:"messageProps",type:{name:"signature",type:"object",raw:"{\n  /**\n   * Message to render. It can type `ChatMessage` or `SystemMessage` or `CustomMessage`.\n   */\n  message: Message;\n  /**\n   * Strings from parent MessageThread component\n   */\n  strings: MessageThreadStrings;\n  /**\n   * Custom CSS styles for chat message container.\n   */\n  messageContainerStyle?: ComponentSlotStyle;\n  /**\n   * Whether the date of a message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n  showDate?: boolean;\n  /**\n   * Disable editing messages.\n   *\n   * @remarks This removes the action menu on messages.\n   *\n   * @defaultValue `false`\n   */\n  disableEditing?: boolean;\n  /**\n   * Optional callback to edit a message.\n   *\n   * @param messageId - message id from chatClient\n   * @param content - new content of the message\n   *\n   */\n  onUpdateMessage?: (messageId: string, content: string) => Promise<void>;\n\n  /**\n   * Optional callback to delete a message.\n   *\n   * @param messageId - message id from chatClient\n   *\n   */\n  onDeleteMessage?: (messageId: string) => Promise<void>;\n}",signature:{properties:[{key:"message",value:{name:"Message",required:!0}},{key:"strings",value:{name:"MessageThreadStrings",required:!0}},{key:"messageContainerStyle",value:{name:"ComponentSlotStyle",required:!1}},{key:"showDate",value:{name:"boolean",required:!1}},{key:"disableEditing",value:{name:"boolean",required:!1}},{key:"onUpdateMessage",value:{name:"signature",type:"function",raw:"(messageId: string, content: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}},{name:"content",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1}},{key:"onDeleteMessage",value:{name:"signature",type:"function",raw:"(messageId: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1}}]}}},{name:"messageRenderer",type:{name:"signature",type:"function",raw:"(props: MessageProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"signature",type:"object",raw:"{\n  /**\n   * Message to render. It can type `ChatMessage` or `SystemMessage` or `CustomMessage`.\n   */\n  message: Message;\n  /**\n   * Strings from parent MessageThread component\n   */\n  strings: MessageThreadStrings;\n  /**\n   * Custom CSS styles for chat message container.\n   */\n  messageContainerStyle?: ComponentSlotStyle;\n  /**\n   * Whether the date of a message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n  showDate?: boolean;\n  /**\n   * Disable editing messages.\n   *\n   * @remarks This removes the action menu on messages.\n   *\n   * @defaultValue `false`\n   */\n  disableEditing?: boolean;\n  /**\n   * Optional callback to edit a message.\n   *\n   * @param messageId - message id from chatClient\n   * @param content - new content of the message\n   *\n   */\n  onUpdateMessage?: (messageId: string, content: string) => Promise<void>;\n\n  /**\n   * Optional callback to delete a message.\n   *\n   * @param messageId - message id from chatClient\n   *\n   */\n  onDeleteMessage?: (messageId: string) => Promise<void>;\n}",signature:{properties:[{key:"message",value:{name:"Message",required:!0}},{key:"strings",value:{name:"MessageThreadStrings",required:!0}},{key:"messageContainerStyle",value:{name:"ComponentSlotStyle",required:!1}},{key:"showDate",value:{name:"boolean",required:!1}},{key:"disableEditing",value:{name:"boolean",required:!1}},{key:"onUpdateMessage",value:{name:"signature",type:"function",raw:"(messageId: string, content: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}},{name:"content",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1}},{key:"onDeleteMessage",value:{name:"signature",type:"function",raw:"(messageId: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}},required:!1}}]}}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:"Optional callback to override render of a message.\n\n@param messageProps - props of type {@link communication-react#MessageProps}\n@param defaultOnRender - default render of type {@link communication-react#MessageRenderer}\n\n@remarks\n`messageRenderer` is not provided for `CustomMessage` and thus only available for `ChatMessage` and `SystemMessage`."},onRenderFileDownloads:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, message: ChatMessage) => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"message",type:{name:"ChatMessage"}}],return:{name:"JSX.Element"}}},description:"Optional callback to render uploaded files in the message component.\n@beta"},onUpdateMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageId: string, content: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}},{name:"content",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback to edit a message.\n\n@param messageId - message id from chatClient\n@param content - new content of the message"},onDeleteMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageId: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback to delete a message.\n\n@param messageId - message id from chatClient"},disableEditing:{required:!1,tsType:{name:"boolean"},description:"/**\nDisable editing messages.\n\n@remarks This removes the action menu on messages.\n\n@defaultValue `false`"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"MessageThreadStrings"}],raw:"Partial<MessageThreadStrings>"},description:"Optional strings to override in component"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/MessageThread.tsx"]={name:"MessageThread",docgenInfo:MessageThread_MessageThread.__docgenInfo,path:"../react-components/src/components/MessageThread.tsx"});var StreamMedia_styles_mediaContainer=function mediaContainer(theme){return Object(lib.H)({position:"relative",height:"100%",width:"100%",background:"transparent",display:"flex","& video":{borderRadius:theme.effects.roundedCorner4}})},StreamMedia_styles_invertedVideoStyle=function invertedVideoStyle(theme){return Object(lib.H)(StreamMedia_styles_mediaContainer(theme),{transform:"rotateY(180deg)"})},StreamMedia_StreamMedia=function StreamMedia(props){var containerEl=Object(react.useRef)(null),theme=Object(theming.e)(),isMirrored=props.isMirrored,videoStreamElement=props.videoStreamElement,styles=props.styles;return Object(react.useEffect)((function(){var container=containerEl.current;if(container)return container.innerHTML="",videoStreamElement&&container.appendChild(videoStreamElement),function(){container.innerHTML=""}}),[videoStreamElement]),Object(jsx_runtime.jsx)("div",{className:Object(lib.H)(isMirrored?StreamMedia_styles_invertedVideoStyle(theme):StreamMedia_styles_mediaContainer(theme),null==styles?void 0:styles.root),ref:containerEl})};StreamMedia_StreamMedia.displayName="StreamMedia",StreamMedia_StreamMedia.__docgenInfo={description:"Utility component to convert an HTMLElement with a video stream into a JSX element.\n\nUse to convert an HTMLElement returned by headless calling API into a component that can be rendered as a {@link VideoTile}.\n\n@public",methods:[],displayName:"StreamMedia",props:{videoStreamElement:{required:!0,tsType:{name:"union",raw:"HTMLElement | null",elements:[{name:"HTMLElement"},{name:"null"}]},description:"Video stream element to render."},isMirrored:{required:!1,tsType:{name:"boolean"},description:"Decides whether to mirror the video or not."},styles:{required:!1,tsType:{name:"BaseCustomStyles"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<StreamMedia styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/StreamMedia.tsx"]={name:"StreamMedia",docgenInfo:StreamMedia_StreamMedia.__docgenInfo,path:"../react-components/src/components/StreamMedia.tsx"});var participantItemContainerStyle=Object(lib.H)({paddingTop:"0.25rem",paddingBottom:"0.25rem",display:"flex",maxWidth:"20rem",minWidth:"12rem",cursor:"pointer",alignItems:"center"}),menuButtonContainerStyle={width:"1.5rem"},iconContainerStyle={display:"flex",alignItems:"center",height:"100%",paddingTop:"0.2rem"},iconStyles=Object(lib.H)({display:"flex",lineHeight:0,alignItems:"center"}),meContainerStyle={paddingRight:"0.5rem"};function ParticipantItem_slicedToArray(arr,i){return function ParticipantItem_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ParticipantItem_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ParticipantItem_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantItem_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantItem_arrayLikeToArray(o,minLen)}(arr,i)||function ParticipantItem_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ParticipantItem_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ParticipantItem_ParticipantItem=function ParticipantItem(props){var _props$strings$isMeTe,_props$strings,_props$strings$menuTi,_props$strings2,userId=props.userId,displayName=props.displayName,onRenderAvatar=props.onRenderAvatar,menuItems=props.menuItems,onRenderIcon=props.onRenderIcon,presence=props.presence,styles=props.styles,me=props.me,_useState2=ParticipantItem_slicedToArray(Object(react.useState)(!1),2),itemHovered=_useState2[0],setItemHovered=_useState2[1],_useState4=ParticipantItem_slicedToArray(Object(react.useState)(!0),2),menuHidden=_useState4[0],setMenuHidden=_useState4[1],containerRef=Object(react.useRef)(null),theme=Object(theming.e)(),localeStrings=LocalizationProvider_useLocale().strings.participantItem,ids=IdentifierProvider_useIdentifiers(),isMeText=null!==(_props$strings$isMeTe=null===(_props$strings=props.strings)||void 0===_props$strings?void 0:_props$strings.isMeText)&&void 0!==_props$strings$isMeTe?_props$strings$isMeTe:localeStrings.isMeText,menuTitle=null!==(_props$strings$menuTi=null===(_props$strings2=props.strings)||void 0===_props$strings2?void 0:_props$strings2.menuTitle)&&void 0!==_props$strings$menuTi?_props$strings$menuTi:localeStrings.menuTitle,avatarOptions={text:displayName,size:Persona_types.c.size32,presence:presence,initialsTextColor:"white"},avatar=onRenderAvatar?onRenderAvatar(null!=userId?userId:"",avatarOptions):Object(jsx_runtime.jsx)(Persona.a,Object.assign({className:Object(lib.H)({lineHeight:"1.15rem"},null==styles?void 0:styles.avatar)},avatarOptions)),meTextStyle=Object(react.useMemo)((function(){return Object(lib.H)(meContainerStyle,{color:theme.palette.neutralTertiary},null==styles?void 0:styles.me)}),[theme.palette.neutralTertiary,null==styles?void 0:styles.me]),contextualMenuStyle=Object(react.useMemo)((function(){return Object(lib.H)({background:theme.palette.neutralLighterAlt},null==styles?void 0:styles.menu)}),[theme.palette.neutralLighterAlt,null==styles?void 0:styles.menu]),infoContainerStyle=Object(react.useMemo)((function(){return Object(lib.H)(iconContainerStyle,{color:theme.palette.neutralTertiary},null==styles?void 0:styles.iconContainer)}),[theme.palette.neutralTertiary,null==styles?void 0:styles.iconContainer]),menuButton=Object(react.useMemo)((function(){return Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,horizontalAlign:"end",className:Object(lib.H)(menuButtonContainerStyle),title:menuTitle,"data-ui-id":ids.participantItemMenuButton,children:Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:itemHovered?"ParticipantItemOptionsHovered":"ParticipantItemOptions",className:iconStyles})})}),[itemHovered,menuTitle,ids.participantItemMenuButton]),onDismissMenu=function onDismissMenu(){setItemHovered(!1),setMenuHidden(!0)};return Object(jsx_runtime.jsxs)("div",{ref:containerRef,role:"menuitem","data-is-focusable":!0,className:Object(lib.H)(participantItemContainerStyle,null==styles?void 0:styles.root),onMouseEnter:function onMouseEnter(){return setItemHovered(!0)},onMouseLeave:function onMouseLeave(){return setItemHovered(!1)},onClick:function onClick(){setItemHovered(!0),setMenuHidden(!1)},children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.H)({width:"calc(100% - "+menuButtonContainerStyle.width+")",alignItems:"center"}),children:[avatar,me&&Object(jsx_runtime.jsx)(Stack.a,{className:meTextStyle,children:isMeText}),Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,className:Object(lib.H)(infoContainerStyle),children:onRenderIcon&&onRenderIcon(props)})]}),menuItems&&menuItems.length>0&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[menuButton,Object(jsx_runtime.jsx)(ContextualMenu.a,{items:menuItems,hidden:menuHidden,target:containerRef,onItemClick:onDismissMenu,onDismiss:onDismissMenu,directionalHint:DirectionalHint.a.bottomRightEdge,className:contextualMenuStyle,calloutProps:{preventDismissOnResize:!0}})]})]})};ParticipantItem_ParticipantItem.displayName="ParticipantItem",ParticipantItem_ParticipantItem.__docgenInfo={description:"Component to render a calling or chat participant.\n\nDisplays the participant's avatar, displayName and status as well as optional icons and context menu.\n\n@public",methods:[],displayName:"ParticipantItem",props:{userId:{required:!1,tsType:{name:"string"},description:"Unique User ID of the participant. This `userId` is available in the `onRenderAvatar` callback function"},displayName:{required:!0,tsType:{name:"string"},description:"Name of participant."},me:{required:!1,tsType:{name:"boolean"},description:"Optional indicator to show participant is the user."},onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:"Optional callback returning a JSX element to override avatar."},menuItems:{required:!1,tsType:{name:"Array",elements:[{name:"IContextualMenuItem"}],raw:"IContextualMenuItem[]"},description:"Optional array of IContextualMenuItem for contextual menu."},onRenderIcon:{required:!1,tsType:{name:"signature",type:"function",raw:"(props?: ParticipantItemProps) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"ParticipantItemProps"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback returning a JSX element rendered on the right portion of the ParticipantItem. Intended for adding icons."},presence:{required:!1,tsType:{name:"PersonaPresence"},description:"Optional PersonaPresence to show participant presence. This will not have an effect if property avatar is assigned."},styles:{required:!1,tsType:{name:"ParticipantItemStyles"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<ParticipantItem styles={{ root: { background: 'blue' } }} />\n```"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"ParticipantItemStrings"}],raw:"Partial<ParticipantItemStrings>"},description:"Optional strings to override in component"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ParticipantItem.tsx"]={name:"ParticipantItem",docgenInfo:ParticipantItem_ParticipantItem.__docgenInfo,path:"../react-components/src/components/ParticipantItem.tsx"});__webpack_require__(74),__webpack_require__(296);var merge=__webpack_require__(889),participantListStyle=Object(lib.H)({height:"100%",padding:"0.125rem"}),participantListItemStyle={root:{paddingLeft:"1rem",paddingRight:"1rem"}},ParticipantList_styles_iconStyles=Object(lib.H)({display:"flex",lineHeight:0,alignItems:"center"});function ParticipantList_toConsumableArray(arr){return function ParticipantList_arrayWithoutHoles(arr){if(Array.isArray(arr))return ParticipantList_arrayLikeToArray(arr)}(arr)||function ParticipantList_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function ParticipantList_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantList_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantList_arrayLikeToArray(o,minLen)}(arr)||function ParticipantList_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ParticipantList_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ParticipantList_ParticipantList=function ParticipantList(props){var _props$styles2,_props$styles3,_props$excludeMe=props.excludeMe,excludeMe=void 0!==_props$excludeMe&&_props$excludeMe,myUserId=props.myUserId,participants=props.participants,onRemoveParticipant=props.onRemoveParticipant,onRenderAvatar=props.onRenderAvatar,onRenderParticipant=props.onRenderParticipant,onFetchParticipantMenuItems=props.onFetchParticipantMenuItems,ids=IdentifierProvider_useIdentifiers(),strings=LocalizationProvider_useLocale().strings.participantItem,displayedParticipants=Object(react.useMemo)((function(){return onRenderParticipant?participants:function getParticipantsForDefaultRender(participants,excludeMe,myUserId){if(!excludeMe||!myUserId)return ParticipantList_toConsumableArray(participants);var userIndex=participants.map((function(p){return p.userId})).indexOf(myUserId);if(-1===userIndex)return ParticipantList_toConsumableArray(participants);var remoteParticipants=ParticipantList_toConsumableArray(participants);return remoteParticipants.splice(userIndex,1),remoteParticipants}(participants,excludeMe,myUserId)}),[participants,excludeMe,myUserId,onRenderParticipant]),createParticipantMenuItems=function createParticipantMenuItems(participant){var _props$styles,_props$styles$partici,menuItems=[];participant.userId!==myUserId&&onRemoveParticipant&&menuItems.push({key:"remove",text:strings.removeButtonLabel,onClick:function onClick(){return onRemoveParticipant(participant.userId)},itemProps:{styles:null===(_props$styles=props.styles)||void 0===_props$styles||null===(_props$styles$partici=_props$styles.participantItemStyles)||void 0===_props$styles$partici?void 0:_props$styles$partici.participantSubMenuItemsStyles},disabled:!participant.isRemovable,"data-ui-id":ids.participantListRemoveParticipantButton});return onFetchParticipantMenuItems&&(menuItems=onFetchParticipantMenuItems(participant.userId,myUserId,menuItems)),menuItems},participantItemStyles=Object(merge.a)(participantListItemStyle,null===(_props$styles2=props.styles)||void 0===_props$styles2?void 0:_props$styles2.participantItemStyles);return Object(jsx_runtime.jsx)(Stack.a,{"data-ui-id":ids.participantList,className:Object(lib.H)(participantListStyle,null===(_props$styles3=props.styles)||void 0===_props$styles3?void 0:_props$styles3.root),children:displayedParticipants.map((function(participant){return onRenderParticipant?onRenderParticipant(participant):function onRenderParticipantDefault(participant,strings,myUserId,onRemoveParticipant,onRenderAvatar,createParticipantMenuItems,styles){var callingParticipant=participant,presence=void 0;callingParticipant&&("Connected"===callingParticipant.state?presence=Persona_types.b.online:"Idle"===callingParticipant.state&&(presence=Persona_types.b.away));var menuItems=createParticipantMenuItems&&createParticipantMenuItems(participant),onRenderIcon=null!=callingParticipant&&callingParticipant.isScreenSharing||null!=callingParticipant&&callingParticipant.isMuted?function(){return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:{childrenGap:"0.5rem"},children:[callingParticipant.isScreenSharing&&Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"ParticipantItemScreenShareStart",className:ParticipantList_styles_iconStyles,ariaLabel:strings.sharingIconLabel}),callingParticipant.isMuted&&Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"ParticipantItemMicOff",className:ParticipantList_styles_iconStyles,ariaLabel:strings.mutedIconLabel})]})}:function(){return null};return participant.displayName?Object(jsx_runtime.jsx)(ParticipantItem_ParticipantItem,{styles:styles,userId:participant.userId,displayName:participant.displayName,me:!!myUserId&&participant.userId===myUserId,menuItems:menuItems,presence:presence,onRenderIcon:onRenderIcon,onRenderAvatar:onRenderAvatar},participant.userId):null}(participant,strings,myUserId,0,onRenderAvatar,createParticipantMenuItems,participantItemStyles)}))})};ParticipantList_ParticipantList.displayName="ParticipantList",ParticipantList_ParticipantList.__docgenInfo={description:"Component to render all calling or chat participants.\n\nBy default, each participant is rendered with {@link ParticipantItem}. See {@link ParticipantListProps.onRenderParticipant} to override.\n\n@public",methods:[],displayName:"ParticipantList",props:{participants:{required:!0,tsType:{name:"Array",elements:[{name:"ParticipantListParticipant"}],raw:"ParticipantListParticipant[]"},description:"Participants in user call or chat"},myUserId:{required:!1,tsType:{name:"string"},description:"User ID of user"},excludeMe:{required:!1,tsType:{name:"boolean"},description:"If set to `true`, excludes the local participant from the participant list with use of `myUserId` props (required in this case).\n\n@defaultValue `false`"},onRenderParticipant:{required:!1,tsType:{name:"signature",type:"function",raw:"(participant: ParticipantListParticipant) => JSX.Element | null",signature:{arguments:[{name:"participant",type:{name:"ParticipantListParticipant"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to render each participant. If no callback is provided, each participant will be rendered with `ParticipantItem`"},onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:"Optional callback to render the avatar for each participant. This property will have no effect if `onRenderParticipant` is assigned."},onRemoveParticipant:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => void",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"void"}}},description:"Optional callback to render the context menu for each participant"},onFetchParticipantMenuItems:{required:!1,tsType:{name:"signature",type:"function",raw:"(\n  participantUserId: string,\n  userId?: string,\n  defaultMenuItems?: IContextualMenuItem[]\n) => IContextualMenuItem[]",signature:{arguments:[{name:"participantUserId",type:{name:"string"}},{name:"userId",type:{name:"string"}},{name:"defaultMenuItems",type:{name:"Array",elements:[{name:"IContextualMenuItem"}],raw:"IContextualMenuItem[]"}}],return:{name:"Array",elements:[{name:"IContextualMenuItem"}],raw:"IContextualMenuItem[]"}}},description:"Optional callback to render custom menu items for each participant."},styles:{required:!1,tsType:{name:"ParticipantListStyles"},description:"Styles for the {@link ParticipantList}"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ParticipantList.tsx"]={name:"ParticipantList",docgenInfo:ParticipantList_ParticipantList.__docgenInfo,path:"../react-components/src/components/ParticipantList.tsx"});__webpack_require__(189),__webpack_require__(115);var Modal=__webpack_require__(1735),LayerHost=__webpack_require__(1722),smartDominantSpeakerParticipants=(__webpack_require__(130),__webpack_require__(159),function smartDominantSpeakerParticipants(args){var participants=args.participants,_args$dominantSpeaker=args.dominantSpeakers,dominantSpeakers=void 0===_args$dominantSpeaker?[]:_args$dominantSpeaker,_args$lastVisiblePart=args.lastVisibleParticipants,lastVisibleParticipants=void 0===_args$lastVisiblePart?[]:_args$lastVisiblePart,maxDominantSpeakers=args.maxDominantSpeakers;if(participants.length<=maxDominantSpeakers)return participants;for(var participantsMap=participantsById(participants),dominantSpeakerIds=Array.from(new Set(dominantSpeakers).values()).filter((function(id){return!!participantsMap[id]})).slice(0,maxDominantSpeakers),lastVisibleParticipantIds=lastVisibleParticipants.map((function(p){return p.userId})),newVisibleParticipantIds=lastVisibleParticipants.map((function(p){return p.userId})).slice(0,maxDominantSpeakers),newDominantSpeakerIds=dominantSpeakerIds.filter((function(id){return!newVisibleParticipantIds.includes(id)})),index=0;index<maxDominantSpeakers;index++){var newVisibleParticipantId=newVisibleParticipantIds[index];if(void 0===newVisibleParticipantId||!dominantSpeakerIds.includes(newVisibleParticipantId)){var replacement=newDominantSpeakerIds.shift();if(!replacement)break;newVisibleParticipantIds[index]=replacement}}lastVisibleParticipantIds.filter((function(p){return!newVisibleParticipantIds.includes(p)})).forEach((function(p){return newVisibleParticipantIds.push(p)}));var newVisibleParticipantIdSet=new Set(newVisibleParticipantIds);return participants.filter((function(p){return!newVisibleParticipantIdSet.has(p.userId)})).forEach((function(p){newVisibleParticipantIds.push(p.userId)})),newVisibleParticipantIds.map((function(participantId){return participantsMap[participantId]})).filter((function(p){return!!p}))}),participantsById=function participantsById(participants){var response={};return participants.forEach((function(p){return response[p.userId]=p})),response},VideoTile_styles_rootStyles={position:"relative",height:"100%",width:"100%"},videoContainerStyles={position:"absolute",top:"0",left:"0",width:"100%",height:"100%",minWidth:"100%",minHeight:"100%",objectPosition:"center",objectFit:"cover",zIndex:0},overlayContainerStyles={width:"100%",height:"100%",zIndex:5},tileInfoContainerStyle=Object(lib.H)({position:"absolute",bottom:"0.5rem",left:"0.5rem",width:"calc(100% - 1rem)"}),disabledVideoHint=Object(lib.H)({backgroundColor:"inherit",boxShadow:"none",textAlign:"left",overflow:"hidden",whiteSpace:"nowrap",alignItems:"center",padding:"0.15rem",maxWidth:"100%"}),videoHint=Object(lib.H)(disabledVideoHint,{backgroundColor:"rgba(255,255,255,0.8)"}),displayNameStyle={padding:"0.1rem",fontSize:"0.75rem",fontWeight:600,color:"inherit",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},VideoTile_styles_iconContainerStyle={height:"100%",alignItems:"center","& svg":{display:"block"}},isSpeakingBorderDiv={zIndex:1,width:"100%",height:"100%",position:"absolute",top:"0",left:"0",pointerEvents:"none"};function VideoTile_slicedToArray(arr,i){return function VideoTile_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VideoTile_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function VideoTile_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return VideoTile_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VideoTile_arrayLikeToArray(o,minLen)}(arr,i)||function VideoTile_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VideoTile_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var VideoTile_DefaultPlaceholder=function DefaultPlaceholder(props){var text=props.text,noVideoAvailableAriaLabel=props.noVideoAvailableAriaLabel,coinSize=props.coinSize,styles=props.styles,hidePersonaDetails=props.hidePersonaDetails;return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)({position:"absolute",height:"100%",width:"100%"}),children:Object(jsx_runtime.jsx)(Persona.a,{styles:styles,coinSize:coinSize,hidePersonaDetails:hidePersonaDetails,text:null!=text?text:"",initialsTextColor:"white","aria-label":null!=noVideoAvailableAriaLabel?noVideoAvailableAriaLabel:""})})};VideoTile_DefaultPlaceholder.displayName="DefaultPlaceholder";var defaultPersonaStyles={root:{margin:"auto",maxHeight:"100%"}},VideoTile_VideoTile=function VideoTile(props){var children=props.children,displayName=props.displayName,initialsName=props.initialsName,isMirrored=props.isMirrored,isMuted=props.isMuted,onRenderPlaceholder=props.onRenderPlaceholder,renderElement=props.renderElement,_props$showLabel=props.showLabel,showLabel=void 0===_props$showLabel||_props$showLabel,_props$showMuteIndica=props.showMuteIndicator,showMuteIndicator=void 0===_props$showMuteIndica||_props$showMuteIndica,styles=props.styles,userId=props.userId,noVideoAvailableAriaLabel=props.noVideoAvailableAriaLabel,isSpeaking=props.isSpeaking,_props$personaMinSize=props.personaMinSize,personaMinSize=void 0===_props$personaMinSize?32:_props$personaMinSize,_props$personaMaxSize=props.personaMaxSize,personaMaxSize=void 0===_props$personaMaxSize?100:_props$personaMaxSize,_useState2=VideoTile_slicedToArray(Object(react.useState)(100),2),personaSize=_useState2[0],setPersonaSize=_useState2[1],videoTileRef=Object(react.useRef)(null),theme=Object(theming.e)(),isVideoRendered=!!renderElement,observer=Object(react.useRef)(new ResizeObserver((function(entries){var _entries$0$contentRec=entries[0].contentRect,width=_entries$0$contentRec.width,height=_entries$0$contentRec.height,personaSize=Math.min(width,height)/3;setPersonaSize(Math.max(Math.min(personaSize,personaMaxSize),personaMinSize))})));Object(react.useLayoutEffect)((function(){videoTileRef.current&&observer.current.observe(videoTileRef.current);var currentObserver=observer.current;return function(){return currentObserver.disconnect()}}),[observer,videoTileRef]);var placeholderOptions={userId:userId,text:initialsName||displayName,noVideoAvailableAriaLabel:noVideoAvailableAriaLabel,coinSize:personaSize,styles:defaultPersonaStyles,hidePersonaDetails:!0},videoHintWithBorderRadius=Object(lib.H)(videoHint,{borderRadius:theme.effects.roundedCorner4}),tileInfoStyle=Object(react.useMemo)((function(){return Object(lib.H)(isVideoRendered?videoHintWithBorderRadius:disabledVideoHint,function getVideoTileOverrideColor(isVideoRendered,theme,color){return{color:isVideoRendered?lib.d[color]:theme.palette[color]}}(isVideoRendered,theme,"neutralPrimary"),null==styles?void 0:styles.displayNameContainer)}),[isVideoRendered,videoHintWithBorderRadius,theme,null==styles?void 0:styles.displayNameContainer]),ids=IdentifierProvider_useIdentifiers();return Object(jsx_runtime.jsx)(Ref.a,{innerRef:videoTileRef,children:Object(jsx_runtime.jsxs)(Stack.a,{"data-ui-id":ids.videoTile,className:Object(lib.H)(VideoTile_styles_rootStyles,{background:theme.palette.neutralLighter,borderRadius:theme.effects.roundedCorner4},null==styles?void 0:styles.root),children:[Object(jsx_runtime.jsx)("div",{className:Object(lib.H)(isSpeakingBorderDiv,{borderRadius:theme.effects.roundedCorner4,border:"0.25rem solid "+(isSpeaking?theme.palette.themePrimary:"transparent")})}),isVideoRendered?Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)(videoContainerStyles,isMirrored&&{transform:"scaleX(-1)"},null==styles?void 0:styles.videoContainer),children:renderElement}):Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)(videoContainerStyles),children:onRenderPlaceholder?onRenderPlaceholder(null!=userId?userId:"",placeholderOptions,VideoTile_DefaultPlaceholder):Object(jsx_runtime.jsx)(VideoTile_DefaultPlaceholder,Object.assign({},placeholderOptions))}),showLabel&&(displayName||showMuteIndicator&&isMuted)&&Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,className:tileInfoContainerStyle,children:Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:tileInfoStyle,children:[displayName&&Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(displayNameStyle),title:displayName,children:displayName}),showMuteIndicator&&isMuted&&Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)(VideoTile_styles_iconContainerStyle),children:Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"VideoTileMicOff"})})]})}),children&&Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)(overlayContainerStyles,null==styles?void 0:styles.overlayContainer),children:children})]})})};VideoTile_VideoTile.displayName="VideoTile",VideoTile_VideoTile.__docgenInfo={description:"A component to render the video stream for a single call participant.\n\nUse with {@link GridLayout} in a {@link VideoGallery}.\n\n@public",methods:[],displayName:"VideoTile",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"React Child components. Child Components will show as overlay component in the VideoTile."},styles:{required:!1,tsType:{name:"VideoTileStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<VideoTile styles={{ root: { background: 'blue' } }} />\n```"},userId:{required:!1,tsType:{name:"string"},description:"user id for the VideoTile placeholder."},renderElement:{required:!1,tsType:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]},description:"Component with the video stream."},isMirrored:{required:!1,tsType:{name:"boolean"},description:"Determines if the video is mirrored or not."},onRenderPlaceholder:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:"Custom render Component function for no video is available. Render a Persona Icon if undefined."},showLabel:{required:!1,tsType:{name:"boolean"},description:"Show label on the VideoTile\n@defaultValue true"},showMuteIndicator:{required:!1,tsType:{name:"boolean"},description:"Whether to display a mute icon beside the user's display name.\n@defaultValue true"},isMuted:{required:!1,tsType:{name:"boolean"},description:"Whether the video is muted or not."},displayName:{required:!1,tsType:{name:"string"},description:"Display Name of the Participant to be shown in the label.\n@remarks `displayName` is used to generate avatar initials if `initialsName` is not provided."},initialsName:{required:!1,tsType:{name:"string"},description:"Name of the participant used to generate initials. For example, a name `John Doe` will display `JD` as initials.\n@remarks `displayName` is used if this property is not specified."},personaMinSize:{required:!1,tsType:{name:"number"},description:"Minimum size of the persona avatar in px.\nThe persona avatar is the default placeholder shown when no video stream is available.\nFor more information see https://developer.microsoft.com/en-us/fluentui#/controls/web/persona\n@defaultValue 32px"},personaMaxSize:{required:!1,tsType:{name:"number"},description:"Maximum size of the personal avatar in px.\nThe persona avatar is the default placeholder shown when no video stream is available.\nFor more information see https://developer.microsoft.com/en-us/fluentui#/controls/web/persona\n@defaultValue 100px"},noVideoAvailableAriaLabel:{required:!1,tsType:{name:"string"},description:"Optional property to set the aria label of the video tile if there is no available stream."},isSpeaking:{required:!1,tsType:{name:"boolean"},description:"Whether the participant in the videoTile is speaking. Shows a speaking indicator (border)."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/VideoTile.tsx"]={name:"VideoTile",docgenInfo:VideoTile_VideoTile.__docgenInfo,path:"../react-components/src/components/VideoTile.tsx"});var RemoteVideoTile=react_default.a.memo((function(props){var isAvailable=props.isAvailable,isMuted=props.isMuted,isSpeaking=props.isSpeaking,isScreenSharingOn=props.isScreenSharingOn,onCreateRemoteStreamView=props.onCreateRemoteStreamView,onDisposeRemoteStreamView=props.onDisposeRemoteStreamView,remoteVideoViewOptions=props.remoteVideoViewOptions,renderElement=props.renderElement,userId=props.userId,displayName=props.displayName,onRenderAvatar=props.onRenderAvatar,showMuteIndicator=props.showMuteIndicator;Object(react.useEffect)((function(){return isAvailable&&!renderElement&&onCreateRemoteStreamView&&onCreateRemoteStreamView(userId,remoteVideoViewOptions),function(){renderElement&&!isScreenSharingOn&&onDisposeRemoteStreamView&&onDisposeRemoteStreamView(userId)}}),[isAvailable,onCreateRemoteStreamView,onDisposeRemoteStreamView,remoteVideoViewOptions,renderElement,userId,isScreenSharingOn]),Object(react.useEffect)((function(){return function(){isScreenSharingOn||onDisposeRemoteStreamView&&onDisposeRemoteStreamView(userId)}}),[onDisposeRemoteStreamView,userId,isScreenSharingOn]);var renderVideoStreamElement=Object(react.useMemo)((function(){if(renderElement&&renderElement.childElementCount)return Object(jsx_runtime.jsx)(StreamMedia_StreamMedia,{videoStreamElement:renderElement})}),[renderElement]);return Object(jsx_runtime.jsx)(VideoTile_VideoTile,{userId:userId,renderElement:renderVideoStreamElement,displayName:displayName,onRenderPlaceholder:onRenderAvatar,isMuted:isMuted,isSpeaking:isSpeaking,showMuteIndicator:showMuteIndicator},userId)})),DefaultButton=__webpack_require__(379),leftRightButtonStyles=function leftRightButtonStyles(theme){return{background:"none",padding:0,height:"auto",minWidth:"1.75rem",maxWidth:"1.75rem",border:"1px solid "+theme.palette.neutralLight,borderRadius:theme.effects.roundedCorner4}},rootStyle={height:"100%",width:"100%",gap:"0.5rem"},childrenContainerStyle={height:"100%",gap:"0.5rem"};function HorizontalGallery_slicedToArray(arr,i){return function HorizontalGallery_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function HorizontalGallery_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function HorizontalGallery_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return HorizontalGallery_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HorizontalGallery_arrayLikeToArray(o,minLen)}(arr,i)||function HorizontalGallery_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HorizontalGallery_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var HorizontalGallery_HorizontalGallery=function HorizontalGallery(props){var _props$styles,_props$styles2,children=props.children,_props$childrenPerPag=props.childrenPerPage,childrenPerPage=void 0===_props$childrenPerPag?5:_props$childrenPerPag,styles=props.styles,ids=IdentifierProvider_useIdentifiers(),_useState2=HorizontalGallery_slicedToArray(Object(react.useState)(0),2),page=_useState2[0],setPage=_useState2[1],numberOfChildren=react_default.a.Children.count(children),lastPage=Math.ceil(numberOfChildren/childrenPerPage)-1,paginatedChildren=Object(react.useMemo)((function(){return function bucketize(arr,bucketSize){var bucketArray=[];if(bucketSize<=0)return bucketArray;for(var i=0;i<arr.length;i+=bucketSize)bucketArray.push(arr.slice(i,i+bucketSize));return bucketArray}(react_default.a.Children.toArray(children),childrenPerPage)}),[children,childrenPerPage]);if(childrenPerPage<=0)return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{});var childrenOnCurrentPage=paginatedChildren[page*childrenPerPage<numberOfChildren-1?page:lastPage],showButtons=numberOfChildren>childrenPerPage,disablePreviousButton=0===page,disableNextButton=page===lastPage;return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.H)(rootStyle,null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.root),children:[showButtons&&Object(jsx_runtime.jsx)(HorizontalGallery_HorizontalGalleryNavigationButton,{icon:Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"HorizontalGalleryLeftButton"}),styles:null==styles?void 0:styles.previousButton,onClick:function onClick(){return setPage(Math.max(0,Math.min(lastPage,page-1)))},disabled:disablePreviousButton,identifier:ids.horizontalGalleryLeftNavButton},"previous-nav-button"),Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,className:Object(lib.H)(childrenContainerStyle,{"> *":null===(_props$styles2=props.styles)||void 0===_props$styles2?void 0:_props$styles2.children}),children:childrenOnCurrentPage}),showButtons&&Object(jsx_runtime.jsx)(HorizontalGallery_HorizontalGalleryNavigationButton,{icon:Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"HorizontalGalleryRightButton"}),styles:null==styles?void 0:styles.nextButton,onClick:function onClick(){return setPage(Math.min(lastPage,page+1))},disabled:disableNextButton,identifier:ids.horizontalGalleryRightNavButton},"next-nav-button")]})};HorizontalGallery_HorizontalGallery.displayName="HorizontalGallery";var HorizontalGallery_HorizontalGalleryNavigationButton=function HorizontalGalleryNavigationButton(props){var theme=Object(theming.e)();return Object(jsx_runtime.jsx)(DefaultButton.a,{className:Object(lib.H)(leftRightButtonStyles(theme),props.styles),onClick:props.onClick,disabled:props.disabled,"data-ui-id":props.identifier,children:props.icon})};HorizontalGallery_HorizontalGalleryNavigationButton.displayName="HorizontalGalleryNavigationButton",HorizontalGallery_HorizontalGallery.__docgenInfo={description:"Renders a horizontal gallery that parents children horizontally. Handles pagination based on the childrenPerPage prop.\n@param props - HorizontalGalleryProps {@link @azure/communication-react#HorizontalGalleryProps}\n@returns",methods:[],displayName:"HorizontalGallery",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},styles:{required:!1,tsType:{name:"HorizontalGalleryStyles"},description:"Styles for HorizontalGallery"},childrenPerPage:{required:!1,tsType:{name:"number"},description:"Children shown per page\n@defaultValue 5"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/HorizontalGallery.tsx"]={name:"HorizontalGallery",docgenInfo:HorizontalGallery_HorizontalGallery.__docgenInfo,path:"../react-components/src/components/HorizontalGallery.tsx"});var ResponsiveHorizontalGallery_ResponsiveHorizontalGallery=function ResponsiveHorizontalGallery(props){var childWidthRem=props.childWidthRem,gapWidthRem=props.gapWidthRem,_props$buttonWidthRem=props.buttonWidthRem,buttonWidthRem=void 0===_props$buttonWidthRem?0:_props$buttonWidthRem,containerRef=Object(react.useRef)(null),containerWidth=responsive_useContainerWidth(containerRef),leftPadding=containerRef.current?parseFloat(getComputedStyle(containerRef.current).paddingLeft):0,rightPadding=containerRef.current?parseFloat(getComputedStyle(containerRef.current).paddingRight):0,childrenPerPage=ResponsiveHorizontalGallery_calculateChildrenPerPage({numberOfChildren:react_default.a.Children.count(props.children),containerWidth:containerWidth-leftPadding-rightPadding,childWidthRem:childWidthRem,gapWidthRem:gapWidthRem,buttonWidthRem:buttonWidthRem});return Object(jsx_runtime.jsx)("div",{ref:containerRef,className:Object(lib.H)(props.containerStyles),children:Object(jsx_runtime.jsx)(HorizontalGallery_HorizontalGallery,{childrenPerPage:childrenPerPage,styles:props.horizontalGalleryStyles,children:props.children})})};ResponsiveHorizontalGallery_ResponsiveHorizontalGallery.displayName="ResponsiveHorizontalGallery";var ResponsiveHorizontalGallery_calculateChildrenPerPage=function calculateChildrenPerPage(args){var numberOfChildren=args.numberOfChildren,containerWidth=args.containerWidth,buttonWidthRem=args.buttonWidthRem,childWidthRem=args.childWidthRem,gapWidthRem=args.gapWidthRem,childWidth=convertRemToPx(childWidthRem),gapWidth=convertRemToPx(gapWidthRem),numberOfChildrenInContainer=Math.floor((containerWidth+gapWidth)/(childWidth+gapWidth));if(numberOfChildren<=numberOfChildrenInContainer)return numberOfChildrenInContainer;var childrenSpace=containerWidth-2*convertRemToPx(buttonWidthRem)-2*gapWidth;return Math.floor((childrenSpace+gapWidth)/(childWidth+gapWidth))};ResponsiveHorizontalGallery_ResponsiveHorizontalGallery.__docgenInfo={description:"Wrapped HorizontalGallery that adjusts the number of items per page based on the\navailable width obtained from a ResizeObserver, width per child, gap width, and button width",methods:[],displayName:"ResponsiveHorizontalGallery",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},containerStyles:{required:!0,tsType:{name:"IStyle"},description:""},horizontalGalleryStyles:{required:!0,tsType:{name:"HorizontalGalleryStyles"},description:""},childWidthRem:{required:!0,tsType:{name:"number"},description:""},gapWidthRem:{required:!0,tsType:{name:"number"},description:""},buttonWidthRem:{required:!1,tsType:{name:"number"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ResponsiveHorizontalGallery.tsx"]={name:"ResponsiveHorizontalGallery",docgenInfo:ResponsiveHorizontalGallery_ResponsiveHorizontalGallery.__docgenInfo,path:"../react-components/src/components/ResponsiveHorizontalGallery.tsx"});var videoGalleryOuterDivStyle=Object(lib.H)({position:"relative",width:"100%",height:"100%"}),videoGalleryContainerStyle={root:{position:"relative",height:"100%",width:"100%",padding:"0.5rem"}},SMALL_FLOATING_MODAL_SIZE_REM_width=4,SMALL_FLOATING_MODAL_SIZE_REM_height=5.5,LARGE_FLOATING_MODAL_SIZE_REM_width=10,LARGE_FLOATING_MODAL_SIZE_REM_height=7.5,VideoGallery_styles_floatingLocalVideoModalStyle=function floatingLocalVideoModalStyle(theme,isNarrow){return Object(lib.r)({main:localVideoTileContainerStyle(theme,isNarrow)},{main:{boxShadow:theme.effects.elevation8}})},localVideoTileContainerStyle=function localVideoTileContainerStyle(theme,isNarrow){return Object.assign({minWidth:isNarrow?SMALL_FLOATING_MODAL_SIZE_REM_width+"rem":LARGE_FLOATING_MODAL_SIZE_REM_width+"rem",minHeight:isNarrow?SMALL_FLOATING_MODAL_SIZE_REM_height+"rem":LARGE_FLOATING_MODAL_SIZE_REM_height+"rem",position:"absolute",bottom:"0.5rem",borderRadius:theme.effects.roundedCorner4,overflow:"hidden"},theme.rtl?{left:"0.5rem"}:{right:"0.5rem"})},floatingLocalVideoTileStyle={root:{position:"absolute",zIndex:1,height:"100%",width:"100%"}},horizontalGalleryContainerStyle=function horizontalGalleryContainerStyle(shouldFloatLocalVideo,isNarrow){return{maxHeight:isNarrow?SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.height+"rem":LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.height+"rem",minHeight:isNarrow?SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.height+"rem":LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.height+"rem",width:shouldFloatLocalVideo?isNarrow?"calc(100% - "+SMALL_FLOATING_MODAL_SIZE_REM_width+"rem)":"calc(100% - "+LARGE_FLOATING_MODAL_SIZE_REM_width+"rem)":"100%",paddingRight:"0.5rem"}},horizontalGalleryStyle=function horizontalGalleryStyle(isNarrow){return{children:isNarrow?SMALL_HORIZONTAL_GALLERY_TILE_STYLE:LARGE_HORIZONTAL_GALLERY_TILE_STYLE}},SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM={height:5.5,width:5.5},LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM={height:7.5,width:10},SMALL_HORIZONTAL_GALLERY_TILE_STYLE={minHeight:SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.height+"rem",minWidth:SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.width+"rem",maxHeight:SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.height+"rem",maxWidth:SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.width+"rem"},LARGE_HORIZONTAL_GALLERY_TILE_STYLE={minHeight:LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.height+"rem",minWidth:LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.width+"rem",maxHeight:LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.height+"rem",maxWidth:LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.width+"rem"},layerHostStyle={position:"absolute",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},localVideoCameraCycleButtonStyles={root:{position:"absolute",right:"0.2rem",top:"0.2rem",color:"#FFFFFF",zIndex:2,background:"transparent"},rootFocused:{color:"#FFFFFF",background:"transparent"}},screenSharingContainerStyle=Object(lib.H)({width:"100%",height:"100%"}),LocalScreenShare_styles_screenSharingNotificationContainerStyle=function screenSharingNotificationContainerStyle(theme){return Object(lib.H)({backgroundColor:"inherit",padding:"1rem",maxWidth:"95%",borderRadius:theme.effects.roundedCorner4,color:theme.palette.neutralSecondary})},screenSharingNotificationIconContainerStyle=Object(lib.H)({height:"2rem",lineHeight:0}),LocalScreenShare_styles_screenSharingNotificationIconStyle=function screenSharingNotificationIconStyle(theme){return Object(lib.H)({transform:"scale(2.5)",color:theme.palette.neutralTertiary})},screenSharingNotificationTextStyle=Object(lib.H)({fontSize:"1rem",color:"inherit"}),LocalScreenShare=react_default.a.memo((function(props){var localParticipant=props.localParticipant,theme=Object(theming.e)(),locale=LocalizationProvider_useLocale();if(!localParticipant||!localParticipant.isScreenSharingOn)return null;var localScreenSharingNotification=Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:screenSharingContainerStyle,children:Object(jsx_runtime.jsxs)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:LocalScreenShare_styles_screenSharingNotificationContainerStyle(theme),tokens:{childrenGap:"1rem"},children:[Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,verticalAlign:"center",className:screenSharingNotificationIconContainerStyle,children:Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"ControlButtonScreenShareStart",className:LocalScreenShare_styles_screenSharingNotificationIconStyle(theme)})}),Object(jsx_runtime.jsx)(Text.a,{className:screenSharingNotificationTextStyle,"aria-live":"polite",children:locale.strings.videoGallery.screenIsBeingSharedMessage})]})});return Object(jsx_runtime.jsx)(VideoTile_VideoTile,{displayName:null==localParticipant?void 0:localParticipant.displayName,isMuted:null==localParticipant?void 0:localParticipant.isMuted,onRenderPlaceholder:function onRenderPlaceholder(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},children:localScreenSharingNotification})})),Spinner=__webpack_require__(1743),Spinner_types=__webpack_require__(207),loadingStyle=Object(lib.H)({height:"100%",width:"100%"}),RemoteScreenShare=react_default.a.memo((function(props){var userId=props.userId,displayName=props.displayName,isMuted=props.isMuted,renderElement=props.renderElement,onCreateRemoteStreamView=props.onCreateRemoteStreamView,onDisposeRemoteStreamView=props.onDisposeRemoteStreamView,locale=LocalizationProvider_useLocale();renderElement||onCreateRemoteStreamView&&onCreateRemoteStreamView(userId),Object(react.useEffect)((function(){return function(){onDisposeRemoteStreamView&&onDisposeRemoteStreamView(userId)}}),[onDisposeRemoteStreamView,userId]);var loadingMessage=displayName?Object(src.b)(locale.strings.videoGallery.screenShareLoadingMessage,{participant:displayName}):"";return Object(jsx_runtime.jsx)(VideoTile_VideoTile,{displayName:displayName,isMuted:isMuted,renderElement:renderElement?Object(jsx_runtime.jsx)(StreamMedia_StreamMedia,{videoStreamElement:renderElement}):void 0,onRenderPlaceholder:function onRenderPlaceholder(){return Object(jsx_runtime.jsx)(RemoteScreenShare_LoadingSpinner,{loadingMessage:loadingMessage})}})})),RemoteScreenShare_LoadingSpinner=function LoadingSpinner(props){return Object(jsx_runtime.jsx)(Stack.a,{verticalAlign:"center",className:loadingStyle,children:Object(jsx_runtime.jsx)(Spinner.a,{label:props.loadingMessage,size:Spinner_types.a.xSmall,"aria-live":"assertive"})})};RemoteScreenShare_LoadingSpinner.displayName="LoadingSpinner";var useId=__webpack_require__(1706),LocalVideoCameraButton_LocalVideoCameraCycleButton=(__webpack_require__(566),function LocalVideoCameraCycleButton(props){var cameras=props.cameras,selectedCamera=props.selectedCamera,onSelectCamera=props.onSelectCamera,label=props.label;return Object(jsx_runtime.jsx)(IconButton.a,{"data-ui-id":"local-camera-switcher-button",styles:localVideoCameraCycleButtonStyles,iconProps:{iconName:"LocalCameraSwitch"},ariaLabel:label,"aria-live":"polite",onClick:function onClick(){if(cameras&&cameras.length>1&&void 0!==selectedCamera){var index=cameras.findIndex((function(camera){return selectedCamera.id===camera.id})),newCamera=cameras[(index+1)%cameras.length];void 0!==onSelectCamera&&onSelectCamera(newCamera)}}})});LocalVideoCameraButton_LocalVideoCameraCycleButton.displayName="LocalVideoCameraCycleButton",LocalVideoCameraButton_LocalVideoCameraCycleButton.__docgenInfo={description:"local video tile camera cycle button - for use on mobile screens only.\n@internal",methods:[],displayName:"LocalVideoCameraCycleButton",props:{cameras:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Array of cameras available to the user."},selectedCamera:{required:!1,tsType:{name:"OptionsDevice"},description:"Currently selected camera in the local video stream."},onSelectCamera:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"callback function to change video feed."},label:{required:!1,tsType:{name:"string"},description:"label for local video camera switcher"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/LocalVideoCameraButton.tsx"]={name:"LocalVideoCameraCycleButton",docgenInfo:LocalVideoCameraButton_LocalVideoCameraCycleButton.__docgenInfo,path:"../react-components/src/components/LocalVideoCameraButton.tsx"});var DRAG_OPTIONS={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:ContextualMenu.a,keepInBounds:!0},VideoGallery_VideoGallery=function VideoGallery(props){var _remoteParticipants$f,_remoteParticipants$f2,_localParticipant$vid,_screenShareParticipa,localParticipant=props.localParticipant,_props$remoteParticip=props.remoteParticipants,remoteParticipants=void 0===_props$remoteParticip?[]:_props$remoteParticip,localVideoViewOptions=props.localVideoViewOptions,remoteVideoViewOptions=props.remoteVideoViewOptions,dominantSpeakers=props.dominantSpeakers,onRenderLocalVideoTile=props.onRenderLocalVideoTile,onRenderRemoteVideoTile=props.onRenderRemoteVideoTile,onCreateLocalStreamView=props.onCreateLocalStreamView,onCreateRemoteStreamView=props.onCreateRemoteStreamView,onDisposeRemoteStreamView=props.onDisposeRemoteStreamView,styles=props.styles,layout=props.layout,onRenderAvatar=props.onRenderAvatar,showMuteIndicator=props.showMuteIndicator,_props$maxRemoteVideo=props.maxRemoteVideoStreams,maxRemoteVideoStreams=void 0===_props$maxRemoteVideo?4:_props$maxRemoteVideo,showCameraSwitcherInLocalPreview=props.showCameraSwitcherInLocalPreview,localVideoCameraCycleButtonProps=props.localVideoCameraCycleButtonProps,ids=IdentifierProvider_useIdentifiers(),theme=Object(theming.e)(),localeStrings=LocalizationProvider_useLocale().strings.videoGallery,strings=Object.assign({},localeStrings,props.strings),shouldFloatLocalVideo=!!("floatingLocalVideo"===layout&&remoteParticipants.length>0),containerRef=Object(react.useRef)(null),containerWidth=responsive_useContainerWidth(containerRef),isNarrow=responsive_isNarrowWidth(containerWidth),visibleVideoParticipants=Object(react.useRef)([]),visibleAudioParticipants=Object(react.useRef)([]);visibleVideoParticipants.current=smartDominantSpeakerParticipants({participants:null!==(_remoteParticipants$f=null==remoteParticipants?void 0:remoteParticipants.filter((function(p){var _p$videoStream;return null===(_p$videoStream=p.videoStream)||void 0===_p$videoStream?void 0:_p$videoStream.isAvailable})))&&void 0!==_remoteParticipants$f?_remoteParticipants$f:[],dominantSpeakers:dominantSpeakers,lastVisibleParticipants:visibleVideoParticipants.current,maxDominantSpeakers:maxRemoteVideoStreams}).slice(0,maxRemoteVideoStreams);var visibleVideoParticipantsSet=new Set(visibleVideoParticipants.current.map((function(p){return p.userId})));visibleAudioParticipants.current=smartDominantSpeakerParticipants({participants:null!==(_remoteParticipants$f2=null==remoteParticipants?void 0:remoteParticipants.filter((function(p){return!visibleVideoParticipantsSet.has(p.userId)})))&&void 0!==_remoteParticipants$f2?_remoteParticipants$f2:[],dominantSpeakers:dominantSpeakers,lastVisibleParticipants:visibleAudioParticipants.current,maxDominantSpeakers:6});var localCameraCycleButton=function localCameraCycleButton(localVideoCameraCycleButtonProps){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:showCameraSwitcherInLocalPreview&&void 0!==(null==localVideoCameraCycleButtonProps?void 0:localVideoCameraCycleButtonProps.cameras)&&void 0!==(null==localVideoCameraCycleButtonProps?void 0:localVideoCameraCycleButtonProps.selectedCamera)&&void 0!==(null==localVideoCameraCycleButtonProps?void 0:localVideoCameraCycleButtonProps.onSelectCamera)&&Object(jsx_runtime.jsx)(LocalVideoCameraButton_LocalVideoCameraCycleButton,{cameras:localVideoCameraCycleButtonProps.cameras,selectedCamera:localVideoCameraCycleButtonProps.selectedCamera,onSelectCamera:localVideoCameraCycleButtonProps.onSelectCamera,label:strings.localVideoCameraSwitcherLabel})})},localVideoTile=Object(react.useMemo)((function(){var localVideoStream=null==localParticipant?void 0:localParticipant.videoStream;if(onRenderLocalVideoTile)return onRenderLocalVideoTile(localParticipant);var localVideoTileStyles=shouldFloatLocalVideo?floatingLocalVideoTileStyle:{},localVideoTileStylesThemed=Object(lib.r)(localVideoTileStyles,{root:{borderRadius:theme.effects.roundedCorner4}},null==styles?void 0:styles.localVideo);return localVideoStream&&!localVideoStream.renderElement&&onCreateLocalStreamView&&onCreateLocalStreamView(localVideoViewOptions),Object(jsx_runtime.jsx)(VideoTile_VideoTile,{userId:localParticipant.userId,renderElement:null!=localVideoStream&&localVideoStream.renderElement?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[localCameraCycleButton(localVideoCameraCycleButtonProps),Object(jsx_runtime.jsx)(StreamMedia_StreamMedia,{videoStreamElement:localVideoStream.renderElement})]}):void 0,showLabel:!(shouldFloatLocalVideo&&isNarrow),displayName:isNarrow?"":strings.localVideoLabel,initialsName:localParticipant.displayName,styles:localVideoTileStylesThemed,onRenderPlaceholder:onRenderAvatar,isMuted:localParticipant.isMuted,showMuteIndicator:showMuteIndicator},localParticipant.userId)}),[localParticipant,localParticipant.isScreenSharingOn,localParticipant.videoStream,null===(_localParticipant$vid=localParticipant.videoStream)||void 0===_localParticipant$vid?void 0:_localParticipant$vid.renderElement,isNarrow,onCreateLocalStreamView,onRenderLocalVideoTile,onRenderAvatar,shouldFloatLocalVideo]),defaultOnRenderVideoTile=Object(react.useCallback)((function(participant,isVideoParticipant){var remoteVideoStream=participant.videoStream;return Object(jsx_runtime.jsx)(RemoteVideoTile,Object.assign({},participant,{onCreateRemoteStreamView:isVideoParticipant?onCreateRemoteStreamView:void 0,onDisposeRemoteStreamView:isVideoParticipant?onDisposeRemoteStreamView:void 0,isAvailable:!!isVideoParticipant&&(null==remoteVideoStream?void 0:remoteVideoStream.isAvailable),renderElement:isVideoParticipant?null==remoteVideoStream?void 0:remoteVideoStream.renderElement:void 0,remoteVideoViewOptions:isVideoParticipant?remoteVideoViewOptions:void 0,onRenderAvatar:onRenderAvatar,showMuteIndicator:showMuteIndicator}),participant.userId)}),[onCreateRemoteStreamView,onDisposeRemoteStreamView,remoteVideoViewOptions,onRenderAvatar,showMuteIndicator]),videoTiles=onRenderRemoteVideoTile?visibleVideoParticipants.current.map((function(participant){return onRenderRemoteVideoTile(participant)})):visibleVideoParticipants.current.map((function(participant){return defaultOnRenderVideoTile(participant,!0)})),audioTiles=onRenderRemoteVideoTile?visibleAudioParticipants.current.map((function(participant){return onRenderRemoteVideoTile(participant)})):visibleAudioParticipants.current.map((function(participant){return defaultOnRenderVideoTile(participant,!1)})),screenShareParticipant=remoteParticipants.find((function(participant){var _participant$screenSh;return null===(_participant$screenSh=participant.screenShareStream)||void 0===_participant$screenSh?void 0:_participant$screenSh.isAvailable})),gridTiles=[],horizontalGalleryTiles=[];screenShareParticipant||(null==localParticipant?void 0:localParticipant.isScreenSharingOn)?horizontalGalleryTiles=videoTiles.concat(audioTiles):(gridTiles=videoTiles.length>0?videoTiles:audioTiles,horizontalGalleryTiles=videoTiles.length>0?audioTiles:[]),!shouldFloatLocalVideo&&localParticipant&&gridTiles.push(localVideoTile);var localScreenShareStreamComponent=Object(jsx_runtime.jsx)(LocalScreenShare,{localParticipant:localParticipant}),remoteScreenShareComponent=screenShareParticipant&&Object(jsx_runtime.jsx)(RemoteScreenShare,Object.assign({},screenShareParticipant,{renderElement:null===(_screenShareParticipa=screenShareParticipant.screenShareStream)||void 0===_screenShareParticipa?void 0:_screenShareParticipa.renderElement,onCreateRemoteStreamView:onCreateRemoteStreamView,onDisposeRemoteStreamView:onDisposeRemoteStreamView})),horizontalGalleryPresent=horizontalGalleryTiles&&horizontalGalleryTiles.length>0,layerHostId=Object(useId.a)("layerhost");return Object(jsx_runtime.jsxs)("div",{"data-ui-id":ids.videoGallery,ref:containerRef,className:Object(lib.H)(videoGalleryOuterDivStyle,null==styles?void 0:styles.root),children:[shouldFloatLocalVideo&&localParticipant&&(horizontalGalleryPresent?Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)(localVideoTileContainerStyle(theme,isNarrow)),children:localVideoTile}):Object(jsx_runtime.jsx)(Modal.a,{isOpen:!0,isModeless:!0,dragOptions:DRAG_OPTIONS,styles:VideoGallery_styles_floatingLocalVideoModalStyle(theme,isNarrow),layerProps:{hostId:layerHostId},children:localVideoTile})),Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!1,styles:videoGalleryContainerStyle,children:[screenShareParticipant?remoteScreenShareComponent:null!=localParticipant&&localParticipant.isScreenSharingOn?localScreenShareStreamComponent:Object(jsx_runtime.jsx)(GridLayout_GridLayout,{styles:null==styles?void 0:styles.gridLayout,children:gridTiles},"grid-layout"),horizontalGalleryPresent&&Object(jsx_runtime.jsx)("div",{style:{paddingTop:"0.5rem"},children:Object(jsx_runtime.jsx)(ResponsiveHorizontalGallery_ResponsiveHorizontalGallery,{containerStyles:horizontalGalleryContainerStyle(shouldFloatLocalVideo,isNarrow),horizontalGalleryStyles:Object(lib.r)(horizontalGalleryStyle(isNarrow),null==styles?void 0:styles.horizontalGallery),childWidthRem:isNarrow?SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.width:LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.width,buttonWidthRem:1.75,gapWidthRem:.5,children:horizontalGalleryTiles},"responsive-horizontal-gallery")}),Object(jsx_runtime.jsx)(LayerHost.a,{id:layerHostId,className:Object(lib.H)(layerHostStyle)})]})]})};VideoGallery_VideoGallery.displayName="VideoGallery",VideoGallery_VideoGallery.__docgenInfo={description:"VideoGallery represents a layout of video tiles for a specific call.\nIt displays a {@link VideoTile} for the local user as well as for each remote participant who has joined the call.\n\n@public",methods:[],displayName:"VideoGallery",props:{styles:{required:!1,tsType:{name:"VideoGalleryStyles"},description:"Allows users to pass an object containing custom CSS styles for the gallery container.\n\n@Example\n```\n<VideoGallery styles={{ root: { border: 'solid 1px red' } }} />\n```"},layout:{required:!1,tsType:{name:"union",raw:"'default' | 'floatingLocalVideo'",elements:[{name:"literal",value:"'default'"},{name:"literal",value:"'floatingLocalVideo'"}]},description:"Layout of the video tiles."},localParticipant:{required:!0,tsType:{name:"VideoGalleryLocalParticipant"},description:"Local video particpant"},remoteParticipants:{required:!1,tsType:{name:"Array",elements:[{name:"VideoGalleryRemoteParticipant"}],raw:"VideoGalleryRemoteParticipant[]"},description:"List of remote video particpants"},dominantSpeakers:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"List of dominant speaker userIds in the order of their dominance. 0th index is the most dominant."},localVideoViewOptions:{required:!1,tsType:{name:"VideoStreamOptions"},description:"Local video view options"},remoteVideoViewOptions:{required:!1,tsType:{name:"VideoStreamOptions"},description:"Remote videos view options"},onCreateLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback to create the local video stream view"},onDisposeLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback to dispose of the local video stream view"},onRenderLocalVideoTile:{required:!1,tsType:{name:"signature",type:"function",raw:"(localParticipant: VideoGalleryLocalParticipant) => JSX.Element",signature:{arguments:[{name:"localParticipant",type:{name:"VideoGalleryLocalParticipant"}}],return:{name:"JSX.Element"}}},description:"Callback to render the local video tile"},onCreateRemoteStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback to create a remote video stream view"},onRenderRemoteVideoTile:{required:!1,tsType:{name:"signature",type:"function",raw:"(remoteParticipant: VideoGalleryRemoteParticipant) => JSX.Element",signature:{arguments:[{name:"remoteParticipant",type:{name:"VideoGalleryRemoteParticipant"}}],return:{name:"JSX.Element"}}},description:"Callback to render a remote video tile"},onDisposeRemoteStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => Promise<void>",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback to dispose a remote video stream view"},onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:"Callback to render a particpant avatar"},showCameraSwitcherInLocalPreview:{required:!1,tsType:{name:"boolean"},description:"Whether to display the local video camera switcher button"},showMuteIndicator:{required:!1,tsType:{name:"boolean"},description:"Whether to display a mute icon beside the user's display name.\n@defaultValue `true`"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"VideoGalleryStrings"}],raw:"Partial<VideoGalleryStrings>"},description:"Optional strings to override in component"},maxRemoteVideoStreams:{required:!1,tsType:{name:"number"},description:"Maximum number of participant remote video streams that is rendered.\n@defaultValue 4"},localVideoCameraCycleButtonProps:{required:!1,tsType:{name:"LocalVideoCameraCycleButtonProps"},description:"Camera control information for button to switch cameras."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/VideoGallery.tsx"]={name:"VideoGallery",docgenInfo:VideoGallery_VideoGallery.__docgenInfo,path:"../react-components/src/components/VideoGallery.tsx"});__webpack_require__(113);var controlBarStyles={horizontal:{flexFlow:"row nowrap"},vertical:{flexFlow:"column nowrap",width:"fit-content",maxWidth:"8rem"},dockedTop:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",minWidth:"fit-content"},dockedBottom:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",bottom:0,left:0,width:"100%",minWidth:"fit-content"},dockedLeft:{justifyContent:"center",overflow:"hidden",position:"absolute",top:0,left:0,height:"100%"},dockedRight:{justifyContent:"center",overflow:"hidden",position:"absolute",top:0,right:0,height:"100%"},floatingTop:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",top:"1rem",left:"50%",transform:"translateX(-50%)",minWidth:"fit-content",zIndex:10},floatingBottom:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",bottom:"1rem",left:"50%",transform:"translateX(-50%)",minWidth:"fit-content",zIndex:10},floatingLeft:{flexFlow:"column nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",top:"50%",left:"1rem",transform:"translateY(-50%)",zIndex:10},floatingRight:{flexFlow:"column nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",top:"50%",right:"1rem",transform:"translateY(-50%)",zIndex:10}},controlButtonStyles={root:{background:"none",border:"none",borderRadius:0,minHeight:"3.5rem",minWidth:"3.5rem",width:"100%",maxWidth:"8rem",svg:{verticalAlign:"text-top"}},splitButtonMenuButton:{border:"none"},flexContainer:{flexFlow:"column",display:"contents"},label:{fontSize:"0.625rem",fontWeight:"400",lineHeight:"1rem",cursor:"pointer",display:"block",margin:"0rem 0.25rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},participantsButtonMenuPropsStyle={title:{background:"initial",paddingLeft:".5rem",fontWeight:600,fontSize:".75rem"}},defaultParticipantListContainerStyle={root:{maxHeight:"20rem"}},buttonFlyoutItemStyles={icon:{lineHeight:0},checkmarkIcon:{lineHeight:0}},calloutProps={gapSpace:0},hostStyles={root:{display:"inline-block"}},ControlButtonTooltip_ControlButtonTooltip=function ControlButtonTooltip(props){return Object(jsx_runtime.jsx)(TooltipHost.a,Object.assign({},props,{"data-ui-id":props.id,calloutProps:Object.assign({},calloutProps,props.calloutProps),styles:Object(lib.G)(hostStyles,props.styles),children:props.children}))};ControlButtonTooltip_ControlButtonTooltip.displayName="ControlButtonTooltip",ControlButtonTooltip_ControlButtonTooltip.__docgenInfo={description:"Tooltip that should wrap control bar buttons.\n\n@private",methods:[],displayName:"ControlButtonTooltip"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ControlButtonTooltip.tsx"]={name:"ControlButtonTooltip",docgenInfo:ControlButtonTooltip_ControlButtonTooltip.__docgenInfo,path:"../react-components/src/components/ControlButtonTooltip.tsx"});var DefaultRenderIcon=function DefaultRenderIcon(props){return null!=props&&props.checked?null!=props&&props.onRenderOnIcon?null==props?void 0:props.onRenderOnIcon():null:null!=props&&props.onRenderOffIcon?null==props?void 0:props.onRenderOffIcon():null},ControlBarButton_ControlBarButton=function ControlBarButton(props){var _props$styles,_ref,_props$text,_props$strings,_props$strings2,_props$strings3,_props$strings$toolti,_props$strings4,_props$strings5,_props$strings6,_props$strings7,_props$tooltipId,_props$onRenderIcon,_props$allowDisabledF,componentStyles=Object(lib.r)(controlButtonStyles,null!==(_props$styles=props.styles)&&void 0!==_props$styles?_props$styles:{}),labelText=null!==(_ref=null!==(_props$text=null==props?void 0:props.text)&&void 0!==_props$text?_props$text:null==props||null===(_props$strings=props.strings)||void 0===_props$strings?void 0:_props$strings.label)&&void 0!==_ref?_ref:null!=props&&props.checked?null==props||null===(_props$strings2=props.strings)||void 0===_props$strings2?void 0:_props$strings2.onLabel:null==props||null===(_props$strings3=props.strings)||void 0===_props$strings3?void 0:_props$strings3.offLabel,tooltipContent=null!==(_props$strings$toolti=null==props||null===(_props$strings4=props.strings)||void 0===_props$strings4?void 0:_props$strings4.tooltipContent)&&void 0!==_props$strings$toolti?_props$strings$toolti:null!=props&&props.disabled?null==props||null===(_props$strings5=props.strings)||void 0===_props$strings5?void 0:_props$strings5.tooltipDisabledContent:null!=props&&props.checked?null==props||null===(_props$strings6=props.strings)||void 0===_props$strings6?void 0:_props$strings6.tooltipOnContent:null==props||null===(_props$strings7=props.strings)||void 0===_props$strings7?void 0:_props$strings7.tooltipOffContent,tooltipId=(null!==(_props$tooltipId=props.tooltipId)&&void 0!==_props$tooltipId?_props$tooltipId:props.labelKey)?props.labelKey+"-tooltip":void 0;return Object(jsx_runtime.jsx)(ControlButtonTooltip_ControlButtonTooltip,{content:tooltipContent,id:tooltipId,children:Object(jsx_runtime.jsx)(DefaultButton.a,Object.assign({},props,{styles:componentStyles,onRenderText:props.showLabel&&props.onRenderText?props.onRenderText:void 0,onRenderIcon:null!==(_props$onRenderIcon=props.onRenderIcon)&&void 0!==_props$onRenderIcon?_props$onRenderIcon:DefaultRenderIcon,ariaLabel:tooltipContent,allowDisabledFocus:null===(_props$allowDisabledF=props.allowDisabledFocus)||void 0===_props$allowDisabledF||_props$allowDisabledF,children:props.showLabel?labelText:Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}))})};ControlBarButton_ControlBarButton.displayName="ControlBarButton",ControlBarButton_ControlBarButton.__docgenInfo={description:"Default button styled for the {@link ControlBar}.\n\nUse this component create custom buttons that are styled the same as other buttons provided by the UI Library.\n\n@public",methods:[],displayName:"ControlBarButton",props:{showLabel:{required:!1,tsType:{name:"boolean"},description:"Whether the label is displayed or not.\n\n@defaultValue `false`"},labelKey:{required:!1,tsType:{name:"string"},description:"Key to use for the Label component"},tooltipId:{required:!1,tsType:{name:"string"},description:"Id to use for the tooltip host.\n\n@defaultValue This uses the labelKey and appends -tooltip by default"},strings:{required:!1,tsType:{name:"ControlBarButtonStrings"},description:"Optional strings to override in component."},onRenderOnIcon:{required:!1,tsType:{name:"IRenderFunction",elements:[{name:"IButtonProps"}],raw:"IRenderFunction<IButtonProps>"},description:"Icon to render when the button is checked."},onRenderOffIcon:{required:!1,tsType:{name:"IRenderFunction",elements:[{name:"IButtonProps"}],raw:"IRenderFunction<IButtonProps>"},description:"Icon to render when the button is not checked."},styles:{required:!1,tsType:{name:"IButtonStyles"},description:"Fluent styles, including extensions common to all {@link ControlBarButton}s."}},composes:["IButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ControlBarButton.tsx"]={name:"ControlBarButton",docgenInfo:ControlBarButton_ControlBarButton.__docgenInfo,path:"../react-components/src/components/ControlBarButton.tsx"});var HighContrastAwareIcon_HighContrastAwareIcon=function HighContrastAwareIcon(props){var iconName=props.iconName,disabled=props.disabled,theme=Object(theming.e)();return Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:iconName,className:Object(lib.H)({svg:{fill:disabled?theme.palette.neutralTertiary:theme.palette.neutralPrimaryAlt,"@media (forced-colors: active) and (prefers-color-scheme: dark)":{fill:disabled?theme.palette.neutralPrimaryAlt:theme.palette.neutralTertiary}}})})};HighContrastAwareIcon_HighContrastAwareIcon.displayName="HighContrastAwareIcon",HighContrastAwareIcon_HighContrastAwareIcon.__docgenInfo={description:"This is a helper component to define and unify icon colors\n\n@private",methods:[],displayName:"HighContrastAwareIcon",props:{iconName:{required:!0,tsType:{name:"string"},description:"Icon name"},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"Whether button is disabled"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/HighContrastAwareIcon.tsx"]={name:"HighContrastAwareIcon",docgenInfo:HighContrastAwareIcon_HighContrastAwareIcon.__docgenInfo,path:"../react-components/src/components/HighContrastAwareIcon.tsx"});var ContextualMenu_types=__webpack_require__(166),DevicesButton_generateDefaultDeviceMenuProps=function generateDefaultDeviceMenuProps(props,strings){var _props$styles$menuIte,_props$styles,microphones=props.microphones,speakers=props.speakers,cameras=props.cameras,selectedMicrophone=props.selectedMicrophone,selectedSpeaker=props.selectedSpeaker,selectedCamera=props.selectedCamera,onSelectCamera=props.onSelectCamera,onSelectMicrophone=props.onSelectMicrophone,onSelectSpeaker=props.onSelectSpeaker,defaultMenuProps={items:[],styles:props.styles,calloutProps:{styles:{root:{maxWidth:"95%"}},preventDismissOnResize:!0}},menuItemStyles=Object(merge.a)(buttonFlyoutItemStyles,null!==(_props$styles$menuIte=null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.menuItemStyles)&&void 0!==_props$styles$menuIte?_props$styles$menuIte:{});if(cameras&&selectedCamera&&onSelectCamera&&defaultMenuProps.items.push({key:"sectionCamera",title:strings.cameraMenuTooltip,itemType:ContextualMenu_types.a.Section,sectionProps:{title:strings.cameraMenuTitle,items:cameras.map((function(camera){return{key:camera.id,text:camera.name,title:camera.name,iconProps:{iconName:"OptionsCamera",styles:{root:{lineHeight:0}}},itemProps:{styles:menuItemStyles},role:"menuitem",canCheck:!0,isChecked:camera.id===(null==selectedCamera?void 0:selectedCamera.id),onClick:function onClick(){camera.id!==(null==selectedCamera?void 0:selectedCamera.id)&&onSelectCamera(camera)}}}))}}),microphones&&selectedMicrophone&&onSelectMicrophone&&defaultMenuProps.items.push({key:"sectionMicrophone",title:strings.microphoneMenuTooltip,itemType:ContextualMenu_types.a.Section,sectionProps:{title:strings.microphoneMenuTitle,items:microphones.map((function(microphone){return{key:microphone.id,text:microphone.name,title:microphone.name,iconProps:{iconName:"OptionsMic",styles:{root:{lineHeight:0}}},itemProps:{styles:menuItemStyles},role:"menuitem",canCheck:!0,isChecked:microphone.id===(null==selectedMicrophone?void 0:selectedMicrophone.id),onClick:function onClick(){microphone.id!==(null==selectedMicrophone?void 0:selectedMicrophone.id)&&onSelectMicrophone(microphone)}}}))}}),speakers&&selectedSpeaker&&onSelectSpeaker&&defaultMenuProps.items.push({key:"sectionSpeaker",title:strings.speakerMenuTooltip,itemType:ContextualMenu_types.a.Section,sectionProps:{title:strings.speakerMenuTitle,items:speakers.map((function(speaker){return{key:speaker.id,text:speaker.name,title:speaker.name,iconProps:{iconName:"OptionsSpeaker",styles:{root:{lineHeight:0}}},itemProps:{styles:menuItemStyles},role:"menuitem",canCheck:!0,isChecked:speaker.id===(null==selectedSpeaker?void 0:selectedSpeaker.id),onClick:function onClick(){speaker.id!==(null==selectedSpeaker?void 0:selectedSpeaker.id)&&onSelectSpeaker(speaker)}}}))}}),0!==defaultMenuProps.items.length)return defaultMenuProps},DevicesButton_DevicesButton=function DevicesButton(props){var _props$menuProps,_props$styles2,_props$labelKey,onRenderIcon=props.onRenderIcon,localeStrings=LocalizationProvider_useLocale().strings.devicesButton,strings=Object.assign({},localeStrings,props.strings),devicesButtonMenu=null!==(_props$menuProps=props.menuProps)&&void 0!==_props$menuProps?_props$menuProps:DevicesButton_generateDefaultDeviceMenuProps(Object.assign({},props,{styles:null===(_props$styles2=props.styles)||void 0===_props$styles2?void 0:_props$styles2.menuStyles}),strings);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{menuProps:devicesButtonMenu,menuIconProps:{hidden:!0},onRenderIcon:null!=onRenderIcon?onRenderIcon:function onRenderOptionsIcon(){return Object(jsx_runtime.jsx)(HighContrastAwareIcon_HighContrastAwareIcon,{disabled:props.disabled,iconName:"ControlButtonOptions"})},strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"devicesButtonLabel"}))};function CameraButton_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CameraButton_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CameraButton_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CameraButton_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function CameraButton_slicedToArray(arr,i){return function CameraButton_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CameraButton_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CameraButton_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CameraButton_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CameraButton_arrayLikeToArray(o,minLen)}(arr,i)||function CameraButton_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CameraButton_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}DevicesButton_DevicesButton.displayName="DevicesButton",DevicesButton_DevicesButton.__docgenInfo={description:"A button to open a menu that controls device options.\n\nCan be used with {@link ControlBar}.\n\n@public",methods:[],displayName:"DevicesButton",props:{microphones:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available microphones for selection"},speakers:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available speakers for selection"},cameras:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available cameras for selection"},selectedMicrophone:{required:!1,tsType:{name:"OptionsDevice"},description:"Microphone that is shown as currently selected"},selectedSpeaker:{required:!1,tsType:{name:"OptionsDevice"},description:"Speaker that is shown as currently selected"},selectedCamera:{required:!1,tsType:{name:"OptionsDevice"},description:"Camera that is shown as currently selected"},onSelectCamera:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback when a camera is selected"},onSelectMicrophone:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback when a microphone is selected"},onSelectSpeaker:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Speaker when a speaker is selected"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"DevicesButtonStrings"}],raw:"Partial<DevicesButtonStrings>"},description:"Optional strings to override in component"},styles:{required:!1,tsType:{name:"DevicesButtonStyles"},description:"Option to increase the touch targets of the button flyout menu items from 36px to 48px.\nRecommended for mobile devices."}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/DevicesButton.tsx"]={name:"DevicesButton",docgenInfo:DevicesButton_DevicesButton.__docgenInfo,path:"../react-components/src/components/DevicesButton.tsx"});var defaultLocalVideoViewOptions={scalingMode:"Crop",isMirrored:!0},CameraButton_CameraButton=function CameraButton(props){var _props$onRenderOnIcon,_props$onRenderOffIco,_props$labelKey,_props$menuProps,_props$menuIconProps,_props$split,localVideoViewOptions=props.localVideoViewOptions,onToggleCamera=props.onToggleCamera,_useState2=CameraButton_slicedToArray(Object(react.useState)(!1),2),waitForCamera=_useState2[0],setWaitForCamera=_useState2[1],localeStrings=LocalizationProvider_useLocale().strings.cameraButton,strings=Object.assign({},localeStrings,props.strings);waitForCamera&&strings.tooltipVideoLoadingContent&&(strings.tooltipDisabledContent=strings.tooltipVideoLoadingContent);var onToggleClick=Object(react.useCallback)(CameraButton_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!onToggleCamera){_context.next=8;break}return setWaitForCamera(!0),_context.prev=2,_context.next=5,onToggleCamera(null!=localVideoViewOptions?localVideoViewOptions:defaultLocalVideoViewOptions);case 5:return _context.prev=5,setWaitForCamera(!1),_context.finish(5);case 8:case"end":return _context.stop()}}),_callee,null,[[2,,5,8]])}))),[localVideoViewOptions,onToggleCamera]);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{disabled:props.disabled||waitForCamera,onClick:onToggleCamera?onToggleClick:props.onClick,onRenderOnIcon:null!==(_props$onRenderOnIcon=props.onRenderOnIcon)&&void 0!==_props$onRenderOnIcon?_props$onRenderOnIcon:function onRenderCameraOnIcon(){return Object(jsx_runtime.jsx)(HighContrastAwareIcon_HighContrastAwareIcon,{disabled:props.disabled||waitForCamera,iconName:"ControlButtonCameraOn"})},onRenderOffIcon:null!==(_props$onRenderOffIco=props.onRenderOffIcon)&&void 0!==_props$onRenderOffIco?_props$onRenderOffIco:function onRenderCameraOffIcon(){return Object(jsx_runtime.jsx)(HighContrastAwareIcon_HighContrastAwareIcon,{disabled:props.disabled||waitForCamera,iconName:"ControlButtonCameraOff"})},strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"cameraButtonLabel",menuProps:null!==(_props$menuProps=props.menuProps)&&void 0!==_props$menuProps?_props$menuProps:CameraButton_generateDefaultDeviceMenuPropsTrampoline(props,strings),menuIconProps:(null!==(_props$menuIconProps=props.menuIconProps)&&void 0!==_props$menuIconProps?_props$menuIconProps:!enableDeviceSelectionMenuTrampoline(props))?{hidden:!0}:void 0,split:null!==(_props$split=props.split)&&void 0!==_props$split?_props$split:enableDeviceSelectionMenuTrampoline(props)}))};CameraButton_CameraButton.displayName="CameraButton";var CameraButton_generateDefaultDeviceMenuPropsTrampoline=function generateDefaultDeviceMenuPropsTrampoline(props,strings){var _props$styles;if(props.enableDeviceSelectionMenu)return DevicesButton_generateDefaultDeviceMenuProps(Object.assign({},props,{styles:null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.menuStyles}),strings)},enableDeviceSelectionMenuTrampoline=function enableDeviceSelectionMenuTrampoline(props){return!!props.enableDeviceSelectionMenu};CameraButton_CameraButton.__docgenInfo={description:"A button to turn camera on / off.\n\nCan be used with {@link ControlBar}.\n\n@public",methods:[],displayName:"CameraButton",props:{onToggleCamera:{required:!1,tsType:{name:"signature",type:"function",raw:"(options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."},localVideoViewOptions:{required:!1,tsType:{name:"VideoStreamOptions"},description:"Options for rendering local video view."},cameras:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available cameras for selection"},selectedCamera:{required:!1,tsType:{name:"OptionsDevice"},description:"Camera that is shown as currently selected"},onSelectCamera:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback when a camera is selected"},enableDeviceSelectionMenu:{required:!1,tsType:{name:"boolean"},description:"Whether to use a {@link SplitButton} with a {@link IContextualMenu} for device selection.\n\ndefault: false"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"CameraButtonStrings"}],raw:"Partial<CameraButtonStrings>"},description:"Optional strings to override in component"},styles:{required:!1,tsType:{name:"Partial",elements:[{name:"CameraButtonStyles"}],raw:"Partial<CameraButtonStyles>"},description:"Styles for {@link CameraButton} and the device selection flyout."}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/CameraButton.tsx"]={name:"CameraButton",docgenInfo:CameraButton_CameraButton.__docgenInfo,path:"../react-components/src/components/CameraButton.tsx"});__webpack_require__(195);var mainDivStyle={position:"relative",height:"100%",width:"100%"},ControlBar_ControlBar=function ControlBar(props){var styles=props.styles,layout=props.layout,theme=Object(theming.e)(),controlBarClassName=Object(react.useMemo)((function(){var controlBarStyle=controlBarStyles[null!=layout?layout:"horizontal"],backgroundStyle={background:isDarkThemed(theme)&&null!=layout&&layout.startsWith("floating")?theme.palette.neutralQuaternaryAlt:theme.palette.white},borderAndBoxShadowStyle=null!=layout&&layout.startsWith("floating")?{boxShadow:theme.effects.elevation16,borderRadius:theme.effects.roundedCorner6}:{},transformOverrideStyle=!theme.rtl||"floatingTop"!==layout&&"floatingBottom"!==layout?{}:{transform:"translateX(50%)"};return Object(lib.H)(controlBarStyle,backgroundStyle,borderAndBoxShadowStyle,transformOverrideStyle,null==styles?void 0:styles.root)}),[layout,null==styles?void 0:styles.root,theme]);return Object(jsx_runtime.jsx)("div",{className:Object(lib.H)(mainDivStyle),children:Object(jsx_runtime.jsx)(Stack.a,{className:controlBarClassName,children:props.children})})};ControlBar_ControlBar.displayName="ControlBar",ControlBar_ControlBar.__docgenInfo={description:"A container for various buttons for call controls.\n\nUse with various call control buttons in this library, e.g., {@link CameraButton}, or your own instances of\n{@link ControlBarButton} directly.\n\n@public",methods:[],displayName:"ControlBar",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"React Child components."},styles:{required:!1,tsType:{name:"BaseCustomStyles"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<ControlBar styles={{ root: { background: 'blue' } }} />\n```"},layout:{required:!1,tsType:{name:"union",raw:"| 'horizontal'\n| 'vertical'\n| 'dockedTop'\n| 'dockedBottom'\n| 'dockedLeft'\n| 'dockedRight'\n| 'floatingTop'\n| 'floatingBottom'\n| 'floatingLeft'\n| 'floatingRight'",elements:[{name:"literal",value:"'horizontal'"},{name:"literal",value:"'vertical'"},{name:"literal",value:"'dockedTop'"},{name:"literal",value:"'dockedBottom'"},{name:"literal",value:"'dockedLeft'"},{name:"literal",value:"'dockedRight'"},{name:"literal",value:"'floatingTop'"},{name:"literal",value:"'floatingBottom'"},{name:"literal",value:"'floatingLeft'"},{name:"literal",value:"'floatingRight'"}]},description:"Changes the layout of the control bar.\nAvailable layouts are `horizontal`, `vertical`, `dockedTop`, `dockedBottom`,\n`dockedLeft`, `dockedRight`, `floatingTop`, `floatingBottom`, `floatingLeft`,\n`floatingRight`\nDefaults to a `horizontal` layout."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ControlBar.tsx"]={name:"ControlBar",docgenInfo:ControlBar_ControlBar.__docgenInfo,path:"../react-components/src/components/ControlBar.tsx"});var themes=__webpack_require__(103),EndCallButton_onRenderEndCallIcon=function onRenderEndCallIcon(){return Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"ControlButtonEndCall"})};EndCallButton_onRenderEndCallIcon.displayName="onRenderEndCallIcon";var EndCallButton_EndCallButton=function EndCallButton(props){var _props$onHangUp,_props$onRenderIcon,_props$labelKey,styles=props.styles,localeStrings=LocalizationProvider_useLocale().strings.endCallButton,strings=Object.assign({},localeStrings,props.strings),theme=Object(theming.e)(),isDarkTheme=isDarkThemed(theme),componentStyles=Object(lib.r)(isDarkTheme?darkThemeCallButtonStyles:lightThemeCallButtonStyles,null!=styles?styles:{});return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{onClick:null!==(_props$onHangUp=props.onHangUp)&&void 0!==_props$onHangUp?_props$onHangUp:props.onClick,styles:componentStyles,onRenderIcon:null!==(_props$onRenderIcon=props.onRenderIcon)&&void 0!==_props$onRenderIcon?_props$onRenderIcon:EndCallButton_onRenderEndCallIcon,strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"endCallButtonLabel"}))};EndCallButton_EndCallButton.displayName="EndCallButton";var darkThemeCallButtonStyles={root:{color:themes.a.callingPalette.iconWhite,background:themes.a.callingPalette.callRed,"@media (forced-colors: active)":{forcedColorAdjust:"none"},":focus::after":{outlineColor:themes.a.callingPalette.iconWhite+" !important"}},rootHovered:{color:themes.a.callingPalette.iconWhite,background:themes.a.callingPalette.callRed,"@media (forced-colors: active)":{forcedColorAdjust:"none"}},rootPressed:{color:themes.a.callingPalette.iconWhite,background:themes.a.callingPalette.callRed,"@media (forced-colors: active)":{forcedColorAdjust:"none"}},label:{color:themes.a.callingPalette.iconWhite}},lightThemeCallButtonStyles={root:{color:themes.b.callingPalette.iconWhite,background:themes.b.callingPalette.callRed,"@media (forced-colors: active)":{forcedColorAdjust:"none"},":focus::after":{outlineColor:themes.b.callingPalette.iconWhite+" !important"}},rootHovered:{color:themes.b.callingPalette.iconWhite,background:themes.b.callingPalette.callRed,"@media (forced-colors: active)":{forcedColorAdjust:"none"}},rootPressed:{color:themes.b.callingPalette.iconWhite,background:themes.b.callingPalette.callRed,"@media (forced-colors: active)":{forcedColorAdjust:"none"}},label:{color:themes.b.callingPalette.iconWhite}};EndCallButton_EndCallButton.__docgenInfo={description:"A button to end an ongoing call.\n\nCan be used with {@link ControlBar}.\n\n@public",methods:[],displayName:"EndCallButton",props:{onHangUp:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."},strings:{required:!1,tsType:{name:"EndCallButtonStrings"},description:"Optional strings to override in component"}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/EndCallButton.tsx"]={name:"EndCallButton",docgenInfo:EndCallButton_EndCallButton.__docgenInfo,path:"../react-components/src/components/EndCallButton.tsx"});var MicrophoneButton_MicrophoneButton=function MicrophoneButton(props){var _props$onToggleMicrop,_props$onRenderOnIcon,_props$onRenderOffIco,_props$labelKey,_props$menuProps,_props$menuIconProps,_props$split,localeStrings=LocalizationProvider_useLocale().strings.microphoneButton,strings=Object.assign({},localeStrings,props.strings);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{onClick:null!==(_props$onToggleMicrop=props.onToggleMicrophone)&&void 0!==_props$onToggleMicrop?_props$onToggleMicrop:props.onClick,onRenderOnIcon:null!==(_props$onRenderOnIcon=props.onRenderOnIcon)&&void 0!==_props$onRenderOnIcon?_props$onRenderOnIcon:function onRenderMicOnIcon(){return Object(jsx_runtime.jsx)(HighContrastAwareIcon_HighContrastAwareIcon,{disabled:props.disabled,iconName:"ControlButtonMicOn"})},onRenderOffIcon:null!==(_props$onRenderOffIco=props.onRenderOffIcon)&&void 0!==_props$onRenderOffIco?_props$onRenderOffIco:function onRenderMicOffIcon(){return Object(jsx_runtime.jsx)(HighContrastAwareIcon_HighContrastAwareIcon,{disabled:props.disabled,iconName:"ControlButtonMicOff"})},strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"microphoneButtonLabel",menuProps:null!==(_props$menuProps=props.menuProps)&&void 0!==_props$menuProps?_props$menuProps:MicrophoneButton_generateDefaultDeviceMenuPropsTrampoline(props,strings),menuIconProps:(null!==(_props$menuIconProps=props.menuIconProps)&&void 0!==_props$menuIconProps?_props$menuIconProps:!MicrophoneButton_enableDeviceSelectionMenuTrampoline(props))?{hidden:!0}:void 0,split:null!==(_props$split=props.split)&&void 0!==_props$split?_props$split:MicrophoneButton_enableDeviceSelectionMenuTrampoline(props)}))};MicrophoneButton_MicrophoneButton.displayName="MicrophoneButton";var MicrophoneButton_generateDefaultDeviceMenuPropsTrampoline=function generateDefaultDeviceMenuPropsTrampoline(props,strings){var _props$styles;if(props.enableDeviceSelectionMenu)return DevicesButton_generateDefaultDeviceMenuProps(Object.assign({},props,{styles:null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.menuStyles}),strings)},MicrophoneButton_enableDeviceSelectionMenuTrampoline=function enableDeviceSelectionMenuTrampoline(props){return!!props.enableDeviceSelectionMenu};MicrophoneButton_MicrophoneButton.__docgenInfo={description:"A button to turn microphone on / off.\n\nCan be used with {@link ControlBar}.\n\n@public",methods:[],displayName:"MicrophoneButton",props:{onToggleMicrophone:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."},microphones:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available microphones for selection"},speakers:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available speakers for selection"},selectedMicrophone:{required:!1,tsType:{name:"OptionsDevice"},description:"Microphone that is shown as currently selected"},selectedSpeaker:{required:!1,tsType:{name:"OptionsDevice"},description:"Speaker that is shown as currently selected"},onSelectMicrophone:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback when a microphone is selected"},onSelectSpeaker:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Speaker when a speaker is selected"},enableDeviceSelectionMenu:{required:!1,tsType:{name:"boolean"},description:"Whether to use a {@link SplitButton} with a {@link IContextualMenu} for device selection.\n\ndefault: false"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"MicrophoneButtonStrings"}],raw:"Partial<MicrophoneButtonStrings>"},description:"Optional strings to override in component"},styles:{required:!1,tsType:{name:"Partial",elements:[{name:"MicrophoneButtonStyles"}],raw:"Partial<MicrophoneButtonStyles>"},description:"Styles for {@link MicrophoneButton} and the device selection flyout."}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/MicrophoneButton.tsx"]={name:"MicrophoneButton",docgenInfo:MicrophoneButton_MicrophoneButton.__docgenInfo,path:"../react-components/src/components/MicrophoneButton.tsx"});var copy_to_clipboard=__webpack_require__(371),copy_to_clipboard_default=__webpack_require__.n(copy_to_clipboard),ParticipantsButton_ParticipantsButton=function ParticipantsButton(props){var _styles$menuStyles2,_styles$menuStyles4,_props$menuProps,_props$labelKey,callInvitationURL=props.callInvitationURL,styles=props.styles,onMuteAll=props.onMuteAll,onRenderIcon=props.onRenderIcon,onRenderParticipantList=props.onRenderParticipantList,participants=props.participants,myUserId=props.myUserId,excludeMe=props.excludeMe,onRenderParticipant=props.onRenderParticipant,onRenderAvatar=props.onRenderAvatar,onRemoveParticipant=props.onRemoveParticipant,onFetchParticipantMenuItems=props.onFetchParticipantMenuItems,ids=IdentifierProvider_useIdentifiers(),onMuteAllCallback=Object(react.useCallback)((function(){onMuteAll&&onMuteAll()}),[onMuteAll]),defaultParticipantList=Object(react.useCallback)((function(){var _styles$menuStyles;return Object(jsx_runtime.jsx)(ParticipantList_ParticipantList,{participants:participants,myUserId:myUserId,excludeMe:excludeMe,onRenderParticipant:onRenderParticipant,onRenderAvatar:onRenderAvatar,onRemoveParticipant:onRemoveParticipant,onFetchParticipantMenuItems:onFetchParticipantMenuItems,styles:Object(merge.a)(defaultParticipantListContainerStyle,null==styles||null===(_styles$menuStyles=styles.menuStyles)||void 0===_styles$menuStyles?void 0:_styles$menuStyles.participantListStyles)})}),[excludeMe,myUserId,onRemoveParticipant,onRenderAvatar,onRenderParticipant,participants,null==styles||null===(_styles$menuStyles2=styles.menuStyles)||void 0===_styles$menuStyles2?void 0:_styles$menuStyles2.participantListStyles,onFetchParticipantMenuItems]),onCopyCallback=Object(react.useCallback)((function(){return!!callInvitationURL&&copy_to_clipboard_default()(callInvitationURL)}),[callInvitationURL]),localeStrings=LocalizationProvider_useLocale().strings.participantsButton,strings=Object(react.useMemo)((function(){return Object.assign({},localeStrings,props.strings)}),[localeStrings,props.strings]),participantCount=participants.length,generateDefaultParticipantsSubMenuProps=Object(react.useCallback)((function(){var _styles$menuStyles3,items=[];participantCount>0&&(items.push({key:"participantListMenuItemKey",onRender:null!=onRenderParticipantList?onRenderParticipantList:defaultParticipantList}),items.push({key:"participantsDivider1",itemType:ContextualMenu_types.a.Divider}),onMuteAll&&items.push({key:"muteAllKey",text:strings.muteAllButtonLabel,title:strings.muteAllButtonLabel,styles:null==styles||null===(_styles$menuStyles3=styles.menuStyles)||void 0===_styles$menuStyles3?void 0:_styles$menuStyles3.menuItemStyles,iconProps:{iconName:"MicOff2"},onClick:onMuteAllCallback}));return items}),[participantCount,onRenderParticipantList,defaultParticipantList,onMuteAll,strings.muteAllButtonLabel,null==styles||null===(_styles$menuStyles4=styles.menuStyles)||void 0===_styles$menuStyles4?void 0:_styles$menuStyles4.menuItemStyles,onMuteAllCallback]),defaultMenuProps=Object(react.useMemo)((function(){var _styles$menuStyles6,menuProps={title:strings.menuHeader,styles:Object(merge.a)(participantsButtonMenuPropsStyle,null==styles?void 0:styles.menuStyles),items:[],calloutProps:{preventDismissOnResize:!0}};if(participantCount>0){var _styles$menuStyles5,participantCountWithoutMe=participants.map((function(p){return p.userId})).length;excludeMe&&(participantCountWithoutMe-=1),menuProps.items.push({key:"participantCountKey",name:Object(src.b)(strings.participantsListButtonLabel,{numParticipants:""+participantCountWithoutMe}),itemProps:{styles:null==styles||null===(_styles$menuStyles5=styles.menuStyles)||void 0===_styles$menuStyles5?void 0:_styles$menuStyles5.menuItemStyles},iconProps:{iconName:"People"},subMenuProps:{items:generateDefaultParticipantsSubMenuProps(),calloutProps:{styles:{root:{maxWidth:"100%"}},preventDismissOnResize:!0}},"data-ui-id":ids.participantButtonPeopleMenuItem})}callInvitationURL&&menuProps.items.push({key:"InviteLinkKey",name:strings.copyInviteLinkButtonLabel,title:strings.copyInviteLinkButtonLabel,itemProps:{styles:null==styles||null===(_styles$menuStyles6=styles.menuStyles)||void 0===_styles$menuStyles6?void 0:_styles$menuStyles6.menuItemStyles},iconProps:{iconName:"Link"},onClick:onCopyCallback});return menuProps}),[strings.menuHeader,strings.participantsListButtonLabel,strings.copyInviteLinkButtonLabel,null==styles?void 0:styles.menuStyles,participantCount,callInvitationURL,participants,excludeMe,ids.participantButtonPeopleMenuItem,generateDefaultParticipantsSubMenuProps,onCopyCallback]);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{menuProps:null!==(_props$menuProps=props.menuProps)&&void 0!==_props$menuProps?_props$menuProps:defaultMenuProps,menuIconProps:{hidden:!0},onRenderIcon:null!=onRenderIcon?onRenderIcon:function onRenderPeopleIcon(){return Object(jsx_runtime.jsx)(HighContrastAwareIcon_HighContrastAwareIcon,{disabled:props.disabled,iconName:"ControlButtonParticipants"})},strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"participantsButtonLabel"}))};ParticipantsButton_ParticipantsButton.displayName="ParticipantsButton",ParticipantsButton_ParticipantsButton.__docgenInfo={description:"A button to show a menu with calling or chat participants.\n\nCan be used with {@link ControlBar}.\n\nThis button contains dropdown menu items defined through its property `menuProps`. By default, it can display the number of remote participants with the full list\nas sub-menu and an option to mute all participants, as well as a copy-to-clipboard button to copy the call invitation URL.\nThis `menuProps` can be fully redefined and its property is of type [IContextualMenuProps](https://developer.microsoft.com/fluentui#/controls/web/contextualmenu#IContextualMenuProps).\n\n@public",methods:[],displayName:"ParticipantsButton",props:{participants:{required:!0,tsType:{name:"Array",elements:[{name:"ParticipantListParticipant"}],raw:"ParticipantListParticipant[]"},description:"Participants in user call or chat"},myUserId:{required:!1,tsType:{name:"string"},description:"User ID of user"},excludeMe:{required:!1,tsType:{name:"boolean"},description:"If set to `true`, excludes the local participant from the participant list with use of `myUserId` props (required in this case).\n\n@defaultValue `false`"},onRenderParticipant:{required:!1,tsType:{name:"signature",type:"function",raw:"(participant: CommunicationParticipant) => JSX.Element | null",signature:{arguments:[{name:"participant",type:{name:"CommunicationParticipant"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Callback to render each participant. If no callback is provided, each participant will be rendered with `ParticipantItem`"},onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:"Callback to render the avatar for each participant. This property will have no effect if `onRenderParticipant` is assigned."},onRemoveParticipant:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => void",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"void"}}},description:"Callback to render the context menu for each participant"},onFetchParticipantMenuItems:{required:!1,tsType:{name:"ParticipantMenuItemsCallback"},description:"Callback to render custom menu items for each participant."},onRenderParticipantList:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: ParticipantListProps) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"ParticipantListProps"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to render a custom participant list."},styles:{required:!1,tsType:{name:"ParticipantsButtonStyles"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<ParticipantsButton styles={{ root: { background: 'blue' } }} />\n```"},callInvitationURL:{required:!1,tsType:{name:"string"},description:"URL to invite new participants to the current call"},onMuteAll:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"CallBack to mute all remote participants"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"ParticipantsButtonStrings"}],raw:"Partial<ParticipantsButtonStrings>"},description:"Optional strings to override in component"}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ParticipantsButton.tsx"]={name:"ParticipantsButton",docgenInfo:ParticipantsButton_ParticipantsButton.__docgenInfo,path:"../react-components/src/components/ParticipantsButton.tsx"});var ScreenShareButton_ScreenShareButton=function ScreenShareButton(props){var _props$onToggleScreen,_props$onRenderOnIcon,_props$onRenderOffIco,_props$labelKey,localeStrings=LocalizationProvider_useLocale().strings.screenShareButton,strings=Object.assign({},localeStrings,props.strings),theme=Object(useTheme.a)(),styles=ScreenShareButton_screenshareButtonStyles(theme);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{className:Object(lib.H)(styles,props.styles),onClick:null!==(_props$onToggleScreen=props.onToggleScreenShare)&&void 0!==_props$onToggleScreen?_props$onToggleScreen:props.onClick,onRenderOnIcon:null!==(_props$onRenderOnIcon=props.onRenderOnIcon)&&void 0!==_props$onRenderOnIcon?_props$onRenderOnIcon:function onRenderScreenShareOnIcon(){return Object(jsx_runtime.jsx)(HighContrastAwareIcon_HighContrastAwareIcon,{disabled:props.disabled,iconName:"ControlButtonScreenShareStop"})},onRenderOffIcon:null!==(_props$onRenderOffIco=props.onRenderOffIcon)&&void 0!==_props$onRenderOffIco?_props$onRenderOffIco:function onRenderScreenShareOffIcon(){return Object(jsx_runtime.jsx)(HighContrastAwareIcon_HighContrastAwareIcon,{disabled:props.disabled,iconName:"ControlButtonScreenShareStart"})},strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"screenShareButtonLabel"}))};ScreenShareButton_ScreenShareButton.displayName="ScreenShareButton";var ScreenShareButton_screenshareButtonStyles=function screenshareButtonStyles(theme){return{rootChecked:{background:theme.palette.themePrimary,color:lib.d.white,":focus::after":{outlineColor:lib.d.white+" !important"}},rootCheckedHovered:{background:theme.palette.themePrimary,color:lib.d.white,":focus::after":{outlineColor:lib.d.white+" !important"}},labelChecked:{color:lib.d.white}}};ScreenShareButton_ScreenShareButton.__docgenInfo={description:"A button to start / stop screen sharing.\n\nCan be used with {@link ControlBar}.\n\n@public",methods:[],displayName:"ScreenShareButton",props:{onToggleScreenShare:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"ScreenShareButtonStrings"}],raw:"Partial<ScreenShareButtonStrings>"},description:"Optional strings to override in component"}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ScreenShareButton.tsx"]={name:"ScreenShareButton",docgenInfo:ScreenShareButton_ScreenShareButton.__docgenInfo,path:"../react-components/src/components/ScreenShareButton.tsx"});var submitWithKeyboard=function submitWithKeyboard(e,onSubmit){"Enter"!==e.key&&" "!==e.key||onSubmit(e)},memoize=__webpack_require__(325),PictureInPictureInPictureTile_PictureInPictureInPicturePrimaryTile=function PictureInPictureInPicturePrimaryTile(props){var boxShadow=Object(FluentThemeProvider.b)().effects.elevation8;return Object(jsx_runtime.jsx)(PictureInPictureInPictureTile_PictureInPictureInPictureTile,Object.assign({},props,{styles:primaryTileStyles(props.orientation,boxShadow)}))};PictureInPictureInPictureTile_PictureInPictureInPicturePrimaryTile.displayName="PictureInPictureInPicturePrimaryTile";var PictureInPictureInPictureTile_PictureInPictureInPictureSecondaryTile=function PictureInPictureInPictureSecondaryTile(props){return Object(jsx_runtime.jsx)(PictureInPictureInPictureTile_PictureInPictureInPictureTile,Object.assign({},props,{personaMinSize:20,styles:secondaryTileStyles(props.orientation)}))};PictureInPictureInPictureTile_PictureInPictureInPictureSecondaryTile.displayName="PictureInPictureInPictureSecondaryTile";var PictureInPictureInPictureTile_PictureInPictureInPictureTile=function PictureInPictureInPictureTile(props){return Object(jsx_runtime.jsx)(VideoTile_VideoTile,Object.assign({},props,{showLabel:!1}))};PictureInPictureInPictureTile_PictureInPictureInPictureTile.displayName="PictureInPictureInPictureTile";var primaryTileStyles=Object(memoize.a)((function(orientation,themeElevation){return{root:{borderRadius:"0.25rem",height:"landscape"===orientation?"5.5rem":"8rem",width:"landscape"===orientation?"8rem":"5.5rem",boxShadow:themeElevation}}})),secondaryTileStyles=Object(memoize.a)((function(orientation){return{root:{borderRadius:"0.25rem",height:"landscape"===orientation?"1.625rem":"2rem",width:"landscape"===orientation?"2rem":"1.625rem"}}}));PictureInPictureInPictureTile_PictureInPictureInPicturePrimaryTile.__docgenInfo={description:"@private",methods:[],displayName:"PictureInPictureInPicturePrimaryTile",props:{orientation:{required:!0,tsType:{name:"union",raw:"'portrait' | 'landscape'",elements:[{name:"literal",value:"'portrait'"},{name:"literal",value:"'landscape'"}]},description:""}},composes:["Pick"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/PictureInPictureInPicture/PictureInPictureInPictureTile.tsx"]={name:"PictureInPictureInPicturePrimaryTile",docgenInfo:PictureInPictureInPictureTile_PictureInPictureInPicturePrimaryTile.__docgenInfo,path:"../react-components/src/components/PictureInPictureInPicture/PictureInPictureInPictureTile.tsx"}),PictureInPictureInPictureTile_PictureInPictureInPictureSecondaryTile.__docgenInfo={description:"@private",methods:[],displayName:"PictureInPictureInPictureSecondaryTile",props:{orientation:{required:!0,tsType:{name:"union",raw:"'portrait' | 'landscape'",elements:[{name:"literal",value:"'portrait'"},{name:"literal",value:"'landscape'"}]},description:""}},composes:["Pick"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/PictureInPictureInPicture/PictureInPictureInPictureTile.tsx"]={name:"PictureInPictureInPictureSecondaryTile",docgenInfo:PictureInPictureInPictureTile_PictureInPictureInPictureSecondaryTile.__docgenInfo,path:"../react-components/src/components/PictureInPictureInPicture/PictureInPictureInPictureTile.tsx"});var PictureInPictureInPicture_PictureInPictureInPicture=function _PictureInPictureInPicture(props){return Object(jsx_runtime.jsx)(PictureInPictureInPicture_PictureInPictureInPictureContainer,{onClick:props.onClick,primaryView:Object(jsx_runtime.jsx)(PictureInPictureInPictureTile_PictureInPictureInPicturePrimaryTile,Object.assign({},props.primaryTile)),secondaryView:props.secondaryTile&&Object(jsx_runtime.jsx)(PictureInPictureInPictureTile_PictureInPictureInPictureSecondaryTile,Object.assign({},props.secondaryTile)),ariaLabel:props.strings.rootAriaLabel})};PictureInPictureInPicture_PictureInPictureInPicture.displayName="_PictureInPictureInPicture";var PictureInPictureInPicture_PictureInPictureInPictureContainer=function PictureInPictureInPictureContainer(props){return Object(jsx_runtime.jsxs)("aside",{style:tileContainerStyles,onClick:props.onClick,onKeyPress:function onKeyPress(e){return props.onClick&&submitWithKeyboard(e,props.onClick)},"aria-label":props.ariaLabel,tabIndex:props.onClick?0:-1,children:[props.primaryView,Object(jsx_runtime.jsx)("div",{style:secondaryTileFloatingStyles,children:props.secondaryView})]})};PictureInPictureInPicture_PictureInPictureInPictureContainer.displayName="PictureInPictureInPictureContainer";var tileContainerStyles={display:"inline-block",width:"min-content",position:"relative",cursor:"pointer"},secondaryTileFloatingStyles={position:"absolute",bottom:"0.125rem",right:"0.125rem"};PictureInPictureInPicture_PictureInPictureInPicture.__docgenInfo={description:"Component that displays a video feed for use as a Picture-in-Picture style component.\nIt contains a secondary video feed resulting in an inner Picture-in-Picture style feed.\n\n@remarks\nThe double nature of the Picture-in-Picture styles is where this component gets its name; Picture-in-Picture-in-Picture.\n\n@internal",methods:[],displayName:"_PictureInPictureInPicture",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when the {@link _PictureInPictureInPicture} is clicked."},primaryTile:{required:!0,tsType:{name:"_PictureInPictureInPictureTileProps"},description:""},secondaryTile:{required:!1,tsType:{name:"_PictureInPictureInPictureTileProps"},description:""},strings:{required:!0,tsType:{name:"_PictureInPictureInPictureStrings"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/PictureInPictureInPicture/PictureInPictureInPicture.tsx"]={name:"_PictureInPictureInPicture",docgenInfo:PictureInPictureInPicture_PictureInPictureInPicture.__docgenInfo,path:"../react-components/src/components/PictureInPictureInPicture/PictureInPictureInPicture.tsx"});__webpack_require__(747);var DrawerMenuItem_DrawerMenuItem=function DrawerMenuItem(props){var _props$styles,theme=Object(FluentThemeProvider.b)(),onClick=function onClick(ev){return props.onItemClick&&props.onItemClick(ev,props.itemKey)},secondaryIcon=props.secondaryIconProps?Object(jsx_runtime.jsx)(DrawerMenuItem_MenuItemIcon,Object.assign({},props.secondaryIconProps)):props.subMenuProps?Object(jsx_runtime.jsx)(DrawerMenuItem_MenuItemIcon,{iconName:"ChevronRight"}):void 0;return Object(jsx_runtime.jsxs)(Stack.a,{tabIndex:0,role:"menuitem",horizontal:!0,className:Object(lib.H)(drawerMenuItemRootStyles(theme.palette.neutralLight,theme.fonts.small),null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.root),onKeyPress:function onKeyPress(ev){return onClick&&submitWithKeyboard(ev,onClick)},onClick:onClick,tokens:menuItemChildrenGap,children:[props.iconProps&&Object(jsx_runtime.jsx)(Stack.a.Item,{role:"presentation",children:Object(jsx_runtime.jsx)(DrawerMenuItem_MenuItemIcon,Object.assign({},props.iconProps))}),Object(jsx_runtime.jsx)(Stack.a.Item,{styles:drawerMenuItemTextStyles,grow:!0,children:Object(jsx_runtime.jsx)(Text.a,{children:props.text})}),props.secondaryText&&Object(jsx_runtime.jsx)(Stack.a.Item,{styles:drawerMenuItemTextStyles,className:Object(lib.H)(secondaryTextStyles),children:Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)({color:theme.palette.neutralSecondary}),children:props.secondaryText})}),secondaryIcon&&Object(jsx_runtime.jsx)(Stack.a.Item,{children:secondaryIcon})]})};DrawerMenuItem_DrawerMenuItem.displayName="DrawerMenuItem";var DrawerMenuItem_MenuItemIcon=function MenuItemIcon(props){return Object(jsx_runtime.jsx)(FontIcon.a,Object.assign({className:Object(lib.H)(DrawerMenuItem_iconStyles)},props))};DrawerMenuItem_MenuItemIcon.displayName="MenuItemIcon";var menuItemChildrenGap={childrenGap:"0.5rem"},drawerMenuItemRootStyles=function drawerMenuItemRootStyles(hoverBackground,fontSize){return Object.assign({},fontSize,{height:"3rem",lineHeight:"3rem",padding:"0rem 0.75rem",cursor:"pointer",":hover, :focus":{background:hoverBackground}})},drawerMenuItemTextStyles={root:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},DrawerMenuItem_iconStyles={display:"flex",alignItems:"center",height:"100%"," span":{display:"flex",alignItems:"center",height:"100%"}},secondaryTextStyles={maxWidth:"50%"};DrawerMenuItem_DrawerMenuItem.__docgenInfo={description:"Maps the individual item in menuProps.items passed in the {@link DrawerMenu} into a UI component.\n\n@private",methods:[],displayName:"DrawerMenuItem",props:{onItemClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(ev?: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>, itemKey?: string) => void",signature:{arguments:[{name:"ev",type:{name:"union",raw:"React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent<HTMLElement>",elements:[{name:"HTMLElement"}]},{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLElement>",elements:[{name:"HTMLElement"}]}]}},{name:"itemKey",type:{name:"string"}}],return:{name:"void"}}},description:""},itemKey:{required:!0,tsType:{name:"string"},description:""},text:{required:!1,tsType:{name:"string"},description:"Text that shows at the start of the menu item after any icon supplied"},secondaryText:{required:!1,tsType:{name:"string"},description:"Text that shows at the end of the menu item before any secondaryIcon is supplied"},iconProps:{required:!1,tsType:{name:"IIconProps"},description:"Icon shown at the start of the menu item (before the menu item text)"},secondaryIconProps:{required:!1,tsType:{name:"IIconProps"},description:"Icon shown at the end of the menu item.\nBy default if this component has subMenuProps, this icon is the RightChevron."},styles:{required:!1,tsType:{name:"BaseCustomStyles"},description:""},subMenuProps:{required:!1,tsType:{name:"Array",elements:[{name:"_DrawerMenuItemProps"}],raw:"_DrawerMenuItemProps[]"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/Drawer/DrawerMenuItem.tsx"]={name:"DrawerMenuItem",docgenInfo:DrawerMenuItem_DrawerMenuItem.__docgenInfo,path:"../react-components/src/components/Drawer/DrawerMenuItem.tsx"});var FocusTrapZone=__webpack_require__(1753),DrawerContentContainer_DrawerContentContainer=function DrawerContentContainer(props){var _props$styles,theme=Object(useTheme.a)(),backgroundColor=theme.palette.white,borderRadius=theme.effects.roundedCorner4,rootStyles=Object(lib.H)(DrawerContentContainer_containerStyles(backgroundColor,borderRadius),null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.root);return Object(jsx_runtime.jsx)(Stack.a,{className:rootStyles,children:props.children})};DrawerContentContainer_DrawerContentContainer.displayName="DrawerContentContainer";var DrawerContentContainer_containerStyles=function containerStyles(backgroundColor,borderRadius){return Object.assign({background:backgroundColor,borderTopRightRadius:borderRadius,borderTopLeftRadius:borderRadius},lib.b.slideUpIn10)};DrawerContentContainer_DrawerContentContainer.__docgenInfo={description:"Container that holds the content of the drawer\n\n@private",methods:[],displayName:"DrawerContentContainer",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},styles:{required:!1,tsType:{name:"BaseCustomStyles"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/Drawer/DrawerContentContainer.tsx"]={name:"DrawerContentContainer",docgenInfo:DrawerContentContainer_DrawerContentContainer.__docgenInfo,path:"../react-components/src/components/Drawer/DrawerContentContainer.tsx"});var DrawerLightDismiss_DrawerLightDismiss=function DrawerLightDismiss(props){return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)(lightDismissContainerStyles,props.styles),grow:!0,onClick:function onClick(){return props.onDismiss()}})};DrawerLightDismiss_DrawerLightDismiss.displayName="DrawerLightDismiss";var lightDismissContainerStyles={root:{height:"100%"}};DrawerLightDismiss_DrawerLightDismiss.__docgenInfo={description:"An element that fills the space the DrawerContentContainer does not take up.\nThis is the element that enables the light dismiss feature.\n\n@private",methods:[],displayName:"DrawerLightDismiss",props:{onDismiss:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},styles:{required:!1,tsType:{name:"BaseCustomStyles"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/Drawer/DrawerLightDismiss.tsx"]={name:"DrawerLightDismiss",docgenInfo:DrawerLightDismiss_DrawerLightDismiss.__docgenInfo,path:"../react-components/src/components/Drawer/DrawerLightDismiss.tsx"});var DrawerSurface_DrawerSurface=function _DrawerSurface(props){var _props$styles,_props$styles2,_props$styles3,rootStyles=Object(lib.H)(drawerSurfaceStyles,null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.root);return Object(jsx_runtime.jsxs)(Stack.a,{className:rootStyles,children:[Object(jsx_runtime.jsx)(DrawerLightDismiss_DrawerLightDismiss,{styles:null===(_props$styles2=props.styles)||void 0===_props$styles2?void 0:_props$styles2.lightDismissRoot,onDismiss:props.onLightDismiss}),Object(jsx_runtime.jsx)(FocusTrapZone.a,{onKeyDown:function onKeyDown(e){"Escape"!==e.key&&"Esc"!==e.key||props.onLightDismiss&&props.onLightDismiss()},isClickableOutsideFocusTrap:!0,children:Object(jsx_runtime.jsx)(DrawerContentContainer_DrawerContentContainer,{styles:null===(_props$styles3=props.styles)||void 0===_props$styles3?void 0:_props$styles3.drawerContentContainer,children:props.children})})]})};DrawerSurface_DrawerSurface.displayName="_DrawerSurface";var drawerSurfaceStyles={width:"100%",height:"100%",background:"rgba(0,0,0,0.4)"};function DrawerMenu_toConsumableArray(arr){return function DrawerMenu_arrayWithoutHoles(arr){if(Array.isArray(arr))return DrawerMenu_arrayLikeToArray(arr)}(arr)||function DrawerMenu_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||DrawerMenu_unsupportedIterableToArray(arr)||function DrawerMenu_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DrawerMenu_slicedToArray(arr,i){return function DrawerMenu_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function DrawerMenu_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||DrawerMenu_unsupportedIterableToArray(arr,i)||function DrawerMenu_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DrawerMenu_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return DrawerMenu_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?DrawerMenu_arrayLikeToArray(o,minLen):void 0}}function DrawerMenu_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}DrawerSurface_DrawerSurface.__docgenInfo={description:"A `Drawer` can be used to reveal lightweight views inside your application.\nThey appear from the bottom of the screen upwards and are light-dismissed.\n\n@internal",methods:[],displayName:"_DrawerSurface",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Content of the Drawer"},onLightDismiss:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when the drawer's light-dismissal is triggered."},styles:{required:!1,tsType:{name:"_DrawerSurfaceStyles"},description:"Styles for the {@link DrawerSurface}"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/Drawer/DrawerSurface.tsx"]={name:"_DrawerSurface",docgenInfo:DrawerSurface_DrawerSurface.__docgenInfo,path:"../react-components/src/components/Drawer/DrawerSurface.tsx"});var DrawerMenu_DrawerMenu=function _DrawerMenu(props){var _menuItemsToRender$,_props$styles,_useState2=DrawerMenu_slicedToArray(Object(react.useState)([]),2),selectedKeyPath=_useState2[0],setSelectedKeyPath=_useState2[1],menuItemsToRender=Object(react.useMemo)((function(){var _step,items=props.items,_loop=function _loop(subMenuKey){var _items,_items$find;items=null===(_items=items)||void 0===_items||null===(_items$find=_items.find((function(item){return item.itemKey===subMenuKey})))||void 0===_items$find?void 0:_items$find.subMenuProps},_iterator=function DrawerMenu_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=DrawerMenu_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(selectedKeyPath);try{for(_iterator.s();!(_step=_iterator.n()).done;){_loop(_step.value)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return items}),[props.items,selectedKeyPath]),_onItemClick=Object(react.useCallback)((function(item,ev,itemKey){var _item$onItemClick;item.subMenuProps&&setSelectedKeyPath([].concat(DrawerMenu_toConsumableArray(selectedKeyPath),[item.itemKey])),null===(_item$onItemClick=item.onItemClick)||void 0===_item$onItemClick||_item$onItemClick.call(item,ev,itemKey)}),[selectedKeyPath]),borderRadius=Object(FluentThemeProvider.b)().effects.roundedCorner4,firstItemStyle=menuItemsToRender&&(null===(_menuItemsToRender$=menuItemsToRender[0])||void 0===_menuItemsToRender$?void 0:_menuItemsToRender$.styles),modifiedFirstItemStyle=Object(react.useMemo)((function(){return Object(merge.a)(null!=firstItemStyle?firstItemStyle:{},{root:{borderTopRightRadius:borderRadius,borderTopLeftRadius:borderRadius}})}),[firstItemStyle,borderRadius]);return Object(jsx_runtime.jsx)(DrawerSurface_DrawerSurface,{styles:null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.drawerSurfaceStyles,onLightDismiss:props.onLightDismiss,children:Object(jsx_runtime.jsxs)(Stack.a,{styles:props.styles,role:"menu",children:[null==menuItemsToRender?void 0:menuItemsToRender.slice(0,1).map((function(item){return Object(react.createElement)(DrawerMenuItem_DrawerMenuItem,Object.assign({},item,{key:"0",styles:modifiedFirstItemStyle,onItemClick:function onItemClick(ev,itemKey){_onItemClick(item,ev,itemKey)}}))})),null==menuItemsToRender?void 0:menuItemsToRender.slice(1).map((function(item,i){return Object(react.createElement)(DrawerMenuItem_DrawerMenuItem,Object.assign({},item,{key:""+(i+1),onItemClick:function onItemClick(ev,itemKey){_onItemClick(item,ev,itemKey)}}))}))]})})};DrawerMenu_DrawerMenu.displayName="_DrawerMenu",DrawerMenu_DrawerMenu.__docgenInfo={description:"Takes a set of menu items and returns a created menu inside a {@link _DrawerSurface}.\n\n@internal",methods:[],displayName:"_DrawerMenu",props:{items:{required:!0,tsType:{name:"Array",elements:[{name:"_DrawerMenuItemProps"}],raw:"_DrawerMenuItemProps[]"},description:""},onLightDismiss:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when the drawer's light-dismissal is triggered."},styles:{required:!1,tsType:{name:"_DrawerMenuStyles"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/Drawer/DrawerMenu.tsx"]={name:"_DrawerMenu",docgenInfo:DrawerMenu_DrawerMenu.__docgenInfo,path:"../react-components/src/components/Drawer/DrawerMenu.tsx"})},227:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return callControlsContainerStyles})),__webpack_require__.d(__webpack_exports__,"b",(function(){return containerStyleDesktop})),__webpack_require__.d(__webpack_exports__,"c",(function(){return containerStyleMobile})),__webpack_require__.d(__webpack_exports__,"d",(function(){return galleryParentContainerStyles})),__webpack_require__.d(__webpack_exports__,"e",(function(){return mediaGalleryContainerStyles})),__webpack_require__.d(__webpack_exports__,"f",(function(){return notificationsContainerStyles}));__webpack_require__(7);var _fluentui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(22),_CallControls_styles__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(474),NOTIFICATION_CONTAINER_Z_INDEX=Math.max(2,1)+1,callControlsContainerStyles=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.H)(_CallControls_styles__WEBPACK_IMPORTED_MODULE_2__.a,{zIndex:2}),containerStyle={width:"100%",position:"relative",minHeight:"15rem"},containerStyleDesktop=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.H)(Object.assign({},containerStyle,{minWidth:"30rem"})),containerStyleMobile=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.H)(Object.assign({},containerStyle,{minWidth:"19.5rem"})),galleryParentContainerStyles=function galleryParentContainerStyles(backgroundColor){return{root:{zIndex:1,width:"100%",background:backgroundColor}}},mediaGalleryContainerStyles={root:{height:"100%"}},notificationsContainerStyles={root:{width:"100%",position:"absolute",top:0,left:0,padding:"1rem",zIndex:NOTIFICATION_CONTAINER_Z_INDEX}}},245:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _azure_communication_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(80),_fluentui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(616),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(1),__webpack_require__(2)),containerText=__webpack_require__(1367).default,customDataModelExampleContainerText=__webpack_require__(1368).default,getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.j,{children:"CallComposite"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"CallComposite brings together key components to provide a full calling experience out of the box."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"Note that CallComposite has the following min width and height:"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"- mobile: 19.5rem x 21rem (312px x 336px, with default rem at 16px)"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"- desktop: 30rem x 22rem (480px x 352px, with default rem at 16px)"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Basic usage"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"There are two parts to the composite - a `CallComposite` react component and a `CallAdapter` that connects the react component to the backend APIs."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"The key thing to note is that initialization of `CallAdapter` is asynchronous. Thus, the initialization step requires special handling, as the example code below shows."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.h,{code:containerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Prerequisites"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"CallComposite provides the UI for an *existing user* to join a call. The user must be created beforehand. Typically, the user and group call or teams meeting are created on a Contoso-owned service and provided to the client application that then passes it to the CallComposite."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Styling"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"CallComposite is designed to fill the space of the parent it is in. By default these examples put the composite in a container of a set height and width. If your composite is living outside of any parent container and you wish for it to fill the page, we recommend ensuring your react app is set to fill the screen by adding the following css to your primary css file:"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.h,{code:"\nhtml,\nbody,\n#root {\n  height: 100%;\n}\n"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Running in a Mobile browser"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:'CallComposite by default is optimized for desktop views. To provide an optimized mobile experience, you may set the `formFactor` property to `"mobile"`. The CallComposite does not detect if it is running on mobile device vs desktop, instead you must identify if your clients device is a mobile device and set the `formFactor` property to `"mobile"`. This prop can be set at any time and immediately updates the composite UI to be optimized for a mobile device.'}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.h,{code:'\n<CallComposite formFactor="mobile" />\n'}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.a,{children:'Note: Only Protrait mode is supported when the `formFactor` is set to "mobile". Landscape mode is not supported.'}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"You can try out the form factor property in the [CallComposite Basic Example](./?path=/story/composites-call-basicexample--basic-example)."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Theming"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"CallComposite can be themed with Fluent UI themes, just like the base components. Look at the [CallComposite theme example](./?path=/story/composites-call-themeexample--theme-example) to see theming in action or the [overall theming example](./?path=/docs/theming--page) to see how theming works for all the components in this UI library."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Custom Data Model"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"It is a primary tenet of Azure Communication Services that customers bring their own user identities. Customers then use the Azure Communication Services identity service to create corresponding authentication tokens for their users. The ChatComposite allows developers to easily inject custom data associated with these user identities. Look at the [example canvas](./?path=/story/composites-call-customdatamodelexample--custom-data-model-example) to see how the initials displayed for users can be provided by Contoso."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"Note that, by default, the initials text color is setup to `white`"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.h,{code:customDataModelExampleContainerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"See the [Custom data model example documentation](./?path=/docs/customuserdatamodel--page) to understand how custom data model can be injected for all the components in this UI library."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Fonts"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"Custom fonts can be applied to the CallComposite using the in built theming mechanism. Look at the [CallComposite themes canvas](./?path=/story/composites-call-themeexample--theme-example) to see custom fonts in action or the [overall theming example](./?path=/story/theming--page) to see how theming works for all the components in this UI library. Read more about fonts in [Fluent UI Typography](https://developer.microsoft.com/fluentui#/styles/web/typography)."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Icons"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"Custom icons can be applied to the Composite using `icons` prop exposed by the Composite. The `icons` prop accepts an object where you can provide a custom JSX element against an icon name key."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Joining an existing Call"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.d,{children:"The [join existing call](./?path=/story/composites-call-joinexistingcall--join-existing-call) provides an easy playground to join an existing Azure Communication Services group call or an existing Teams meeting. This is useful if you want to explore the composite with multiple users."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.e,{children:"Call Composite Props"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.g,{of:_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.CallComposite})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/CallCompositeDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/CallComposite/CallCompositeDocs.tsx"})},246:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ConfigHintBanner})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ConfigJoinCallHintBanner}));__webpack_require__(1);var _CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(191),_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(14),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),ConfigHintBanner=function ConfigHintBanner(){var emptyConfigTips=Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("p",{children:["Please provide an"," ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("a",{href:_constants__WEBPACK_IMPORTED_MODULE_2__.e,target:"_blank",rel:"noreferrer",children:"access token, userId"}),"."]});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__.b)([emptyConfigTips])})},ConfigJoinCallHintBanner=function ConfigJoinCallHintBanner(){var emptyConfigTips=Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("p",{children:["Please provide an"," ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("a",{href:_constants__WEBPACK_IMPORTED_MODULE_2__.e,target:"_blank",rel:"noreferrer",children:"access token, userId"}),", display name, and a group call Id (or a teams meeting link)."]});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__.b)([emptyConfigTips])})};ConfigHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/Utils.tsx"]={name:"ConfigHintBanner",docgenInfo:ConfigHintBanner.__docgenInfo,path:"stories/CallComposite/snippets/Utils.tsx"}),ConfigJoinCallHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigJoinCallHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/Utils.tsx"]={name:"ConfigJoinCallHintBanner",docgenInfo:ConfigJoinCallHintBanner.__docgenInfo,path:"stories/CallComposite/snippets/Utils.tsx"})},300:function(module,__webpack_exports__,__webpack_require__){"use strict";var _CallComposite__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(803);__webpack_require__.d(__webpack_exports__,"CallComposite",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_0__.a}));var _adapter__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(800);__webpack_require__.d(__webpack_exports__,"createAzureCommunicationCallAdapter",(function(){return _adapter__WEBPACK_IMPORTED_MODULE_1__.a}));var _Strings__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(801);__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_DE_DE")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_DE_DE",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_DE_DE})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_EN_GB")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_GB",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_EN_GB})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_EN_US")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_US",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_EN_US})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_ES_ES")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ES_ES",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_ES_ES})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_FR_FR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_FR_FR",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_FR_FR})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_IT_IT")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_IT_IT",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_IT_IT})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_JA_JP")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_JA_JP",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_JA_JP})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_KO_KR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_KO_KR",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_KO_KR})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_NL_NL")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_NL_NL",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_NL_NL})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_PT_BR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_PT_BR",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_PT_BR})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_RU_RU")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_RU_RU",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_RU_RU})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_TR_TR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_TR_TR",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_TR_TR})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_ZH_CN")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_CN",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_ZH_CN})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_ZH_TW")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_TW",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_ZH_TW})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"CallWithChatComposite")&&__webpack_require__.d(__webpack_exports__,"CallWithChatComposite",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.CallWithChatComposite})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"ChatComposite")&&__webpack_require__.d(__webpack_exports__,"ChatComposite",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.ChatComposite})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"createAzureCommunicationChatAdapter")&&__webpack_require__.d(__webpack_exports__,"createAzureCommunicationChatAdapter",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.createAzureCommunicationChatAdapter}))},301:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createAzureCommunicationChatAdapter})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createAzureCommunicationChatAdapterFromClient}));__webpack_require__(9),__webpack_require__(19),__webpack_require__(12),__webpack_require__(395),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(39),__webpack_require__(7),__webpack_require__(47),__webpack_require__(98),__webpack_require__(97),__webpack_require__(265);var src_chatClient=__webpack_require__(615),src=__webpack_require__(32),events=(__webpack_require__(122),__webpack_require__(125),__webpack_require__(70),__webpack_require__(576),__webpack_require__(62),__webpack_require__(266),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28),__webpack_require__(40),__webpack_require__(133)),events_default=__webpack_require__.n(events),immer_esm=__webpack_require__(165);__webpack_require__(573),__webpack_require__(138),__webpack_require__(74),__webpack_require__(123),__webpack_require__(149),__webpack_require__(147),__webpack_require__(572);function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)})(Class)}function _construct(Parent,args,Class){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ChatError=function(_Error){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(subClass,"prototype",{value:Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(ChatError,_Error);var _super=function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}(ChatError);function ChatError(target,innerError,timestamp){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ChatError),(_this=_super.call(this)).target=void 0,_this.innerError=void 0,_this.timestamp=void 0,_this.target=target,_this.innerError=innerError,_this.timestamp=null!=timestamp?timestamp:new Date(Date.now()),_this.name="ChatError",_this.message=_this.target+": "+_this.innerError.message,_this}return ChatError}(_wrapNativeSuper(Error)),dist_esm_src=__webpack_require__(151),Constants_TYPING_INDICATOR_MAINTAIN_TIME=8e3;new Date(0);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}Object(immer_esm.b)(),Object(immer_esm.c)();var ChatContext_ChatContext=function(){function ChatContext(maxListeners){!function ChatContext_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ChatContext),this._state={userId:{id:""},displayName:"",threads:{},latestErrors:{}},this._batchMode=!1,this._logger=void 0,this._emitter=void 0,this.typingIndicatorInterval=void 0,this._logger=Object(dist_esm_src.createClientLogger)("communication-react:chat-context"),this._emitter=new events_default.a,maxListeners&&this._emitter.setMaxListeners(maxListeners)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(ChatContext,[{key:"getState",value:function getState(){return this._state}},{key:"setState",value:function setState(state){this._state=state,this._batchMode||this._emitter.emit("stateChanged",this._state)}},{key:"modifyState",value:function modifyState(modifier){var _this=this;this._state=Object(immer_esm.a)(this._state,modifier,(function(patches){"verbose"===Object(dist_esm_src.getLogLevel)()&&_this._logger.info("State change: "+Object(src.d)(patches))})),this._batchMode||this._emitter.emit("stateChanged",this._state)}},{key:"setThread",value:function setThread(threadId,threadState){this.modifyState((function(draft){draft.threads[threadId]=threadState}))}},{key:"createThread",value:function createThread(threadId,properties){this.modifyState((function(draft){draft.threads[threadId]={chatMessages:{},threadId:threadId,properties:properties,participants:{},readReceipts:[],typingIndicators:[],latestReadTime:new Date(0)}}))}},{key:"updateChatConfig",value:function updateChatConfig(userId,displayName){this.modifyState((function(draft){draft.displayName=displayName,draft.userId=userId}))}},{key:"createThreadIfNotExist",value:function createThreadIfNotExist(threadId,properties){return!Object.prototype.hasOwnProperty.call(this.getState().threads,threadId)&&(this.createThread(threadId,properties),!0)}},{key:"updateThread",value:function updateThread(threadId,properties){this.modifyState((function(draft){var thread=draft.threads[threadId];thread&&(thread.properties=properties)}))}},{key:"updateThreadTopic",value:function updateThreadTopic(threadId,topic){this.modifyState((function(draft){if(void 0!==topic){var thread=draft.threads[threadId];thread&&!thread.properties?thread.properties={topic:topic}:thread&&thread.properties&&(thread.properties.topic=topic)}}))}},{key:"deleteThread",value:function deleteThread(threadId){this.modifyState((function(draft){draft.threads[threadId]&&delete draft.threads[threadId]}))}},{key:"setChatMessages",value:function setChatMessages(threadId,messages){var _this2=this;this.modifyState((function(draft){var threadState=draft.threads[threadId];threadState&&(threadState.chatMessages=messages);var thread=draft.threads[threadId];if(thread)for(var _i=0,_Object$values=Object.values(messages);_i<_Object$values.length;_i++){var message=_Object$values[_i];_this2.filterTypingIndicatorForUser(thread,message.sender)}}))}},{key:"updateChatMessageContent",value:function updateChatMessageContent(threadId,messagesId,content){this.modifyState((function(draft){var _draft$threads$thread,chatMessage=null===(_draft$threads$thread=draft.threads[threadId])||void 0===_draft$threads$thread?void 0:_draft$threads$thread.chatMessages[messagesId];chatMessage&&(chatMessage.content||(chatMessage.content={}),chatMessage.content.message=content)}))}},{key:"deleteLocalMessage",value:function deleteLocalMessage(threadId,localId){var localMessageDeleted=!1;return this.modifyState((function(draft){var _draft$threads$thread2,chatMessages=null===(_draft$threads$thread2=draft.threads[threadId])||void 0===_draft$threads$thread2?void 0:_draft$threads$thread2.chatMessages,message=chatMessages?chatMessages[localId]:void 0;chatMessages&&message&&message.clientMessageId&&(delete chatMessages[message.clientMessageId],localMessageDeleted=!0)})),localMessageDeleted}},{key:"deleteMessage",value:function deleteMessage(threadId,id){this.modifyState((function(draft){var _draft$threads$thread3,chatMessages=null===(_draft$threads$thread3=draft.threads[threadId])||void 0===_draft$threads$thread3?void 0:_draft$threads$thread3.chatMessages;chatMessages&&delete chatMessages[id]}))}},{key:"setParticipant",value:function setParticipant(threadId,participant){this.modifyState((function(draft){var _draft$threads$thread4,participants=null===(_draft$threads$thread4=draft.threads[threadId])||void 0===_draft$threads$thread4?void 0:_draft$threads$thread4.participants;participants&&(participants[Object(src.g)(participant.id)]=participant)}))}},{key:"setParticipants",value:function setParticipants(threadId,participants){this.modifyState((function(draft){var _draft$threads$thread5,participantsMap=null===(_draft$threads$thread5=draft.threads[threadId])||void 0===_draft$threads$thread5?void 0:_draft$threads$thread5.participants;if(participantsMap){var _step,_iterator=_createForOfIteratorHelper(participants);try{for(_iterator.s();!(_step=_iterator.n()).done;){var participant=_step.value;participantsMap[Object(src.g)(participant.id)]=participant}}catch(err){_iterator.e(err)}finally{_iterator.f()}}}))}},{key:"deleteParticipants",value:function deleteParticipants(threadId,participantIds){this.modifyState((function(draft){var _draft$threads$thread6,participants=null===(_draft$threads$thread6=draft.threads[threadId])||void 0===_draft$threads$thread6?void 0:_draft$threads$thread6.participants;participants&&participantIds.forEach((function(id){delete participants[Object(src.g)(id)]}))}))}},{key:"deleteParticipant",value:function deleteParticipant(threadId,participantId){this.modifyState((function(draft){var _draft$threads$thread7,participants=null===(_draft$threads$thread7=draft.threads[threadId])||void 0===_draft$threads$thread7?void 0:_draft$threads$thread7.participants;participants&&delete participants[Object(src.g)(participantId)]}))}},{key:"addReadReceipt",value:function addReadReceipt(threadId,readReceipt){var _this3=this;this.modifyState((function(draft){var thread=draft.threads[threadId],readReceipts=null==thread?void 0:thread.readReceipts;thread&&readReceipts&&(readReceipt.sender!==_this3.getState().userId&&thread.latestReadTime<readReceipt.readOn&&(thread.latestReadTime=readReceipt.readOn),readReceipts.push(readReceipt))}))}},{key:"startTypingIndicatorCleanUp",value:function startTypingIndicatorCleanUp(){var _this4=this;this.typingIndicatorInterval||(this.typingIndicatorInterval=window.setInterval((function(){var isTypingActive=!1,isStateChanged=!1,newState=Object(immer_esm.a)(_this4._state,(function(draft){for(var _i2=0,_Object$values2=Object.values(draft.threads);_i2<_Object$values2.length;_i2++){var thread=_Object$values2[_i2],filteredTypingIndicators=thread.typingIndicators.filter((function(typingIndicator){return Date.now()-typingIndicator.receivedOn.getTime()<Constants_TYPING_INDICATOR_MAINTAIN_TIME}));thread.typingIndicators.length!==filteredTypingIndicators.length&&(isStateChanged=!0,thread.typingIndicators=filteredTypingIndicators),thread.typingIndicators.length>0&&(isTypingActive=!0)}}));isStateChanged&&_this4.setState(newState),!isTypingActive&&_this4.typingIndicatorInterval&&(window.clearInterval(_this4.typingIndicatorInterval),_this4.typingIndicatorInterval=void 0)}),1e3))}},{key:"addTypingIndicator",value:function addTypingIndicator(threadId,typingIndicator){this.modifyState((function(draft){var thread=draft.threads[threadId];thread&&thread.typingIndicators.push(typingIndicator)})),this.startTypingIndicatorCleanUp()}},{key:"setChatMessage",value:function setChatMessage(threadId,message){var _this5=this,messageId=message.id,clientMessageId=message.clientMessageId;(messageId||clientMessageId)&&this.modifyState((function(draft){var _draft$threads$thread8,threadMessages=null===(_draft$threads$thread8=draft.threads[threadId])||void 0===_draft$threads$thread8?void 0:_draft$threads$thread8.chatMessages,isLocalIdInMap=threadMessages&&clientMessageId&&threadMessages[clientMessageId],messageKey=!messageId||isLocalIdInMap?clientMessageId:messageId;threadMessages&&messageKey&&(threadMessages[messageKey]=message);var thread=draft.threads[threadId];thread&&_this5.filterTypingIndicatorForUser(thread,message.sender)}))}},{key:"withAsyncErrorTeedToState",value:function withAsyncErrorTeedToState(f,target){var _this6=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee(){var chatError,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,f.apply(void 0,_args);case 3:return _context.abrupt("return",_context.sent);case 6:throw _context.prev=6,_context.t0=_context.catch(0),chatError=ChatContext_toChatError(target,_context.t0),_this6.setLatestError(target,chatError),chatError;case 11:case"end":return _context.stop()}}),_callee,null,[[0,6]])})))}},{key:"withErrorTeedToState",value:function withErrorTeedToState(f,target){var _this7=this;return function(){try{return f.apply(void 0,arguments)}catch(error){var chatError=ChatContext_toChatError(target,error);throw _this7.setLatestError(target,chatError),chatError}}}},{key:"setLatestError",value:function setLatestError(target,error){this.modifyState((function(draft){draft.latestErrors[target]=error}))}},{key:"filterTypingIndicatorForUser",value:function filterTypingIndicatorForUser(thread,userId){if(userId){var typingIndicators=thread.typingIndicators,userIdAsKey=Object(src.g)(userId),filteredTypingIndicators=typingIndicators.filter((function(typingIndicator){return Object(src.g)(typingIndicator.sender)!==userIdAsKey}));filteredTypingIndicators.length!==typingIndicators.length&&(thread.typingIndicators=filteredTypingIndicators)}}},{key:"batch",value:function batch(operations){if(this._batchMode)throw new Error("batch() called from within another batch()");this._batchMode=!0;var priorState=this._state;try{operations(),this._state!==priorState&&this._emitter.emit("stateChanged",this._state)}catch(e){throw this._state=priorState,"verbose"===Object(dist_esm_src.getLogLevel)()&&this._logger.warning("State rollback to: "+Object(src.d)(priorState)),e}finally{this._batchMode=!1}}},{key:"onStateChange",value:function onStateChange(handler){this._emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this._emitter.off("stateChanged",handler)}}]),ChatContext}(),ChatContext_toChatError=function toChatError(target,error){return error instanceof Error?new ChatError(target,error):new ChatError(target,new Error(""+error))},convertChatMessage=(__webpack_require__(34),function convertChatMessage(message){var status=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"delivered",clientMessageId=arguments.length>2?arguments[2]:void 0;return Object.assign({},message,{clientMessageId:clientMessageId,status:status})});function EventSubscriber_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncIterator(iterable){var method,async,sync,retry=2;for("undefined"!=typeof Symbol&&(async=Symbol.asyncIterator,sync=Symbol.iterator);retry--;){if(async&&null!=(method=iterable[async]))return method.call(iterable);if(sync&&null!=(method=iterable[sync]))return new AsyncFromSyncIterator(method.call(iterable));async="@@asyncIterator",sync="@@iterator"}throw new TypeError("Object is not async iterable")}function AsyncFromSyncIterator(s){function AsyncFromSyncIteratorContinuation(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var done=r.done;return Promise.resolve(r.value).then((function(value){return{value:value,done:done}}))}return(AsyncFromSyncIterator=function AsyncFromSyncIterator(s){this.s=s,this.n=s.next}).prototype={s:null,n:null,next:function next(){return AsyncFromSyncIteratorContinuation(this.n.apply(this.s,arguments))},return:function _return(value){var ret=this.s.return;return void 0===ret?Promise.resolve({value:value,done:!0}):AsyncFromSyncIteratorContinuation(ret.apply(this.s,arguments))},throw:function _throw(value){var thr=this.s.return;return void 0===thr?Promise.reject(value):AsyncFromSyncIteratorContinuation(thr.apply(this.s,arguments))}},new AsyncFromSyncIterator(s)}var EventSubscriber_EventSubscriber=function EventSubscriber(chatClient,chatContext){var _this=this;!function EventSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,EventSubscriber),this.chatClient=void 0,this.chatContext=void 0,this.convertEventToChatMessage=function(event){return convertChatMessage({id:event.id,version:event.version,content:{message:event.message},type:_this.convertEventType(event.type),sender:event.sender,senderDisplayName:event.senderDisplayName,sequenceId:"",createdOn:new Date(event.createdOn),editedOn:"editedOn"in event?event.editedOn:void 0,metadata:event.metadata})},this.convertEventType=function(type){var lowerCaseType=type.toLowerCase();return"richtext/html"===lowerCaseType||"html"===lowerCaseType?"html":"text"},this.onChatMessageReceived=function(event){var _this$chatContext$get,messageEventType=event.type.toLowerCase();if("text"===messageEventType||"richtext/html"===messageEventType||"html"===messageEventType){var newMessage=_this.convertEventToChatMessage(event),existingMessage=null===(_this$chatContext$get=_this.chatContext.getState().threads[event.threadId])||void 0===_this$chatContext$get?void 0:_this$chatContext$get.chatMessages[event.id];existingMessage&&(newMessage.sequenceId=existingMessage.sequenceId),_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(event.threadId),_this.chatContext.setChatMessage(event.threadId,newMessage)}))}},this.onChatMessageDeleted=function(event){_this.chatContext.deleteMessage(event.threadId,event.id)},this.onChatMessageEdited=function(event){var editedMessage=_this.convertEventToChatMessage(event);_this.chatContext.setChatMessage(event.threadId,convertChatMessage(editedMessage))},this.onParticipantsAdded=function(event){var participantsToAdd=event.participantsAdded.map((function(participant){return Object.assign({},participant,{shareHistoryTime:participant.shareHistoryTime?new Date(participant.shareHistoryTime):void 0})}));_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(event.threadId),_this.chatContext.setParticipants(event.threadId,participantsToAdd)})),_this.fetchLastParticipantMessage(event.threadId,"participantAdded")},this.fetchLastParticipantMessage=function(){var _ref=function EventSubscriber_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){EventSubscriber_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){EventSubscriber_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(threadId,actionType){var _iteratorAbruptCompletion,_didIteratorError,_iteratorError,_iterator,_step,message;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:_iteratorAbruptCompletion=!1,_didIteratorError=!1,_context.prev=2,_iterator=_asyncIterator(_this.chatClient.getChatThreadClient(threadId).listMessages({startTime:new Date(Date.now()-1e4)}));case 4:return _context.next=6,_iterator.next();case 6:if(!(_iteratorAbruptCompletion=!(_step=_context.sent).done)){_context.next=12;break}(message=_step.value).type===actionType&&_this.chatContext.setChatMessage(threadId,Object.assign({},message,{status:"delivered"}));case 9:_iteratorAbruptCompletion=!1,_context.next=4;break;case 12:_context.next=18;break;case 14:_context.prev=14,_context.t0=_context.catch(2),_didIteratorError=!0,_iteratorError=_context.t0;case 18:if(_context.prev=18,_context.prev=19,!_iteratorAbruptCompletion||null==_iterator.return){_context.next=23;break}return _context.next=23,_iterator.return();case 23:if(_context.prev=23,!_didIteratorError){_context.next=26;break}throw _iteratorError;case 26:return _context.finish(23);case 27:return _context.finish(18);case 28:case"end":return _context.stop()}}),_callee,null,[[2,14,18,28],[19,,23,27]])})));return function(_x,_x2){return _ref.apply(this,arguments)}}(),this.onParticipantsRemoved=function(event){var participantIds=event.participantsRemoved.map((function(participant){return participant.id}));_this.chatContext.deleteParticipants(event.threadId,participantIds),_this.fetchLastParticipantMessage(event.threadId,"participantRemoved")},this.onReadReceiptReceived=function(event){var readReceipt=Object.assign({},event,{sender:event.sender,readOn:new Date(event.readOn)});_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(event.threadId),_this.chatContext.addReadReceipt(event.threadId,readReceipt)}))},this.onTypingIndicatorReceived=function(typingIndicator){_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(typingIndicator.threadId),_this.chatContext.addTypingIndicator(typingIndicator.threadId,typingIndicator)}))},this.onChatThreadCreated=function(event){var properties={topic:event.properties.topic};_this.chatContext.createThreadIfNotExist(event.threadId,properties)||_this.chatContext.updateThread(event.threadId,properties)},this.onChatThreadDeleted=function(event){_this.chatContext.deleteThread(event.threadId)},this.onChatThreadPropertiesUpdated=function(event){_this.chatContext.updateThread(event.threadId,{topic:event.properties.topic})},this.subscribe=function(){_this.chatClient.on("chatMessageReceived",_this.onChatMessageReceived),_this.chatClient.on("chatMessageDeleted",_this.onChatMessageDeleted),_this.chatClient.on("chatMessageEdited",_this.onChatMessageEdited),_this.chatClient.on("participantsAdded",_this.onParticipantsAdded),_this.chatClient.on("participantsRemoved",_this.onParticipantsRemoved),_this.chatClient.on("readReceiptReceived",_this.onReadReceiptReceived),_this.chatClient.on("typingIndicatorReceived",_this.onTypingIndicatorReceived),_this.chatClient.on("chatThreadCreated",_this.onChatThreadCreated),_this.chatClient.on("chatThreadDeleted",_this.onChatThreadDeleted),_this.chatClient.on("chatThreadPropertiesUpdated",_this.onChatThreadPropertiesUpdated)},this.unsubscribe=function(){_this.chatClient.off("chatMessageReceived",_this.onChatMessageReceived),_this.chatClient.off("chatMessageDeleted",_this.onChatMessageDeleted),_this.chatClient.off("chatMessageEdited",_this.onChatMessageEdited),_this.chatClient.off("participantsAdded",_this.onParticipantsAdded),_this.chatClient.off("participantsRemoved",_this.onParticipantsRemoved),_this.chatClient.off("readReceiptReceived",_this.onReadReceiptReceived),_this.chatClient.off("typingIndicatorReceived",_this.onTypingIndicatorReceived),_this.chatClient.off("chatThreadCreated",_this.onChatThreadCreated),_this.chatClient.off("chatThreadDeleted",_this.onChatThreadDeleted),_this.chatClient.off("chatThreadPropertiesUpdated",_this.onChatThreadPropertiesUpdated)},this.chatClient=chatClient,this.chatContext=chatContext,this.subscribe()},identifierModels=__webpack_require__(437),index_browser=__webpack_require__(375);function createDecoratedIterator_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function createDecoratedIterator_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return createDecoratedIterator_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return createDecoratedIterator_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function createDecoratedIterator_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function createDecoratedIterator_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function createDecoratedIterator_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){createDecoratedIterator_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){createDecoratedIterator_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var createDecoratedIterator=function createDecoratedIterator(iteratorCreator,context,decorateFn){return function(){var _ref2,_next2,threadsIterator=iteratorCreator.apply(void 0,arguments);return(_ref2={next:(_next2=createDecoratedIterator_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,threadsIterator.next();case 2:return!(result=_context.sent).done&&result.value&&decorateFn(result.value,context),_context.abrupt("return",result);case 5:case"end":return _context.stop()}}),_callee)}))),function next(){return _next2.apply(this,arguments)})})[Symbol.asyncIterator]=function(){return this},_ref2.byPage=function byPage(){var _ref,_next3,settings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},pages=threadsIterator.byPage(settings);return(_ref={next:(_next3=createDecoratedIterator_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var result,page;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,pages.next();case 2:return result=_context2.sent,page=result.value,!result.done&&result.value&&context.batch((function(){var _step,_iterator=createDecoratedIterator_createForOfIteratorHelper(page);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _item=_step.value;decorateFn(_item,context)}}catch(err){_iterator.e(err)}finally{_iterator.f()}})),_context2.abrupt("return",result);case 6:case"end":return _context2.stop()}}),_callee2)}))),function next(){return _next3.apply(this,arguments)})})[Symbol.asyncIterator]=function(){return this},_ref},_ref2}},createErrorHandlingIterator=function createErrorHandlingIterator(iteratorCreator,context,target){return function(){var _ref4,innerIter=iteratorCreator.apply(void 0,arguments);return(_ref4={next:context.withAsyncErrorTeedToState(innerIter.next.bind(innerIter),target)})[Symbol.asyncIterator]=function(){return this},_ref4.byPage=function byPage(){var _ref3,settings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},pages=innerIter.byPage(settings);return(_ref3={next:context.withAsyncErrorTeedToState(pages.next.bind(pages),target)})[Symbol.asyncIterator]=function(){return this},_ref3},_ref4}};function StatefulChatThreadClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StatefulChatThreadClient_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StatefulChatThreadClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StatefulChatThreadClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function StatefulChatThreadClient_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var StatefulChatThreadClient_ProxyChatThreadClient=function(){function ProxyChatThreadClient(context){!function StatefulChatThreadClient_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyChatThreadClient),this._context=void 0,this._context=context}return function StatefulChatThreadClient_createClass(Constructor,protoProps,staticProps){return protoProps&&StatefulChatThreadClient_defineProperties(Constructor.prototype,protoProps),staticProps&&StatefulChatThreadClient_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(ProxyChatThreadClient,[{key:"get",value:function get(chatThreadClient,prop){var _this=this;switch(prop){case"listMessages":return function createDecoratedListMessages(chatThreadClient,context){return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatThreadClient.listMessages.bind(chatThreadClient),"ChatThreadClient.listMessages"),context,"ChatThreadClient.listMessages"),context,(function setMessage(message,context){context.setChatMessage(chatThreadClient.threadId,convertChatMessage(message))}))}(chatThreadClient,this._context);case"getMessage":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var message,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,chatThreadClient.getMessage.apply(chatThreadClient,_args);case 2:return message=_context.sent,_this._context.setChatMessage(chatThreadClient.threadId,convertChatMessage(message)),_context.abrupt("return",message);case 5:case"end":return _context.stop()}}),_callee)}))),"ChatThreadClient.getMessage");case"sendMessage":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _result,_ref3,content,clientMessageId,newMessage,result,_args2=arguments;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _ref3=_args2.length<=0?void 0:_args2[0],content=_ref3.content,clientMessageId=Object(index_browser.a)(),newMessage={content:{message:content},clientMessageId:clientMessageId,id:"",type:"text",sequenceId:"",version:"",createdOn:new Date,status:"sending",senderDisplayName:_this._context.getState().displayName,sender:_this._context.getState().userId},_this._context.setChatMessage(chatThreadClient.threadId,newMessage),result=void 0,_context2.prev=5,_context2.next=8,chatThreadClient.sendMessage.apply(chatThreadClient,_args2);case 8:result=_context2.sent,_context2.next=15;break;case 11:throw _context2.prev=11,_context2.t0=_context2.catch(5),_this._context.setChatMessage(chatThreadClient.threadId,Object.assign({},newMessage,{status:"failed"})),_context2.t0;case 15:return null!==(_result=result)&&void 0!==_result&&_result.id&&_this._context.batch((function(){result&&(_this._context.setChatMessage(chatThreadClient.threadId,Object.assign({},newMessage,{clientMessageId:void 0,status:"delivered",id:result.id})),_this._context.deleteLocalMessage(chatThreadClient.threadId,clientMessageId))})),_context2.abrupt("return",result);case 17:case"end":return _context2.stop()}}),_callee2,null,[[5,11]])}))),"ChatThreadClient.sendMessage");case"addParticipants":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _len,args,_key,result,addRequest,participantsToAdd,_args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:for(_len=_args3.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=_args3[_key];return _context3.next=3,chatThreadClient.addParticipants.apply(chatThreadClient,args);case 3:return result=_context3.sent,addRequest=args[0],participantsToAdd=addRequest.participants,_this._context.setParticipants(chatThreadClient.threadId,participantsToAdd),_context3.abrupt("return",result);case 8:case"end":return _context3.stop()}}),_callee3)}))),"ChatThreadClient.addParticipants");case"deleteMessage":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _len2,args,_key2,messageId,result,_args4=arguments;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:for(_len2=_args4.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=_args4[_key2];if(messageId=args[0],!_this._context.deleteLocalMessage(chatThreadClient.threadId,messageId)){_context4.next=4;break}return _context4.abrupt("return",{});case 4:return _context4.next=6,chatThreadClient.deleteMessage.apply(chatThreadClient,args);case 6:return result=_context4.sent,_this._context.deleteMessage(chatThreadClient.threadId,messageId),_context4.abrupt("return",result);case 9:case"end":return _context4.stop()}}),_callee4)}))),"ChatThreadClient.deleteMessage");case"listParticipants":return function createDecoratedListParticipants(chatThreadClient,context){return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatThreadClient.listParticipants.bind(chatThreadClient),"ChatThreadClient.listParticipants"),context,"ChatThreadClient.listParticipants"),context,(function setParticipant(participant,context){context.setParticipant(chatThreadClient.threadId,participant)}))}(chatThreadClient,this._context);case"listReadReceipts":return function createDecoratedListReadReceipts(chatThreadClient,context){return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatThreadClient.listReadReceipts.bind(chatThreadClient),"ChatThreadClient.listReadReceipts"),context,"ChatThreadClient.listReadReceipts"),context,(function setReadReceipt(readReceipt,context){context.addReadReceipt(chatThreadClient.threadId,Object.assign({},readReceipt))}))}(chatThreadClient,this._context);case"removeParticipant":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var _len3,args,_key3,result,removeIdentifier,_args5=arguments;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:for(_len3=_args5.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=_args5[_key3];return _context5.next=3,chatThreadClient.removeParticipant.apply(chatThreadClient,args);case 3:return result=_context5.sent,removeIdentifier=args[0],_this._context.deleteParticipant(chatThreadClient.threadId,Object(identifierModels.a)(removeIdentifier)),_context5.abrupt("return",result);case 7:case"end":return _context5.stop()}}),_callee5)}))),"ChatThreadClient.removeParticipant");case"updateMessage":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){var _len4,args,_key4,result,messageId,updateOption,_args6=arguments;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:for(_len4=_args6.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=_args6[_key4];return _context6.next=3,chatThreadClient.updateMessage.apply(chatThreadClient,args);case 3:return result=_context6.sent,messageId=args[0],updateOption=args[1],_this._context.updateChatMessageContent(chatThreadClient.threadId,messageId,null==updateOption?void 0:updateOption.content),_context6.abrupt("return",result);case 7:case"end":return _context6.stop()}}),_callee6)}))),"ChatThreadClient.updateMessage");case"updateTopic":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){var _len5,args,_key5,result,topic,_args7=arguments;return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:for(_len5=_args7.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=_args7[_key5];return _context7.next=3,chatThreadClient.updateTopic.apply(chatThreadClient,args);case 3:return result=_context7.sent,topic=args[0],_this._context.updateThreadTopic(chatThreadClient.threadId,topic),_context7.abrupt("return",result);case 7:case"end":return _context7.stop()}}),_callee7)}))),"ChatThreadClient.updateTopic");case"getProperties":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){var result,_args8=arguments;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,chatThreadClient.getProperties.apply(chatThreadClient,_args8);case 2:return result=_context8.sent,_this._context.updateThread(chatThreadClient.threadId,result),_context8.abrupt("return",result);case 5:case"end":return _context8.stop()}}),_callee8)}))),"ChatThreadClient.getProperties");default:return Reflect.get(chatThreadClient,prop)}}}]),ProxyChatThreadClient}(),chatThreadClientDeclaratify=function chatThreadClientDeclaratify(chatThreadClient,context){return context.createThreadIfNotExist(chatThreadClient.threadId),new Proxy(chatThreadClient,new StatefulChatThreadClient_ProxyChatThreadClient(context))};function StatefulChatClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StatefulChatClient_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StatefulChatClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StatefulChatClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var proxyChatClient={get:function get(chatClient,prop,receiver){if("context"===prop)return Reflect.get(chatClient,prop);var context=receiver.context;switch(prop){case"createChatThread":return context.withAsyncErrorTeedToState(StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _len,args,_key,result,thread,request,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:for(_len=_args.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=_args[_key];return _context.next=3,chatClient.createChatThread.apply(chatClient,args);case 3:return result=_context.sent,(thread=result.chatThread)&&(request=args[0],context.createThread(thread.id,{topic:request.topic})),_context.abrupt("return",result);case 7:case"end":return _context.stop()}}),_callee)}))),"ChatClient.createChatThread");case"deleteChatThread":return context.withAsyncErrorTeedToState(StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var result,_args2=arguments;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,chatClient.deleteChatThread.apply(chatClient,_args2);case 2:return result=_context2.sent,context.deleteThread(_args2.length<=0?void 0:_args2[0]),_context2.abrupt("return",result);case 5:case"end":return _context2.stop()}}),_callee2)}))),"ChatClient.deleteChatThread");case"listChatThreads":return function createDecoratedListThreads(chatClient,context){return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatClient.listChatThreads.bind(chatClient),"ChatClient.listChatThreads"),context,"ChatClient.listChatThreads"),context,(function setThreadProperties(chatThreadItem,context){var properties={topic:chatThreadItem.topic};context.createThreadIfNotExist(chatThreadItem.id,properties)||context.updateThread(chatThreadItem.id,properties)}))}(chatClient,context);case"getChatThreadClient":return function(){var chatThreadClient=chatClient.getChatThreadClient.apply(chatClient,arguments);return chatThreadClientDeclaratify(chatThreadClient,context)};case"startRealtimeNotifications":return context.withAsyncErrorTeedToState(StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var ret,_args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,chatClient.startRealtimeNotifications.apply(chatClient,_args3);case 2:return ret=_context3.sent,receiver.eventSubscriber||(receiver.eventSubscriber=new EventSubscriber_EventSubscriber(chatClient,context)),_context3.abrupt("return",ret);case 5:case"end":return _context3.stop()}}),_callee3)}))),"ChatClient.startRealtimeNotifications");case"stopRealtimeNotifications":return context.withAsyncErrorTeedToState(StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var ret,_args4=arguments;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,chatClient.stopRealtimeNotifications.apply(chatClient,_args4);case 2:return ret=_context4.sent,receiver.eventSubscriber&&(receiver.eventSubscriber.unsubscribe(),receiver.eventSubscriber=void 0),_context4.abrupt("return",ret);case 5:case"end":return _context4.stop()}}),_callee4)}))),"ChatClient.stopRealtimeNotifications");default:return Reflect.get(chatClient,prop)}}},StatefulChatClient_createStatefulChatClient=function createStatefulChatClient(args,options){var tweakedOptions=Object.assign({},options,{chatClientOptions:Object.assign({},null==options?void 0:options.chatClientOptions,{userAgentOptions:{userAgentPrefix:Object(src.c)()}})});return StatefulChatClient_createStatefulChatClientWithDeps(new src_chatClient.a(args.endpoint,args.credential,tweakedOptions.chatClientOptions),args,tweakedOptions)},StatefulChatClient_createStatefulChatClientWithDeps=function createStatefulChatClientWithDeps(chatClient,args,options){var eventSubscriber,context=new ChatContext_ChatContext(null==options?void 0:options.maxStateChangeListeners);context.updateChatConfig(Object(identifierModels.a)(args.userId),args.displayName);var proxy=new Proxy(chatClient,proxyChatClient);return Object.defineProperty(proxy,"context",{configurable:!1,get:function get(){return context}}),Object.defineProperty(proxy,"eventSubscriber",{configurable:!1,get:function get(){return eventSubscriber},set:function set(val){eventSubscriber=val}}),Object.defineProperty(proxy,"getState",{configurable:!1,value:function value(){return null==context?void 0:context.getState()}}),Object.defineProperty(proxy,"onStateChange",{configurable:!1,value:function value(handler){return null==context?void 0:context.onStateChange(handler)}}),Object.defineProperty(proxy,"offStateChange",{configurable:!1,value:function value(handler){return null==context?void 0:context.offStateChange(handler)}}),proxy},chat_component_bindings_src=__webpack_require__(485);__webpack_require__(155),__webpack_require__(115),__webpack_require__(45),__webpack_require__(36);function AzureCommunicationFileUploadAdapter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AzureCommunicationFileUploadAdapter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AzureCommunicationFileUploadAdapter_createClass(Constructor,protoProps,staticProps){return protoProps&&AzureCommunicationFileUploadAdapter_defineProperties(Constructor.prototype,protoProps),staticProps&&AzureCommunicationFileUploadAdapter_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}var AzureCommunicationFileUploadAdapter_FileUploadContext=function(){function FileUploadContext(chatContext){AzureCommunicationFileUploadAdapter_classCallCheck(this,FileUploadContext),this.chatContext=void 0,this.chatContext=chatContext}return AzureCommunicationFileUploadAdapter_createClass(FileUploadContext,[{key:"getFileUploads",value:function getFileUploads(){return this.chatContext.getState().fileUploads}},{key:"setFileUploads",value:function setFileUploads(fileUploads){var fileUploadsMap=fileUploads.reduce((function(map,fileUpload){return map[fileUpload.id]={id:fileUpload.id,filename:fileUpload.fileName,progress:0,metadata:fileUpload.metadata},map}),{});this.chatContext.setState(Object(immer_esm.a)(this.chatContext.getState(),(function(draft){draft.fileUploads=fileUploadsMap})))}},{key:"updateFileUpload",value:function updateFileUpload(id,data){this.chatContext.setState(Object(immer_esm.a)(this.chatContext.getState(),(function(draft){var _draft$fileUploads,_draft$fileUploads2;null!==(_draft$fileUploads=draft.fileUploads)&&void 0!==_draft$fileUploads&&_draft$fileUploads[id]&&(draft.fileUploads[id]=Object.assign({},null===(_draft$fileUploads2=draft.fileUploads)||void 0===_draft$fileUploads2?void 0:_draft$fileUploads2[id],data))})))}},{key:"deleteFileUpload",value:function deleteFileUpload(id){this.chatContext.setState(Object(immer_esm.a)(this.chatContext.getState(),(function(draft){var _draft$fileUploads3;null==draft||(null===(_draft$fileUploads3=draft.fileUploads)||void 0===_draft$fileUploads3||delete _draft$fileUploads3[id])})))}}]),FileUploadContext}(),AzureCommunicationFileUploadAdapter=function(){function AzureCommunicationFileUploadAdapter(chatContext){AzureCommunicationFileUploadAdapter_classCallCheck(this,AzureCommunicationFileUploadAdapter),this.context=void 0,this.fileUploads=[],this.context=new AzureCommunicationFileUploadAdapter_FileUploadContext(chatContext)}return AzureCommunicationFileUploadAdapter_createClass(AzureCommunicationFileUploadAdapter,[{key:"findFileUpload",value:function findFileUpload(id){return this.fileUploads.find((function(fileUpload){return fileUpload.id===id}))}},{key:"deleteFileUpload",value:function deleteFileUpload(id){this.fileUploads=this.fileUploads.filter((function(fileUpload){return fileUpload.id!==id}))}},{key:"registerFileUploads",value:function registerFileUploads(fileUploads){var _this=this;this.fileUploads=this.fileUploads.concat(fileUploads),this.context.setFileUploads(this.fileUploads),this.fileUploads.forEach((function(fileUpload){return _this.subscribeAllEvents(fileUpload)}))}},{key:"clearFileUploads",value:function clearFileUploads(){var _this2=this;this.context.setFileUploads([]),this.fileUploads.forEach((function(fileUpload){return _this2.unsubscribeAllEvents(fileUpload)})),this.fileUploads=[]}},{key:"cancelFileUpload",value:function cancelFileUpload(id){this.context.deleteFileUpload(id);var fileUpload=this.findFileUpload(id);if(!fileUpload)throw new Error("File upload not found");this.unsubscribeAllEvents(fileUpload),this.deleteFileUpload(id)}},{key:"fileUploadProgressListener",value:function fileUploadProgressListener(id,progress){this.context.updateFileUpload(id,{progress:progress})}},{key:"fileUploadFailedListener",value:function fileUploadFailedListener(id,errorMessage){this.context.updateFileUpload(id,{errorMessage:errorMessage})}},{key:"fileUploadCompletedListener",value:function fileUploadCompletedListener(id,metadata){this.context.updateFileUpload(id,{progress:1,metadata:metadata})}},{key:"subscribeAllEvents",value:function subscribeAllEvents(fileUpload){fileUpload.on("uploadProgressed",this.fileUploadProgressListener.bind(this)),fileUpload.on("uploadCompleted",this.fileUploadCompletedListener.bind(this)),fileUpload.on("uploadFailed",this.fileUploadFailedListener.bind(this))}},{key:"unsubscribeAllEvents",value:function unsubscribeAllEvents(fileUpload){null==fileUpload||fileUpload.off("uploadProgressed",this.fileUploadProgressListener.bind(this)),null==fileUpload||fileUpload.off("uploadCompleted",this.fileUploadCompletedListener.bind(this)),null==fileUpload||fileUpload.off("uploadFailed",this.fileUploadFailedListener.bind(this))}}]),AzureCommunicationFileUploadAdapter}(),convertFileUploadsUiStateToMessageMetadata=function convertFileUploadsUiStateToMessageMetadata(fileUploads){var fileMetadata=[];return fileUploads&&Object.keys(fileUploads).forEach((function(key){var file=fileUploads[key];!file.errorMessage&&file.metadata&&fileMetadata.push(file.metadata)})),{fileSharingMetadata:JSON.stringify(fileMetadata)}};function AzureCommunicationChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function AzureCommunicationChatAdapter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){AzureCommunicationChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){AzureCommunicationChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function AzureCommunicationChatAdapter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AzureCommunicationChatAdapter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AzureCommunicationChatAdapter_createClass(Constructor,protoProps,staticProps){return protoProps&&AzureCommunicationChatAdapter_defineProperties(Constructor.prototype,protoProps),staticProps&&AzureCommunicationChatAdapter_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function AzureCommunicationChatAdapter_asyncIterator(iterable){var method,async,sync,retry=2;for("undefined"!=typeof Symbol&&(async=Symbol.asyncIterator,sync=Symbol.iterator);retry--;){if(async&&null!=(method=iterable[async]))return method.call(iterable);if(sync&&null!=(method=iterable[sync]))return new AzureCommunicationChatAdapter_AsyncFromSyncIterator(method.call(iterable));async="@@asyncIterator",sync="@@iterator"}throw new TypeError("Object is not async iterable")}function AzureCommunicationChatAdapter_AsyncFromSyncIterator(s){function AsyncFromSyncIteratorContinuation(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var done=r.done;return Promise.resolve(r.value).then((function(value){return{value:value,done:done}}))}return(AzureCommunicationChatAdapter_AsyncFromSyncIterator=function AsyncFromSyncIterator(s){this.s=s,this.n=s.next}).prototype={s:null,n:null,next:function next(){return AsyncFromSyncIteratorContinuation(this.n.apply(this.s,arguments))},return:function _return(value){var ret=this.s.return;return void 0===ret?Promise.resolve({value:value,done:!0}):AsyncFromSyncIteratorContinuation(ret.apply(this.s,arguments))},throw:function _throw(value){var thr=this.s.return;return void 0===thr?Promise.reject(value):AsyncFromSyncIteratorContinuation(thr.apply(this.s,arguments))}},new AzureCommunicationChatAdapter_AsyncFromSyncIterator(s)}var AzureCommunicationChatAdapter_ChatContext=function(){function ChatContext(clientState,threadId){AzureCommunicationChatAdapter_classCallCheck(this,ChatContext),this.emitter=new events_default.a,this.state=void 0,this.threadId=void 0;var thread=clientState.threads[threadId];if(this.threadId=threadId,!thread)throw"Cannot find threadId, please initialize thread before use!";this.state={userId:clientState.userId,displayName:clientState.displayName,thread:thread,latestErrors:clientState.latestErrors}}return AzureCommunicationChatAdapter_createClass(ChatContext,[{key:"onStateChange",value:function onStateChange(handler){this.emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this.emitter.off("stateChanged",handler)}},{key:"setState",value:function setState(state){this.state=state,this.emitter.emit("stateChanged",this.state)}},{key:"getState",value:function getState(){return this.state}},{key:"setError",value:function setError(error){this.setState(Object.assign({},this.state,{error:error}))}},{key:"updateClientState",value:function updateClientState(clientState){var thread=clientState.threads[this.threadId];if(!thread)throw"Cannot find threadId, please make sure thread state is still in Stateful ChatClient.";var updatedState={userId:clientState.userId,displayName:clientState.displayName,thread:thread,latestErrors:clientState.latestErrors};updatedState=Object.assign({},updatedState,{fileUploads:this.state.fileUploads}),this.setState(updatedState)}}]),ChatContext}(),AzureCommunicationChatAdapter_AzureCommunicationChatAdapter=function(){function AzureCommunicationChatAdapter(chatClient,chatThreadClient){var _this=this;AzureCommunicationChatAdapter_classCallCheck(this,AzureCommunicationChatAdapter),this.chatClient=void 0,this.chatThreadClient=void 0,this.context=void 0,this.fileUploadAdapter=void 0,this.handlers=void 0,this.emitter=new events_default.a,this.bindAllPublicMethods(),this.chatClient=chatClient,this.chatThreadClient=chatThreadClient,this.context=new AzureCommunicationChatAdapter_ChatContext(chatClient.getState(),chatThreadClient.threadId),this.fileUploadAdapter=new AzureCommunicationFileUploadAdapter(this.context);this.handlers=Object(chat_component_bindings_src.a)(chatClient,chatThreadClient),this.chatClient.onStateChange((function onStateChange(clientState){_this?_this.context.updateClientState(clientState):chatClient.offStateChange(onStateChange)})),this.subscribeAllEvents()}var _asyncTeeErrorToEventEmitter,_deleteMessage,_updateMessage,_loadPreviousChatMessages,_setTopic,_removeParticipant,_sendTypingIndicator,_sendReadReceipt,_sendMessage,_fetchInitialData;return AzureCommunicationChatAdapter_createClass(AzureCommunicationChatAdapter,[{key:"bindAllPublicMethods",value:function bindAllPublicMethods(){this.onStateChange=this.onStateChange.bind(this),this.offStateChange=this.offStateChange.bind(this),this.getState=this.getState.bind(this),this.dispose=this.dispose.bind(this),this.fetchInitialData=this.fetchInitialData.bind(this),this.sendMessage=this.sendMessage.bind(this),this.sendReadReceipt=this.sendReadReceipt.bind(this),this.sendTypingIndicator=this.sendTypingIndicator.bind(this),this.updateMessage=this.updateMessage.bind(this),this.deleteMessage=this.deleteMessage.bind(this),this.removeParticipant=this.removeParticipant.bind(this),this.setTopic=this.setTopic.bind(this),this.loadPreviousChatMessages=this.loadPreviousChatMessages.bind(this),this.on=this.on.bind(this),this.off=this.off.bind(this),this.registerFileUploads=this.registerFileUploads.bind(this),this.clearFileUploads=this.clearFileUploads.bind(this),this.cancelFileUpload=this.cancelFileUpload.bind(this)}},{key:"dispose",value:function dispose(){this.unsubscribeAllEvents()}},{key:"fetchInitialData",value:(_fetchInitialData=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _iteratorAbruptCompletion,_didIteratorError,_iteratorError,_iterator,_step;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,this.chatThreadClient.getProperties();case 3:_context.next=8;break;case 5:_context.prev=5,_context.t0=_context.catch(0),console.log(_context.t0);case 8:_context.prev=8,_iteratorAbruptCompletion=!1,_didIteratorError=!1,_context.prev=11,_iterator=AzureCommunicationChatAdapter_asyncIterator(this.chatThreadClient.listParticipants().byPage({maxPageSize:100}));case 13:return _context.next=15,_iterator.next();case 15:if(!(_iteratorAbruptCompletion=!(_step=_context.sent).done)){_context.next=21;break}_step.value;case 18:_iteratorAbruptCompletion=!1,_context.next=13;break;case 21:_context.next=27;break;case 23:_context.prev=23,_context.t1=_context.catch(11),_didIteratorError=!0,_iteratorError=_context.t1;case 27:if(_context.prev=27,_context.prev=28,!_iteratorAbruptCompletion||null==_iterator.return){_context.next=32;break}return _context.next=32,_iterator.return();case 32:if(_context.prev=32,!_didIteratorError){_context.next=35;break}throw _iteratorError;case 35:return _context.finish(32);case 36:return _context.finish(27);case 37:_context.next=42;break;case 39:_context.prev=39,_context.t2=_context.catch(8),console.log(_context.t2);case 42:case"end":return _context.stop()}}),_callee,this,[[0,5],[8,39],[11,23,27,37],[28,,32,36]])}))),function fetchInitialData(){return _fetchInitialData.apply(this,arguments)})},{key:"getState",value:function getState(){return this.context.getState()}},{key:"onStateChange",value:function onStateChange(handler){this.context.onStateChange(handler)}},{key:"offStateChange",value:function offStateChange(handler){this.context.offStateChange(handler)}},{key:"sendMessage",value:(_sendMessage=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee3(content){var options,_this2=this,_args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return options=_args3.length>1&&void 0!==_args3[1]?_args3[1]:{},_context3.next=3,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return options.metadata=Object.assign({},options.metadata,convertFileUploadsUiStateToMessageMetadata(_this2.context.getState().fileUploads)),_context2.next=3,_this2.handlers.onSendMessage(content,options);case 3:_this2.fileUploadAdapter.clearFileUploads&&_this2.fileUploadAdapter.clearFileUploads();case 4:case"end":return _context2.stop()}}),_callee2)}))));case 3:case"end":return _context3.stop()}}),_callee3,this)}))),function sendMessage(_x){return _sendMessage.apply(this,arguments)})},{key:"sendReadReceipt",value:(_sendReadReceipt=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee5(chatMessageId){var _this3=this;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_this3.handlers.onMessageSeen(chatMessageId);case 2:case"end":return _context4.stop()}}),_callee4)}))));case 2:case"end":return _context5.stop()}}),_callee5,this)}))),function sendReadReceipt(_x2){return _sendReadReceipt.apply(this,arguments)})},{key:"sendTypingIndicator",value:(_sendTypingIndicator=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,this.handlers.onTyping();case 2:case"end":return _context6.stop()}}),_callee6,this)}))),function sendTypingIndicator(){return _sendTypingIndicator.apply(this,arguments)})},{key:"removeParticipant",value:(_removeParticipant=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee8(userId){var _this4=this;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,_this4.handlers.onRemoveParticipant(userId);case 2:case"end":return _context7.stop()}}),_callee7)}))));case 2:case"end":return _context8.stop()}}),_callee8,this)}))),function removeParticipant(_x3){return _removeParticipant.apply(this,arguments)})},{key:"setTopic",value:(_setTopic=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee10(topicName){var _this5=this;return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,_this5.handlers.updateThreadTopicName(topicName);case 2:case"end":return _context9.stop()}}),_callee9)}))));case 2:case"end":return _context10.stop()}}),_callee10,this)}))),function setTopic(_x4){return _setTopic.apply(this,arguments)})},{key:"loadPreviousChatMessages",value:(_loadPreviousChatMessages=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee12(messagesToLoad){var _this6=this;return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return _context12.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,_this6.handlers.onLoadPreviousChatMessages(messagesToLoad);case 2:return _context11.abrupt("return",_context11.sent);case 3:case"end":return _context11.stop()}}),_callee11)}))));case 2:return _context12.abrupt("return",_context12.sent);case 3:case"end":return _context12.stop()}}),_callee12,this)}))),function loadPreviousChatMessages(_x5){return _loadPreviousChatMessages.apply(this,arguments)})},{key:"updateMessage",value:(_updateMessage=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee14(messageId,content){var _this7=this;return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return _context14.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee13(){return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return _context13.next=2,_this7.handlers.onUpdateMessage(messageId,content);case 2:return _context13.abrupt("return",_context13.sent);case 3:case"end":return _context13.stop()}}),_callee13)}))));case 2:return _context14.abrupt("return",_context14.sent);case 3:case"end":return _context14.stop()}}),_callee14,this)}))),function updateMessage(_x6,_x7){return _updateMessage.apply(this,arguments)})},{key:"deleteMessage",value:(_deleteMessage=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee16(messageId){var _this8=this;return regeneratorRuntime.wrap((function _callee16$(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:return _context16.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee15(){return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return _context15.next=2,_this8.handlers.onDeleteMessage(messageId);case 2:return _context15.abrupt("return",_context15.sent);case 3:case"end":return _context15.stop()}}),_callee15)}))));case 2:return _context16.abrupt("return",_context16.sent);case 3:case"end":return _context16.stop()}}),_callee16,this)}))),function deleteMessage(_x8){return _deleteMessage.apply(this,arguments)})},{key:"registerFileUploads",value:function registerFileUploads(fileUploads){this.fileUploadAdapter.registerFileUploads&&this.fileUploadAdapter.registerFileUploads(fileUploads)}},{key:"clearFileUploads",value:function clearFileUploads(){this.fileUploadAdapter.clearFileUploads&&this.fileUploadAdapter.clearFileUploads()}},{key:"cancelFileUpload",value:function cancelFileUpload(id){this.fileUploadAdapter.cancelFileUpload&&this.fileUploadAdapter.cancelFileUpload(id)}},{key:"messageReceivedListener",value:function messageReceivedListener(event){var message=convertEventToChatMessage(event);this.emitter.emit("messageReceived",{message:message});var currentUserId=Object(src.g)(this.chatClient.getState().userId);null!=message&&message.sender&&Object(src.g)(message.sender)===currentUserId&&this.emitter.emit("messageSent",{message:message})}},{key:"messageReadListener",value:function messageReadListener(_ref8){var chatMessageId=_ref8.chatMessageId,recipient=_ref8.recipient,message=this.getState().thread.chatMessages[chatMessageId];message&&this.emitter.emit("messageRead",{message:message,readBy:recipient})}},{key:"participantsAddedListener",value:function participantsAddedListener(_ref9){var addedBy=_ref9.addedBy,participantsAdded=_ref9.participantsAdded;this.emitter.emit("participantsAdded",{addedBy:addedBy,participantsAdded:participantsAdded})}},{key:"participantsRemovedListener",value:function participantsRemovedListener(_ref10){var removedBy=_ref10.removedBy,participantsRemoved=_ref10.participantsRemoved;this.emitter.emit("participantsRemoved",{removedBy:removedBy,participantsRemoved:participantsRemoved})}},{key:"chatThreadPropertiesUpdatedListener",value:function chatThreadPropertiesUpdatedListener(event){this.emitter.emit("topicChanged",{topic:event.properties.topic})}},{key:"subscribeAllEvents",value:function subscribeAllEvents(){this.chatClient.on("chatThreadPropertiesUpdated",this.chatThreadPropertiesUpdatedListener.bind(this)),this.chatClient.on("participantsAdded",this.participantsAddedListener.bind(this)),this.chatClient.on("participantsRemoved",this.participantsRemovedListener.bind(this)),this.chatClient.on("chatMessageReceived",this.messageReceivedListener.bind(this)),this.chatClient.on("readReceiptReceived",this.messageReadListener.bind(this)),this.chatClient.on("participantsRemoved",this.participantsRemovedListener.bind(this))}},{key:"unsubscribeAllEvents",value:function unsubscribeAllEvents(){this.chatClient.off("chatThreadPropertiesUpdated",this.chatThreadPropertiesUpdatedListener.bind(this)),this.chatClient.off("participantsAdded",this.participantsAddedListener.bind(this)),this.chatClient.off("participantsRemoved",this.participantsRemovedListener.bind(this)),this.chatClient.off("chatMessageReceived",this.messageReceivedListener.bind(this)),this.chatClient.off("readReceiptReceived",this.messageReadListener.bind(this)),this.chatClient.off("participantsRemoved",this.participantsRemovedListener.bind(this))}},{key:"on",value:function on(event,listener){this.emitter.on(event,listener)}},{key:"off",value:function off(event,listener){this.emitter.off(event,listener)}},{key:"asyncTeeErrorToEventEmitter",value:(_asyncTeeErrorToEventEmitter=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee17(f){return regeneratorRuntime.wrap((function _callee17$(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:return _context17.prev=0,_context17.next=3,f();case 3:return _context17.abrupt("return",_context17.sent);case 6:throw _context17.prev=6,_context17.t0=_context17.catch(0),isChatError(_context17.t0)&&this.emitter.emit("error",_context17.t0),_context17.t0;case 10:case"end":return _context17.stop()}}),_callee17,this,[[0,6]])}))),function asyncTeeErrorToEventEmitter(_x9){return _asyncTeeErrorToEventEmitter.apply(this,arguments)})}]),AzureCommunicationChatAdapter}(),convertEventToChatMessage=function convertEventToChatMessage(event){return{id:event.id,version:event.version,content:{message:event.message},type:convertEventType(event.type),sender:event.sender,senderDisplayName:event.senderDisplayName,sequenceId:"",createdOn:new Date(event.createdOn)}},convertEventType=function convertEventType(type){var lowerCaseType=type.toLowerCase();return"richtext/html"===lowerCaseType||"html"===lowerCaseType?"html":"text"},createAzureCommunicationChatAdapter=function(){var _ref12=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee18(_ref11){var endpointUrl,userId,displayName,credential,threadId,chatClient,chatThreadClient,adapter;return regeneratorRuntime.wrap((function _callee18$(_context18){for(;;)switch(_context18.prev=_context18.next){case 0:return endpointUrl=_ref11.endpoint,userId=_ref11.userId,displayName=_ref11.displayName,credential=_ref11.credential,threadId=_ref11.threadId,chatClient=StatefulChatClient_createStatefulChatClient({userId:userId,displayName:displayName,endpoint:endpointUrl,credential:credential}),_context18.next=4,chatClient.getChatThreadClient(threadId);case 4:return chatThreadClient=_context18.sent,_context18.next=7,chatClient.startRealtimeNotifications();case 7:return _context18.next=9,createAzureCommunicationChatAdapterFromClient(chatClient,chatThreadClient);case 9:return adapter=_context18.sent,_context18.next=12,adapter.fetchInitialData();case 12:return _context18.abrupt("return",adapter);case 13:case"end":return _context18.stop()}}),_callee18)})));return function createAzureCommunicationChatAdapter(_x10){return _ref12.apply(this,arguments)}}(),createAzureCommunicationChatAdapterFromClient=function(){var _ref13=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee19(chatClient,chatThreadClient){return regeneratorRuntime.wrap((function _callee19$(_context19){for(;;)switch(_context19.prev=_context19.next){case 0:return _context19.abrupt("return",new AzureCommunicationChatAdapter_AzureCommunicationChatAdapter(chatClient,chatThreadClient));case 1:case"end":return _context19.stop()}}),_callee19)})));return function createAzureCommunicationChatAdapterFromClient(_x11,_x12){return _ref13.apply(this,arguments)}}(),isChatError=function isChatError(e){return void 0!==e.target&&void 0!==e.innerError}},310:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BaseProvider}));__webpack_require__(7);var _fluentui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(22),_internal_react_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(21),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1),_localization__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(91),_icons__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(57),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2),BaseProvider=function BaseProvider(props){var fluentTheme=props.fluentTheme,rtl=props.rtl,locale=props.locale;if(useBase())return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:props.children});Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.L)({icons:Object.assign({},_icons__WEBPACK_IMPORTED_MODULE_5__.d,props.icons)});var CompositeElement=Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(_internal_react_components__WEBPACK_IMPORTED_MODULE_2__.v,{fluentTheme:fluentTheme,rtl:rtl,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"}),props.children]}),localizedElement=locale?Object(_localization__WEBPACK_IMPORTED_MODULE_4__.a)({locale:locale,children:CompositeElement}):CompositeElement;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(BaseContext.Provider,{value:!0,children:localizedElement})};BaseProvider.displayName="BaseProvider";var BaseContext=Object(react__WEBPACK_IMPORTED_MODULE_3__.createContext)(!1),useBase=function useBase(){return Object(react__WEBPACK_IMPORTED_MODULE_3__.useContext)(BaseContext)};BaseProvider.__docgenInfo={description:"A base provider {@link React.Context} to wrap components with other required providers\n(e.g. icons, FluentThemeProvider, LocalizationProvider).\n\nRequired providers are only wrapped once, with all other instances only passing children.\n\n@private",methods:[],displayName:"BaseProvider",props:{fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Fluent theme for the composite.\n\n@defaultValue light theme"},icons:{required:!1,tsType:{name:"TIcons"},description:"Custom Icon override for the composite.\nA JSX element can be provided to override the default icon."},locale:{required:!1,tsType:{name:"CompositeLocale"},description:"Locale for the composite.\n\n@defaultValue English (US)"},rtl:{required:!1,tsType:{name:"boolean"},description:"Whether composite is displayed right-to-left.\n\n@defaultValue false"},onFetchAvatarPersonaData:{required:!1,tsType:{name:"AvatarPersonaDataCallback"},description:"A callback function that can be used to provide custom data to Avatars rendered\nin Composite."},onFetchParticipantMenuItems:{required:!1,tsType:{name:"ParticipantMenuItemsCallback"},description:"A callback function that can be used to provide custom menu items for a participant in\nparticipant list."},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/BaseComposite.tsx"]={name:"BaseProvider",docgenInfo:BaseProvider.__docgenInfo,path:"../react-composites/src/composites/common/BaseComposite.tsx"})},311:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AvatarPersona}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(7),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var _fluentui_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(1542),react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_14__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var AvatarPersona=function AvatarPersona(props){var _data$text,_data$imageUrl,_data$imageInitials,_data$initialsColor,_ref2,_data$initialsTextCol,userId=props.userId,dataProvider=props.dataProvider,text=props.text,imageUrl=props.imageUrl,imageInitials=props.imageInitials,initialsColor=props.initialsColor,initialsTextColor=props.initialsTextColor,_React$useState2=_slicedToArray(react__WEBPACK_IMPORTED_MODULE_14___default.a.useState(),2),data=_React$useState2[0],setData=_React$useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_14__.useEffect)((function(){!function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var _data;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!dataProvider||!userId){_context.next=5;break}return _context.next=3,dataProvider(userId);case 3:_data=_context.sent,setData(_data);case 5:case"end":return _context.stop()}}),_callee)})))()}),[dataProvider,userId]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_13__.a,Object.assign({},props,{text:null!==(_data$text=null==data?void 0:data.text)&&void 0!==_data$text?_data$text:text,imageUrl:null!==(_data$imageUrl=null==data?void 0:data.imageUrl)&&void 0!==_data$imageUrl?_data$imageUrl:imageUrl,imageInitials:null!==(_data$imageInitials=null==data?void 0:data.imageInitials)&&void 0!==_data$imageInitials?_data$imageInitials:imageInitials,initialsColor:null!==(_data$initialsColor=null==data?void 0:data.initialsColor)&&void 0!==_data$initialsColor?_data$initialsColor:initialsColor,initialsTextColor:null!==(_ref2=null!==(_data$initialsTextCol=null==data?void 0:data.initialsTextColor)&&void 0!==_data$initialsTextCol?_data$initialsTextCol:initialsTextColor)&&void 0!==_ref2?_ref2:"white"}))};AvatarPersona.displayName="AvatarPersona",AvatarPersona.__docgenInfo={description:"An Avatar component made using the `Persona` component.\nIt allows you to specify a `userId` and a `dataProvider` to retrieve the `AvatarPersonaData`.\nRead more about `Persona` component at https://developer.microsoft.com/fluentui#/controls/web/persona\n\n@private",methods:[],displayName:"AvatarPersona",props:{userId:{required:!1,tsType:{name:"string"},description:"Azure Communicator user ID."},dataProvider:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => Promise<AvatarPersonaData>",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"signature",type:"object",raw:"{\n  /**\n   * Primary text to display, usually the name of the person.\n   */\n  text?: string;\n  /**\n   * Image URL to use, should be a square aspect ratio and big enough to fit in the image area.\n   */\n  imageUrl?: string;\n  /**\n   * The user's initials to display in the image area when there is no image.\n   * @defaultvalue Derived from `text`\n   */\n  imageInitials?: string;\n  /**\n   * The background color when the user's initials are displayed.\n   * @defaultvalue Derived from `text`\n   */\n  initialsColor?: PersonaInitialsColor | string;\n  /**\n   * The text color when the user's initials are displayed\n   * @defaultvalue `white`\n   */\n  initialsTextColor?: string;\n}",signature:{properties:[{key:"text",value:{name:"string",required:!1}},{key:"imageUrl",value:{name:"string",required:!1}},{key:"imageInitials",value:{name:"string",required:!1}},{key:"initialsColor",value:{name:"union",raw:"PersonaInitialsColor | string",elements:[{name:"PersonaInitialsColor"},{name:"string"}],required:!1}},{key:"initialsTextColor",value:{name:"string",required:!1}}]}}],raw:"Promise<AvatarPersonaData>"}}},description:"A function that returns a Promise that resolves to the data to be displayed."}},composes:["IPersonaProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/AvatarPersona.tsx"]={name:"AvatarPersona",docgenInfo:AvatarPersona.__docgenInfo,path:"../react-composites/src/composites/common/AvatarPersona.tsx"})},312:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useAdaptedSelector})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useSelectorWithAdaptation}));__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var react__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(1),memoize_one__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(153),_adapter_CallAdapterProvider__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(134);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var useAdaptedSelector=function useAdaptedSelector(selector,selectorProps){return useSelectorWithAdaptation(selector,adaptCompositeState,selectorProps)},useSelectorWithAdaptation=function useSelectorWithAdaptation(selector,adaptState,selectorProps){var _adapter$getState$cal,adapter=Object(_adapter_CallAdapterProvider__WEBPACK_IMPORTED_MODULE_13__.b)(),mounted=Object(react__WEBPACK_IMPORTED_MODULE_11__.useRef)(!1);Object(react__WEBPACK_IMPORTED_MODULE_11__.useEffect)((function(){return mounted.current=!0,function(){mounted.current=!1}}));var callId=null===(_adapter$getState$cal=adapter.getState().call)||void 0===_adapter$getState$cal?void 0:_adapter$getState$cal.id,callConfigProps=Object(react__WEBPACK_IMPORTED_MODULE_11__.useMemo)((function(){return{callId:callId}}),[callId]),_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_11__.useState)(selector(adaptState(adapter.getState()),null!=selectorProps?selectorProps:callConfigProps)),2),props=_useState2[0],setProps=_useState2[1],propRef=Object(react__WEBPACK_IMPORTED_MODULE_11__.useRef)(props);return propRef.current=props,Object(react__WEBPACK_IMPORTED_MODULE_11__.useEffect)((function(){var onStateChange=function onStateChange(state){if(mounted.current){var newProps=selector(adaptState(state),null!=selectorProps?selectorProps:callConfigProps);propRef.current!==newProps&&setProps(newProps)}};return adapter.onStateChange(onStateChange),function(){adapter.offStateChange(onStateChange)}}),[adaptState,adapter,selector,selectorProps,callConfigProps]),props},memoizeState=Object(memoize_one__WEBPACK_IMPORTED_MODULE_12__.a)((function(userId,deviceManager,calls,latestErrors,displayName){return{userId:userId,incomingCalls:{},incomingCallsEnded:{},callsEnded:{},deviceManager:deviceManager,callAgent:{displayName:displayName},calls:calls,latestErrors:latestErrors}})),memoizeCalls=Object(memoize_one__WEBPACK_IMPORTED_MODULE_12__.a)((function(call){var _ref;return call?((_ref={})[call.id]=call,_ref):{}})),adaptCompositeState=function adaptCompositeState(compositeState){return memoizeState(compositeState.userId,compositeState.devices,memoizeCalls(compositeState.call),compositeState.latestErrors,compositeState.displayName)}},313:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ContosoCallContainer}));__webpack_require__(195),__webpack_require__(39),__webpack_require__(12),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var _azure_communication_common__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(253),_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(80),react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var isTeamsMeetingLink=function isTeamsMeetingLink(link){return link.startsWith("https://teams.microsoft.com/l/meetup-join")},ContosoCallContainer=function ContosoCallContainer(props){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_15__.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1],credential=Object(react__WEBPACK_IMPORTED_MODULE_15__.useMemo)((function(){try{return new _azure_communication_common__WEBPACK_IMPORTED_MODULE_13__.a(props.token)}catch(_unused){return void console.error("Failed to construct token credential")}}),[props.token]);return Object(react__WEBPACK_IMPORTED_MODULE_15__.useEffect)((function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var callLocator;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:credential&&props.locator&&props.displayName&&(callLocator=isTeamsMeetingLink(props.locator)?{meetingLink:props.locator}:{groupId:props.locator},function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(credential){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.createAzureCommunicationCallAdapter)({userId:props.userId,displayName:props.displayName,credential:credential,locator:callLocator});case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(_x){return _ref2.apply(this,arguments)}}()(credential));case 1:case"end":return _context2.stop()}}),_callee2)})))()}),[props,credential]),Object(react__WEBPACK_IMPORTED_MODULE_15__.useEffect)((function(){return function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(adapter){_context3.next=2;break}return _context3.abrupt("return");case 2:return _context3.next=4,adapter.leaveCall().catch((function(e){console.error("Failed to leave call",e)}));case 4:adapter.dispose();case 5:case"end":return _context3.stop()}}),_callee3)})))()}}),[adapter]),adapter?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("div",{style:{height:"90vh",width:"90vw"},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.CallComposite,{adapter:adapter,formFactor:props.formFactor,fluentTheme:props.fluentTheme,callInvitationUrl:null==props?void 0:props.callInvitationURL,locale:null==props?void 0:props.locale,options:null==props?void 0:props.options})}):void 0===credential?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.Fragment,{children:"Failed to construct credential. Provided token is malformed."}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.Fragment,{children:"Initializing..."})};ContosoCallContainer.__docgenInfo={description:"",methods:[],displayName:"ContosoCallContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},locator:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},formFactor:{required:!1,tsType:{name:"union",raw:"'desktop' | 'mobile'",elements:[{name:"literal",value:"'desktop'"},{name:"literal",value:"'mobile'"}]},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},callInvitationURL:{required:!1,tsType:{name:"string"},description:""},locale:{required:!1,tsType:{name:"CompositeLocale"},description:""},options:{required:!1,tsType:{name:"CallCompositeOptions"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/Container.snippet.tsx"]={name:"ContosoCallContainer",docgenInfo:ContosoCallContainer.__docgenInfo,path:"stories/CallComposite/snippets/Container.snippet.tsx"})},314:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ContosoChatContainer}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(253),_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(80),react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ContosoChatContainer=function ContosoChatContainer(props){var credential=Object(react__WEBPACK_IMPORTED_MODULE_14__.useMemo)((function(){try{return new _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__.a(props.token)}catch(_unused){return void console.error("Failed to construct token credential")}}),[props.token]),_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_14__.useEffect)((function(){credential&&props&&function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(credential){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__.createAzureCommunicationChatAdapter)({endpoint:props.endpointUrl,userId:props.userId,displayName:props.displayName,credential:credential,threadId:props.threadId});case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(_x){return _ref.apply(this,arguments)}}()(credential)}),[props,credential]),adapter?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)("div",{style:{height:"90vh",width:"90vw"},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__.ChatComposite,{adapter:adapter,fluentTheme:props.fluentTheme,options:{errorBar:props.errorBar,participantPane:props.participants,topic:props.topic},locale:props.locale})}):void 0===credential?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.Fragment,{children:"Failed to construct credential. Provided token is malformed."}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.Fragment,{children:"Initializing..."})};ContosoChatContainer.__docgenInfo={description:"",methods:[],displayName:"ContosoChatContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},threadId:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},errorBar:{required:!1,tsType:{name:"boolean"},description:""},participants:{required:!1,tsType:{name:"boolean"},description:""},topic:{required:!1,tsType:{name:"boolean"},description:""},locale:{required:!1,tsType:{name:"CompositeLocale"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/Container.snippet.tsx"]={name:"ContosoChatContainer",docgenInfo:ContosoChatContainer.__docgenInfo,path:"stories/ChatComposite/snippets/Container.snippet.tsx"})},32:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"f",(function(){return memoizeFnAll})),__webpack_require__.d(__webpack_exports__,"e",(function(){return fromFlatCommunicationIdentifier})),__webpack_require__.d(__webpack_exports__,"g",(function(){return identifier_toFlatCommunicationIdentifier})),__webpack_require__.d(__webpack_exports__,"c",(function(){return telemetry_getApplicationId})),__webpack_require__.d(__webpack_exports__,"b",(function(){return _formatString})),__webpack_require__.d(__webpack_exports__,"d",(function(){return _safeJSONStringify})),__webpack_require__.d(__webpack_exports__,"a",(function(){return _MAX_EVENT_LISTENERS}));__webpack_require__(782),__webpack_require__(1287),__webpack_require__(147),__webpack_require__(12),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(45),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var argsCmp=function argsCmp(args1,args2,objCmp){return args1.length===args2.length&&args1.every((function(arg1,index){return objCmp(args2[index],arg1)}))},memoizeFnAll=function memoizeFnAll(fnToMemoize){var shouldCacheUpdate=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,cache=new Map,nextCache=new Map;return function(callback){var retValue=callback((function memoizedFn(key){for(var value=cache.get(key),_len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];if(value){var _value=_slicedToArray(value,2),preArgs=_value[0],_ret=_value[1];if(argsCmp(preArgs,args,shouldCacheUpdate))return nextCache.set(key,[args,_ret]),_ret}var ret=fnToMemoize.apply(void 0,[key].concat(args));return nextCache.set(key,[args,ret]),ret}));return cache=nextCache,nextCache=new Map,retValue}},identifierModels=(__webpack_require__(195),__webpack_require__(437)),identifier_toFlatCommunicationIdentifier=function toFlatCommunicationIdentifier(identifier){return Object(identifierModels.b)(identifier)?identifier.communicationUserId:Object(identifierModels.c)(identifier)?identifier.isAnonymous?"8:teamsvisitor:"+identifier.microsoftTeamsUserId:"dod"==identifier.cloud?"8:dod:"+identifier.microsoftTeamsUserId:"gcch"==identifier.cloud?"8:gcch:"+identifier.microsoftTeamsUserId:"8:origid:"+identifier.microsoftTeamsUserId:Object(identifierModels.d)(identifier)?"4:"+identifier.phoneNumber:identifier.id},fromFlatCommunicationIdentifier=function fromFlatCommunicationIdentifier(id){return id.startsWith("8:acs:")?{communicationUserId:id}:id.startsWith("4:")?{phoneNumber:id.substr("4:".length)}:id.startsWith("8:origid:")?{microsoftTeamsUserId:id.substr("8:origid:".length)}:id.startsWith("8:dod:")?{microsoftTeamsUserId:id.substr("8:dod:".length),cloud:"dod"}:id.startsWith("8:gcch:")?{microsoftTeamsUserId:id.substr("8:gcch:".length),cloud:"gcch"}:id.startsWith("8:teamsvisitor:")?{microsoftTeamsUserId:id.substr("8:teamsvisitor:".length),isAnonymous:!0}:{id:id}},telemetryVersion=(__webpack_require__(402),__webpack_require__(56),__webpack_require__(863)),telemetryVersion_default=__webpack_require__.n(telemetryVersion),telemetry_getApplicationId=function _getApplicationId(){return function sanitize(version){var alphaIndex=version.search(/alpha/);return alphaIndex>=0?version.substring(0,alphaIndex+5):version}("acr/"+telemetryVersion_default.a)},_formatString=(__webpack_require__(104),function _formatString(str,vars){if(!str)return"";if(!vars)return str;return str.replace(/{(\w+)}/g,(function(_,k){return vars[k]||"{"+k+"}"}))}),_safeJSONStringify=function _safeJSONStringify(value,replacer,space){try{return JSON.stringify(value,replacer,space)}catch(e){return void console.error(e)}},_MAX_EVENT_LISTENERS=50},322:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return IncomingCallAlerts_IncomingCallModal})),__webpack_require__.d(__webpack_exports__,"b",(function(){return IncomingCallAlerts_IncomingCallToast}));__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var theming=__webpack_require__(77),src=__webpack_require__(21),Stack=__webpack_require__(69),Persona=__webpack_require__(1542),Persona_types=__webpack_require__(27),DefaultButton=__webpack_require__(379),DialogContent_types=__webpack_require__(276),Dialog=__webpack_require__(1738),DialogFooter=__webpack_require__(885),useBoolean=__webpack_require__(1705),CallEnd20Filled=__webpack_require__(1520),Call20Filled=__webpack_require__(1729),Video20Filled=__webpack_require__(1519),VideoOff20Filled=__webpack_require__(1518),lib=(__webpack_require__(1),__webpack_require__(22)),IncomingCallAlerts_styles_theme=Object(lib.C)(),IncomingCallAlerts_styles_palette=IncomingCallAlerts_styles_theme.palette,incomingCallToastStyle=Object(lib.H)({minWidth:"20rem",width:"100%",height:"100%",backgroundColor:IncomingCallAlerts_styles_palette.whiteTranslucent40,opacity:.95,borderRadius:"0.5rem",boxShadow:IncomingCallAlerts_styles_theme.effects.elevation8,padding:"1rem"}),incomingCallToastAvatarContainerStyle=Object(lib.H)({marginRight:"0.5rem"}),incomingCallAcceptButtonStyle=Object(lib.H)({backgroundColor:IncomingCallAlerts_styles_palette.greenDark,color:IncomingCallAlerts_styles_palette.white,borderRadius:"2rem",minWidth:"2rem",width:"2rem",border:"none",padding:"none",":hover, :active":{backgroundColor:IncomingCallAlerts_styles_palette.green,color:IncomingCallAlerts_styles_palette.white}}),incomingCallRejectButtonStyle=Object(lib.H)({backgroundColor:IncomingCallAlerts_styles_palette.redDark,color:IncomingCallAlerts_styles_palette.white,borderRadius:"2rem",minWidth:"2rem",width:"2rem",border:"none",padding:"none",":hover, :active":{backgroundColor:IncomingCallAlerts_styles_palette.red,color:IncomingCallAlerts_styles_palette.white}}),incomingCallModalContainerStyle={borderRadius:"0.75rem"},incomingCallModalLocalPreviewStyle=Object(lib.H)({height:"10rem",background:IncomingCallAlerts_styles_palette.neutralLighterAlt,margin:"1.5rem 0",borderRadius:"0.25rem","& video":{borderRadius:"0.25rem"}}),jsx_runtime=__webpack_require__(2);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var IncomingCallAlerts_IncomingCallToast=function IncomingCallToast(props){var callerName=props.callerName,alertText=props.alertText,avatar=props.avatar,onClickAccept=props.onClickAccept,onClickReject=props.onClickReject;return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,verticalAlign:"center",className:incomingCallToastStyle,children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"start",className:incomingCallToastAvatarContainerStyle,children:Object(jsx_runtime.jsx)(Persona.a,{imageUrl:avatar,text:callerName,size:Persona_types.c.size40,hidePersonaDetails:!0,"aria-label":callerName})}),Object(jsx_runtime.jsxs)(Stack.a,{grow:1,horizontalAlign:"center",style:{alignItems:"flex-start",fontFamily:"Segoe UI"},children:[Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.875rem"},children:Object(jsx_runtime.jsx)("b",{children:null!=callerName?callerName:"No display name"})}),Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.75rem"},children:Object(jsx_runtime.jsx)("span",{children:null!=alertText?alertText:"Incoming call"})})]}),Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:{childrenGap:10},children:[Object(jsx_runtime.jsx)(DefaultButton.a,{className:incomingCallRejectButtonStyle,onClick:function onClick(){return onClickReject()},onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(CallEnd20Filled.a,{})}}),Object(jsx_runtime.jsx)(DefaultButton.a,{className:incomingCallAcceptButtonStyle,onClick:function onClick(){return onClickAccept()},onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Call20Filled.a,{})}})]})]})};IncomingCallAlerts_IncomingCallToast.displayName="IncomingCallToast";var IncomingCallAlerts_IncomingCallModal=function IncomingCallModal(props){var alertText=props.alertText,avatar=props.avatar,callerName=props.callerName,callerNameAlt=props.callerNameAlt,callerTitle=props.callerTitle,localParticipantDisplayName=props.localParticipantDisplayName,localVideoInverted=props.localVideoInverted,onClickAccept=props.onClickAccept,onClickReject=props.onClickReject,onClickVideoToggle=props.onClickVideoToggle,localVideoStreamElement=props.localVideoStreamElement,palette=Object(theming.e)().palette,_useBoolean2=_slicedToArray(Object(useBoolean.a)(!1),2),hideDialog=_useBoolean2[0],toggleHideDialog=_useBoolean2[1].toggle,dialogContentProps={type:DialogContent_types.a.normal,title:null!=alertText?alertText:"Incoming Video Call"},showLocalVideo=!!localVideoStreamElement,mediaGalleryLocalParticipant=Object(jsx_runtime.jsx)(src.K,{renderElement:Object(jsx_runtime.jsx)(src.H,{videoStreamElement:localVideoStreamElement}),displayName:localParticipantDisplayName,isMirrored:localVideoInverted});return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(jsx_runtime.jsxs)(Dialog.a,{hidden:hideDialog,onDismiss:toggleHideDialog,dialogContentProps:dialogContentProps,modalProps:{isBlocking:!0,styles:{main:incomingCallModalContainerStyle}},children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"start",style:{marginRight:"0.5rem"},children:Object(jsx_runtime.jsx)(Persona.a,{imageUrl:avatar,text:callerName,size:Persona_types.c.size40,hidePersonaDetails:!0,"aria-label":callerName})}),Object(jsx_runtime.jsxs)(Stack.a,{grow:1,horizontalAlign:"center",style:{alignItems:"flex-start"},children:[Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.875rem",color:palette.black,fontWeight:"bold"},children:Object(jsx_runtime.jsxs)("span",{children:[null!=callerName?callerName:"No display name",callerNameAlt?Object(jsx_runtime.jsxs)("span",{style:{opacity:.5,marginLeft:"0.2rem"},children:["  ",callerNameAlt]}):null]})}),Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.75rem",color:palette.neutralDark},children:Object(jsx_runtime.jsx)("span",{children:null!=callerTitle?callerTitle:""})})]})]}),showLocalVideo?Object(jsx_runtime.jsx)(Stack.a,{className:incomingCallModalLocalPreviewStyle,children:mediaGalleryLocalParticipant}):null,Object(jsx_runtime.jsxs)(DialogFooter.a,{children:[Object(jsx_runtime.jsx)(DefaultButton.a,{style:{background:palette.neutralLighterAlt,border:"none"},onClick:function onClick(){return onClickVideoToggle()},onRenderIcon:function onRenderIcon(){return showLocalVideo?Object(jsx_runtime.jsx)(Video20Filled.a,{primaryFill:"currentColor"}):Object(jsx_runtime.jsx)(VideoOff20Filled.a,{primaryFill:"currentColor"})}}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickAccept()},text:"Accept",style:{background:palette.green,border:"none"}}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickReject()},text:"Decline",style:{background:palette.redDark,border:"none"}})]})]})})};IncomingCallAlerts_IncomingCallToast.__docgenInfo={description:"",methods:[],displayName:"IncomingCallToast",props:{callerName:{required:!1,tsType:{name:"string"},description:"Caller's Name"},alertText:{required:!1,tsType:{name:"string"},description:'Alert Text. For example "incoming video call..."'},avatar:{required:!1,tsType:{name:"string"},description:"Caller's Avatar/Profile Image"},onClickAccept:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Accept Button is clicked"},onClickReject:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Reject Button is clicked"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/IncomingCallAlerts/components/IncomingCallAlerts.tsx"]={name:"IncomingCallToast",docgenInfo:IncomingCallAlerts_IncomingCallToast.__docgenInfo,path:"stories/Examples/IncomingCallAlerts/components/IncomingCallAlerts.tsx"}),IncomingCallAlerts_IncomingCallModal.__docgenInfo={description:"",methods:[],displayName:"IncomingCallModal",props:{callerName:{required:!1,tsType:{name:"string"},description:"Caller's Name"},alertText:{required:!1,tsType:{name:"string"},description:'Alert Text. For example "incoming video call..."'},avatar:{required:!1,tsType:{name:"string"},description:"Caller's Avatar/Profile Image"},onClickAccept:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Accept Button is clicked"},onClickReject:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Reject Button is clicked"},callerNameAlt:{required:!1,tsType:{name:"string"},description:"Text to the right of a Caller's Name"},callerTitle:{required:!1,tsType:{name:"string"},description:"A Caller's subtitle. Displayed right below the callers name"},localParticipantDisplayName:{required:!1,tsType:{name:"string"},description:"Receiver's Name"},localVideoInverted:{required:!1,tsType:{name:"boolean"},description:"If set to `true`, mirrors the local video preview of the receiver"},localVideoStreamElement:{required:!0,tsType:{name:"union",raw:"HTMLElement | null",elements:[{name:"HTMLElement"},{name:"null"}]},description:"Local Video Stream Element. An HTML Element containing a video stream."},onClickVideoToggle:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Video Toggle Button is clicked"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/IncomingCallAlerts/components/IncomingCallAlerts.tsx"]={name:"IncomingCallModal",docgenInfo:IncomingCallAlerts_IncomingCallModal.__docgenInfo,path:"stories/Examples/IncomingCallAlerts/components/IncomingCallAlerts.tsx"})},359:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createAzureCommunicationCallAdapter})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createAzureCommunicationCallAdapterFromClient}));__webpack_require__(7),__webpack_require__(97),__webpack_require__(122),__webpack_require__(23),__webpack_require__(147),__webpack_require__(12),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(47),__webpack_require__(39),__webpack_require__(114),__webpack_require__(34),__webpack_require__(125),__webpack_require__(70),__webpack_require__(15),__webpack_require__(28),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(40),__webpack_require__(123),__webpack_require__(98);var src=__webpack_require__(88),sdk_bundle=(__webpack_require__(265),__webpack_require__(189),__webpack_require__(95));function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var ProxyDeviceManager=function(){function ProxyDeviceManager(deviceManager,context){var _this=this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyDeviceManager),this._deviceManager=void 0,this._context=void 0,this.setDeviceManager=function(){_this._context.setDeviceManagerIsSpeakerSelectionAvailable(_this._deviceManager.isSpeakerSelectionAvailable),_this._context.setDeviceManagerSelectedMicrophone(_this._deviceManager.selectedMicrophone),_this._context.setDeviceManagerSelectedSpeaker(_this._deviceManager.selectedSpeaker)},this.subscribe=function(){_this._deviceManager.on("videoDevicesUpdated",_this.videoDevicesUpdated),_this._deviceManager.on("audioDevicesUpdated",_this.audioDevicesUpdated),_this._deviceManager.on("selectedMicrophoneChanged",_this.selectedMicrophoneChanged),_this._deviceManager.on("selectedSpeakerChanged",_this.selectedSpeakerChanged)},this.unsubscribe=function(){_this._deviceManager.off("videoDevicesUpdated",_this.videoDevicesUpdated),_this._deviceManager.off("audioDevicesUpdated",_this.audioDevicesUpdated),_this._deviceManager.off("selectedMicrophoneChanged",_this.selectedMicrophoneChanged),_this._deviceManager.off("selectedSpeakerChanged",_this.selectedSpeakerChanged)},this.selectCamera=function(videoDeviceInfo){_this._context.setDeviceManagerSelectedCamera(videoDeviceInfo)},this.videoDevicesUpdated=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=_this._context,_context.t1=dedupeById,_context.next=4,_this._deviceManager.getCameras();case 4:_context.t2=_context.sent,_context.t3=(0,_context.t1)(_context.t2),_context.t0.setDeviceManagerCameras.call(_context.t0,_context.t3);case 7:case"end":return _context.stop()}}),_callee)}))),this.audioDevicesUpdated=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.t0=_this._context,_context2.t1=dedupeById,_context2.next=4,_this._deviceManager.getMicrophones();case 4:return _context2.t2=_context2.sent,_context2.t3=(0,_context2.t1)(_context2.t2),_context2.t0.setDeviceManagerMicrophones.call(_context2.t0,_context2.t3),_context2.t4=_this._context,_context2.t5=dedupeById,_context2.next=11,_this._deviceManager.getSpeakers();case 11:_context2.t6=_context2.sent,_context2.t7=(0,_context2.t5)(_context2.t6),_context2.t4.setDeviceManagerSpeakers.call(_context2.t4,_context2.t7);case 14:case"end":return _context2.stop()}}),_callee2)}))),this.selectedMicrophoneChanged=function(){_this._context.setDeviceManagerSelectedMicrophone(_this._deviceManager.selectedMicrophone)},this.selectedSpeakerChanged=function(){_this._context.setDeviceManagerSelectedSpeaker(_this._deviceManager.selectedSpeaker)},this._deviceManager=deviceManager,this._context=context,this.setDeviceManager(),this.subscribe()}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(ProxyDeviceManager,[{key:"get",value:function get(target,prop){var _this2=this;switch(prop){case"getCameras":return this._context.withAsyncErrorTeedToState((function(){return target.getCameras().then((function(cameras){return _this2._context.setDeviceManagerCameras(dedupeById(cameras)),cameras}))}),"DeviceManager.getCameras");case"getMicrophones":return this._context.withAsyncErrorTeedToState((function(){return target.getMicrophones().then((function(microphones){return _this2._context.setDeviceManagerMicrophones(dedupeById(microphones)),microphones}))}),"DeviceManager.getMicrophones");case"getSpeakers":return this._context.withAsyncErrorTeedToState((function(){return target.getSpeakers().then((function(speakers){return _this2._context.setDeviceManagerSpeakers(dedupeById(speakers)),speakers}))}),"DeviceManager.getSpeakers");case"selectMicrophone":return this._context.withAsyncErrorTeedToState((function(){return target.selectMicrophone.apply(target,arguments).then((function(){_this2._context.setDeviceManagerSelectedMicrophone(target.selectedMicrophone)}))}),"DeviceManager.selectMicrophone");case"selectSpeaker":return this._context.withAsyncErrorTeedToState((function(){return target.selectSpeaker.apply(target,arguments).then((function(){_this2._context.setDeviceManagerSelectedSpeaker(target.selectedSpeaker)}))}),"DeviceManager.selectSpeaker");case"askDevicePermission":return this._context.withAsyncErrorTeedToState((function(){return target.askDevicePermission.apply(target,arguments).then((function(deviceAccess){return _this2._context.setDeviceManagerDeviceAccess(deviceAccess),_this2.setDeviceManager(),deviceAccess}))}),"DeviceManager.askDevicePermission");default:return Reflect.get(target,prop)}}}]),ProxyDeviceManager}(),dedupeById=function dedupeById(devices){var ids=new Set,uniqueDevices=[];return devices.forEach((function(device){ids.has(device.id)||(uniqueDevices.push(device),ids.add(device.id))})),uniqueDevices},deviceManagerDeclaratify=function deviceManagerDeclaratify(deviceManager,context){var proxyDeviceManager=new ProxyDeviceManager(deviceManager,context);return Object.defineProperty(deviceManager,"unsubscribe",{configurable:!1,value:function value(){return proxyDeviceManager.unsubscribe()}}),Object.defineProperty(deviceManager,"selectCamera",{configurable:!1,value:function value(videoDeviceInfo){return proxyDeviceManager.selectCamera(videoDeviceInfo)}}),new Proxy(deviceManager,proxyDeviceManager)},dist_esm_src=(__webpack_require__(36),__webpack_require__(355),__webpack_require__(566),__webpack_require__(296),__webpack_require__(168),__webpack_require__(151)),events=__webpack_require__(133),events_default=__webpack_require__.n(events),immer_esm=__webpack_require__(165),acs_ui_common_src=__webpack_require__(32);__webpack_require__(266),__webpack_require__(573),__webpack_require__(138),__webpack_require__(74),__webpack_require__(149),__webpack_require__(572);function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)})(Class)}function _construct(Parent,args,Class){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var CallError=function(_Error){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(subClass,"prototype",{value:Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(CallError,_Error);var _super=function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}(CallError);function CallError(target,innerError,timestamp){var _this;return function CallClientState_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CallError),(_this=_super.call(this)).target=void 0,_this.innerError=void 0,_this.timestamp=void 0,_this.target=target,_this.innerError=innerError,_this.timestamp=null!=timestamp?timestamp:new Date(Date.now()),_this.name="CallError",_this.message=_this.target+": "+_this.innerError.message,_this}return CallError}(_wrapNativeSuper(Error));function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallContext_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CallContext_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CallContext_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CallContext_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CallContext_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function CallContext_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}Object(immer_esm.b)(),Object(immer_esm.c)();var CallContext_CallContext=function(){function CallContext(userId){var maxListeners=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;CallContext_classCallCheck(this,CallContext),this._logger=void 0,this._state=void 0,this._emitter=void 0,this._atomicId=void 0,this._batchMode=void 0,this._logger=Object(dist_esm_src.createClientLogger)("communication-react:calling-context"),this._state={calls:{},callsEnded:{},incomingCalls:{},incomingCallsEnded:{},deviceManager:{isSpeakerSelectionAvailable:!1,cameras:[],microphones:[],speakers:[],unparentedViews:[]},callAgent:void 0,userId:userId,latestErrors:{}},this._emitter=new events_default.a,this._emitter.setMaxListeners(maxListeners),this._batchMode=!1,this._atomicId=0}return function CallContext_createClass(Constructor,protoProps,staticProps){return protoProps&&CallContext_defineProperties(Constructor.prototype,protoProps),staticProps&&CallContext_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(CallContext,[{key:"getState",value:function getState(){return this._state}},{key:"modifyState",value:function modifyState(modifier){var _this=this;this._state=Object(immer_esm.d)(this._state,modifier,(function(patches){"verbose"===Object(dist_esm_src.getLogLevel)()&&_this._logger.info("State change: "+Object(acs_ui_common_src.d)(patches))})),this._batchMode||this._emitter.emit("stateChanged",this._state)}},{key:"onStateChange",value:function onStateChange(handler){this._emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this._emitter.off("stateChanged",handler)}},{key:"clearCallRelatedState",value:function clearCallRelatedState(){this.modifyState((function(draft){draft.calls={},draft.incomingCalls={},draft.callsEnded={},draft.incomingCallsEnded={}}))}},{key:"setCallAgent",value:function setCallAgent(callAgent){this.modifyState((function(draft){draft.callAgent=callAgent}))}},{key:"setCall",value:function setCall(call){this.modifyState((function(draft){var existingCall=draft.calls[call.id];existingCall?(existingCall.callerInfo=call.callerInfo,existingCall.state=call.state,existingCall.callEndReason=call.callEndReason,existingCall.direction=call.direction,existingCall.isMuted=call.isMuted,existingCall.isScreenSharingOn=call.isScreenSharingOn,existingCall.localVideoStreams=call.localVideoStreams,existingCall.remoteParticipants=call.remoteParticipants,existingCall.transcription.isTranscriptionActive=call.transcription.isTranscriptionActive,existingCall.recording.isRecordingActive=call.recording.isRecordingActive):draft.calls[call.id]=call}))}},{key:"removeCall",value:function removeCall(callId){this.modifyState((function(draft){delete draft.calls[callId]}))}},{key:"setCallEnded",value:function setCallEnded(callId,callEndReason){this.modifyState((function(draft){var call=draft.calls[callId];if(call){for(call.endTime=new Date,call.callEndReason=callEndReason,delete draft.calls[callId];Object.keys(draft.callsEnded).length>=10;)delete draft.callsEnded[findOldestCallEnded(draft.callsEnded)];draft.callsEnded[callId]=call}}))}},{key:"setCallState",value:function setCallState(callId,state){this.modifyState((function(draft){var call=draft.calls[callId];call&&(call.state=state)}))}},{key:"setCallId",value:function setCallId(newCallId,oldCallId){this.modifyState((function(draft){var call=draft.calls[oldCallId];call&&(delete draft.calls[oldCallId],draft.calls[newCallId]=call)}))}},{key:"setCallIsScreenSharingOn",value:function setCallIsScreenSharingOn(callId,isScreenSharingOn){this.modifyState((function(draft){var call=draft.calls[callId];call&&(call.isScreenSharingOn=isScreenSharingOn)}))}},{key:"setCallRemoteParticipants",value:function setCallRemoteParticipants(callId,addRemoteParticipant,removeRemoteParticipant){this.modifyState((function(draft){var call=draft.calls[callId];call&&(removeRemoteParticipant.forEach((function(id){delete call.remoteParticipants[id]})),addRemoteParticipant.forEach((function(participant){call.remoteParticipants[Object(acs_ui_common_src.g)(participant.identifier)]=participant})))}))}},{key:"setCallRemoteParticipantsEnded",value:function setCallRemoteParticipantsEnded(callId,addRemoteParticipant,removeRemoteParticipant){this.modifyState((function(draft){var call=draft.calls[callId];call&&(removeRemoteParticipant.forEach((function(id){delete call.remoteParticipantsEnded[id]})),addRemoteParticipant.forEach((function(participant){call.remoteParticipantsEnded[Object(acs_ui_common_src.g)(participant.identifier)]=participant})))}))}},{key:"setCallLocalVideoStream",value:function setCallLocalVideoStream(callId,streams){this.modifyState((function(draft){var call=draft.calls[callId];call&&(call.localVideoStreams=streams)}))}},{key:"setCallIsMicrophoneMuted",value:function setCallIsMicrophoneMuted(callId,isMicrophoneMuted){this.modifyState((function(draft){var call=draft.calls[callId];call&&(call.isMuted=isMicrophoneMuted)}))}},{key:"setCallDominantSpeakers",value:function setCallDominantSpeakers(callId,dominantSpeakers){this.modifyState((function(draft){var call=draft.calls[callId];call&&(call.dominantSpeakers=dominantSpeakers)}))}},{key:"setCallRecordingActive",value:function setCallRecordingActive(callId,isRecordingActive){this.modifyState((function(draft){var call=draft.calls[callId];call&&(call.recording.isRecordingActive=isRecordingActive)}))}},{key:"setCallTranscriptionActive",value:function setCallTranscriptionActive(callId,isTranscriptionActive){this.modifyState((function(draft){var call=draft.calls[callId];call&&(call.transcription.isTranscriptionActive=isTranscriptionActive)}))}},{key:"setCallScreenShareParticipant",value:function setCallScreenShareParticipant(callId,participantKey){this.modifyState((function(draft){var call=draft.calls[callId];call&&(call.screenShareRemoteParticipant=participantKey)}))}},{key:"setLocalVideoStreamRendererView",value:function setLocalVideoStreamRendererView(callId,view){this.modifyState((function(draft){var call=draft.calls[callId];call&&call.localVideoStreams.length>0&&(call.localVideoStreams[0].view=view)}))}},{key:"setParticipantState",value:function setParticipantState(callId,participantKey,state){this.modifyState((function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];participant&&(participant.state=state)}}))}},{key:"setParticipantIsMuted",value:function setParticipantIsMuted(callId,participantKey,muted){this.modifyState((function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];participant&&(participant.isMuted=muted)}}))}},{key:"setParticipantDisplayName",value:function setParticipantDisplayName(callId,participantKey,displayName){this.modifyState((function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];participant&&(participant.displayName=displayName)}}))}},{key:"setParticipantIsSpeaking",value:function setParticipantIsSpeaking(callId,participantKey,isSpeaking){this.modifyState((function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];participant&&(participant.isSpeaking=isSpeaking)}}))}},{key:"setParticipantVideoStream",value:function setParticipantVideoStream(callId,participantKey,stream){this.modifyState((function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];if(participant){var existingStream=participant.videoStreams[stream.id];existingStream?(existingStream.isAvailable=stream.isAvailable,existingStream.mediaStreamType=stream.mediaStreamType):participant.videoStreams[stream.id]=stream}}}))}},{key:"setRemoteVideoStreamIsAvailable",value:function setRemoteVideoStreamIsAvailable(callId,participantKey,streamId,isAvailable){this.modifyState((function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];if(participant){var stream=participant.videoStreams[streamId];stream&&(stream.isAvailable=isAvailable)}}}))}},{key:"setRemoteVideoStreams",value:function setRemoteVideoStreams(callId,participantKey,addRemoteVideoStream,removeRemoteVideoStream){this.modifyState((function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];if(participant){var _step,_iterator=_createForOfIteratorHelper(removeRemoteVideoStream);try{for(_iterator.s();!(_step=_iterator.n()).done;){var id=_step.value;delete participant.videoStreams[id]}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=_createForOfIteratorHelper(addRemoteVideoStream);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var newStream=_step2.value,stream=participant.videoStreams[newStream.id];stream?(stream.mediaStreamType=newStream.mediaStreamType,stream.isAvailable=newStream.isAvailable):participant.videoStreams[newStream.id]=newStream}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}}))}},{key:"setRemoteVideoStreamRendererView",value:function setRemoteVideoStreamRendererView(callId,participantKey,streamId,view){this.modifyState((function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];if(participant){var stream=participant.videoStreams[streamId];stream&&(stream.view=view)}}}))}},{key:"setIncomingCall",value:function setIncomingCall(call){this.modifyState((function(draft){var existingCall=draft.incomingCalls[call.id];existingCall?existingCall.callerInfo=call.callerInfo:draft.incomingCalls[call.id]=call}))}},{key:"removeIncomingCall",value:function removeIncomingCall(callId){this.modifyState((function(draft){delete draft.incomingCalls[callId]}))}},{key:"setIncomingCallEnded",value:function setIncomingCallEnded(callId,callEndReason){this.modifyState((function(draft){var call=draft.incomingCalls[callId];if(call){for(call.endTime=new Date,call.callEndReason=callEndReason,delete draft.incomingCalls[callId];Object.keys(draft.incomingCallsEnded).length>=10;)delete draft.incomingCallsEnded[findOldestCallEnded(draft.incomingCallsEnded)];draft.incomingCallsEnded[callId]=call}}))}},{key:"setDeviceManagerIsSpeakerSelectionAvailable",value:function setDeviceManagerIsSpeakerSelectionAvailable(isSpeakerSelectionAvailable){this.modifyState((function(draft){draft.deviceManager.isSpeakerSelectionAvailable=isSpeakerSelectionAvailable}))}},{key:"setDeviceManagerSelectedMicrophone",value:function setDeviceManagerSelectedMicrophone(selectedMicrophone){this.modifyState((function(draft){draft.deviceManager.selectedMicrophone=selectedMicrophone}))}},{key:"setDeviceManagerSelectedSpeaker",value:function setDeviceManagerSelectedSpeaker(selectedSpeaker){this.modifyState((function(draft){draft.deviceManager.selectedSpeaker=selectedSpeaker}))}},{key:"setDeviceManagerSelectedCamera",value:function setDeviceManagerSelectedCamera(selectedCamera){this.modifyState((function(draft){draft.deviceManager.selectedCamera=selectedCamera}))}},{key:"setDeviceManagerCameras",value:function setDeviceManagerCameras(cameras){this.modifyState((function(draft){cameras.length>0&&!cameras.some((function(camera){var _draft$deviceManager$;return camera.id===(null===(_draft$deviceManager$=draft.deviceManager.selectedCamera)||void 0===_draft$deviceManager$?void 0:_draft$deviceManager$.id)}))&&(draft.deviceManager.selectedCamera=cameras[0]),draft.deviceManager.cameras=cameras}))}},{key:"setDeviceManagerMicrophones",value:function setDeviceManagerMicrophones(microphones){this.modifyState((function(draft){draft.deviceManager.microphones=microphones}))}},{key:"setDeviceManagerSpeakers",value:function setDeviceManagerSpeakers(speakers){this.modifyState((function(draft){draft.deviceManager.speakers=speakers}))}},{key:"setDeviceManagerDeviceAccess",value:function setDeviceManagerDeviceAccess(deviceAccess){this.modifyState((function(draft){draft.deviceManager.deviceAccess=deviceAccess}))}},{key:"setDeviceManagerUnparentedView",value:function setDeviceManagerUnparentedView(localVideoStream,view){this.modifyState((function(draft){draft.deviceManager.unparentedViews.push({source:localVideoStream.source,mediaStreamType:localVideoStream.mediaStreamType,view:view})}))}},{key:"deleteDeviceManagerUnparentedView",value:function deleteDeviceManagerUnparentedView(localVideoStream){this.modifyState((function(draft){var foundIndex=draft.deviceManager.unparentedViews.findIndex((function(stream){return stream.source.id===localVideoStream.source.id&&stream.mediaStreamType===localVideoStream.mediaStreamType}));-1!==foundIndex&&draft.deviceManager.unparentedViews.splice(foundIndex,1)}))}},{key:"getAndIncrementAtomicId",value:function getAndIncrementAtomicId(){var id=this._atomicId;return this._atomicId++,id}},{key:"withAsyncErrorTeedToState",value:function withAsyncErrorTeedToState(action,target){var _this2=this;return CallContext_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var callError,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,action.apply(void 0,_args);case 3:return _context.abrupt("return",_context.sent);case 6:throw _context.prev=6,_context.t0=_context.catch(0),callError=CallContext_toCallError(target,_context.t0),_this2.setLatestError(target,callError),callError;case 11:case"end":return _context.stop()}}),_callee,null,[[0,6]])})))}},{key:"withErrorTeedToState",value:function withErrorTeedToState(action,target){var _this3=this;return function(){try{return action.apply(void 0,arguments)}catch(error){var callError=CallContext_toCallError(target,error);throw _this3.setLatestError(target,callError),callError}}}},{key:"setLatestError",value:function setLatestError(target,error){this.modifyState((function(draft){draft.latestErrors[target]=error}))}}]),CallContext}(),CallContext_toCallError=function toCallError(target,error){return error instanceof Error?new CallError(target,error):new CallError(target,new Error(error))},findOldestCallEnded=function findOldestCallEnded(calls){var callEntries=Object.entries(calls),_callEntries$=_slicedToArray(callEntries[0],2),oldestCallId=_callEntries$[0],oldestCall=_callEntries$[1];if(void 0===oldestCall.endTime)return oldestCallId;var _step3,_iterator3=_createForOfIteratorHelper(callEntries.slice(1));try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _call$endTime$getTime,_call$endTime,_oldestCall$endTime$g,_oldestCall$endTime,_ref3=_slicedToArray(_step3.value,2),callId=_ref3[0],call=_ref3[1];if(void 0===call.endTime)return callId;(null!==(_call$endTime$getTime=null===(_call$endTime=call.endTime)||void 0===_call$endTime?void 0:_call$endTime.getTime())&&void 0!==_call$endTime$getTime?_call$endTime$getTime:0)<(null!==(_oldestCall$endTime$g=null===(_oldestCall$endTime=oldestCall.endTime)||void 0===_oldestCall$endTime?void 0:_oldestCall$endTime.getTime())&&void 0!==_oldestCall$endTime$g?_oldestCall$endTime$g:0)&&(oldestCallId=callId,oldestCall=call)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return oldestCallId};function CallDeclarative_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CallDeclarative_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CallDeclarative_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CallDeclarative_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function CallDeclarative_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var ProxyCall=function(){function ProxyCall(context){!function CallDeclarative_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyCall),this._context=void 0,this._context=context}return function CallDeclarative_createClass(Constructor,protoProps,staticProps){return protoProps&&CallDeclarative_defineProperties(Constructor.prototype,protoProps),staticProps&&CallDeclarative_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(ProxyCall,[{key:"unsubscribe",value:function unsubscribe(){}},{key:"get",value:function get(target,prop){switch(prop){case"mute":return this._context.withAsyncErrorTeedToState(CallDeclarative_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,target.mute.apply(target,_args);case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee)}))),"Call.mute");case"unmute":return this._context.withAsyncErrorTeedToState(CallDeclarative_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _args2=arguments;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,target.unmute.apply(target,_args2);case 2:return _context2.abrupt("return",_context2.sent);case 3:case"end":return _context2.stop()}}),_callee2)}))),"Call.unmute");case"startVideo":return this._context.withAsyncErrorTeedToState(CallDeclarative_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,target.startVideo.apply(target,_args3);case 2:return _context3.abrupt("return",_context3.sent);case 3:case"end":return _context3.stop()}}),_callee3)}))),"Call.startVideo");case"stopVideo":return this._context.withAsyncErrorTeedToState(CallDeclarative_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _args4=arguments;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,target.stopVideo.apply(target,_args4);case 2:return _context4.abrupt("return",_context4.sent);case 3:case"end":return _context4.stop()}}),_callee4)}))),"Call.stopVideo");case"startScreenSharing":return this._context.withAsyncErrorTeedToState(CallDeclarative_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var _args5=arguments;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,target.startScreenSharing.apply(target,_args5);case 2:return _context5.abrupt("return",_context5.sent);case 3:case"end":return _context5.stop()}}),_callee5)}))),"Call.startScreenSharing");case"stopScreenSharing":return this._context.withAsyncErrorTeedToState(CallDeclarative_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){var _args6=arguments;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,target.stopScreenSharing.apply(target,_args6);case 2:return _context6.abrupt("return",_context6.sent);case 3:case"end":return _context6.stop()}}),_callee6)}))),"Call.stopScreenSharing");default:return Reflect.get(target,prop)}}}]),ProxyCall}(),callDeclaratify=function callDeclaratify(call,context){var proxyCall=new ProxyCall(context);return Object.defineProperty(call,"unsubscribe",{configurable:!1,value:function value(){return proxyCall.unsubscribe()}}),new Proxy(call,proxyCall)};__webpack_require__(45);function Converter_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function Converter_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Converter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Converter_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Converter_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function convertSdkLocalStreamToDeclarativeLocalStream(stream){return{source:stream.source,mediaStreamType:stream.mediaStreamType,view:void 0}}function convertSdkRemoteStreamToDeclarativeRemoteStream(stream){return{id:stream.id,mediaStreamType:stream.mediaStreamType,isAvailable:stream.isAvailable,view:void 0}}function convertSdkParticipantToDeclarativeParticipant(participant){var _step,declarativeVideoStreams={},_iterator=Converter_createForOfIteratorHelper(participant.videoStreams);try{for(_iterator.s();!(_step=_iterator.n()).done;){var videoStream=_step.value;declarativeVideoStreams[videoStream.id]=convertSdkRemoteStreamToDeclarativeRemoteStream(videoStream)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return{identifier:participant.identifier,displayName:participant.displayName,state:participant.state,callEndReason:participant.callEndReason,videoStreams:declarativeVideoStreams,isMuted:participant.isMuted,isSpeaking:participant.isSpeaking}}function convertFromSDKToDeclarativeVideoStreamRendererView(view){return{scalingMode:view.scalingMode,isMirrored:view.isMirrored,target:view.target}}var RemoteVideoStreamSubscriber=function RemoteVideoStreamSubscriber(callIdRef,participantKey,remoteVideoStream,context){var _this=this;!function RemoteVideoStreamSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RemoteVideoStreamSubscriber),this._callIdRef=void 0,this._participantKey=void 0,this._remoteVideoStream=void 0,this._context=void 0,this.subscribe=function(){_this._remoteVideoStream.on("isAvailableChanged",_this.isAvailableChanged),_this.checkAndUpdateScreenShareState()},this.unsubscribe=function(){_this._remoteVideoStream.off("isAvailableChanged",_this.isAvailableChanged)},this.includesActiveScreenShareStream=function(streams){for(var _i=0,_Object$values=Object.values(streams);_i<_Object$values.length;_i++){var stream=_Object$values[_i];if("ScreenSharing"===stream.mediaStreamType&&stream.isAvailable)return!0}return!1},this.checkAndUpdateScreenShareState=function(){var _this$_context$getSta,_this$_context$getSta2,_this$_context$getSta3;if("ScreenSharing"===_this._remoteVideoStream.mediaStreamType)if(_this._remoteVideoStream.isAvailable)_this._context.setCallScreenShareParticipant(_this._callIdRef.callId,_this._participantKey);else{var existingScreenShare=null===(_this$_context$getSta=_this._context.getState().calls[_this._callIdRef.callId])||void 0===_this$_context$getSta?void 0:_this$_context$getSta.screenShareRemoteParticipant;if(existingScreenShare&&existingScreenShare!==_this._participantKey){var streams=null===(_this$_context$getSta2=_this._context.getState().calls[_this._callIdRef.callId])||void 0===_this$_context$getSta2||null===(_this$_context$getSta3=_this$_context$getSta2.remoteParticipants[existingScreenShare])||void 0===_this$_context$getSta3?void 0:_this$_context$getSta3.videoStreams;streams&&_this.includesActiveScreenShareStream(streams)||_this._context.setCallScreenShareParticipant(_this._callIdRef.callId,void 0)}else _this._context.setCallScreenShareParticipant(_this._callIdRef.callId,void 0)}},this.isAvailableChanged=function(){_this._context.setRemoteVideoStreamIsAvailable(_this._callIdRef.callId,_this._participantKey,_this._remoteVideoStream.id,_this._remoteVideoStream.isAvailable),_this.checkAndUpdateScreenShareState()},this._callIdRef=callIdRef,this._participantKey=participantKey,this._remoteVideoStream=remoteVideoStream,this._context=context,this.subscribe()};function StreamUtils_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=StreamUtils_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function StreamUtils_slicedToArray(arr,i){return function StreamUtils_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function StreamUtils_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||StreamUtils_unsupportedIterableToArray(arr,i)||function StreamUtils_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function StreamUtils_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return StreamUtils_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?StreamUtils_arrayLikeToArray(o,minLen):void 0}}function StreamUtils_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function StreamUtils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StreamUtils_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StreamUtils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StreamUtils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _createViewRemoteVideo(){return(_createViewRemoteVideo=StreamUtils_asyncToGenerator(regeneratorRuntime.mark((function _callee(context,internalContext,callId,participantId,stream,options){var streamId,participantKey,renderInfo,renderer,view,refreshedRenderInfo;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(streamId=stream.id,participantKey="string"==typeof participantId?participantId:Object(acs_ui_common_src.g)(participantId),renderInfo=internalContext.getRemoteRenderInfoForParticipant(callId,participantKey,streamId)){_context.next=6;break}return console.warn("RemoteVideoStream not found in state"),_context.abrupt("return");case 6:if("Rendered"!==renderInfo.status){_context.next=9;break}return console.warn("RemoteVideoStream is already rendered"),_context.abrupt("return");case 9:if("Rendering"!==renderInfo.status){_context.next=11;break}return _context.abrupt("return");case 11:if("Stopping"!==renderInfo.status){_context.next=14;break}return console.warn("RemoteVideoStream is in the middle of stopping"),_context.abrupt("return");case 14:return renderer=new sdk_bundle.VideoStreamRenderer(renderInfo.stream),internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"Rendering",void 0),_context.prev=16,_context.next=19,renderer.createView(options);case 19:view=_context.sent,_context.next=26;break;case 22:throw _context.prev=22,_context.t0=_context.catch(16),internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"NotRendered",void 0),_context.t0;case 26:if(refreshedRenderInfo=internalContext.getRemoteRenderInfoForParticipant(callId,participantKey,streamId)){_context.next=31;break}return renderer.dispose(),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,void 0),_context.abrupt("return");case 31:if("Stopping"!==refreshedRenderInfo.status){_context.next=36;break}return renderer.dispose(),internalContext.setRemoteRenderInfo(callId,participantKey,streamId,refreshedRenderInfo.stream,"NotRendered",void 0),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,void 0),_context.abrupt("return");case 36:internalContext.setRemoteRenderInfo(callId,participantKey,streamId,refreshedRenderInfo.stream,"Rendered",renderer),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,convertFromSDKToDeclarativeVideoStreamRendererView(view));case 38:case"end":return _context.stop()}}),_callee,null,[[16,22]])})))).apply(this,arguments)}function _createViewLocalVideo(){return(_createViewLocalVideo=StreamUtils_asyncToGenerator(regeneratorRuntime.mark((function _callee2(context,internalContext,callId,options){var renderInfo,renderer,view,refreshedRenderInfo;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(renderInfo=internalContext.getLocalRenderInfo(callId)){_context2.next=4;break}return console.warn("LocalVideoStream not found in state"),_context2.abrupt("return");case 4:if("Rendered"!==renderInfo.status){_context2.next=7;break}return console.warn("LocalVideoStream is already rendered"),_context2.abrupt("return");case 7:if("Rendering"!==renderInfo.status){_context2.next=9;break}return _context2.abrupt("return");case 9:if("Stopping"!==renderInfo.status){_context2.next=12;break}return console.warn("LocalVideoStream is in the middle of stopping"),_context2.abrupt("return");case 12:return renderer=new sdk_bundle.VideoStreamRenderer(renderInfo.stream),internalContext.setLocalRenderInfo(callId,renderInfo.stream,"Rendering",renderer),_context2.prev=14,_context2.next=17,renderer.createView(options);case 17:view=_context2.sent,_context2.next=24;break;case 20:throw _context2.prev=20,_context2.t0=_context2.catch(14),internalContext.setLocalRenderInfo(callId,renderInfo.stream,"NotRendered",void 0),_context2.t0;case 24:if(refreshedRenderInfo=internalContext.getLocalRenderInfo(callId)){_context2.next=29;break}return renderer.dispose(),context.setLocalVideoStreamRendererView(callId,void 0),_context2.abrupt("return");case 29:if("Stopping"!==refreshedRenderInfo.status){_context2.next=34;break}return renderer.dispose(),internalContext.setLocalRenderInfo(callId,refreshedRenderInfo.stream,"NotRendered",void 0),context.setLocalVideoStreamRendererView(callId,void 0),_context2.abrupt("return");case 34:internalContext.setLocalRenderInfo(callId,refreshedRenderInfo.stream,"Rendered",renderer),context.setLocalVideoStreamRendererView(callId,convertFromSDKToDeclarativeVideoStreamRendererView(view));case 36:case"end":return _context2.stop()}}),_callee2,null,[[14,20]])})))).apply(this,arguments)}function _createViewUnparentedVideo(){return(_createViewUnparentedVideo=StreamUtils_asyncToGenerator(regeneratorRuntime.mark((function _callee3(context,internalContext,stream,options){var renderInfo,localVideoStream,renderer,view,refreshedRenderInfo;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!(renderInfo=internalContext.getUnparentedRenderInfo(stream))||"Rendered"!==renderInfo.status){_context3.next=4;break}return console.warn("Unparented LocalVideoStream is already rendered"),_context3.abrupt("return");case 4:if(!renderInfo||"Rendering"!==renderInfo.status){_context3.next=6;break}return _context3.abrupt("return");case 6:if(!renderInfo||"Stopping"!==renderInfo.status){_context3.next=9;break}return console.warn("Unparented LocalVideoStream is in the middle of stopping"),_context3.abrupt("return");case 9:return localVideoStream=new sdk_bundle.LocalVideoStream(stream.source),renderer=new sdk_bundle.VideoStreamRenderer(localVideoStream),internalContext.setUnparentedRenderInfo(stream,localVideoStream,"Rendering",void 0),_context3.prev=12,_context3.next=15,renderer.createView(options);case 15:view=_context3.sent,_context3.next=22;break;case 18:throw _context3.prev=18,_context3.t0=_context3.catch(12),internalContext.deleteUnparentedRenderInfo(stream),_context3.t0;case 22:if(refreshedRenderInfo=internalContext.getUnparentedRenderInfo(stream)){_context3.next=27;break}return renderer.dispose(),context.deleteDeviceManagerUnparentedView(stream),_context3.abrupt("return");case 27:if("Stopping"!==refreshedRenderInfo.status){_context3.next=31;break}return internalContext.deleteUnparentedRenderInfo(stream),context.deleteDeviceManagerUnparentedView(stream),_context3.abrupt("return");case 31:internalContext.setUnparentedRenderInfo(stream,localVideoStream,"Rendered",renderer),context.setDeviceManagerUnparentedView(stream,convertFromSDKToDeclarativeVideoStreamRendererView(view));case 33:case"end":return _context3.stop()}}),_callee3,null,[[12,18]])})))).apply(this,arguments)}function createView(context,internalContext,callId,participantId,stream,options){return"id"in stream&&callId&&participantId?function createViewRemoteVideo(_x,_x2,_x3,_x4,_x5,_x6){return _createViewRemoteVideo.apply(this,arguments)}(context,internalContext,callId,participantId,stream,options):!("id"in stream)&&callId?function createViewLocalVideo(_x7,_x8,_x9,_x10){return _createViewLocalVideo.apply(this,arguments)}(context,internalContext,callId,options):"id"in stream||callId?(console.warn("Invalid combination of parameters"),Promise.resolve()):function createViewUnparentedVideo(_x11,_x12,_x13,_x14){return _createViewUnparentedVideo.apply(this,arguments)}(context,internalContext,stream,options)}function disposeView(context,internalContext,callId,participantId,stream){if("id"in stream&&callId&&participantId)!function disposeViewRemoteVideo(context,internalContext,callId,participantId,stream){var participantKey,streamId=stream.id;participantKey="string"==typeof participantId?participantId:Object(acs_ui_common_src.g)(participantId),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,void 0);var renderInfo=internalContext.getRemoteRenderInfoForParticipant(callId,participantKey,streamId);renderInfo&&("Rendering"===renderInfo.status?internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"Stopping",void 0):internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"NotRendered",void 0),renderInfo.renderer&&renderInfo.renderer.dispose())}(context,internalContext,callId,participantId,stream);else if(!("id"in stream)&&callId)!function disposeViewLocalVideo(context,internalContext,callId){context.setLocalVideoStreamRendererView(callId,void 0);var renderInfo=internalContext.getLocalRenderInfo(callId);renderInfo&&("Rendering"===renderInfo.status?internalContext.setLocalRenderInfo(callId,renderInfo.stream,"Stopping",void 0):internalContext.setLocalRenderInfo(callId,renderInfo.stream,"NotRendered",void 0),renderInfo.renderer&&renderInfo.renderer.dispose())}(context,internalContext,callId);else{if("id"in stream||callId)return void console.warn("Invalid combination of parameters");!function disposeViewUnparentedVideo(context,internalContext,stream){context.deleteDeviceManagerUnparentedView(stream);var renderInfo=internalContext.getUnparentedRenderInfo(stream);renderInfo&&("Rendering"===renderInfo.status?internalContext.setUnparentedRenderInfo(stream,renderInfo.stream,"Stopping",void 0):internalContext.deleteUnparentedRenderInfo(stream),renderInfo.renderer&&renderInfo.renderer.dispose())}(context,internalContext,stream)}}function disposeAllViewsFromCall(context,internalContext,callId){var callStreams=internalContext.getRemoteRenderInfoForCall(callId);if(callStreams){var _step,_iterator=StreamUtils_createForOfIteratorHelper(callStreams.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,_ref2=StreamUtils_slicedToArray(_step.value,2),participantKey=_ref2[0],_iterator2=StreamUtils_createForOfIteratorHelper(_ref2[1].entries());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _ref4=StreamUtils_slicedToArray(_step2.value,2);_ref4[0];disposeView(context,internalContext,callId,participantKey,convertSdkRemoteStreamToDeclarativeRemoteStream(_ref4[1].stream))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}var localStreamAndRenderer=internalContext.getLocalRenderInfo(callId);localStreamAndRenderer&&localStreamAndRenderer.renderer&&disposeView(context,internalContext,callId,void 0,convertSdkLocalStreamToDeclarativeLocalStream(localStreamAndRenderer.stream))}function ParticipantSubscriber_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function ParticipantSubscriber_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantSubscriber_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantSubscriber_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function ParticipantSubscriber_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ParticipantSubscriber_ParticipantSubscriber=function ParticipantSubscriber(callIdRef,participant,context,internalContext){var _this=this;!function ParticipantSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ParticipantSubscriber),this._callIdRef=void 0,this._participant=void 0,this._context=void 0,this._internalContext=void 0,this._participantKey=void 0,this._remoteVideoStreamSubscribers=void 0,this.subscribe=function(){if(_this._participant.on("stateChanged",_this.stateChanged),_this._participant.on("isMutedChanged",_this.isMutedChanged),_this._participant.on("displayNameChanged",_this.displayNameChanged),_this._participant.on("isSpeakingChanged",_this.isSpeakingChanged),_this._participant.on("videoStreamsUpdated",_this.videoStreamsUpdated),_this._participant.videoStreams.length>0){var _step,_iterator=ParticipantSubscriber_createForOfIteratorHelper(_this._participant.videoStreams);try{for(_iterator.s();!(_step=_iterator.n()).done;){var stream=_step.value;_this._internalContext.setRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,stream.id,stream,"NotRendered",void 0),_this.addRemoteVideoStreamSubscriber(stream)}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this._context.setRemoteVideoStreams(_this._callIdRef.callId,_this._participantKey,_this._participant.videoStreams.map(convertSdkRemoteStreamToDeclarativeRemoteStream),[])}},this.unsubscribe=function(){if(_this._participant.off("stateChanged",_this.stateChanged),_this._participant.off("isMutedChanged",_this.isMutedChanged),_this._participant.off("displayNameChanged",_this.displayNameChanged),_this._participant.off("isSpeakingChanged",_this.isSpeakingChanged),_this._participant.off("videoStreamsUpdated",_this.videoStreamsUpdated),_this._participant.videoStreams.length>0){var _step2,_iterator2=ParticipantSubscriber_createForOfIteratorHelper(_this._participant.videoStreams);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var stream=_step2.value;disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,_this._participantKey,convertSdkRemoteStreamToDeclarativeRemoteStream(stream)),_this._internalContext.deleteRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,stream.id)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}},this.addRemoteVideoStreamSubscriber=function(remoteVideoStream){var _this$_remoteVideoStr;null===(_this$_remoteVideoStr=_this._remoteVideoStreamSubscribers.get(remoteVideoStream.id))||void 0===_this$_remoteVideoStr||_this$_remoteVideoStr.unsubscribe(),_this._remoteVideoStreamSubscribers.set(remoteVideoStream.id,new RemoteVideoStreamSubscriber(_this._callIdRef,_this._participantKey,remoteVideoStream,_this._context))},this.stateChanged=function(){_this._context.setParticipantState(_this._callIdRef.callId,_this._participantKey,_this._participant.state)},this.isMutedChanged=function(){_this._context.setParticipantIsMuted(_this._callIdRef.callId,_this._participantKey,_this._participant.isMuted)},this.displayNameChanged=function(){_this._context.setParticipantDisplayName(_this._callIdRef.callId,_this._participantKey,_this._participant.displayName||"")},this.isSpeakingChanged=function(){_this._context.setParticipantIsSpeaking(_this._callIdRef.callId,_this._participantKey,_this._participant.isSpeaking)},this.videoStreamsUpdated=function(event){var _step3,_iterator3=ParticipantSubscriber_createForOfIteratorHelper(event.removed);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _this$_remoteVideoStr2,stream=_step3.value;null===(_this$_remoteVideoStr2=_this._remoteVideoStreamSubscribers.get(stream.id))||void 0===_this$_remoteVideoStr2||_this$_remoteVideoStr2.unsubscribe(),disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,_this._participantKey,convertSdkRemoteStreamToDeclarativeRemoteStream(stream)),_this._internalContext.deleteRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,stream.id)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}var _step4,_iterator4=ParticipantSubscriber_createForOfIteratorHelper(event.added);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _stream=_step4.value;_this._internalContext.setRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,_stream.id,_stream,"NotRendered",void 0),_this.addRemoteVideoStreamSubscriber(_stream)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}_this._context.setRemoteVideoStreams(_this._callIdRef.callId,_this._participantKey,event.added.map(convertSdkRemoteStreamToDeclarativeRemoteStream),event.removed.map((function(stream){return stream.id})))},this._callIdRef=callIdRef,this._participant=participant,this._context=context,this._internalContext=internalContext,this._participantKey=Object(acs_ui_common_src.g)(this._participant.identifier),this._remoteVideoStreamSubscribers=new Map,this.subscribe()};var RecordingSubscriber=function RecordingSubscriber(callIdRef,context,recording){var _this=this;!function RecordingSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RecordingSubscriber),this._callIdRef=void 0,this._context=void 0,this._recording=void 0,this.subscribe=function(){_this._recording.on("isRecordingActiveChanged",_this.isAvailableChanged)},this.unsubscribe=function(){_this._recording.off("isRecordingActiveChanged",_this.isAvailableChanged)},this.isAvailableChanged=function(){_this._context.setCallRecordingActive(_this._callIdRef.callId,_this._recording.isRecordingActive)},this._callIdRef=callIdRef,this._context=context,this._recording=recording,this._recording.isRecordingActive&&this._context.setCallRecordingActive(this._callIdRef.callId,this._recording.isRecordingActive),this.subscribe()};var TranscriptionSubscriber=function TranscriptionSubscriber(callIdRef,context,transcription){var _this=this;!function TranscriptionSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TranscriptionSubscriber),this._callIdRef=void 0,this._context=void 0,this._transcription=void 0,this.subscribe=function(){_this._transcription.on("isTranscriptionActiveChanged",_this.isTranscriptionActiveChanged)},this.unsubscribe=function(){_this._transcription.off("isTranscriptionActiveChanged",_this.isTranscriptionActiveChanged)},this.isTranscriptionActiveChanged=function(){_this._context.setCallTranscriptionActive(_this._callIdRef.callId,_this._transcription.isTranscriptionActive)},this._callIdRef=callIdRef,this._context=context,this._transcription=transcription,this._transcription.isTranscriptionActive&&this._context.setCallTranscriptionActive(this._callIdRef.callId,this._transcription.isTranscriptionActive),this.subscribe()};function UserFacingDiagnosticsSubscriber_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var UserFacingDiagnosticsSubscriber=function(){function UserFacingDiagnosticsSubscriber(callIdRef,context,diagnostics){var _this=this;!function UserFacingDiagnosticsSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UserFacingDiagnosticsSubscriber),this._callIdRef=void 0,this._context=void 0,this._diagnostics=void 0,this.unsubscribe=function(){_this._diagnostics.network.off("diagnosticChanged",_this.networkDiagnosticsChanged.bind(_this)),_this._diagnostics.media.off("diagnosticChanged",_this.mediaDiagnosticsChanged.bind(_this))},this._callIdRef=callIdRef,this._context=context,this._diagnostics=diagnostics,this.setInitialDiagnostics(),this.subscribe()}return function UserFacingDiagnosticsSubscriber_createClass(Constructor,protoProps,staticProps){return protoProps&&UserFacingDiagnosticsSubscriber_defineProperties(Constructor.prototype,protoProps),staticProps&&UserFacingDiagnosticsSubscriber_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(UserFacingDiagnosticsSubscriber,[{key:"setInitialDiagnostics",value:function setInitialDiagnostics(){var _this2=this,network=this._diagnostics.network.getLatest(),media=this._diagnostics.media.getLatest();0===Object.entries(network).length&&0===Object.entries(media).length||this._context.modifyState((function(state){var call=state.calls[_this2._callIdRef.callId];void 0!==call&&(call.diagnostics={network:{latest:network},media:{latest:media}})}))}},{key:"subscribe",value:function subscribe(){this._diagnostics.network.on("diagnosticChanged",this.networkDiagnosticsChanged.bind(this)),this._diagnostics.media.on("diagnosticChanged",this.mediaDiagnosticsChanged.bind(this))}},{key:"networkDiagnosticsChanged",value:function networkDiagnosticsChanged(args){var _this3=this;this._context.modifyState((function(state){var _call$diagnostics,call=state.calls[_this3._callIdRef.callId];if(void 0!==call){var network=null===(_call$diagnostics=call.diagnostics)||void 0===_call$diagnostics?void 0:_call$diagnostics.network.latest;network&&(network[args.diagnostic]=latestFromEvent(args))}}))}},{key:"mediaDiagnosticsChanged",value:function mediaDiagnosticsChanged(args){var _this4=this;this._context.modifyState((function(state){var _call$diagnostics2,call=state.calls[_this4._callIdRef.callId];if(void 0!==call){var media=null===(_call$diagnostics2=call.diagnostics)||void 0===_call$diagnostics2?void 0:_call$diagnostics2.media.latest;media&&(media[args.diagnostic]=latestFromEvent(args))}}))}}]),UserFacingDiagnosticsSubscriber}(),latestFromEvent=function latestFromEvent(args){return{value:args.value,valueType:args.valueType}};function CallSubscriber_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CallSubscriber_CallSubscriber=function(){function CallSubscriber(call,context,internalContext){var _this=this;!function CallSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CallSubscriber),this._call=void 0,this._callIdRef=void 0,this._context=void 0,this._internalContext=void 0,this._diagnosticsSubscriber=void 0,this._participantSubscribers=void 0,this._recordingSubscriber=void 0,this._transcriptionSubscriber=void 0,this.subscribe=function(){_this._call.on("stateChanged",_this.stateChanged),_this._call.on("idChanged",_this.idChanged),_this._call.on("isScreenSharingOnChanged",_this.isScreenSharingOnChanged),_this._call.on("remoteParticipantsUpdated",_this.remoteParticipantsUpdated),_this._call.on("localVideoStreamsUpdated",_this.localVideoStreamsUpdated),_this._call.on("isMutedChanged",_this.isMuteChanged),_this._call.feature(sdk_bundle.Features.DominantSpeakers).on("dominantSpeakersChanged",_this.dominantSpeakersChanged),_this._call.localVideoStreams.length>0&&_this._internalContext.setLocalRenderInfo(_this._callIdRef.callId,_this._call.localVideoStreams[0],"NotRendered",void 0),_this._call.remoteParticipants.length>0&&(_this._call.remoteParticipants.forEach((function(participant){_this.addParticipantListener(participant)})),_this._context.setCallRemoteParticipants(_this._callIdRef.callId,_this._call.remoteParticipants.map(convertSdkParticipantToDeclarativeParticipant),[]))},this.unsubscribe=function(){_this._call.off("stateChanged",_this.stateChanged),_this._call.off("idChanged",_this.idChanged),_this._call.off("isScreenSharingOnChanged",_this.isScreenSharingOnChanged),_this._call.off("remoteParticipantsUpdated",_this.remoteParticipantsUpdated),_this._call.off("localVideoStreamsUpdated",_this.localVideoStreamsUpdated),_this._call.off("isMutedChanged",_this.isMuteChanged),_this._participantSubscribers.forEach((function(participantSubscriber){participantSubscriber.unsubscribe()})),_this._participantSubscribers.clear(),_this._call.localVideoStreams&&_this._call.localVideoStreams[0]&&disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,void 0,convertSdkLocalStreamToDeclarativeLocalStream(_this._call.localVideoStreams[0])),_this._internalContext.deleteLocalRenderInfo(_this._callIdRef.callId),_this._diagnosticsSubscriber.unsubscribe(),_this._recordingSubscriber.unsubscribe(),_this._transcriptionSubscriber.unsubscribe()},this.stateChanged=function(){_this._context.setCallState(_this._callIdRef.callId,_this._call.state)},this.idChanged=function(){_this._internalContext.setCallId(_this._call.id,_this._callIdRef.callId),_this._context.setCallId(_this._call.id,_this._callIdRef.callId),_this._callIdRef.callId=_this._call.id},this.isScreenSharingOnChanged=function(){_this._context.setCallIsScreenSharingOn(_this._callIdRef.callId,_this._call.isScreenSharingOn)},this.isMuteChanged=function(){_this._context.setCallIsMicrophoneMuted(_this._callIdRef.callId,_this._call.isMuted)},this.remoteParticipantsUpdated=function(event){event.added.forEach((function(participant){_this.addParticipantListener(participant)})),event.removed.forEach((function(participant){_this.removeParticipantListener(participant)})),_this._context.setCallRemoteParticipantsEnded(_this._callIdRef.callId,event.removed.map(convertSdkParticipantToDeclarativeParticipant),event.added.map((function(participant){return Object(acs_ui_common_src.g)(participant.identifier)}))),_this._context.setCallRemoteParticipants(_this._callIdRef.callId,event.added.map(convertSdkParticipantToDeclarativeParticipant),event.removed.map((function(participant){return Object(acs_ui_common_src.g)(participant.identifier)})))},this.localVideoStreamsUpdated=function(event){if(event.added.length>0){var localVideoStreams=[convertSdkLocalStreamToDeclarativeLocalStream(_this._call.localVideoStreams[0])];_this._internalContext.setLocalRenderInfo(_this._callIdRef.callId,_this._call.localVideoStreams[0],"NotRendered",void 0),_this._context.setCallLocalVideoStream(_this._callIdRef.callId,[].concat(localVideoStreams))}event.removed.length>0&&(disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,void 0,convertSdkLocalStreamToDeclarativeLocalStream(event.removed[0])),_this._internalContext.deleteLocalRenderInfo(_this._callIdRef.callId),_this._context.setCallLocalVideoStream(_this._callIdRef.callId,[]))},this.dominantSpeakersChanged=function(){var dominantSpeakers=_this._call.feature(sdk_bundle.Features.DominantSpeakers).dominantSpeakers;_this._context.setCallDominantSpeakers(_this._callIdRef.callId,dominantSpeakers)},this._call=call,this._callIdRef={callId:call.id},this._context=context,this._internalContext=internalContext,this._diagnosticsSubscriber=new UserFacingDiagnosticsSubscriber(this._callIdRef,this._context,this._call.feature(sdk_bundle.Features.UserFacingDiagnostics)),this._participantSubscribers=new Map,this._recordingSubscriber=new RecordingSubscriber(this._callIdRef,this._context,this._call.feature(sdk_bundle.Features.Recording)),this._transcriptionSubscriber=new TranscriptionSubscriber(this._callIdRef,this._context,this._call.feature(sdk_bundle.Features.Transcription)),this.subscribe()}return function CallSubscriber_createClass(Constructor,protoProps,staticProps){return protoProps&&CallSubscriber_defineProperties(Constructor.prototype,protoProps),staticProps&&CallSubscriber_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(CallSubscriber,[{key:"addParticipantListener",value:function addParticipantListener(participant){var _this$_participantSub,participantKey=Object(acs_ui_common_src.g)(participant.identifier);null===(_this$_participantSub=this._participantSubscribers.get(participantKey))||void 0===_this$_participantSub||_this$_participantSub.unsubscribe(),this._participantSubscribers.set(participantKey,new ParticipantSubscriber_ParticipantSubscriber(this._callIdRef,participant,this._context,this._internalContext))}},{key:"removeParticipantListener",value:function removeParticipantListener(participant){var participantKey=Object(acs_ui_common_src.g)(participant.identifier),participantSubscriber=this._participantSubscribers.get(participantKey);participantSubscriber&&(participantSubscriber.unsubscribe(),this._participantSubscribers.delete(participantKey))}}]),CallSubscriber}();var IncomingCallSubscriber=function IncomingCallSubscriber(incomingCall,setIncomingCallEnded){var _this=this;!function IncomingCallSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,IncomingCallSubscriber),this._incomingCall=void 0,this._setIncomingCallEnded=void 0,this.subscribe=function(){_this._incomingCall.on("callEnded",_this.callEnded)},this.unsubscribe=function(){_this._incomingCall.off("callEnded",_this.callEnded)},this.callEnded=function(event){_this._setIncomingCallEnded(_this._incomingCall.id,event.callEndReason)},this._incomingCall=incomingCall,this._setIncomingCallEnded=setIncomingCallEnded,this.subscribe()};function CallAgentDeclarative_slicedToArray(arr,i){return function CallAgentDeclarative_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallAgentDeclarative_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||CallAgentDeclarative_unsupportedIterableToArray(arr,i)||function CallAgentDeclarative_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallAgentDeclarative_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=CallAgentDeclarative_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function CallAgentDeclarative_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return CallAgentDeclarative_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?CallAgentDeclarative_arrayLikeToArray(o,minLen):void 0}}function CallAgentDeclarative_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CallAgentDeclarative_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CallAgentDeclarative_ProxyCallAgent=function(){function ProxyCallAgent(callAgent,context,internalContext){var _this=this;!function CallAgentDeclarative_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyCallAgent),this._callAgent=void 0,this._context=void 0,this._internalContext=void 0,this._callSubscribers=void 0,this._incomingCallSubscribers=void 0,this._declarativeCalls=void 0,this._externalCallsUpdatedListeners=void 0,this.subscribe=function(){_this._callAgent.on("callsUpdated",_this.callsUpdated),_this._callAgent.on("incomingCall",_this.incomingCall);var _step,_iterator=CallAgentDeclarative_createForOfIteratorHelper(_this._callAgent.calls);try{for(_iterator.s();!(_step=_iterator.n()).done;){var call=_step.value;_this.addCall(call)}}catch(err){_iterator.e(err)}finally{_iterator.f()}},this.unsubscribe=function(){_this._callAgent.off("callsUpdated",_this.callsUpdated),_this._callAgent.off("incomingCall",_this.incomingCall);var _step2,_iterator2=CallAgentDeclarative_createForOfIteratorHelper(_this._callSubscribers.entries());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _ref2=CallAgentDeclarative_slicedToArray(_step2.value,2);_ref2[0];_ref2[1].unsubscribe()}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}_this._callSubscribers.clear();var _step3,_iterator3=CallAgentDeclarative_createForOfIteratorHelper(_this._incomingCallSubscribers.entries());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _ref4=CallAgentDeclarative_slicedToArray(_step3.value,2);_ref4[0];_ref4[1].unsubscribe()}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}_this._incomingCallSubscribers.clear();var _step4,_iterator4=CallAgentDeclarative_createForOfIteratorHelper(_this._declarativeCalls.entries());try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _ref6=CallAgentDeclarative_slicedToArray(_step4.value,2);_ref6[0];_ref6[1].unsubscribe()}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}_this._declarativeCalls.clear()},this.callsUpdated=function(event){var _step5,addedStatefulCall=[],_iterator5=CallAgentDeclarative_createForOfIteratorHelper(event.added);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var call=_step5.value,statefulCall=_this.addCall(call);addedStatefulCall.push(statefulCall)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}var _step6,removedStatefulCall=[],_iterator6=CallAgentDeclarative_createForOfIteratorHelper(event.removed);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _call=_step6.value;disposeAllViewsFromCall(_this._context,_this._internalContext,_call.id);var callSubscriber=_this._callSubscribers.get(_call);callSubscriber&&(callSubscriber.unsubscribe(),_this._callSubscribers.delete(_call)),_this._context.setCallEnded(_call.id,_call.callEndReason);var declarativeCall=_this._declarativeCalls.get(_call);declarativeCall?(declarativeCall.unsubscribe(),removedStatefulCall.push(declarativeCall),_this._declarativeCalls.delete(_call)):removedStatefulCall.push(callDeclaratify(_call,_this._context))}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}var _step7,_iterator7=CallAgentDeclarative_createForOfIteratorHelper(_this._externalCallsUpdatedListeners);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){(0,_step7.value)({added:addedStatefulCall,removed:removedStatefulCall})}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}},this.setIncomingCallEnded=function(incomingCallId,callEndReason){var incomingCallSubscriber=_this._incomingCallSubscribers.get(incomingCallId);incomingCallSubscriber&&(incomingCallSubscriber.unsubscribe(),_this._incomingCallSubscribers.delete(incomingCallId)),_this._context.setIncomingCallEnded(incomingCallId,callEndReason)},this.incomingCall=function(event){_this._incomingCallSubscribers.has(event.incomingCall.id)||_this._incomingCallSubscribers.set(event.incomingCall.id,new IncomingCallSubscriber(event.incomingCall,_this.setIncomingCallEnded)),_this._context.setIncomingCall(function convertSdkIncomingCallToDeclarativeIncomingCall(call){return{id:call.id,callerInfo:call.callerInfo,startTime:new Date,endTime:void 0}}(event.incomingCall))},this.addCall=function(call){var _this$_callSubscriber;return null===(_this$_callSubscriber=_this._callSubscribers.get(call))||void 0===_this$_callSubscriber||_this$_callSubscriber.unsubscribe(),_this._context.setCall(function convertSdkCallToDeclarativeCall(call){var declarativeRemoteParticipants={};return call.remoteParticipants.forEach((function(participant){declarativeRemoteParticipants[Object(acs_ui_common_src.g)(participant.identifier)]=convertSdkParticipantToDeclarativeParticipant(participant)})),{id:call.id,callerInfo:call.callerInfo,state:call.state,callEndReason:call.callEndReason,diagnostics:{network:{latest:{}},media:{latest:{}}},direction:call.direction,isMuted:call.isMuted,isScreenSharingOn:call.isScreenSharingOn,localVideoStreams:call.localVideoStreams.map(convertSdkLocalStreamToDeclarativeLocalStream),remoteParticipants:declarativeRemoteParticipants,remoteParticipantsEnded:{},recording:{isRecordingActive:!1},transcription:{isTranscriptionActive:!1},screenShareRemoteParticipant:void 0,startTime:new Date,endTime:void 0}}(call)),_this._callSubscribers.set(call,new CallSubscriber_CallSubscriber(call,_this._context,_this._internalContext)),_this.getOrCreateDeclarativeCall(call)},this.getOrCreateDeclarativeCall=function(call){var declarativeCall=_this._declarativeCalls.get(call);if(declarativeCall)return declarativeCall;var newDeclarativeCall=callDeclaratify(call,_this._context);return _this._declarativeCalls.set(call,newDeclarativeCall),newDeclarativeCall},this._callAgent=callAgent,this._context=context,this._internalContext=internalContext,this._callSubscribers=new Map,this._incomingCallSubscribers=new Map,this._declarativeCalls=new Map,this._externalCallsUpdatedListeners=new Set,this.subscribe()}return function CallAgentDeclarative_createClass(Constructor,protoProps,staticProps){return protoProps&&CallAgentDeclarative_defineProperties(Constructor.prototype,protoProps),staticProps&&CallAgentDeclarative_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(ProxyCallAgent,[{key:"get",value:function get(target,prop){var _this2=this;switch(prop){case"startCall":return this._context.withErrorTeedToState((function(){var call=target.startCall.apply(target,arguments);return _this2.addCall(call),_this2.getOrCreateDeclarativeCall(call)}),"CallAgent.startCall");case"join":return this._context.withErrorTeedToState((function(){var call=target.join.apply(target,arguments);return _this2.addCall(call),_this2.getOrCreateDeclarativeCall(call)}),"CallAgent.join");case"calls":return Array.from(this._declarativeCalls.values());case"on":return function(){var isCallsUpdated="callsUpdated"===(arguments.length<=0?void 0:arguments[0]);if(isCallsUpdated){var listener=arguments.length<=1?void 0:arguments[1];_this2._externalCallsUpdatedListeners.add(listener)}else target.on.apply(target,arguments)};case"off":return function(){var isCallsUpdated="callsUpdated"===(arguments.length<=0?void 0:arguments[0]);if(isCallsUpdated){var listener=arguments.length<=1?void 0:arguments[1];_this2._externalCallsUpdatedListeners.delete(listener)}else target.off.apply(target,arguments)};case"dispose":return function(){return target.dispose().then((function(){_this2.unsubscribe()}))};default:return Reflect.get(target,prop)}}}]),ProxyCallAgent}(),CallAgentDeclarative_callAgentDeclaratify=function callAgentDeclaratify(callAgent,context,internalContext){return function disposeAllViews(context,internalContext){var _step3,_iterator3=StreamUtils_createForOfIteratorHelper(internalContext.getRemoteRenderInfos().entries());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;)disposeAllViewsFromCall(context,internalContext,StreamUtils_slicedToArray(_step3.value,1)[0])}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}(context,internalContext),context.clearCallRelatedState(),internalContext.clearCallRelatedState(),new Proxy(callAgent,new CallAgentDeclarative_ProxyCallAgent(callAgent,context,internalContext))};function InternalCallContext_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var InternalCallContext=function(){function InternalCallContext(){!function InternalCallContext_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,InternalCallContext),this._remoteRenderInfos=new Map,this._localRenderInfos=new Map,this._unparentedRenderInfos=new Map}return function InternalCallContext_createClass(Constructor,protoProps,staticProps){return protoProps&&InternalCallContext_defineProperties(Constructor.prototype,protoProps),staticProps&&InternalCallContext_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(InternalCallContext,[{key:"setCallId",value:function setCallId(newCallId,oldCallId){var remoteRenderInfos=this._remoteRenderInfos.get(oldCallId);remoteRenderInfos&&(this._remoteRenderInfos.delete(oldCallId),this._remoteRenderInfos.set(newCallId,remoteRenderInfos));var localRenderInfos=this._localRenderInfos.get(oldCallId);localRenderInfos&&(this._localRenderInfos.delete(oldCallId),this._localRenderInfos.set(newCallId,localRenderInfos))}},{key:"getRemoteRenderInfos",value:function getRemoteRenderInfos(){return this._remoteRenderInfos}},{key:"getRemoteRenderInfoForCall",value:function getRemoteRenderInfoForCall(callId){return this._remoteRenderInfos.get(callId)}},{key:"getRemoteRenderInfoForParticipant",value:function getRemoteRenderInfoForParticipant(callId,participantKey,streamId){var callRenderInfos=this._remoteRenderInfos.get(callId);if(callRenderInfos){var participantRenderInfos=callRenderInfos.get(participantKey);if(participantRenderInfos)return participantRenderInfos.get(streamId)}}},{key:"setRemoteRenderInfo",value:function setRemoteRenderInfo(callId,participantKey,streamId,stream,status,renderer){var callRenderInfos=this._remoteRenderInfos.get(callId);callRenderInfos||(callRenderInfos=new Map,this._remoteRenderInfos.set(callId,callRenderInfos));var participantRenderInfos=callRenderInfos.get(participantKey);participantRenderInfos||(participantRenderInfos=new Map,callRenderInfos.set(participantKey,participantRenderInfos)),participantRenderInfos.set(streamId,{stream:stream,status:status,renderer:renderer})}},{key:"deleteRemoteRenderInfo",value:function deleteRemoteRenderInfo(callId,participantKey,streamId){var callRenderInfos=this._remoteRenderInfos.get(callId);if(callRenderInfos){var participantRenderInfos=callRenderInfos.get(participantKey);participantRenderInfos&&participantRenderInfos.delete(streamId)}}},{key:"setLocalRenderInfo",value:function setLocalRenderInfo(callId,stream,status,renderer){this._localRenderInfos.set(callId,{stream:stream,status:status,renderer:renderer})}},{key:"getLocalRenderInfo",value:function getLocalRenderInfo(callId){return this._localRenderInfos.get(callId)}},{key:"deleteLocalRenderInfo",value:function deleteLocalRenderInfo(callId){this._localRenderInfos.delete(callId)}},{key:"getUnparentedRenderInfo",value:function getUnparentedRenderInfo(localVideoStream){return this._unparentedRenderInfos.get(localVideoStream.source.id)}},{key:"setUnparentedRenderInfo",value:function setUnparentedRenderInfo(statefulStream,stream,status,renderer){this._unparentedRenderInfos.set(statefulStream.source.id,{stream:stream,status:status,renderer:renderer})}},{key:"deleteUnparentedRenderInfo",value:function deleteUnparentedRenderInfo(localVideoStream){this._unparentedRenderInfos.delete(localVideoStream.source.id)}},{key:"clearCallRelatedState",value:function clearCallRelatedState(){this._remoteRenderInfos.clear(),this._localRenderInfos.clear()}}]),InternalCallContext}(),identifierModels=__webpack_require__(437);function StatefulCallClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StatefulCallClient_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StatefulCallClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StatefulCallClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function StatefulCallClient_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var StatefulCallClient_ProxyCallClient=function(){function ProxyCallClient(context,internalContext){!function StatefulCallClient_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyCallClient),this._context=void 0,this._internalContext=void 0,this._callAgent=void 0,this._deviceManager=void 0,this._sdkDeviceManager=void 0,this._context=context,this._internalContext=internalContext}return function StatefulCallClient_createClass(Constructor,protoProps,staticProps){return protoProps&&StatefulCallClient_defineProperties(Constructor.prototype,protoProps),staticProps&&StatefulCallClient_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(ProxyCallClient,[{key:"get",value:function get(target,prop){var _this=this;switch(prop){case"createCallAgent":return this._context.withAsyncErrorTeedToState(StatefulCallClient_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var callAgent,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,target.createCallAgent.apply(target,_args);case 2:return callAgent=_context.sent,_this._callAgent=CallAgentDeclarative_callAgentDeclaratify(callAgent,_this._context,_this._internalContext),_this._context.setCallAgent({displayName:_this._callAgent.displayName}),_context.abrupt("return",_this._callAgent);case 6:case"end":return _context.stop()}}),_callee)}))),"CallClient.createCallAgent");case"getDeviceManager":return this._context.withAsyncErrorTeedToState(StatefulCallClient_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var deviceManager;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,target.getDeviceManager();case 2:if(deviceManager=_context2.sent,!_this._sdkDeviceManager){_context2.next=11;break}if(_this._sdkDeviceManager!==deviceManager){_context2.next=8;break}return _context2.abrupt("return",_this._deviceManager);case 8:throw new Error("Multiple DeviceManager not supported. This means a incompatible version of communication-calling is used OR calling declarative was not properly updated to communication-calling version.");case 9:_context2.next=12;break;case 11:_this._sdkDeviceManager=deviceManager;case 12:return _this._deviceManager=deviceManagerDeclaratify(deviceManager,_this._context),_context2.abrupt("return",_this._deviceManager);case 14:case"end":return _context2.stop()}}),_callee2)}))),"CallClient.getDeviceManager");default:return Reflect.get(target,prop)}}}]),ProxyCallClient}(),StatefulCallClient_createStatefulCallClient=function createStatefulCallClient(args,options){return StatefulCallClient_createStatefulCallClientWithDeps(new sdk_bundle.CallClient(StatefulCallClient_withTelemetryTag(null==options?void 0:options.callClientOptions)),new CallContext_CallContext(Object(identifierModels.a)(args.userId),null==options?void 0:options.maxStateChangeListeners),new InternalCallContext)},StatefulCallClient_createStatefulCallClientWithDeps=function createStatefulCallClientWithDeps(callClient,context,internalContext){return Object.defineProperty(callClient,"getState",{configurable:!1,value:function value(){return context.getState()}}),Object.defineProperty(callClient,"onStateChange",{configurable:!1,value:function value(handler){return context.onStateChange(handler)}}),Object.defineProperty(callClient,"offStateChange",{configurable:!1,value:function value(handler){return context.offStateChange(handler)}}),Object.defineProperty(callClient,"createView",{configurable:!1,value:function value(callId,participantId,stream,options){var participantIdKind=participantId?Object(identifierModels.a)(participantId):void 0;return createView(context,internalContext,callId,participantIdKind,stream,options)}}),Object.defineProperty(callClient,"disposeView",{configurable:!1,value:function value(callId,participantId,stream){var participantIdKind=participantId?Object(identifierModels.a)(participantId):void 0;disposeView(context,internalContext,callId,participantIdKind,stream)}}),new Proxy(callClient,new StatefulCallClient_ProxyCallClient(context,internalContext))},StatefulCallClient_withTelemetryTag=function withTelemetryTag(options){var _options$diagnostics$,_options$diagnostics,tags=null!==(_options$diagnostics$=null==options||null===(_options$diagnostics=options.diagnostics)||void 0===_options$diagnostics?void 0:_options$diagnostics.tags)&&void 0!==_options$diagnostics$?_options$diagnostics$:[];return tags.push(Object(acs_ui_common_src.c)()),Object.assign({},options,{diagnostics:Object.assign({},null==options?void 0:options.diagnostics,{tags:tags})})},utils=__webpack_require__(179);function ParticipantSubcriber_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var ParticipantSubcriber_ParticipantSubscriber=function(){function ParticipantSubscriber(participant,emitter){var _this=this;!function ParticipantSubcriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ParticipantSubscriber),this.participant=void 0,this.emitter=void 0,this.isMutedChangedHandler=function(){_this.emitter.emit("isMutedChanged",{participantId:_this.participant.identifier,isMuted:_this.participant.isMuted})},this.displayNameChangedHandler=function(){_this.emitter.emit("displayNameChanged",{participantId:_this.participant.identifier,displayName:_this.participant.displayName})},this.isSpeakingChangedHandler=function(){_this.emitter.emit("isSpeakingChanged",{participantId:_this.participant.identifier,isSpeaking:_this.participant.isSpeaking})},this.videoStreamsUpdatedHandler=function(event){_this.emitter.emit("videoStreamsUpdated",event)},this.participant=participant,this.emitter=emitter,this.subscribeParticipantEvents()}return function ParticipantSubcriber_createClass(Constructor,protoProps,staticProps){return protoProps&&ParticipantSubcriber_defineProperties(Constructor.prototype,protoProps),staticProps&&ParticipantSubcriber_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(ParticipantSubscriber,[{key:"subscribeParticipantEvents",value:function subscribeParticipantEvents(){this.participant.on("isMutedChanged",this.isMutedChangedHandler),this.participant.on("displayNameChanged",this.displayNameChangedHandler),this.participant.on("isSpeakingChanged",this.isSpeakingChangedHandler),this.participant.on("videoStreamsUpdated",this.videoStreamsUpdatedHandler)}},{key:"unsubscribeAll",value:function unsubscribeAll(){this.participant.off("isMutedChanged",this.isMutedChangedHandler),this.participant.off("displayNameChanged",this.displayNameChangedHandler),this.participant.off("isSpeakingChanged",this.isSpeakingChangedHandler),this.participant.off("videoStreamsUpdated",this.videoStreamsUpdatedHandler)}}]),ParticipantSubscriber}();function DiagnosticsForwarder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var DiagnosticsForwarder_DiagnosticsForwarder=function(){function DiagnosticsForwarder(emitter,call){var _this=this;!function DiagnosticsForwarder_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DiagnosticsForwarder),this._diagnostics=void 0,this._emitter=void 0,this.unsubscribe=function(){_this._diagnostics.network.off("diagnosticChanged",_this.networkDiagnosticsChanged.bind(_this)),_this._diagnostics.media.off("diagnosticChanged",_this.mediaDiagnosticsChanged.bind(_this))},this._diagnostics=call.feature(sdk_bundle.Features.UserFacingDiagnostics),this._emitter=emitter,this.subscribe()}return function DiagnosticsForwarder_createClass(Constructor,protoProps,staticProps){return protoProps&&DiagnosticsForwarder_defineProperties(Constructor.prototype,protoProps),staticProps&&DiagnosticsForwarder_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(DiagnosticsForwarder,[{key:"subscribe",value:function subscribe(){this._diagnostics.network.on("diagnosticChanged",this.networkDiagnosticsChanged.bind(this)),this._diagnostics.media.on("diagnosticChanged",this.mediaDiagnosticsChanged.bind(this))}},{key:"networkDiagnosticsChanged",value:function networkDiagnosticsChanged(args){var event=Object.assign({type:"network"},args);this._emitter.emit("diagnosticChanged",event)}},{key:"mediaDiagnosticsChanged",value:function mediaDiagnosticsChanged(args){var event=Object.assign({type:"media"},args);this._emitter.emit("diagnosticChanged",event)}}]),DiagnosticsForwarder}();function AzureCommunicationCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function AzureCommunicationCallAdapter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){AzureCommunicationCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){AzureCommunicationCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function AzureCommunicationCallAdapter_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function AzureCommunicationCallAdapter_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return AzureCommunicationCallAdapter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AzureCommunicationCallAdapter_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){function e(_x16){return _e.apply(this,arguments)}return e.toString=function(){return _e.toString()},e}((function(e){throw e})),f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){function e(_x17){return _e2.apply(this,arguments)}return e.toString=function(){return _e2.toString()},e}((function(e){didErr=!0,err=e})),f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function AzureCommunicationCallAdapter_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AzureCommunicationCallAdapter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AzureCommunicationCallAdapter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AzureCommunicationCallAdapter_createClass(Constructor,protoProps,staticProps){return protoProps&&AzureCommunicationCallAdapter_defineProperties(Constructor.prototype,protoProps),staticProps&&AzureCommunicationCallAdapter_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}var AzureCommunicationCallAdapter_CallContext=function(){function CallContext(clientState,isTeamsCall){var _clientState$callAgen;AzureCommunicationCallAdapter_classCallCheck(this,CallContext),this.emitter=new events.EventEmitter,this.state=void 0,this.callId=void 0,this.state={isLocalPreviewMicrophoneEnabled:!1,userId:clientState.userId,displayName:null===(_clientState$callAgen=clientState.callAgent)||void 0===_clientState$callAgen?void 0:_clientState$callAgen.displayName,devices:clientState.deviceManager,call:void 0,page:"configuration",latestErrors:clientState.latestErrors,isTeamsCall:isTeamsCall}}return AzureCommunicationCallAdapter_createClass(CallContext,[{key:"onStateChange",value:function onStateChange(handler){this.emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this.emitter.off("stateChanged",handler)}},{key:"setState",value:function setState(state){this.state=state,this.emitter.emit("stateChanged",this.state)}},{key:"getState",value:function getState(){return this.state}},{key:"setIsLocalMicrophoneEnabled",value:function setIsLocalMicrophoneEnabled(isLocalPreviewMicrophoneEnabled){this.setState(Object.assign({},this.state,{isLocalPreviewMicrophoneEnabled:isLocalPreviewMicrophoneEnabled}))}},{key:"setCallId",value:function setCallId(callId){this.callId=callId}},{key:"updateClientState",value:function updateClientState(clientState){var _clientState$callAgen2,call=this.callId?clientState.calls[this.callId]:void 0,latestEndedCall=findLatestEndedCall(clientState.callsEnded);this.setState(Object.assign({},this.state,{userId:clientState.userId,displayName:null===(_clientState$callAgen2=clientState.callAgent)||void 0===_clientState$callAgen2?void 0:_clientState$callAgen2.displayName,call:call,page:Object(utils.b)(call,latestEndedCall),endedCall:latestEndedCall,devices:clientState.deviceManager,latestErrors:clientState.latestErrors}))}}]),CallContext}(),findLatestEndedCall=function findLatestEndedCall(calls){var callStates=Object.values(calls);if(0!==callStates.length){var _step,latestCall=callStates[0],_iterator=AzureCommunicationCallAdapter_createForOfIteratorHelper(callStates.slice(1));try{for(_iterator.s();!(_step=_iterator.n()).done;){var _call$endTime$getTime,_call$endTime,_latestCall$endTime$g,_latestCall$endTime,call=_step.value;(null!==(_call$endTime$getTime=null===(_call$endTime=call.endTime)||void 0===_call$endTime?void 0:_call$endTime.getTime())&&void 0!==_call$endTime$getTime?_call$endTime$getTime:0)>(null!==(_latestCall$endTime$g=null===(_latestCall$endTime=latestCall.endTime)||void 0===_latestCall$endTime?void 0:_latestCall$endTime.getTime())&&void 0!==_latestCall$endTime$g?_latestCall$endTime$g:0)&&(latestCall=call)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return latestCall}},AzureCommunicationCallAdapter_AzureCommunicationCallAdapter=function(){function AzureCommunicationCallAdapter(callClient,locator,callAgent,deviceManager){var _this=this;AzureCommunicationCallAdapter_classCallCheck(this,AzureCommunicationCallAdapter),this.callClient=void 0,this.callAgent=void 0,this.deviceManager=void 0,this.localStream=void 0,this.locator=void 0,this._call=void 0,this.context=void 0,this.diagnosticsForwarder=void 0,this.handlers=void 0,this.participantSubscribers=new Map,this.emitter=new events.EventEmitter,this.onClientStateChange=void 0,this.isMyMutedChanged=function(){var _this$call;_this.emitter.emit("isMutedChanged",{participantId:_this.getState().userId,isMuted:null===(_this$call=_this.call)||void 0===_this$call?void 0:_this$call.isMuted})},this.bindPublicMethods(),this.callClient=callClient,this.callAgent=callAgent,this.locator=locator,this.deviceManager=deviceManager;var isTeamsMeeting="meetingLink"in this.locator;this.context=new AzureCommunicationCallAdapter_CallContext(callClient.getState(),isTeamsMeeting);var onStateChange=function onStateChange(clientState){_this?_this.context.updateClientState(clientState):callClient.offStateChange(onStateChange)};this.handlers=Object(src.e)(callClient,callAgent,deviceManager,void 0),this.onClientStateChange=onStateChange,this.callClient.onStateChange(onStateChange)}var _asyncTeeErrorToEventEmitter,_removeParticipant,_stopScreenShare,_startScreenShare,_unmute,_mute,_stopCamera,_startCamera,_setSpeaker,_setMicrophone,_setCamera,_leaveCall,_disposeStreamView,_createStreamView,_askDevicePermission,_querySpeakers,_queryMicrophones,_queryCameras;return AzureCommunicationCallAdapter_createClass(AzureCommunicationCallAdapter,[{key:"call",get:function get(){return this._call},set:function set(newCall){this.resetDiagnosticsForwarder(newCall),this._call=newCall}},{key:"bindPublicMethods",value:function bindPublicMethods(){this.onStateChange.bind(this),this.offStateChange.bind(this),this.getState.bind(this),this.dispose.bind(this),this.joinCall.bind(this),this.leaveCall.bind(this),this.setCamera.bind(this),this.setMicrophone.bind(this),this.setSpeaker.bind(this),this.askDevicePermission.bind(this),this.queryCameras.bind(this),this.queryMicrophones.bind(this),this.querySpeakers.bind(this),this.startCamera.bind(this),this.stopCamera.bind(this),this.mute.bind(this),this.unmute.bind(this),this.startCall.bind(this),this.startScreenShare.bind(this),this.stopScreenShare.bind(this),this.removeParticipant.bind(this),this.createStreamView.bind(this),this.disposeStreamView.bind(this),this.on.bind(this),this.off.bind(this),this.processNewCall.bind(this)}},{key:"dispose",value:function dispose(){this.resetDiagnosticsForwarder(),this.callClient.offStateChange(this.onClientStateChange),this.callAgent.dispose()}},{key:"queryCameras",value:(_queryCameras=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _this2=this;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",_this2.deviceManager.getCameras());case 1:case"end":return _context.stop()}}),_callee)}))));case 2:return _context2.abrupt("return",_context2.sent);case 3:case"end":return _context2.stop()}}),_callee2,this)}))),function queryCameras(){return _queryCameras.apply(this,arguments)})},{key:"queryMicrophones",value:(_queryMicrophones=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _this3=this;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",_this3.deviceManager.getMicrophones());case 1:case"end":return _context3.stop()}}),_callee3)}))));case 2:return _context4.abrupt("return",_context4.sent);case 3:case"end":return _context4.stop()}}),_callee4,this)}))),function queryMicrophones(){return _queryMicrophones.apply(this,arguments)})},{key:"querySpeakers",value:(_querySpeakers=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){var _this4=this;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.abrupt("return",_this4.deviceManager.isSpeakerSelectionAvailable?_this4.deviceManager.getSpeakers():[]);case 1:case"end":return _context5.stop()}}),_callee5)}))));case 2:return _context6.abrupt("return",_context6.sent);case 3:case"end":return _context6.stop()}}),_callee6,this)}))),function querySpeakers(){return _querySpeakers.apply(this,arguments)})},{key:"askDevicePermission",value:(_askDevicePermission=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee8(constrain){var _this5=this;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,_this5.deviceManager.askDevicePermission(constrain);case 2:case"end":return _context7.stop()}}),_callee7)}))));case 2:return _context8.abrupt("return",_context8.sent);case 3:case"end":return _context8.stop()}}),_callee8,this)}))),function askDevicePermission(_x){return _askDevicePermission.apply(this,arguments)})},{key:"joinCall",value:function joinCall(microphoneOn){var _this$getState$call$s,_this$getState$call;if(Object(src.b)(null!==(_this$getState$call$s=null===(_this$getState$call=this.getState().call)||void 0===_this$getState$call?void 0:_this$getState$call.state)&&void 0!==_this$getState$call$s?_this$getState$call$s:"None"))throw new Error("You are already in the call!");if(isAdhocCall(this.locator))return this.startCall(this.locator.participantIDs);var audioOptions={muted:null!=microphoneOn?microphoneOn:!this.getState().isLocalPreviewMicrophoneEnabled},videoOptions={localVideoStreams:this.localStream?[this.localStream]:void 0},call=(this.locator,this.callAgent.join(this.locator,{audioOptions:audioOptions,videoOptions:videoOptions}));return this.processNewCall(call),call}},{key:"createStreamView",value:(_createStreamView=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee9(remoteUserId,options){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(void 0!==remoteUserId){_context9.next=5;break}return _context9.next=3,this.handlers.onCreateLocalStreamView(options);case 3:_context9.next=7;break;case 5:return _context9.next=7,this.handlers.onCreateRemoteStreamView(remoteUserId,options);case 7:case"end":return _context9.stop()}}),_callee9,this)}))),function createStreamView(_x2,_x3){return _createStreamView.apply(this,arguments)})},{key:"disposeStreamView",value:(_disposeStreamView=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee10(remoteUserId){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(void 0!==remoteUserId){_context10.next=5;break}return _context10.next=3,this.handlers.onDisposeLocalStreamView();case 3:_context10.next=7;break;case 5:return _context10.next=7,this.handlers.onDisposeRemoteStreamView(remoteUserId);case 7:case"end":return _context10.stop()}}),_callee10,this)}))),function disposeStreamView(_x4){return _disposeStreamView.apply(this,arguments)})},{key:"leaveCall",value:(_leaveCall=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){var _this$call2,callId;return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return callId=null===(_this$call2=this.call)||void 0===_this$call2?void 0:_this$call2.id,_context11.next=3,this.handlers.onHangUp();case 3:this.unsubscribeCallEvents(),this.call=void 0,this.handlers=Object(src.e)(this.callClient,this.callAgent,this.deviceManager,void 0),this.context.setCallId(void 0),this.context.updateClientState(this.callClient.getState()),this.stopCamera(),this.mute(),this.emitter.emit("callEnded",{callId:callId});case 11:case"end":return _context11.stop()}}),_callee11,this)}))),function leaveCall(){return _leaveCall.apply(this,arguments)})},{key:"setCamera",value:(_setCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee13(device,options){var _this6=this;return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return _context13.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee12(){return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return _context12.next=2,_this6.handlers.onSelectCamera(device,options);case 2:case"end":return _context12.stop()}}),_callee12)}))));case 2:return _context13.abrupt("return",_context13.sent);case 3:case"end":return _context13.stop()}}),_callee13,this)}))),function setCamera(_x5,_x6){return _setCamera.apply(this,arguments)})},{key:"setMicrophone",value:(_setMicrophone=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee15(device){var _this7=this;return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return _context15.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee14(){return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return _context14.next=2,_this7.handlers.onSelectMicrophone(device);case 2:case"end":return _context14.stop()}}),_callee14)}))));case 2:return _context15.abrupt("return",_context15.sent);case 3:case"end":return _context15.stop()}}),_callee15,this)}))),function setMicrophone(_x7){return _setMicrophone.apply(this,arguments)})},{key:"setSpeaker",value:(_setSpeaker=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee17(device){var _this8=this;return regeneratorRuntime.wrap((function _callee17$(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:return _context17.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee16(){return regeneratorRuntime.wrap((function _callee16$(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:return _context16.next=2,_this8.handlers.onSelectSpeaker(device);case 2:case"end":return _context16.stop()}}),_callee16)}))));case 2:return _context17.abrupt("return",_context17.sent);case 3:case"end":return _context17.stop()}}),_callee17,this)}))),function setSpeaker(_x8){return _setSpeaker.apply(this,arguments)})},{key:"startCamera",value:(_startCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee19(options){var _this9=this;return regeneratorRuntime.wrap((function _callee19$(_context19){for(;;)switch(_context19.prev=_context19.next){case 0:return _context19.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee18(){return regeneratorRuntime.wrap((function _callee18$(_context18){for(;;)switch(_context18.prev=_context18.next){case 0:if(Object(utils.c)(_this9.getState())){_context18.next=3;break}return _context18.next=3,_this9.handlers.onToggleCamera(options);case 3:case"end":return _context18.stop()}}),_callee18)}))));case 2:return _context19.abrupt("return",_context19.sent);case 3:case"end":return _context19.stop()}}),_callee19,this)}))),function startCamera(_x9){return _startCamera.apply(this,arguments)})},{key:"stopCamera",value:(_stopCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee21(){var _this10=this;return regeneratorRuntime.wrap((function _callee21$(_context21){for(;;)switch(_context21.prev=_context21.next){case 0:return _context21.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee20(){return regeneratorRuntime.wrap((function _callee20$(_context20){for(;;)switch(_context20.prev=_context20.next){case 0:if(!Object(utils.c)(_this10.getState())){_context20.next=3;break}return _context20.next=3,_this10.handlers.onToggleCamera();case 3:case"end":return _context20.stop()}}),_callee20)}))));case 2:return _context21.abrupt("return",_context21.sent);case 3:case"end":return _context21.stop()}}),_callee21,this)}))),function stopCamera(){return _stopCamera.apply(this,arguments)})},{key:"mute",value:(_mute=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee23(){var _this11=this;return regeneratorRuntime.wrap((function _callee23$(_context23){for(;;)switch(_context23.prev=_context23.next){case 0:return _context23.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee22(){var _this11$call,_this11$call2;return regeneratorRuntime.wrap((function _callee22$(_context22){for(;;)switch(_context22.prev=_context22.next){case 0:if(_this11.context.setIsLocalMicrophoneEnabled(!1),!Object(src.b)(null===(_this11$call=_this11.call)||void 0===_this11$call?void 0:_this11$call.state)||null!==(_this11$call2=_this11.call)&&void 0!==_this11$call2&&_this11$call2.isMuted){_context22.next=4;break}return _context22.next=4,_this11.handlers.onToggleMicrophone();case 4:case"end":return _context22.stop()}}),_callee22)}))));case 2:return _context23.abrupt("return",_context23.sent);case 3:case"end":return _context23.stop()}}),_callee23,this)}))),function mute(){return _mute.apply(this,arguments)})},{key:"unmute",value:(_unmute=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee25(){var _this12=this;return regeneratorRuntime.wrap((function _callee25$(_context25){for(;;)switch(_context25.prev=_context25.next){case 0:return _context25.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee24(){var _this12$call,_this12$call2;return regeneratorRuntime.wrap((function _callee24$(_context24){for(;;)switch(_context24.prev=_context24.next){case 0:if(_this12.context.setIsLocalMicrophoneEnabled(!0),!Object(src.b)(null===(_this12$call=_this12.call)||void 0===_this12$call?void 0:_this12$call.state)||null===(_this12$call2=_this12.call)||void 0===_this12$call2||!_this12$call2.isMuted){_context24.next=4;break}return _context24.next=4,_this12.handlers.onToggleMicrophone();case 4:case"end":return _context24.stop()}}),_callee24)}))));case 2:return _context25.abrupt("return",_context25.sent);case 3:case"end":return _context25.stop()}}),_callee25,this)}))),function unmute(){return _unmute.apply(this,arguments)})},{key:"startScreenShare",value:(_startScreenShare=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee27(){var _this13=this;return regeneratorRuntime.wrap((function _callee27$(_context27){for(;;)switch(_context27.prev=_context27.next){case 0:return _context27.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee26(){var _this13$call;return regeneratorRuntime.wrap((function _callee26$(_context26){for(;;)switch(_context26.prev=_context26.next){case 0:if(null!==(_this13$call=_this13.call)&&void 0!==_this13$call&&_this13$call.isScreenSharingOn){_context26.next=3;break}return _context26.next=3,_this13.handlers.onToggleScreenShare();case 3:case"end":return _context26.stop()}}),_callee26)}))));case 2:return _context27.abrupt("return",_context27.sent);case 3:case"end":return _context27.stop()}}),_callee27,this)}))),function startScreenShare(){return _startScreenShare.apply(this,arguments)})},{key:"stopScreenShare",value:(_stopScreenShare=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee29(){var _this14=this;return regeneratorRuntime.wrap((function _callee29$(_context29){for(;;)switch(_context29.prev=_context29.next){case 0:return _context29.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee28(){var _this14$call;return regeneratorRuntime.wrap((function _callee28$(_context28){for(;;)switch(_context28.prev=_context28.next){case 0:if(null===(_this14$call=_this14.call)||void 0===_this14$call||!_this14$call.isScreenSharingOn){_context28.next=3;break}return _context28.next=3,_this14.handlers.onToggleScreenShare();case 3:case"end":return _context28.stop()}}),_callee28)}))));case 2:return _context29.abrupt("return",_context29.sent);case 3:case"end":return _context29.stop()}}),_callee29,this)}))),function stopScreenShare(){return _stopScreenShare.apply(this,arguments)})},{key:"startCall",value:function startCall(participants){var _this$getState$call$s2,_this$getState$call2;if(Object(src.b)(null!==(_this$getState$call$s2=null===(_this$getState$call2=this.getState().call)||void 0===_this$getState$call2?void 0:_this$getState$call2.state)&&void 0!==_this$getState$call$s2?_this$getState$call$s2:"None"))throw new Error("You are already in the call.");var idsToAdd=participants.map((function(participant){return Object(acs_ui_common_src.e)(participant)})),call=this.handlers.onStartCall(idsToAdd);if(!call)throw new Error("Unable to start call.");return this.processNewCall(call),this.call}},{key:"processNewCall",value:function processNewCall(call){this.call=call,this.context.setCallId(call.id),this.context.updateClientState(this.callClient.getState()),this.handlers=Object(src.e)(this.callClient,this.callAgent,this.deviceManager,this.call),this.subscribeCallEvents()}},{key:"removeParticipant",value:(_removeParticipant=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee30(userId){return regeneratorRuntime.wrap((function _callee30$(_context30){for(;;)switch(_context30.prev=_context30.next){case 0:this.handlers.onRemoveParticipant(userId);case 1:case"end":return _context30.stop()}}),_callee30,this)}))),function removeParticipant(_x10){return _removeParticipant.apply(this,arguments)})},{key:"getState",value:function getState(){return this.context.getState()}},{key:"onStateChange",value:function onStateChange(handler){this.context.onStateChange(handler)}},{key:"offStateChange",value:function offStateChange(handler){this.context.offStateChange(handler)}},{key:"on",value:function on(event,listener){this.emitter.on(event,listener)}},{key:"subscribeCallEvents",value:function subscribeCallEvents(){var _this$call3,_this$call4,_this$call5,_this$call6;null===(_this$call3=this.call)||void 0===_this$call3||_this$call3.on("remoteParticipantsUpdated",this.onRemoteParticipantsUpdated.bind(this)),null===(_this$call4=this.call)||void 0===_this$call4||_this$call4.on("isMutedChanged",this.isMyMutedChanged.bind(this)),null===(_this$call5=this.call)||void 0===_this$call5||_this$call5.on("isScreenSharingOnChanged",this.isScreenSharingOnChanged.bind(this)),null===(_this$call6=this.call)||void 0===_this$call6||_this$call6.on("idChanged",this.callIdChanged.bind(this))}},{key:"unsubscribeCallEvents",value:function unsubscribeCallEvents(){var _this$call7,_this$call8,_this$call9,_this$call10,_step2,_iterator2=AzureCommunicationCallAdapter_createForOfIteratorHelper(this.participantSubscribers.values());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){_step2.value.unsubscribeAll()}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.participantSubscribers.clear(),null===(_this$call7=this.call)||void 0===_this$call7||_this$call7.off("remoteParticipantsUpdated",this.onRemoteParticipantsUpdated.bind(this)),null===(_this$call8=this.call)||void 0===_this$call8||_this$call8.off("isMutedChanged",this.isMyMutedChanged.bind(this)),null===(_this$call9=this.call)||void 0===_this$call9||_this$call9.off("isScreenSharingOnChanged",this.isScreenSharingOnChanged.bind(this)),null===(_this$call10=this.call)||void 0===_this$call10||_this$call10.off("idChanged",this.callIdChanged.bind(this))}},{key:"onRemoteParticipantsUpdated",value:function onRemoteParticipantsUpdated(_ref14){var _this15=this,added=_ref14.added,removed=_ref14.removed;added&&added.length>0&&this.emitter.emit("participantsJoined",added),removed&&removed.length>0&&this.emitter.emit("participantsLeft",removed),added.forEach((function(participant){_this15.participantSubscribers.set(Object(acs_ui_common_src.g)(participant.identifier),new ParticipantSubcriber_ParticipantSubscriber(participant,_this15.emitter))})),removed.forEach((function(participant){var subscriber=_this15.participantSubscribers.get(Object(acs_ui_common_src.g)(participant.identifier));subscriber&&subscriber.unsubscribeAll(),_this15.participantSubscribers.delete(Object(acs_ui_common_src.g)(participant.identifier))}))}},{key:"isScreenSharingOnChanged",value:function isScreenSharingOnChanged(){var _this$call11;this.emitter.emit("isLocalScreenSharingActiveChanged",{isScreenSharingOn:null===(_this$call11=this.call)||void 0===_this$call11?void 0:_this$call11.isScreenSharingOn})}},{key:"callIdChanged",value:function callIdChanged(){var _this$call12;this.context.setCallId(null===(_this$call12=this.call)||void 0===_this$call12?void 0:_this$call12.id),this.context.updateClientState(this.callClient.getState()),this.emitter.emit("callIdChanged",{callId:this.callIdChanged.bind(this)})}},{key:"resetDiagnosticsForwarder",value:function resetDiagnosticsForwarder(newCall){this.diagnosticsForwarder&&this.diagnosticsForwarder.unsubscribe(),newCall&&(this.diagnosticsForwarder=new DiagnosticsForwarder_DiagnosticsForwarder(this.emitter,newCall))}},{key:"off",value:function off(event,listener){this.emitter.off(event,listener)}},{key:"asyncTeeErrorToEventEmitter",value:(_asyncTeeErrorToEventEmitter=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee31(f){return regeneratorRuntime.wrap((function _callee31$(_context31){for(;;)switch(_context31.prev=_context31.next){case 0:return _context31.prev=0,_context31.next=3,f();case 3:return _context31.abrupt("return",_context31.sent);case 6:throw _context31.prev=6,_context31.t0=_context31.catch(0),isCallError(_context31.t0)&&this.emitter.emit("error",_context31.t0),_context31.t0;case 10:case"end":return _context31.stop()}}),_callee31,this,[[0,6]])}))),function asyncTeeErrorToEventEmitter(_x11){return _asyncTeeErrorToEventEmitter.apply(this,arguments)})}]),AzureCommunicationCallAdapter}(),createAzureCommunicationCallAdapter=function(){var _ref16=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee32(_ref15){var userId,displayName,credential,locator,callClient,callAgent,adapter;return regeneratorRuntime.wrap((function _callee32$(_context32){for(;;)switch(_context32.prev=_context32.next){case 0:return userId=_ref15.userId,displayName=_ref15.displayName,credential=_ref15.credential,locator=_ref15.locator,callClient=StatefulCallClient_createStatefulCallClient({userId:userId}),_context32.next=4,callClient.createCallAgent(credential,{displayName:displayName});case 4:return callAgent=_context32.sent,adapter=createAzureCommunicationCallAdapterFromClient(callClient,callAgent,locator),_context32.abrupt("return",adapter);case 7:case"end":return _context32.stop()}}),_callee32)})));return function createAzureCommunicationCallAdapter(_x12){return _ref16.apply(this,arguments)}}(),createAzureCommunicationCallAdapterFromClient=function(){var _ref17=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee33(callClient,callAgent,locator){var deviceManager;return regeneratorRuntime.wrap((function _callee33$(_context33){for(;;)switch(_context33.prev=_context33.next){case 0:return _context33.next=2,callClient.getDeviceManager();case 2:return deviceManager=_context33.sent,_context33.abrupt("return",new AzureCommunicationCallAdapter_AzureCommunicationCallAdapter(callClient,locator,callAgent,deviceManager));case 4:case"end":return _context33.stop()}}),_callee33)})));return function createAzureCommunicationCallAdapterFromClient(_x13,_x14,_x15){return _ref17.apply(this,arguments)}}(),isCallError=function isCallError(e){return void 0!==e.target&&void 0!==e.innerError},isAdhocCall=function isAdhocCall(callLocator){return"participantIDs"in callLocator}},428:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallWithChatComposite_CallWithChatComposite})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createAzureCommunicationCallWithChatAdapter}));__webpack_require__(7),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var react=__webpack_require__(1),Stack=__webpack_require__(69),CallComposite=__webpack_require__(300),CallAdapterProvider=__webpack_require__(134),ChatComposite=__webpack_require__(438),LocalizationProvider=__webpack_require__(441),useCallWithChatCompositeStrings_useCallWithChatCompositeStrings=function useCallWithChatCompositeStrings(){return Object(LocalizationProvider.b)().strings.callWithChat},lib=__webpack_require__(22),DefaultButton=__webpack_require__(379),src=__webpack_require__(21),icons=__webpack_require__(57),ParticipantContainer_styles=__webpack_require__(92),mobilePaneStyle={root:{width:"100%",height:"100%"}},hiddenMobilePaneStyle=Object(lib.r)(mobilePaneStyle,{root:{display:"none"}}),mobilePaneControlBarStyle={root:{height:"3rem"}},mobilePaneBackButtonStyles={root:{border:"none",minWidth:"2.5rem",height:"100%",background:"none",padding:"0 1rem 0 0.5rem"},rootChecked:{background:"none"},rootCheckedHovered:{background:"none"}},mobilePaneButtonStyles={root:{border:"none",borderBottom:"0.125rem solid transparent",width:"8rem",height:"100%",background:"none",padding:"0"},rootChecked:{background:"none"},rootCheckedHovered:{background:"none"},flexContainer:{flexFlow:"column",display:"contents"},label:{fontSize:"1rem",fontWeight:100,lineHeight:"2rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},labelChecked:{fontWeight:600}},jsx_runtime=__webpack_require__(2),MobilePane_MobilePane=function MobilePane(props){var mobilePaneStyles=props.hidden?hiddenMobilePaneStyle:mobilePaneStyle,theme=Object(src.M)(),mobilePaneButtonStylesThemed=Object(react.useMemo)((function(){return Object(lib.r)(mobilePaneButtonStyles,{rootChecked:{borderBottom:"0.125rem solid "+theme.palette.themePrimary},label:{fontSize:theme.fonts.medium.fontSize,fontWeight:theme.fonts.medium.fontWeight}})}),[theme]),strings=useCallWithChatCompositeStrings_useCallWithChatCompositeStrings();return Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,grow:!0,styles:mobilePaneStyles,"data-ui-id":props.dataUiId,children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,grow:!0,styles:mobilePaneControlBarStyle,children:[Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:props.onClose,styles:mobilePaneBackButtonStyles,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(MobilePane_ChevronLeftIconTrampoline,{})}}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:props.onChatButtonClicked,styles:mobilePaneButtonStylesThemed,checked:"chat"===props.activeTab,children:strings.chatButtonLabel}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:props.onPeopleButtonClicked,styles:mobilePaneButtonStylesThemed,checked:"people"===props.activeTab,children:strings.peopleButtonLabel})]}),Object(jsx_runtime.jsx)(Stack.a.Item,{verticalFill:!0,grow:!0,styles:ParticipantContainer_styles.b,children:Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,styles:ParticipantContainer_styles.i,children:Object(jsx_runtime.jsx)(Stack.a.Item,{verticalFill:!0,styles:ParticipantContainer_styles.j,children:props.children})})})]})};MobilePane_MobilePane.displayName="MobilePane";var MobilePane_ChevronLeftIconTrampoline=function ChevronLeftIconTrampoline(){return Object(jsx_runtime.jsx)(icons.b,{iconName:"ChevronLeft"})};MobilePane_ChevronLeftIconTrampoline.displayName="ChevronLeftIconTrampoline",MobilePane_MobilePane.__docgenInfo={description:"This is a wrapper for Chat and People pane to cover the entire the screen and to have\nits own navigation bar\n@private",methods:[],displayName:"MobilePane",props:{onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onChatButtonClicked:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPeopleButtonClicked:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},hidden:{required:!0,tsType:{name:"boolean"},description:""},dataUiId:{required:!0,tsType:{name:"string"},description:""},activeTab:{required:!0,tsType:{name:"union",raw:"'chat' | 'people'",elements:[{name:"literal",value:"'chat'"},{name:"literal",value:"'people'"}]},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/MobilePane.tsx"]={name:"MobilePane",docgenInfo:MobilePane_MobilePane.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/MobilePane.tsx"});var CommandBarButton=__webpack_require__(1754),SidePane_SidePane=function SidePane(props){var sidePaneStyles=props.hidden?ParticipantContainer_styles.k:ParticipantContainer_styles.l,theme=Object(src.M)(),sidePaneCloseButtonStyles={icon:{color:theme.palette.neutralSecondary},iconHovered:{color:theme.palette.neutralSecondary},iconPressed:{color:theme.palette.neutralSecondary}};return Object(jsx_runtime.jsx)(Stack.a.Item,{disableShrink:!0,verticalFill:!0,styles:sidePaneStyles,tokens:ParticipantContainer_styles.m,children:Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,"data-ui-id":props.dataUiId,children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"space-between",styles:ParticipantContainer_styles.n,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{children:props.headingText}),Object(jsx_runtime.jsx)(CommandBarButton.a,{styles:sidePaneCloseButtonStyles,iconProps:{iconName:"cancel"},onClick:props.onClose})]}),Object(jsx_runtime.jsx)(Stack.a.Item,{verticalFill:!0,grow:!0,styles:ParticipantContainer_styles.b,children:Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,styles:ParticipantContainer_styles.i,children:Object(jsx_runtime.jsx)(Stack.a.Item,{verticalFill:!0,styles:ParticipantContainer_styles.j,children:props.children})})})]})})};SidePane_SidePane.displayName="SidePane",SidePane_SidePane.__docgenInfo={description:"This is a wrapper for the Chat and People pane to be displayed to the side of the CallWithChat composite\n@private",methods:[],displayName:"SidePane",props:{headingText:{required:!0,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},hidden:{required:!0,tsType:{name:"boolean"},description:""},dataUiId:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/SidePane.tsx"]={name:"SidePane",docgenInfo:SidePane_SidePane.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/SidePane.tsx"});var EmbeddedChatPane_EmbeddedChatPane=function EmbeddedChatPane(props){var callWithChatStrings=useCallWithChatCompositeStrings_useCallWithChatCompositeStrings(),chatComposite=Object(jsx_runtime.jsx)(ChatComposite.ChatComposite,Object.assign({},props.chatCompositeProps,{adapter:props.chatAdapter,fluentTheme:props.fluentTheme,options:{topic:!1,participantPane:!1},onFetchAvatarPersonaData:props.onFetchAvatarPersonaData}));return props.mobileView?Object(jsx_runtime.jsx)(MobilePane_MobilePane,{hidden:props.hidden,dataUiId:"call-with-chat-composite-chat-pane",onClose:props.onClose,activeTab:"chat",onChatButtonClicked:props.onChatButtonClick,onPeopleButtonClicked:props.onPeopleButtonClick,children:chatComposite}):Object(jsx_runtime.jsx)(SidePane_SidePane,{hidden:props.hidden,headingText:callWithChatStrings.chatPaneTitle,onClose:props.onClose,dataUiId:"call-with-chat-composite-chat-pane",children:chatComposite})};EmbeddedChatPane_EmbeddedChatPane.displayName="EmbeddedChatPane",EmbeddedChatPane_EmbeddedChatPane.__docgenInfo={description:"@private",methods:[],displayName:"EmbeddedChatPane",props:{chatCompositeProps:{required:!0,tsType:{name:"Partial",elements:[{name:"ChatCompositeProps"}],raw:"Partial<ChatCompositeProps>"},description:""},chatAdapter:{required:!0,tsType:{name:"ChatAdapter"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},hidden:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onFetchAvatarPersonaData:{required:!1,tsType:{name:"AvatarPersonaDataCallback"},description:""},onChatButtonClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPeopleButtonClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},mobileView:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/EmbeddedChatPane.tsx"]={name:"EmbeddedChatPane",docgenInfo:EmbeddedChatPane_EmbeddedChatPane.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/EmbeddedChatPane.tsx"});__webpack_require__(39);var PrimaryButton=__webpack_require__(1721),copy_to_clipboard=__webpack_require__(371),copy_to_clipboard_default=__webpack_require__.n(copy_to_clipboard),usePropsFor=__webpack_require__(94),ParticipantContainer=__webpack_require__(469),copyLinkButtonStyles={root:{height:"3rem",borderRadius:"0.5rem",margin:"0.75rem 1rem"},textContainer:{display:"contents"}},linkIconStyles={marginRight:"0.5rem"};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var EmbeddedPeoplePane_EmbeddedPeoplePane=function EmbeddedPeoplePane(props){var callAdapter=props.callAdapter,chatAdapter=props.chatAdapter,inviteLink=props.inviteLink,participantListDefaultProps=Object(usePropsFor.a)(src.D),callWithChatStrings=useCallWithChatCompositeStrings_useCallWithChatCompositeStrings(),participantListProps=Object(react.useMemo)((function(){var onRemoveParticipant=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(participantId){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",removeParticipantFromCallWithChat(callAdapter,chatAdapter,participantId));case 1:case"end":return _context.stop()}}),_callee)})));return function onRemoveParticipant(_x){return _ref.apply(this,arguments)}}();return Object.assign({},participantListDefaultProps,{onRemoveParticipant:onRemoveParticipant})}),[participantListDefaultProps,callAdapter,chatAdapter]),participantList=Object(jsx_runtime.jsx)(ParticipantContainer.b,{participantListProps:participantListProps,onFetchAvatarPersonaData:props.onFetchAvatarPersonaData,title:callWithChatStrings.peoplePaneSubTitle});return props.mobileView?Object(jsx_runtime.jsx)(MobilePane_MobilePane,{hidden:props.hidden,dataUiId:"call-with-chat-composite-people-pane",onClose:props.onClose,activeTab:"people",onChatButtonClicked:props.onChatButtonClick,onPeopleButtonClicked:props.onPeopleButtonClick,children:Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,tokens:ParticipantContainer_styles.g,children:[participantList,inviteLink&&Object(jsx_runtime.jsx)(PrimaryButton.a,{onClick:function onClick(){return copy_to_clipboard_default()(inviteLink)},styles:copyLinkButtonStyles,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(EmbeddedPeoplePane_LinkIconTrampoline,{})},text:"Copy invite link"})]})}):Object(jsx_runtime.jsx)(SidePane_SidePane,{hidden:props.hidden,headingText:callWithChatStrings.peoplePaneTitle,onClose:props.onClose,dataUiId:"call-with-chat-composite-people-pane",children:Object(jsx_runtime.jsxs)(Stack.a,{tokens:ParticipantContainer_styles.g,children:[inviteLink&&Object(jsx_runtime.jsx)(DefaultButton.a,{text:"Copy invite link",iconProps:{iconName:"Link"},onClick:function onClick(){return copy_to_clipboard_default()(inviteLink)}}),participantList]})})};EmbeddedPeoplePane_EmbeddedPeoplePane.displayName="EmbeddedPeoplePane";var EmbeddedPeoplePane_LinkIconTrampoline=function LinkIconTrampoline(){return Object(jsx_runtime.jsx)(icons.b,{iconName:"Link",style:linkIconStyles})};EmbeddedPeoplePane_LinkIconTrampoline.displayName="LinkIconTrampoline";var removeParticipantFromCallWithChat=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(callAdapter,chatAdapter,participantId){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,callAdapter.removeParticipant(participantId);case 2:return _context2.next=4,chatAdapter.removeParticipant(participantId);case 4:case"end":return _context2.stop()}}),_callee2)})));return function removeParticipantFromCallWithChat(_x2,_x3,_x4){return _ref2.apply(this,arguments)}}();EmbeddedPeoplePane_EmbeddedPeoplePane.__docgenInfo={description:"@private",methods:[],displayName:"EmbeddedPeoplePane",props:{inviteLink:{required:!1,tsType:{name:"string"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},hidden:{required:!0,tsType:{name:"boolean"},description:""},callAdapter:{required:!0,tsType:{name:"CallAdapter"},description:""},chatAdapter:{required:!0,tsType:{name:"ChatAdapter"},description:""},onFetchAvatarPersonaData:{required:!1,tsType:{name:"AvatarPersonaDataCallback"},description:""},onChatButtonClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPeopleButtonClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},mobileView:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/EmbeddedPeoplePane.tsx"]={name:"EmbeddedPeoplePane",docgenInfo:EmbeddedPeoplePane_EmbeddedPeoplePane.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/EmbeddedPeoplePane.tsx"});var PeopleButton_icon=function icon(){return Object(jsx_runtime.jsx)(icons.b,{iconName:"ControlBarPeopleButton"})};PeopleButton_icon.displayName="icon";var PeopleButton_PeopleButton=function PeopleButton(props){var _props$onRenderOnIcon,_props$onRenderOffIco,strings=Object.assign({label:props.label},props.strings),theme=Object(src.M)(),styles=Object(react.useMemo)((function(){var _props$styles;return Object(lib.r)({rootChecked:{background:theme.palette.neutralLight}},null!==(_props$styles=props.styles)&&void 0!==_props$styles?_props$styles:{})}),[theme]);return Object(jsx_runtime.jsx)(src.q,Object.assign({},props,{strings:strings,labelKey:"peopleButtonLabelKey",onRenderOnIcon:null!==(_props$onRenderOnIcon=props.onRenderOnIcon)&&void 0!==_props$onRenderOnIcon?_props$onRenderOnIcon:PeopleButton_icon,onRenderOffIcon:null!==(_props$onRenderOffIco=props.onRenderOffIcon)&&void 0!==_props$onRenderOffIco?_props$onRenderOffIco:PeopleButton_icon,onClick:props.onClick,styles:styles}))};PeopleButton_PeopleButton.displayName="PeopleButton",PeopleButton_PeopleButton.__docgenInfo={description:"@private",methods:[],displayName:"PeopleButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/PeopleButton.tsx"]={name:"PeopleButton",docgenInfo:PeopleButton_PeopleButton.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/PeopleButton.tsx"});var useTheme=__webpack_require__(369),CallControls_styles=__webpack_require__(474),CallPage_styles=__webpack_require__(227),ChatButton_ChatButton=function ChatButton(props){var strings=Object.assign({label:props.label},props.strings),theme=Object(src.M)(),styles=Object(react.useMemo)((function(){var _props$styles;return Object(lib.r)({rootChecked:{background:theme.palette.neutralLight}},null!==(_props$styles=props.styles)&&void 0!==_props$styles?_props$styles:{})}),[theme]);return Object(jsx_runtime.jsx)(src.q,Object.assign({},props,{labelKey:"chatButtonLabelKey",strings:strings,onClick:props.onClick,styles:styles}))};ChatButton_ChatButton.displayName="ChatButton",ChatButton_ChatButton.__docgenInfo={description:"@private",methods:[],displayName:"ChatButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/ChatButton.tsx"]={name:"ChatButton",docgenInfo:ChatButton_ChatButton.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/ChatButton.tsx"});var Text=__webpack_require__(499),memoize=__webpack_require__(325),NotificationIcon_NotificationIcon=function NotificationIcon(props){var chatMessagesCount=props.chatMessagesCount,label=props.label,theme=Object(useTheme.a)();return Object(jsx_runtime.jsxs)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:notificationIconContainerStyles,children:[Object(jsx_runtime.jsx)(icons.b,{styles:notificationIconStyles(theme),iconName:"ControlBarButtonBadgeIcon"}),function renderNumber(numberOfMessages){if(numberOfMessages<1)return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{});var textNumberOfMessages=numberOfMessages<9?numberOfMessages:"9+";return Object(jsx_runtime.jsx)(Text.a,{role:"status","aria-label":textNumberOfMessages+label,styles:notificationTextStyles(theme),children:textNumberOfMessages})}(chatMessagesCount)]})};NotificationIcon_NotificationIcon.displayName="NotificationIcon";var notificationIconContainerStyles=Object(memoize.a)((function(){return{root:{position:"absolute",top:"-0.5rem",right:"-0.5rem"}}})),notificationIconStyles=Object(memoize.a)((function(theme){return{root:{color:theme.palette.themePrimary}}})),notificationTextStyles=Object(memoize.a)((function(theme){return{root:{position:"absolute",top:"0.1rem",color:theme.palette.white,fontSize:theme.fonts.smallPlus.fontSize}}}));function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}NotificationIcon_NotificationIcon.__docgenInfo={description:"@private",methods:[],displayName:"NotificationIcon",props:{chatMessagesCount:{required:!0,tsType:{name:"number"},description:""},label:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/NotificationIcon.tsx"]={name:"NotificationIcon",docgenInfo:NotificationIcon_NotificationIcon.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/NotificationIcon.tsx"});var filledIcon=Object(jsx_runtime.jsx)(icons.b,{iconName:"ControlBarChatButtonActive"}),regularIcon=Object(jsx_runtime.jsx)(icons.b,{iconName:"ControlBarChatButtonInactive"}),ChatButtonWithUnreadMessagesBadge_ChatButtonWithUnreadMessagesBadge=function ChatButtonWithUnreadMessagesBadge(props){var chatAdapter=props.chatAdapter,isChatPaneVisible=props.isChatPaneVisible,newMessageLabel=props.newMessageLabel,_useState2=_slicedToArray(Object(react.useState)(0),2),unreadChatMessagesCount=_useState2[0],setUnreadChatMessagesCount=_useState2[1],baseIcon=props.showLabel?regularIcon:filledIcon,onRenderOnIcon=Object(react.useCallback)((function(){return baseIcon}),[baseIcon]),notificationOnIcon=Object(react.useCallback)((function(){return Object(jsx_runtime.jsxs)(Stack.a,{styles:chatNotificationContainerStyles,children:[unreadChatMessagesCount>0&&Object(jsx_runtime.jsx)(NotificationIcon_NotificationIcon,{chatMessagesCount:unreadChatMessagesCount,label:newMessageLabel}),baseIcon]})}),[unreadChatMessagesCount,newMessageLabel]);return Object(react.useEffect)((function(){if(!isChatPaneVisible){var incrementUnreadChatMessagesCount=function incrementUnreadChatMessagesCount(event){!isChatPaneVisible&&function validNewChatMessage(message){return!!message.senderDisplayName&&("text"===message.type||"html"===message.type)}(event.message)&&setUnreadChatMessagesCount(unreadChatMessagesCount+1)};return chatAdapter.on("messageReceived",incrementUnreadChatMessagesCount),function(){chatAdapter.off("messageReceived",incrementUnreadChatMessagesCount)}}setUnreadChatMessagesCount(0)}),[chatAdapter,setUnreadChatMessagesCount,isChatPaneVisible,unreadChatMessagesCount]),Object(jsx_runtime.jsx)(ChatButton_ChatButton,Object.assign({},props,{"data-ui-id":"call-with-chat-composite-chat-button",onRenderOffIcon:notificationOnIcon,onRenderOnIcon:onRenderOnIcon}))};ChatButtonWithUnreadMessagesBadge_ChatButtonWithUnreadMessagesBadge.displayName="ChatButtonWithUnreadMessagesBadge";var chatNotificationContainerStyles={root:{display:"inline",position:"relative"}};ChatButtonWithUnreadMessagesBadge_ChatButtonWithUnreadMessagesBadge.__docgenInfo={description:"@private",methods:[],displayName:"ChatButtonWithUnreadMessagesBadge",props:{chatAdapter:{required:!0,tsType:{name:"ChatAdapter"},description:""},isChatPaneVisible:{required:!0,tsType:{name:"boolean"},description:""},newMessageLabel:{required:!1,tsType:{name:"string"},description:""}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/ChatButtonWithUnreadMessagesBadge.tsx"]={name:"ChatButtonWithUnreadMessagesBadge",docgenInfo:ChatButtonWithUnreadMessagesBadge_ChatButtonWithUnreadMessagesBadge.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/ChatButtonWithUnreadMessagesBadge.tsx"});var Microphone=__webpack_require__(472),Camera=__webpack_require__(470),ScreenShare=__webpack_require__(473),EndCall=__webpack_require__(471),MoreHorizontal20Filled=__webpack_require__(1696),MoreButton_icon=function icon(){return Object(jsx_runtime.jsx)(MoreHorizontal20Filled.a,{primaryFill:"currentColor"},"chatOnIconKey")};MoreButton_icon.displayName="icon";var MoreButton_MoreButton=function MoreButton(props){return Object(jsx_runtime.jsx)(src.q,Object.assign({},props,{labelKey:"optionsButtonLabelKey",showLabel:!1,onRenderOnIcon:MoreButton_icon,onRenderOffIcon:MoreButton_icon,onClick:props.onClick,"data-ui-id":"call-with-chat-composite-more-button"}))};MoreButton_MoreButton.displayName="MoreButton",MoreButton_MoreButton.__docgenInfo={description:"@private",methods:[],displayName:"MoreButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/MoreButton.tsx"]={name:"MoreButton",docgenInfo:MoreButton_MoreButton.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/MoreButton.tsx"});var CallWithChatControlBar_CallWithChatControlBar=function CallWithChatControlBar(props){var theme=Object(useTheme.a)(),callWithChatStrings=useCallWithChatCompositeStrings_useCallWithChatCompositeStrings(),options=function inferCallWithChatControlOptions(mobileView,callWithChatControls){if(!1===callWithChatControls)return!1;var options=!0===callWithChatControls||void 0===callWithChatControls?{}:callWithChatControls;return mobileView&&(options.displayType="compact",!0!==options.screenShareButton&&(options.screenShareButton=!1)),options}(props.mobileView,props.callControls),centerContainerStyles=Object(react.useMemo)((function(){return props.mobileView?void 0:desktopControlBarStyles}),[props.mobileView]),commonButtonStyles=Object(react.useMemo)((function(){return props.mobileView?void 0:getDesktopCommonButtonStyles(theme)}),[props.mobileView,theme]),endCallButtonStyles=Object(react.useMemo)((function(){return props.mobileView?void 0:CallWithChatControlBar_getDesktopEndCallButtonStyles(theme)}),[props.mobileView,theme]);if(!1===options)return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{});var chatButton=Object(jsx_runtime.jsx)(ChatButtonWithUnreadMessagesBadge_ChatButtonWithUnreadMessagesBadge,{chatAdapter:props.chatAdapter,checked:props.chatButtonChecked,showLabel:"compact"!==options.displayType,isChatPaneVisible:props.chatButtonChecked,onClick:props.onChatButtonClicked,disabled:props.disableButtonsForLobbyPage,label:callWithChatStrings.chatButtonLabel,styles:commonButtonStyles,newMessageLabel:callWithChatStrings.chatButtonNewMessageNotificationLabel});return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.H)(CallPage_styles.a,CallControls_styles.a),children:[Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,children:Object(jsx_runtime.jsx)(CallAdapterProvider.a,{adapter:props.callAdapter,children:Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",children:Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsxs)(src.p,{layout:"horizontal",styles:centerContainerStyles,children:[isEnabled(options.microphoneButton)&&Object(jsx_runtime.jsx)(Microphone.a,{displayType:options.displayType,styles:commonButtonStyles,splitButtonsForDeviceSelection:!props.mobileView}),isEnabled(options.cameraButton)&&Object(jsx_runtime.jsx)(Camera.a,{displayType:options.displayType,styles:commonButtonStyles,splitButtonsForDeviceSelection:!props.mobileView}),props.mobileView&&isEnabled(null==options?void 0:options.chatButton)&&chatButton,isEnabled(options.screenShareButton)&&Object(jsx_runtime.jsx)(ScreenShare.a,{option:options.screenShareButton,displayType:options.displayType,styles:commonButtonStyles}),props.mobileView&&Object(jsx_runtime.jsx)(MoreButton_MoreButton,{"data-ui-id":"call-with-chat-composite-more-button",onClick:props.onMoreButtonClicked}),Object(jsx_runtime.jsx)(EndCall.a,{displayType:"compact",styles:endCallButtonStyles})]})})})})}),!props.mobileView&&Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:props.mobileView?void 0:Object(lib.H)(desktopButtonContainerStyle),children:[isEnabled(null==options?void 0:options.peopleButton)&&Object(jsx_runtime.jsx)(PeopleButton_PeopleButton,{checked:props.peopleButtonChecked,showLabel:!0,onClick:props.onPeopleButtonClicked,"data-ui-id":"call-with-chat-composite-people-button",disabled:props.disableButtonsForLobbyPage,label:callWithChatStrings.peopleButtonLabel,styles:commonButtonStyles}),isEnabled(null==options?void 0:options.chatButton)&&chatButton]})]})};CallWithChatControlBar_CallWithChatControlBar.displayName="CallWithChatControlBar";var desktopButtonContainerStyle={padding:"0.75rem",columnGap:"0.5rem"},desktopControlBarStyles={root:desktopButtonContainerStyle},getDesktopCommonButtonStyles=function getDesktopCommonButtonStyles(theme){return{root:{border:"solid 1px "+theme.palette.neutralQuaternaryAlt,borderRadius:theme.effects.roundedCorner4,minHeight:"2.5rem"},flexContainer:{flexFlow:"row nowrap"},textContainer:{display:"inline"},label:{display:"inline",fontSize:theme.fonts.medium.fontSize},splitButtonMenuButton:{border:"solid 1px "+theme.palette.neutralQuaternaryAlt,borderRadius:theme.effects.roundedCorner4},splitButtonMenuButtonChecked:{background:"none"}}},CallWithChatControlBar_getDesktopEndCallButtonStyles=function getDesktopEndCallButtonStyles(theme){return Object(lib.r)(getDesktopCommonButtonStyles(theme),{root:{border:"none"}})},isEnabled=function isEnabled(option){return!1!==option};CallWithChatControlBar_CallWithChatControlBar.__docgenInfo={description:"@private",methods:[],displayName:"CallWithChatControlBar",props:{callAdapter:{required:!0,tsType:{name:"CallAdapter"},description:""},chatButtonChecked:{required:!0,tsType:{name:"boolean"},description:""},peopleButtonChecked:{required:!0,tsType:{name:"boolean"},description:""},onChatButtonClicked:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPeopleButtonClicked:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onMoreButtonClicked:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},mobileView:{required:!0,tsType:{name:"boolean"},description:""},disableButtonsForLobbyPage:{required:!0,tsType:{name:"boolean"},description:""},callControls:{required:!1,tsType:{name:"union",raw:"boolean | CallWithChatControlOptions",elements:[{name:"boolean"},{name:"CallWithChatControlOptions"}]},description:""},chatAdapter:{required:!0,tsType:{name:"ChatAdapter"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/CallWithChatControlBar.tsx"]={name:"CallWithChatControlBar",docgenInfo:CallWithChatControlBar_CallWithChatControlBar.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/CallWithChatControlBar.tsx"});var compositeOuterContainerStyles={root:{width:"100%",flexWrap:"wrap",position:"relative"}},callCompositeContainerStyles={root:{position:"relative"}},controlBarContainerStyles={root:{position:"relative"}},drawerContainerStyles={root:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1}};__webpack_require__(147);function CallWithChatBackedCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CallWithChatBackedCallAdapter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CallWithChatBackedCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CallWithChatBackedCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var CallWithChatBackedCallAdapter=function CallWithChatBackedCallAdapter(callWithChatAdapter){var _this=this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CallWithChatBackedCallAdapter),this.callWithChatAdapter=void 0,this.eventStore=new Map,this.on=function(event,listener){switch(event){case"error":return _this.callWithChatAdapter.on("callError",listener);case"participantsJoined":return _this.callWithChatAdapter.on("callParticipantsJoined",listener);case"participantsLeft":return _this.callWithChatAdapter.on("callParticipantsLeft",listener);default:return _this.callWithChatAdapter.on(event,listener)}},this.off=function(event,listener){switch(event){case"error":return _this.callWithChatAdapter.off("callError",listener);case"participantsJoined":return _this.callWithChatAdapter.off("callParticipantsJoined",listener);case"participantsLeft":return _this.callWithChatAdapter.off("callParticipantsLeft",listener);default:return _this.callWithChatAdapter.off(event,listener)}},this.onStateChange=function(handler){var convertedHandler=function convertedHandler(state){handler(callAdapterStateFromCallWithChatAdapterState(state))};_this.callWithChatAdapter.onStateChange(convertedHandler),_this.eventStore.set(handler,convertedHandler)},this.offStateChange=function(handler){var convertedHandler=_this.eventStore.get(handler);convertedHandler&&_this.callWithChatAdapter.offStateChange(convertedHandler)},this.getState=function(){return callAdapterStateFromCallWithChatAdapterState(_this.callWithChatAdapter.getState())},this.dispose=function(){return _this.callWithChatAdapter.dispose()},this.joinCall=function(microphoneOn){return _this.callWithChatAdapter.joinCall(microphoneOn)},this.leaveCall=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.callWithChatAdapter.leaveCall();case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee)}))),this.startCall=function(participants){return _this.callWithChatAdapter.startCall(participants)},this.setCamera=function(){var _ref2=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee2(sourceId,options){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this.callWithChatAdapter.setCamera(sourceId,options);case 2:return _context2.abrupt("return",_context2.sent);case 3:case"end":return _context2.stop()}}),_callee2)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}(),this.setMicrophone=function(){var _ref3=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee3(sourceId){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,_this.callWithChatAdapter.setMicrophone(sourceId);case 2:return _context3.abrupt("return",_context3.sent);case 3:case"end":return _context3.stop()}}),_callee3)})));return function(_x3){return _ref3.apply(this,arguments)}}(),this.setSpeaker=function(){var _ref4=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee4(sourceId){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_this.callWithChatAdapter.setSpeaker(sourceId);case 2:return _context4.abrupt("return",_context4.sent);case 3:case"end":return _context4.stop()}}),_callee4)})));return function(_x4){return _ref4.apply(this,arguments)}}(),this.askDevicePermission=function(){var _ref5=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee5(constraints){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,_this.callWithChatAdapter.askDevicePermission(constraints);case 2:return _context5.abrupt("return",_context5.sent);case 3:case"end":return _context5.stop()}}),_callee5)})));return function(_x5){return _ref5.apply(this,arguments)}}(),this.queryCameras=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,_this.callWithChatAdapter.queryCameras();case 2:return _context6.abrupt("return",_context6.sent);case 3:case"end":return _context6.stop()}}),_callee6)}))),this.queryMicrophones=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,_this.callWithChatAdapter.queryMicrophones();case 2:return _context7.abrupt("return",_context7.sent);case 3:case"end":return _context7.stop()}}),_callee7)}))),this.querySpeakers=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,_this.callWithChatAdapter.querySpeakers();case 2:return _context8.abrupt("return",_context8.sent);case 3:case"end":return _context8.stop()}}),_callee8)}))),this.startCamera=function(){var _ref9=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee9(options){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,_this.callWithChatAdapter.startCamera(options);case 2:return _context9.abrupt("return",_context9.sent);case 3:case"end":return _context9.stop()}}),_callee9)})));return function(_x6){return _ref9.apply(this,arguments)}}(),this.stopCamera=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee10(){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,_this.callWithChatAdapter.stopCamera();case 2:return _context10.abrupt("return",_context10.sent);case 3:case"end":return _context10.stop()}}),_callee10)}))),this.mute=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,_this.callWithChatAdapter.mute();case 2:return _context11.abrupt("return",_context11.sent);case 3:case"end":return _context11.stop()}}),_callee11)}))),this.unmute=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee12(){return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return _context12.next=2,_this.callWithChatAdapter.unmute();case 2:return _context12.abrupt("return",_context12.sent);case 3:case"end":return _context12.stop()}}),_callee12)}))),this.startScreenShare=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee13(){return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return _context13.next=2,_this.callWithChatAdapter.startScreenShare();case 2:return _context13.abrupt("return",_context13.sent);case 3:case"end":return _context13.stop()}}),_callee13)}))),this.stopScreenShare=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee14(){return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return _context14.next=2,_this.callWithChatAdapter.stopScreenShare();case 2:return _context14.abrupt("return",_context14.sent);case 3:case"end":return _context14.stop()}}),_callee14)}))),this.removeParticipant=function(){var _ref15=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee15(userId){return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return _context15.next=2,_this.callWithChatAdapter.removeParticipant(userId);case 2:return _context15.abrupt("return",_context15.sent);case 3:case"end":return _context15.stop()}}),_callee15)})));return function(_x7){return _ref15.apply(this,arguments)}}(),this.createStreamView=function(){var _ref16=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee16(remoteUserId,options){return regeneratorRuntime.wrap((function _callee16$(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:return _context16.next=2,_this.callWithChatAdapter.createStreamView(remoteUserId,options);case 2:return _context16.abrupt("return",_context16.sent);case 3:case"end":return _context16.stop()}}),_callee16)})));return function(_x8,_x9){return _ref16.apply(this,arguments)}}(),this.disposeStreamView=function(){var _ref17=CallWithChatBackedCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee17(remoteUserId,options){return regeneratorRuntime.wrap((function _callee17$(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:return _context17.next=2,_this.callWithChatAdapter.disposeStreamView(remoteUserId,options);case 2:return _context17.abrupt("return",_context17.sent);case 3:case"end":return _context17.stop()}}),_callee17)})));return function(_x10,_x11){return _ref17.apply(this,arguments)}}(),this.callWithChatAdapter=callWithChatAdapter};function callAdapterStateFromCallWithChatAdapterState(callWithChatAdapterState){return{isLocalPreviewMicrophoneEnabled:callWithChatAdapterState.isLocalPreviewMicrophoneEnabled,page:callWithChatAdapterState.page,userId:callWithChatAdapterState.userId,displayName:callWithChatAdapterState.displayName,call:callWithChatAdapterState.call,devices:callWithChatAdapterState.devices,isTeamsCall:callWithChatAdapterState.isTeamsCall,latestErrors:callWithChatAdapterState.latestCallErrors}}function CallWithChatBackedChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CallWithChatBackedChatAdapter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CallWithChatBackedChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CallWithChatBackedChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var CallWithChatBackedChatAdapter=function CallWithChatBackedChatAdapter(callWithChatAdapter){var _this=this;!function CallWithChatBackedChatAdapter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CallWithChatBackedChatAdapter),this.callWithChatAdapter=void 0,this.eventStore=new Map,this.fetchInitialData=CallWithChatBackedChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.callWithChatAdapter.fetchInitialData();case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee)}))),this.sendMessage=function(){var _ref2=CallWithChatBackedChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee2(content){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this.callWithChatAdapter.sendMessage(content);case 2:return _context2.abrupt("return",_context2.sent);case 3:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref2.apply(this,arguments)}}(),this.sendReadReceipt=function(){var _ref3=CallWithChatBackedChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee3(chatMessageId){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,_this.callWithChatAdapter.sendReadReceipt(chatMessageId);case 2:return _context3.abrupt("return",_context3.sent);case 3:case"end":return _context3.stop()}}),_callee3)})));return function(_x2){return _ref3.apply(this,arguments)}}(),this.sendTypingIndicator=CallWithChatBackedChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_this.callWithChatAdapter.sendTypingIndicator();case 2:return _context4.abrupt("return",_context4.sent);case 3:case"end":return _context4.stop()}}),_callee4)}))),this.removeParticipant=function(){var _ref5=CallWithChatBackedChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee5(userId){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,_this.callWithChatAdapter.removeParticipant(userId);case 2:return _context5.abrupt("return",_context5.sent);case 3:case"end":return _context5.stop()}}),_callee5)})));return function(_x3){return _ref5.apply(this,arguments)}}(),this.loadPreviousChatMessages=function(){var _ref6=CallWithChatBackedChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee6(messagesToLoad){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,_this.callWithChatAdapter.loadPreviousChatMessages(messagesToLoad);case 2:return _context6.abrupt("return",_context6.sent);case 3:case"end":return _context6.stop()}}),_callee6)})));return function(_x4){return _ref6.apply(this,arguments)}}(),this.dispose=function(){return _this.callWithChatAdapter.dispose()},this.onStateChange=function(handler){var convertedHandler=function convertedHandler(state){handler(chatAdapterStateFromCallWithChatAdapterState(state))};_this.callWithChatAdapter.onStateChange(convertedHandler),_this.eventStore.set(handler,convertedHandler)},this.offStateChange=function(handler){var convertedHandler=_this.eventStore.get(handler);convertedHandler&&_this.callWithChatAdapter.offStateChange(convertedHandler)},this.getState=function(){return chatAdapterStateFromCallWithChatAdapterState(_this.callWithChatAdapter.getState())},this.on=function(event,listener){switch(event){case"error":return _this.callWithChatAdapter.on("chatError",listener);case"participantsAdded":return _this.callWithChatAdapter.on("chatParticipantsAdded",listener);case"participantsRemoved":return _this.callWithChatAdapter.on("chatParticipantsRemoved",listener);default:return _this.callWithChatAdapter.on(event,listener)}},this.off=function(event,listener){switch(event){case"error":return _this.callWithChatAdapter.off("chatError",listener);case"participantsAdded":return _this.callWithChatAdapter.off("chatParticipantsAdded",listener);case"participantsRemoved":return _this.callWithChatAdapter.off("chatParticipantsRemoved",listener);default:return _this.callWithChatAdapter.off(event,listener)}},this.updateMessage=function(){var _ref7=CallWithChatBackedChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee7(messageId,content){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,_this.callWithChatAdapter.updateMessage(messageId,content);case 2:return _context7.abrupt("return",_context7.sent);case 3:case"end":return _context7.stop()}}),_callee7)})));return function(_x5,_x6){return _ref7.apply(this,arguments)}}(),this.deleteMessage=function(){var _ref8=CallWithChatBackedChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee8(messageId){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,_this.callWithChatAdapter.deleteMessage(messageId);case 2:return _context8.abrupt("return",_context8.sent);case 3:case"end":return _context8.stop()}}),_callee8)})));return function(_x7){return _ref8.apply(this,arguments)}}(),this.clearErrors=function(errorTypes){throw new Error("Method not supported in CallWithChatComposite.")},this.setTopic=function(){var _ref9=CallWithChatBackedChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee9(topicName){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:throw new Error("Chat Topics are not supported in CallWithChatComposite.");case 1:case"end":return _context9.stop()}}),_callee9)})));return function(_x8){return _ref9.apply(this,arguments)}}(),this.callWithChatAdapter=callWithChatAdapter};function chatAdapterStateFromCallWithChatAdapterState(callWithChatAdapterState){if(!callWithChatAdapterState.chat)throw new Error("Chat thread state id undefined.");return{userId:callWithChatAdapterState.userId,displayName:callWithChatAdapterState.displayName||"",thread:callWithChatAdapterState.chat,latestErrors:callWithChatAdapterState.latestChatErrors,fileUploads:callWithChatAdapterState.fileUploads}}var BaseComposite=__webpack_require__(310),ChatAdapterProvider=__webpack_require__(163),MoreDrawer_MoreDrawer=(__webpack_require__(115),__webpack_require__(34),function MoreDrawer(props){var _props$selectedSpeake,drawerMenuItems=[],onSelectSpeaker=Object(react.useCallback)((function(_ev,itemKey){var _props$speakers,selected=null===(_props$speakers=props.speakers)||void 0===_props$speakers?void 0:_props$speakers.find((function(speaker){return speaker.id===itemKey}));selected&&props.onSelectSpeaker(selected)}),[props.speakers,props.onSelectSpeaker]);props.speakers&&props.speakers.length>0&&drawerMenuItems.push({itemKey:"speakers",text:props.strings.speakerMenuTitle,iconProps:{iconName:"MoreDrawerSpeakers"},subMenuProps:props.speakers.map((function(speaker){return{itemKey:speaker.id,iconProps:{iconName:isDeviceSelected(speaker,props.selectedSpeaker)?"MoreDrawerSelectedSpeaker":"MoreDrawerSpeakers"},text:speaker.name,onItemClick:onSelectSpeaker,secondaryIconProps:isDeviceSelected(speaker,props.selectedSpeaker)?{iconName:"Accept"}:void 0}})),secondaryText:null===(_props$selectedSpeake=props.selectedSpeaker)||void 0===_props$selectedSpeake?void 0:_props$selectedSpeake.name});var _props$selectedMicrop,onSelectMicrophone=Object(react.useCallback)((function(_ev,itemKey){var _props$microphones,selected=null===(_props$microphones=props.microphones)||void 0===_props$microphones?void 0:_props$microphones.find((function(mic){return mic.id===itemKey}));selected&&props.onSelectMicrophone(selected)}),[props.microphones,props.onSelectMicrophone]);props.microphones&&props.microphones.length>0&&drawerMenuItems.push({itemKey:"microphones",text:props.strings.microphoneMenuTitle,iconProps:{iconName:"MoreDrawerMicrophones"},subMenuProps:props.microphones.map((function(mic){return{itemKey:mic.id,iconProps:{iconName:isDeviceSelected(mic,props.selectedMicrophone)?"MoreDrawerSelectedMicrophone":"MoreDrawerMicrophones"},text:mic.name,onItemClick:onSelectMicrophone,secondaryIconProps:isDeviceSelected(mic,props.selectedMicrophone)?{iconName:"Accept"}:void 0}})),secondaryText:null===(_props$selectedMicrop=props.selectedMicrophone)||void 0===_props$selectedMicrop?void 0:_props$selectedMicrop.name});return drawerMenuItems.push({itemKey:"people",text:props.strings.peopleButtonLabel,iconProps:{iconName:"MoreDrawerPeople"},onItemClick:props.onPeopleButtonClicked}),Object(jsx_runtime.jsx)(src.L,{items:drawerMenuItems,onLightDismiss:props.onLightDismiss})});MoreDrawer_MoreDrawer.displayName="MoreDrawer";var isDeviceSelected=function isDeviceSelected(speaker,selectedSpeaker){return!!selectedSpeaker&&speaker.id===selectedSpeaker.id};MoreDrawer_MoreDrawer.__docgenInfo={description:"@private",methods:[],displayName:"MoreDrawer",props:{microphones:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available microphones for selection"},speakers:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available speakers for selection"},selectedMicrophone:{required:!1,tsType:{name:"OptionsDevice"},description:"Microphone that is shown as currently selected"},selectedSpeaker:{required:!1,tsType:{name:"OptionsDevice"},description:"Speaker that is shown as currently selected"},onSelectSpeaker:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: AudioDeviceInfo) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"AudioDeviceInfo"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Speaker when a speaker is selected"},onSelectMicrophone:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: AudioDeviceInfo) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"AudioDeviceInfo"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback when a microphone is selected"},onLightDismiss:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPeopleButtonClicked:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},strings:{required:!0,tsType:{name:"MoreDrawerStrings"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/components/MoreDrawer.tsx"]={name:"MoreDrawer",docgenInfo:MoreDrawer_MoreDrawer.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/components/MoreDrawer.tsx"});var es=__webpack_require__(50),baseSelectors=__webpack_require__(67),moreDrawerSelector=es.a([baseSelectors.b],(function(deviceManager){return{microphones:deviceManager.microphones,speakers:deviceManager.speakers,selectedMicrophone:deviceManager.selectedMicrophone,selectedSpeaker:deviceManager.selectedSpeaker}})),useSelector=__webpack_require__(87),useHandlers=__webpack_require__(142),PreparedMoreDrawer_PreparedMoreDrawer=function PreparedMoreDrawer(props){var strings=useCallWithChatCompositeStrings_useCallWithChatCompositeStrings(),moreDrawerStrings=Object(react.useMemo)((function(){return{peopleButtonLabel:strings.peopleButtonLabel,microphoneMenuTitle:strings.moreDrawerMicrophoneMenuTitle,speakerMenuTitle:strings.moreDrawerSpeakerMenuTitle}}),[strings]),deviceProps=Object(useSelector.a)(moreDrawerSelector),callHandlers=Object(useHandlers.a)(MoreDrawer_MoreDrawer);return Object(jsx_runtime.jsx)(MoreDrawer_MoreDrawer,Object.assign({},props,deviceProps,callHandlers,{strings:moreDrawerStrings}))};function CallWithChatComposite_slicedToArray(arr,i){return function CallWithChatComposite_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallWithChatComposite_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CallWithChatComposite_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallWithChatComposite_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallWithChatComposite_arrayLikeToArray(o,minLen)}(arr,i)||function CallWithChatComposite_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallWithChatComposite_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}PreparedMoreDrawer_PreparedMoreDrawer.displayName="PreparedMoreDrawer",PreparedMoreDrawer_PreparedMoreDrawer.__docgenInfo={description:"@private",methods:[],displayName:"PreparedMoreDrawer",props:{onLightDismiss:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPeopleButtonClicked:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/PreparedMoreDrawer.tsx"]={name:"PreparedMoreDrawer",docgenInfo:PreparedMoreDrawer_PreparedMoreDrawer.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/PreparedMoreDrawer.tsx"});var CallWithChatComposite_CallWithChatScreen=function CallWithChatScreen(props){var callWithChatAdapter=props.callWithChatAdapter,fluentTheme=props.fluentTheme,_props$formFactor=props.formFactor,formFactor=void 0===_props$formFactor?"desktop":_props$formFactor,isMobile="mobile"===formFactor;if(!callWithChatAdapter)throw new Error("CallWithChatAdapter is undefined");var callAdapter=Object(react.useMemo)((function(){return new CallWithChatBackedCallAdapter(callWithChatAdapter)}),[callWithChatAdapter]),_useState2=CallWithChatComposite_slicedToArray(Object(react.useState)(),2),currentCallState=_useState2[0],setCurrentCallState=_useState2[1],_useState4=CallWithChatComposite_slicedToArray(Object(react.useState)(),2),currentPage=_useState4[0],setCurrentPage=_useState4[1],_useState6=CallWithChatComposite_slicedToArray(Object(react.useState)(!1),2),showChat=_useState6[0],setShowChat=_useState6[1],_useState8=CallWithChatComposite_slicedToArray(Object(react.useState)(!1),2),showPeople=_useState8[0],setShowPeople=_useState8[1];Object(react.useEffect)((function(){var updateCallWithChatPage=function updateCallWithChatPage(newState){var _newState$call;setCurrentPage(newState.page),setCurrentCallState(null===(_newState$call=newState.call)||void 0===_newState$call?void 0:_newState$call.state)};return callWithChatAdapter.onStateChange(updateCallWithChatPage),function(){callWithChatAdapter.offStateChange(updateCallWithChatPage)}}),[callWithChatAdapter]);var closePane=Object(react.useCallback)((function(){setShowChat(!1),setShowPeople(!1)}),[]),toggleChat=Object(react.useCallback)((function(){setShowPeople(!1),setShowChat(!showChat)}),[showChat]),togglePeople=Object(react.useCallback)((function(){setShowChat(!1),setShowPeople(!showPeople)}),[showPeople]),_useState10=CallWithChatComposite_slicedToArray(Object(react.useState)(!1),2),showDrawer=_useState10[0],setShowDrawer=_useState10[1],onMoreButtonClicked=Object(react.useCallback)((function(){closePane(),setShowDrawer(!0)}),[]),closeDrawer=Object(react.useCallback)((function(){setShowDrawer(!1)}),[]),onMoreDrawerPeopleClicked=Object(react.useCallback)((function(){setShowDrawer(!1),togglePeople()}),[]),selectPeople=Object(react.useCallback)((function(){setShowPeople(!0),setShowChat(!1)}),[]),selectChat=Object(react.useCallback)((function(){setShowChat(!0),setShowPeople(!1)}),[]),chatProps=Object(react.useMemo)((function(){return{adapter:new CallWithChatBackedChatAdapter(callWithChatAdapter)}}),[callWithChatAdapter]),isInLobbyOrConnecting="lobby"===currentPage,hasJoinedCall=!(!currentPage||!hasJoinedCallFn(currentPage,null!=currentCallState?currentCallState:"None")),showControlBar=isInLobbyOrConnecting||hasJoinedCall,showMobilePane=isMobile&&(showChat||showPeople);return Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,grow:!0,styles:compositeOuterContainerStyles,children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,grow:!0,children:[!showMobilePane&&Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,styles:callCompositeContainerStyles,children:Object(jsx_runtime.jsx)(CallComposite.CallComposite,Object.assign({},props,{formFactor:formFactor,options:{callControls:!1},adapter:callAdapter,fluentTheme:fluentTheme}))}),chatProps.adapter&&hasJoinedCall&&Object(jsx_runtime.jsx)(EmbeddedChatPane_EmbeddedChatPane,{chatCompositeProps:chatProps,hidden:!showChat,chatAdapter:chatProps.adapter,fluentTheme:fluentTheme,onClose:closePane,onFetchAvatarPersonaData:props.onFetchAvatarPersonaData,onChatButtonClick:selectChat,onPeopleButtonClick:selectPeople,mobileView:isMobile}),callAdapter&&chatProps.adapter&&hasJoinedCall&&Object(jsx_runtime.jsx)(CallAdapterProvider.a,{adapter:callAdapter,children:Object(jsx_runtime.jsx)(EmbeddedPeoplePane_EmbeddedPeoplePane,{hidden:!showPeople,inviteLink:props.joinInvitationURL,onClose:closePane,chatAdapter:chatProps.adapter,callAdapter:callAdapter,onFetchAvatarPersonaData:props.onFetchAvatarPersonaData,onChatButtonClick:selectChat,onPeopleButtonClick:selectPeople,mobileView:isMobile})})]}),showControlBar&&!showMobilePane&&Object(jsx_runtime.jsx)(ChatAdapterProvider.a,{adapter:chatProps.adapter,children:Object(jsx_runtime.jsx)(Stack.a.Item,{styles:controlBarContainerStyles,children:Object(jsx_runtime.jsx)(CallWithChatControlBar_CallWithChatControlBar,{callAdapter:callAdapter,chatAdapter:chatProps.adapter,chatButtonChecked:showChat,onChatButtonClicked:toggleChat,peopleButtonChecked:showPeople,onPeopleButtonClicked:togglePeople,onMoreButtonClicked:onMoreButtonClicked,mobileView:"mobile"===props.formFactor,disableButtonsForLobbyPage:isInLobbyOrConnecting,callControls:props.callControls})})}),showControlBar&&showDrawer&&Object(jsx_runtime.jsx)(ChatAdapterProvider.a,{adapter:chatProps.adapter,children:Object(jsx_runtime.jsx)(CallAdapterProvider.a,{adapter:callAdapter,children:Object(jsx_runtime.jsx)(Stack.a,{styles:drawerContainerStyles,children:Object(jsx_runtime.jsx)(PreparedMoreDrawer_PreparedMoreDrawer,{onLightDismiss:closeDrawer,onPeopleButtonClicked:onMoreDrawerPeopleClicked})})})})]})};CallWithChatComposite_CallWithChatScreen.displayName="CallWithChatScreen";var CallWithChatComposite_CallWithChatComposite=function CallWithChatComposite(props){var callWithChatAdapter=props.callWithChatAdapter,fluentTheme=props.fluentTheme,formFactor=props.formFactor,joinInvitationURL=props.joinInvitationURL,options=props.options;return Object(jsx_runtime.jsx)(BaseComposite.a,{fluentTheme:fluentTheme,locale:props.locale,icons:props.icons,children:Object(jsx_runtime.jsx)(CallWithChatComposite_CallWithChatScreen,Object.assign({},props,{callWithChatAdapter:callWithChatAdapter,formFactor:formFactor,callControls:null==options?void 0:options.callControls,joinInvitationURL:joinInvitationURL,fluentTheme:fluentTheme}))})};CallWithChatComposite_CallWithChatComposite.displayName="CallWithChatComposite";var hasJoinedCallFn=function hasJoinedCallFn(page,callStatus){return"call"===page&&"Connected"===callStatus};CallWithChatComposite_CallWithChatComposite.__docgenInfo={description:"CallWithChatComposite brings together key components to provide a full call with chat experience out of the box.\n\n@beta",methods:[],displayName:"CallWithChatComposite",props:{callWithChatAdapter:{required:!0,tsType:{name:"CallWithChatAdapter"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Fluent theme for the composite.\n\nDefaults to a light theme if undefined."},formFactor:{required:!1,tsType:{name:"union",raw:"'desktop' | 'mobile'",elements:[{name:"literal",value:"'desktop'"},{name:"literal",value:"'mobile'"}]},description:"Optimizes the composite form factor for either desktop or mobile.\n@remarks `mobile` is currently only optimized for Portrait mode on mobile devices and does not support landscape.\n@defaultValue 'desktop'\n@beta"},joinInvitationURL:{required:!1,tsType:{name:"string"},description:"URL that can be used to copy a call-with-chat invite to the Users clipboard."},options:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  /**\n   * Call control options to change what buttons show on the call-with-chat composite control bar.\n   * If using the boolean values, true will cause default behavior across the whole control bar. False hides the whole control bar.\n   */\n  callControls?: boolean | CallWithChatControlOptions;\n}",signature:{properties:[{key:"callControls",value:{name:"union",raw:"boolean | CallWithChatControlOptions",elements:[{name:"boolean"},{name:"CallWithChatControlOptions"}],required:!1}}]}},description:"Flags to enable/disable or customize UI elements of the {@link CallWithChatComposite}"}},composes:["BaseCompositeProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallWithChatComposite/CallWithChatComposite.tsx"]={name:"CallWithChatComposite",docgenInfo:CallWithChatComposite_CallWithChatComposite.__docgenInfo,path:"../react-composites/src/composites/CallWithChatComposite/CallWithChatComposite.tsx"});__webpack_require__(97),__webpack_require__(47);var AzureCommunicationChatAdapter=__webpack_require__(301),events=__webpack_require__(133),getChatThreadFromTeamsLink=(__webpack_require__(104),__webpack_require__(56),__webpack_require__(113),function getChatThreadFromTeamsLink(teamsMeetingLink){var threadId=teamsMeetingLink.replace("https://teams.microsoft.com/l/meetup-join/","");if(!(threadId=(threadId=decodeURIComponent(threadId)).split(/^(.*?@thread\.v2)/gm)[1])||0===threadId.length)throw new Error("Could not get chat thread from teams link");return threadId});__webpack_require__(359);function AzureCommunicationCallWithChatAdapter_slicedToArray(arr,i){return function AzureCommunicationCallWithChatAdapter_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function AzureCommunicationCallWithChatAdapter_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function AzureCommunicationCallWithChatAdapter_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return AzureCommunicationCallWithChatAdapter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AzureCommunicationCallWithChatAdapter_arrayLikeToArray(o,minLen)}(arr,i)||function AzureCommunicationCallWithChatAdapter_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AzureCommunicationCallWithChatAdapter_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AzureCommunicationCallWithChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function AzureCommunicationCallWithChatAdapter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){AzureCommunicationCallWithChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){AzureCommunicationCallWithChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function AzureCommunicationCallWithChatAdapter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}var AzureCommunicationCallWithChatAdapter_CallWithChatContext=function(){function CallWithChatContext(clientState){AzureCommunicationCallWithChatAdapter_classCallCheck(this,CallWithChatContext),this.emitter=new events.EventEmitter,this.state=void 0,this.state=clientState}return _createClass(CallWithChatContext,[{key:"onStateChange",value:function onStateChange(handler){this.emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this.emitter.off("stateChanged",handler)}},{key:"setState",value:function setState(state){this.state=state,this.emitter.emit("stateChanged",this.state)}},{key:"getState",value:function getState(){return this.state}},{key:"updateClientState",value:function updateClientState(clientState){this.setState(clientState)}},{key:"updateClientStateWithChatState",value:function updateClientStateWithChatState(chatAdapterState){this.updateClientState(function mergeChatAdapterStateIntoCallWithChatAdapterState(existingCallWithChatAdapterState,chatAdapterState){return Object.assign({},existingCallWithChatAdapterState,{chat:chatAdapterState.thread,latestChatErrors:chatAdapterState.latestErrors,fileUploads:chatAdapterState.fileUploads})}(this.state,chatAdapterState))}},{key:"updateClientStateWithCallState",value:function updateClientStateWithCallState(callAdapterState){this.updateClientState(function mergeCallAdapterStateIntoCallWithChatAdapterState(existingCallWithChatAdapterState,callAdapterState){return Object.assign({},existingCallWithChatAdapterState,{userId:callAdapterState.userId,page:callAdapterState.page,displayName:callAdapterState.displayName,devices:callAdapterState.devices,call:callAdapterState.call,isLocalPreviewMicrophoneEnabled:callAdapterState.isLocalPreviewMicrophoneEnabled,isTeamsCall:callAdapterState.isTeamsCall,latestCallErrors:callAdapterState.latestErrors})}(this.state,callAdapterState))}}]),CallWithChatContext}(),AzureCommunicationCallWithChatAdapter_AzureCommunicationCallWithChatAdapter=function(){function AzureCommunicationCallWithChatAdapter(callAdapter,chatAdapter){var _this=this;AzureCommunicationCallWithChatAdapter_classCallCheck(this,AzureCommunicationCallWithChatAdapter),this.callAdapter=void 0,this.chatAdapter=void 0,this.context=void 0,this.onChatStateChange=void 0,this.onCallStateChange=void 0,this.bindPublicMethods(),this.callAdapter=callAdapter,this.chatAdapter=chatAdapter,this.context=new AzureCommunicationCallWithChatAdapter_CallWithChatContext(function callWithChatAdapterStateFromBackingStates(callAdapter,chatAdapter){var callAdapterState=callAdapter.getState(),chatAdapterState=chatAdapter.getState();return{call:callAdapterState.call,chat:chatAdapterState.thread,userId:callAdapterState.userId,page:callAdapterState.page,displayName:callAdapterState.displayName,devices:callAdapterState.devices,isLocalPreviewMicrophoneEnabled:callAdapterState.isLocalPreviewMicrophoneEnabled,isTeamsCall:callAdapterState.isTeamsCall,latestCallErrors:callAdapterState.latestErrors,latestChatErrors:chatAdapterState.latestErrors,fileUploads:chatAdapterState.fileUploads}}(callAdapter,chatAdapter));var onChatStateChange=function onChatStateChange(newChatAdapterState){_this.context.updateClientStateWithChatState(newChatAdapterState)};this.chatAdapter.onStateChange(onChatStateChange),this.onChatStateChange=onChatStateChange;var onCallStateChange=function onCallStateChange(newCallAdapterState){_this.context.updateClientStateWithCallState(newCallAdapterState)};this.callAdapter.onStateChange(onCallStateChange),this.onCallStateChange=onCallStateChange}var _deleteMessage,_updateMessage,_loadPreviousChatMessages,_sendTypingIndicator,_sendReadReceipt,_sendMessage,_fetchInitialData,_disposeStreamView,_createStreamView,_stopScreenShare,_startScreenShare,_unmute,_mute,_stopCamera,_startCamera,_querySpeakers,_queryMicrophones,_queryCameras,_askDevicePermission,_setSpeaker,_setMicrophone,_setCamera,_removeParticipant,_leaveCall;return _createClass(AzureCommunicationCallWithChatAdapter,[{key:"bindPublicMethods",value:function bindPublicMethods(){this.joinCall.bind(this),this.leaveCall.bind(this),this.startCall.bind(this),this.onStateChange.bind(this),this.offStateChange.bind(this),this.getState.bind(this),this.dispose.bind(this),this.setCamera.bind(this),this.setMicrophone.bind(this),this.setSpeaker.bind(this),this.askDevicePermission.bind(this),this.queryCameras.bind(this),this.queryMicrophones.bind(this),this.querySpeakers.bind(this),this.startCamera.bind(this),this.stopCamera.bind(this),this.mute.bind(this),this.unmute.bind(this),this.startScreenShare.bind(this),this.stopScreenShare.bind(this),this.removeParticipant.bind(this),this.createStreamView.bind(this),this.disposeStreamView.bind(this),this.fetchInitialData.bind(this),this.sendMessage.bind(this),this.sendReadReceipt.bind(this),this.sendTypingIndicator.bind(this),this.loadPreviousChatMessages.bind(this),this.updateMessage.bind(this),this.deleteMessage.bind(this),this.on.bind(this),this.off.bind(this)}},{key:"joinCall",value:function joinCall(microphoneOn){return this.callAdapter.joinCall(microphoneOn)}},{key:"leaveCall",value:(_leaveCall=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.callAdapter.leaveCall();case 2:case"end":return _context.stop()}}),_callee,this)}))),function leaveCall(){return _leaveCall.apply(this,arguments)})},{key:"startCall",value:function startCall(participants){return this.callAdapter.startCall(participants)}},{key:"onStateChange",value:function onStateChange(handler){this.context.onStateChange(handler)}},{key:"offStateChange",value:function offStateChange(handler){this.context.offStateChange(handler)}},{key:"getState",value:function getState(){return this.context.getState()}},{key:"dispose",value:function dispose(){this.chatAdapter.offStateChange(this.onChatStateChange),this.callAdapter.offStateChange(this.onCallStateChange),this.chatAdapter.dispose(),this.callAdapter.dispose()}},{key:"removeParticipant",value:(_removeParticipant=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee2(userId){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.callAdapter.removeParticipant(userId);case 2:case"end":return _context2.stop()}}),_callee2,this)}))),function removeParticipant(_x){return _removeParticipant.apply(this,arguments)})},{key:"setCamera",value:(_setCamera=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee3(device,options){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,this.callAdapter.setCamera(device,options);case 2:case"end":return _context3.stop()}}),_callee3,this)}))),function setCamera(_x2,_x3){return _setCamera.apply(this,arguments)})},{key:"setMicrophone",value:(_setMicrophone=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee4(device){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,this.callAdapter.setMicrophone(device);case 2:case"end":return _context4.stop()}}),_callee4,this)}))),function setMicrophone(_x4){return _setMicrophone.apply(this,arguments)})},{key:"setSpeaker",value:(_setSpeaker=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee5(device){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,this.callAdapter.setSpeaker(device);case 2:case"end":return _context5.stop()}}),_callee5,this)}))),function setSpeaker(_x5){return _setSpeaker.apply(this,arguments)})},{key:"askDevicePermission",value:(_askDevicePermission=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee6(constraints){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,this.callAdapter.askDevicePermission(constraints);case 2:case"end":return _context6.stop()}}),_callee6,this)}))),function askDevicePermission(_x6){return _askDevicePermission.apply(this,arguments)})},{key:"queryCameras",value:(_queryCameras=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,this.callAdapter.queryCameras();case 2:return _context7.abrupt("return",_context7.sent);case 3:case"end":return _context7.stop()}}),_callee7,this)}))),function queryCameras(){return _queryCameras.apply(this,arguments)})},{key:"queryMicrophones",value:(_queryMicrophones=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,this.callAdapter.queryMicrophones();case 2:return _context8.abrupt("return",_context8.sent);case 3:case"end":return _context8.stop()}}),_callee8,this)}))),function queryMicrophones(){return _queryMicrophones.apply(this,arguments)})},{key:"querySpeakers",value:(_querySpeakers=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,this.callAdapter.querySpeakers();case 2:return _context9.abrupt("return",_context9.sent);case 3:case"end":return _context9.stop()}}),_callee9,this)}))),function querySpeakers(){return _querySpeakers.apply(this,arguments)})},{key:"startCamera",value:(_startCamera=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee10(options){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,this.callAdapter.startCamera(options);case 2:case"end":return _context10.stop()}}),_callee10,this)}))),function startCamera(_x7){return _startCamera.apply(this,arguments)})},{key:"stopCamera",value:(_stopCamera=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,this.callAdapter.stopCamera();case 2:case"end":return _context11.stop()}}),_callee11,this)}))),function stopCamera(){return _stopCamera.apply(this,arguments)})},{key:"mute",value:(_mute=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee12(){return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return _context12.next=2,this.callAdapter.mute();case 2:case"end":return _context12.stop()}}),_callee12,this)}))),function mute(){return _mute.apply(this,arguments)})},{key:"unmute",value:(_unmute=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee13(){return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return _context13.next=2,this.callAdapter.unmute();case 2:case"end":return _context13.stop()}}),_callee13,this)}))),function unmute(){return _unmute.apply(this,arguments)})},{key:"startScreenShare",value:(_startScreenShare=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee14(){return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return _context14.next=2,this.callAdapter.startScreenShare();case 2:case"end":return _context14.stop()}}),_callee14,this)}))),function startScreenShare(){return _startScreenShare.apply(this,arguments)})},{key:"stopScreenShare",value:(_stopScreenShare=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee15(){return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return _context15.next=2,this.callAdapter.stopScreenShare();case 2:case"end":return _context15.stop()}}),_callee15,this)}))),function stopScreenShare(){return _stopScreenShare.apply(this,arguments)})},{key:"createStreamView",value:(_createStreamView=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee16(remoteUserId,options){return regeneratorRuntime.wrap((function _callee16$(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:return _context16.next=2,this.callAdapter.createStreamView(remoteUserId,options);case 2:case"end":return _context16.stop()}}),_callee16,this)}))),function createStreamView(_x8,_x9){return _createStreamView.apply(this,arguments)})},{key:"disposeStreamView",value:(_disposeStreamView=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee17(remoteUserId,options){return regeneratorRuntime.wrap((function _callee17$(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:return _context17.next=2,this.callAdapter.disposeStreamView(remoteUserId,options);case 2:case"end":return _context17.stop()}}),_callee17,this)}))),function disposeStreamView(_x10,_x11){return _disposeStreamView.apply(this,arguments)})},{key:"fetchInitialData",value:(_fetchInitialData=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee18(){return regeneratorRuntime.wrap((function _callee18$(_context18){for(;;)switch(_context18.prev=_context18.next){case 0:return _context18.next=2,this.chatAdapter.fetchInitialData();case 2:case"end":return _context18.stop()}}),_callee18,this)}))),function fetchInitialData(){return _fetchInitialData.apply(this,arguments)})},{key:"sendMessage",value:(_sendMessage=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee19(content){return regeneratorRuntime.wrap((function _callee19$(_context19){for(;;)switch(_context19.prev=_context19.next){case 0:return _context19.next=2,this.chatAdapter.sendMessage(content);case 2:case"end":return _context19.stop()}}),_callee19,this)}))),function sendMessage(_x12){return _sendMessage.apply(this,arguments)})},{key:"sendReadReceipt",value:(_sendReadReceipt=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee20(chatMessageId){return regeneratorRuntime.wrap((function _callee20$(_context20){for(;;)switch(_context20.prev=_context20.next){case 0:return _context20.next=2,this.chatAdapter.sendReadReceipt(chatMessageId);case 2:case"end":return _context20.stop()}}),_callee20,this)}))),function sendReadReceipt(_x13){return _sendReadReceipt.apply(this,arguments)})},{key:"sendTypingIndicator",value:(_sendTypingIndicator=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee21(){return regeneratorRuntime.wrap((function _callee21$(_context21){for(;;)switch(_context21.prev=_context21.next){case 0:return _context21.next=2,this.chatAdapter.sendTypingIndicator();case 2:case"end":return _context21.stop()}}),_callee21,this)}))),function sendTypingIndicator(){return _sendTypingIndicator.apply(this,arguments)})},{key:"loadPreviousChatMessages",value:(_loadPreviousChatMessages=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee22(messagesToLoad){return regeneratorRuntime.wrap((function _callee22$(_context22){for(;;)switch(_context22.prev=_context22.next){case 0:return _context22.next=2,this.chatAdapter.loadPreviousChatMessages(messagesToLoad);case 2:return _context22.abrupt("return",_context22.sent);case 3:case"end":return _context22.stop()}}),_callee22,this)}))),function loadPreviousChatMessages(_x14){return _loadPreviousChatMessages.apply(this,arguments)})},{key:"updateMessage",value:(_updateMessage=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee23(messageId,content){return regeneratorRuntime.wrap((function _callee23$(_context23){for(;;)switch(_context23.prev=_context23.next){case 0:return _context23.next=2,this.chatAdapter.updateMessage(messageId,content);case 2:return _context23.abrupt("return",_context23.sent);case 3:case"end":return _context23.stop()}}),_callee23,this)}))),function updateMessage(_x15,_x16){return _updateMessage.apply(this,arguments)})},{key:"deleteMessage",value:(_deleteMessage=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee24(messageId){return regeneratorRuntime.wrap((function _callee24$(_context24){for(;;)switch(_context24.prev=_context24.next){case 0:return _context24.next=2,this.chatAdapter.deleteMessage(messageId);case 2:return _context24.abrupt("return",_context24.sent);case 3:case"end":return _context24.stop()}}),_callee24,this)}))),function deleteMessage(_x17){return _deleteMessage.apply(this,arguments)})},{key:"on",value:function on(event,listener){switch(event){case"callParticipantsJoined":this.callAdapter.on("participantsJoined",listener);break;case"callParticipantsLeft":this.callAdapter.on("participantsLeft",listener);break;case"callEnded":this.callAdapter.on("callEnded",listener);break;case"isMutedChanged":this.callAdapter.on("isMutedChanged",listener);break;case"callIdChanged":this.callAdapter.on("callIdChanged",listener);break;case"isLocalScreenSharingActiveChanged":this.callAdapter.on("isLocalScreenSharingActiveChanged",listener);break;case"displayNameChanged":this.callAdapter.on("displayNameChanged",listener);break;case"isSpeakingChanged":this.callAdapter.on("isSpeakingChanged",listener);break;case"messageReceived":this.chatAdapter.on("messageReceived",listener);break;case"messageSent":this.chatAdapter.on("messageSent",listener);break;case"messageRead":this.chatAdapter.on("messageRead",listener);break;case"chatParticipantsAdded":this.chatAdapter.on("participantsAdded",listener);break;case"chatParticipantsRemoved":this.chatAdapter.on("participantsRemoved",listener);break;case"callError":this.callAdapter.on("error",listener);break;case"chatError":this.chatAdapter.on("error",listener);break;default:throw"Unknown AzureCommunicationCallWithChatAdapter Event: "+event}}},{key:"off",value:function off(event,listener){switch(event){case"callParticipantsJoined":this.callAdapter.off("participantsJoined",listener);break;case"callParticipantsLeft":this.callAdapter.off("participantsLeft",listener);break;case"callEnded":this.callAdapter.off("callEnded",listener);break;case"isMutedChanged":this.callAdapter.off("isMutedChanged",listener);break;case"callIdChanged":this.callAdapter.off("callIdChanged",listener);break;case"isLocalScreenSharingActiveChanged":this.callAdapter.off("isLocalScreenSharingActiveChanged",listener);break;case"displayNameChanged":this.callAdapter.off("displayNameChanged",listener);break;case"isSpeakingChanged":this.callAdapter.off("isSpeakingChanged",listener);break;case"messageReceived":this.chatAdapter.off("messageReceived",listener);break;case"messageSent":this.chatAdapter.off("messageSent",listener);break;case"messageRead":this.chatAdapter.off("messageRead",listener);break;case"chatParticipantsAdded":this.chatAdapter.off("participantsAdded",listener);break;case"chatParticipantsRemoved":this.chatAdapter.off("participantsRemoved",listener);break;case"callError":this.callAdapter.off("error",listener);break;case"chatError":this.chatAdapter.off("error",listener);break;default:throw"Unknown AzureCommunicationCallWithChatAdapter Event: "+event}}}]),AzureCommunicationCallWithChatAdapter}(),createAzureCommunicationCallWithChatAdapter=function(){var _ref2=AzureCommunicationCallWithChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee25(_ref){var userId,displayName,credential,endpoint,locator,callAdapterLocator,createCallAdapterPromise,threadId,createChatAdapterPromise,_yield$Promise$all,_yield$Promise$all2,callAdapter,chatAdapter;return regeneratorRuntime.wrap((function _callee25$(_context25){for(;;)switch(_context25.prev=_context25.next){case 0:return userId=_ref.userId,displayName=_ref.displayName,credential=_ref.credential,endpoint=_ref.endpoint,locator=_ref.locator,callAdapterLocator=isTeamsMeetingLinkLocator(locator)?locator:locator.callLocator,createCallAdapterPromise=Object(CallComposite.createAzureCommunicationCallAdapter)({userId:userId,displayName:displayName,credential:credential,locator:callAdapterLocator}),threadId=isTeamsMeetingLinkLocator(locator)?getChatThreadFromTeamsLink(locator.meetingLink):locator.chatThreadId,createChatAdapterPromise=Object(AzureCommunicationChatAdapter.a)({endpoint:endpoint,userId:userId,displayName:displayName,credential:credential,threadId:threadId}),_context25.next=7,Promise.all([createCallAdapterPromise,createChatAdapterPromise]);case 7:return _yield$Promise$all=_context25.sent,_yield$Promise$all2=AzureCommunicationCallWithChatAdapter_slicedToArray(_yield$Promise$all,2),callAdapter=_yield$Promise$all2[0],chatAdapter=_yield$Promise$all2[1],_context25.abrupt("return",new AzureCommunicationCallWithChatAdapter_AzureCommunicationCallWithChatAdapter(callAdapter,chatAdapter));case 12:case"end":return _context25.stop()}}),_callee25)})));return function createAzureCommunicationCallWithChatAdapter(_x18){return _ref2.apply(this,arguments)}}(),isTeamsMeetingLinkLocator=function isTeamsMeetingLinkLocator(locator){return"meetingLink"in locator}},436:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return COMPONENT_LOCALE_EN_US})),__webpack_require__.d(__webpack_exports__,"b",(function(){return COMPONENT_LOCALE_EN_GB})),__webpack_require__.d(__webpack_exports__,"a",(function(){return COMPONENT_LOCALE_DE_DE})),__webpack_require__.d(__webpack_exports__,"d",(function(){return COMPONENT_LOCALE_ES_ES})),__webpack_require__.d(__webpack_exports__,"e",(function(){return COMPONENT_LOCALE_FR_FR})),__webpack_require__.d(__webpack_exports__,"f",(function(){return COMPONENT_LOCALE_IT_IT})),__webpack_require__.d(__webpack_exports__,"g",(function(){return COMPONENT_LOCALE_JA_JP})),__webpack_require__.d(__webpack_exports__,"h",(function(){return COMPONENT_LOCALE_KO_KR})),__webpack_require__.d(__webpack_exports__,"i",(function(){return COMPONENT_LOCALE_NL_NL})),__webpack_require__.d(__webpack_exports__,"j",(function(){return COMPONENT_LOCALE_PT_BR})),__webpack_require__.d(__webpack_exports__,"k",(function(){return COMPONENT_LOCALE_RU_RU})),__webpack_require__.d(__webpack_exports__,"l",(function(){return COMPONENT_LOCALE_TR_TR})),__webpack_require__.d(__webpack_exports__,"m",(function(){return COMPONENT_LOCALE_ZH_CN})),__webpack_require__.d(__webpack_exports__,"n",(function(){return COMPONENT_LOCALE_ZH_TW}));__webpack_require__(7),__webpack_require__(125),__webpack_require__(70),__webpack_require__(36);var _en_US_strings_json__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(603),_en_GB_strings_json__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(843),_de_DE_strings_json__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(844),_es_ES_strings_json__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(845),_fr_FR_strings_json__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(846),_it_IT_strings_json__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(847),_ja_JP_strings_json__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(848),_ko_KR_strings_json__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(849),_nl_NL_strings_json__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(850),_pt_BR_strings_json__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(851),_ru_RU_strings_json__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(852),_tr_TR_strings_json__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(853),_zh_CN_strings_json__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(854),_zh_TW_strings_json__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(855),createComponentStrings=function createComponentStrings(localizedStrings){var strings=Object.assign({},_en_US_strings_json__WEBPACK_IMPORTED_MODULE_4__);return Object.keys(localizedStrings).forEach((function(key){strings[key]=Object.assign({},strings[key],localizedStrings[key])})),strings},COMPONENT_LOCALE_EN_US={strings:_en_US_strings_json__WEBPACK_IMPORTED_MODULE_4__},COMPONENT_LOCALE_EN_GB={strings:createComponentStrings(_en_GB_strings_json__WEBPACK_IMPORTED_MODULE_5__)},COMPONENT_LOCALE_DE_DE={strings:createComponentStrings(_de_DE_strings_json__WEBPACK_IMPORTED_MODULE_6__)},COMPONENT_LOCALE_ES_ES={strings:createComponentStrings(_es_ES_strings_json__WEBPACK_IMPORTED_MODULE_7__)},COMPONENT_LOCALE_FR_FR={strings:createComponentStrings(_fr_FR_strings_json__WEBPACK_IMPORTED_MODULE_8__)},COMPONENT_LOCALE_IT_IT={strings:createComponentStrings(_it_IT_strings_json__WEBPACK_IMPORTED_MODULE_9__)},COMPONENT_LOCALE_JA_JP={strings:createComponentStrings(_ja_JP_strings_json__WEBPACK_IMPORTED_MODULE_10__)},COMPONENT_LOCALE_KO_KR={strings:createComponentStrings(_ko_KR_strings_json__WEBPACK_IMPORTED_MODULE_11__)},COMPONENT_LOCALE_NL_NL={strings:createComponentStrings(_nl_NL_strings_json__WEBPACK_IMPORTED_MODULE_12__)},COMPONENT_LOCALE_PT_BR={strings:createComponentStrings(_pt_BR_strings_json__WEBPACK_IMPORTED_MODULE_13__)},COMPONENT_LOCALE_RU_RU={strings:createComponentStrings(_ru_RU_strings_json__WEBPACK_IMPORTED_MODULE_14__)},COMPONENT_LOCALE_TR_TR={strings:createComponentStrings(_tr_TR_strings_json__WEBPACK_IMPORTED_MODULE_15__)},COMPONENT_LOCALE_ZH_CN={strings:createComponentStrings(_zh_CN_strings_json__WEBPACK_IMPORTED_MODULE_16__)},COMPONENT_LOCALE_ZH_TW={strings:createComponentStrings(_zh_TW_strings_json__WEBPACK_IMPORTED_MODULE_17__)}},438:function(module,__webpack_exports__,__webpack_require__){"use strict";var _adapter_AzureCommunicationChatAdapter__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(301);__webpack_require__.d(__webpack_exports__,"createAzureCommunicationChatAdapter",(function(){return _adapter_AzureCommunicationChatAdapter__WEBPACK_IMPORTED_MODULE_0__.a}));var _ChatComposite__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(804);__webpack_require__.d(__webpack_exports__,"ChatComposite",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_1__.a}));var _Strings__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(799);__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_DE_DE")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_DE_DE",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_DE_DE})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_EN_GB")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_GB",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_EN_GB})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_EN_US")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_US",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_EN_US})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_ES_ES")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ES_ES",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_ES_ES})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_FR_FR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_FR_FR",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_FR_FR})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_IT_IT")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_IT_IT",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_IT_IT})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_JA_JP")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_JA_JP",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_JA_JP})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_KO_KR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_KO_KR",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_KO_KR})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_NL_NL")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_NL_NL",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_NL_NL})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_PT_BR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_PT_BR",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_PT_BR})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_RU_RU")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_RU_RU",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_RU_RU})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_TR_TR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_TR_TR",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_TR_TR})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_ZH_CN")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_CN",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_ZH_CN})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"COMPOSITE_LOCALE_ZH_TW")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_TW",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.COMPOSITE_LOCALE_ZH_TW})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"CallComposite")&&__webpack_require__.d(__webpack_exports__,"CallComposite",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.CallComposite})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"CallWithChatComposite")&&__webpack_require__.d(__webpack_exports__,"CallWithChatComposite",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.CallWithChatComposite})),__webpack_require__.o(_Strings__WEBPACK_IMPORTED_MODULE_2__,"createAzureCommunicationCallAdapter")&&__webpack_require__.d(__webpack_exports__,"createAzureCommunicationCallAdapter",(function(){return _Strings__WEBPACK_IMPORTED_MODULE_2__.createAzureCommunicationCallAdapter}))},441:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LocalizationProvider})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useLocale}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_internal_react_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21),_locales__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(442),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),LocaleContext=Object(react__WEBPACK_IMPORTED_MODULE_0__.createContext)(_locales__WEBPACK_IMPORTED_MODULE_2__.c),LocalizationProvider=function LocalizationProvider(props){var locale=props.locale,children=props.children;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(LocaleContext.Provider,{value:locale,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_internal_react_components__WEBPACK_IMPORTED_MODULE_1__.y,{locale:locale.component,children:children})})};LocalizationProvider.displayName="LocalizationProvider";var useLocale=function useLocale(){return Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(LocaleContext)};LocalizationProvider.__docgenInfo={description:"Provider to provide localized strings for this library's composites.\n\n@private",methods:[],displayName:"LocalizationProvider",props:{locale:{required:!0,tsType:{name:"CompositeLocale"},description:"Locale context to provide components"},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Children to provide locale context."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/localization/LocalizationProvider.tsx"]={name:"LocalizationProvider",docgenInfo:LocalizationProvider.__docgenInfo,path:"../react-composites/src/composites/localization/LocalizationProvider.tsx"})},442:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return COMPOSITE_LOCALE_EN_US})),__webpack_require__.d(__webpack_exports__,"b",(function(){return COMPOSITE_LOCALE_EN_GB})),__webpack_require__.d(__webpack_exports__,"a",(function(){return COMPOSITE_LOCALE_DE_DE})),__webpack_require__.d(__webpack_exports__,"d",(function(){return COMPOSITE_LOCALE_ES_ES})),__webpack_require__.d(__webpack_exports__,"e",(function(){return COMPOSITE_LOCALE_FR_FR})),__webpack_require__.d(__webpack_exports__,"f",(function(){return COMPOSITE_LOCALE_IT_IT})),__webpack_require__.d(__webpack_exports__,"g",(function(){return COMPOSITE_LOCALE_JA_JP})),__webpack_require__.d(__webpack_exports__,"h",(function(){return COMPOSITE_LOCALE_KO_KR})),__webpack_require__.d(__webpack_exports__,"i",(function(){return COMPOSITE_LOCALE_NL_NL})),__webpack_require__.d(__webpack_exports__,"j",(function(){return COMPOSITE_LOCALE_PT_BR})),__webpack_require__.d(__webpack_exports__,"k",(function(){return COMPOSITE_LOCALE_RU_RU})),__webpack_require__.d(__webpack_exports__,"l",(function(){return COMPOSITE_LOCALE_TR_TR})),__webpack_require__.d(__webpack_exports__,"m",(function(){return COMPOSITE_LOCALE_ZH_CN})),__webpack_require__.d(__webpack_exports__,"n",(function(){return COMPOSITE_LOCALE_ZH_TW}));__webpack_require__(7),__webpack_require__(125),__webpack_require__(70),__webpack_require__(36);var _internal_react_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(21),_en_US_strings_json__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(611),_en_GB_strings_json__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(868),_de_DE_strings_json__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(869),_es_ES_strings_json__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(870),_fr_FR_strings_json__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(871),_it_IT_strings_json__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(872),_ja_JP_strings_json__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(873),_ko_KR_strings_json__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(874),_nl_NL_strings_json__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(875),_pt_BR_strings_json__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(876),_ru_RU_strings_json__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(877),_tr_TR_strings_json__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(878),_zh_CN_strings_json__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(879),_zh_TW_strings_json__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(880),createCompositeStrings=function createCompositeStrings(localizedStrings){var strings=Object.assign({},_en_US_strings_json__WEBPACK_IMPORTED_MODULE_5__);return Object.keys(localizedStrings).forEach((function(key){strings[key]=Object.assign({},strings[key],localizedStrings[key])})),strings},COMPOSITE_LOCALE_EN_US={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.c,strings:_en_US_strings_json__WEBPACK_IMPORTED_MODULE_5__},COMPOSITE_LOCALE_EN_GB={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.b,strings:createCompositeStrings(_en_GB_strings_json__WEBPACK_IMPORTED_MODULE_6__)},COMPOSITE_LOCALE_DE_DE={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.a,strings:createCompositeStrings(_de_DE_strings_json__WEBPACK_IMPORTED_MODULE_7__)},COMPOSITE_LOCALE_ES_ES={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.d,strings:createCompositeStrings(_es_ES_strings_json__WEBPACK_IMPORTED_MODULE_8__)},COMPOSITE_LOCALE_FR_FR={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.e,strings:createCompositeStrings(_fr_FR_strings_json__WEBPACK_IMPORTED_MODULE_9__)},COMPOSITE_LOCALE_IT_IT={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.f,strings:createCompositeStrings(_it_IT_strings_json__WEBPACK_IMPORTED_MODULE_10__)},COMPOSITE_LOCALE_JA_JP={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.g,strings:createCompositeStrings(_ja_JP_strings_json__WEBPACK_IMPORTED_MODULE_11__)},COMPOSITE_LOCALE_KO_KR={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.h,strings:createCompositeStrings(_ko_KR_strings_json__WEBPACK_IMPORTED_MODULE_12__)},COMPOSITE_LOCALE_NL_NL={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.i,strings:createCompositeStrings(_nl_NL_strings_json__WEBPACK_IMPORTED_MODULE_13__)},COMPOSITE_LOCALE_PT_BR={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.j,strings:createCompositeStrings(_pt_BR_strings_json__WEBPACK_IMPORTED_MODULE_14__)},COMPOSITE_LOCALE_RU_RU={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.k,strings:createCompositeStrings(_ru_RU_strings_json__WEBPACK_IMPORTED_MODULE_15__)},COMPOSITE_LOCALE_TR_TR={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.l,strings:createCompositeStrings(_tr_TR_strings_json__WEBPACK_IMPORTED_MODULE_16__)},COMPOSITE_LOCALE_ZH_CN={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.m,strings:createCompositeStrings(_zh_CN_strings_json__WEBPACK_IMPORTED_MODULE_17__)},COMPOSITE_LOCALE_ZH_TW={component:_internal_react_components__WEBPACK_IMPORTED_MODULE_4__.n,strings:createCompositeStrings(_zh_TW_strings_json__WEBPACK_IMPORTED_MODULE_18__)}},469:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ParticipantContainer})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ParticipantListWithHeading}));__webpack_require__(7),__webpack_require__(1);var _styles_ParticipantContainer_styles__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(92),_internal_react_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(21),_fluentui_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(69),_fluentui_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(369),_fluentui_react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(22),_fluentui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1547),_AvatarPersona__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(311),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(2),ParticipantContainer=function ParticipantContainer(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_4__.a,{className:_styles_ParticipantContainer_styles__WEBPACK_IMPORTED_MODULE_2__.f,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(ParticipantListWithHeading,Object.assign({},props))})};ParticipantContainer.displayName="ParticipantContainer";var ParticipantListWithHeading=function ParticipantListWithHeading(props){var onFetchAvatarPersonaData=props.onFetchAvatarPersonaData,onFetchParticipantMenuItems=props.onFetchParticipantMenuItems,title=props.title,participantListProps=props.participantListProps,theme=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_5__.a)(),subheadingStyleThemed=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_6__.r)(_styles_ParticipantContainer_styles__WEBPACK_IMPORTED_MODULE_2__.h,{root:{color:theme.palette.neutralSecondary}});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_4__.a,{className:_styles_ParticipantContainer_styles__WEBPACK_IMPORTED_MODULE_2__.d,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_4__.a.Item,{styles:subheadingStyleThemed,className:_styles_ParticipantContainer_styles__WEBPACK_IMPORTED_MODULE_2__.a,children:title}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{className:_styles_ParticipantContainer_styles__WEBPACK_IMPORTED_MODULE_2__.e,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_internal_react_components__WEBPACK_IMPORTED_MODULE_3__.D,Object.assign({},participantListProps,{onRenderAvatar:function onRenderAvatar(userId,options){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_AvatarPersona__WEBPACK_IMPORTED_MODULE_8__.a,Object.assign({"data-ui-id":"chat-composite-participant-custom-avatar",userId:userId},options,{dataProvider:onFetchAvatarPersonaData}))},onFetchParticipantMenuItems:onFetchParticipantMenuItems}))})]})};ParticipantListWithHeading.displayName="ParticipantListWithHeading",ParticipantContainer.__docgenInfo={description:"@private",methods:[],displayName:"ParticipantContainer",props:{onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:""},onFetchParticipantMenuItems:{required:!1,tsType:{name:"ParticipantMenuItemsCallback"},description:""},onFetchAvatarPersonaData:{required:!1,tsType:{name:"AvatarPersonaDataCallback"},description:""},participantListProps:{required:!0,tsType:{name:"ParticipantListProps"},description:""},title:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/ParticipantContainer.tsx"]={name:"ParticipantContainer",docgenInfo:ParticipantContainer.__docgenInfo,path:"../react-composites/src/composites/common/ParticipantContainer.tsx"}),ParticipantListWithHeading.__docgenInfo={description:"@private",methods:[],displayName:"ParticipantListWithHeading",props:{participantListProps:{required:!0,tsType:{name:"ParticipantListProps"},description:""},title:{required:!1,tsType:{name:"string"},description:""},onFetchAvatarPersonaData:{required:!1,tsType:{name:"AvatarPersonaDataCallback"},description:""},onFetchParticipantMenuItems:{required:!1,tsType:{name:"ParticipantMenuItemsCallback"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/ParticipantContainer.tsx"]={name:"ParticipantListWithHeading",docgenInfo:ParticipantListWithHeading.__docgenInfo,path:"../react-composites/src/composites/common/ParticipantContainer.tsx"})},470:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Camera}));__webpack_require__(7);var _internal_react_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),_hooks_usePropsFor__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(94),_styles_Buttons_styles__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(127),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),Camera=function Camera(props){var cameraButtonProps=Object(_hooks_usePropsFor__WEBPACK_IMPORTED_MODULE_3__.a)(_internal_react_components__WEBPACK_IMPORTED_MODULE_1__.o),styles=Object(react__WEBPACK_IMPORTED_MODULE_2__.useMemo)((function(){var _props$styles;return Object(_styles_Buttons_styles__WEBPACK_IMPORTED_MODULE_4__.b)(null!==(_props$styles=props.styles)&&void 0!==_props$styles?_props$styles:{})}),[props.styles]);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_internal_react_components__WEBPACK_IMPORTED_MODULE_1__.o,Object.assign({"data-ui-id":"call-composite-camera-button"},cameraButtonProps,{showLabel:"compact"!==props.displayType,styles:styles,enableDeviceSelectionMenu:props.splitButtonsForDeviceSelection}))};Camera.displayName="Camera",Camera.__docgenInfo={description:"@private",methods:[],displayName:"Camera",props:{displayType:{required:!1,tsType:{name:"CallControlDisplayType"},description:""},styles:{required:!1,tsType:{name:"ControlBarButtonStyles"},description:""},splitButtonsForDeviceSelection:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/buttons/Camera.tsx"]={name:"Camera",docgenInfo:Camera.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/buttons/Camera.tsx"})},471:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return EndCall}));__webpack_require__(7);var _fluentui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(22),_internal_react_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(21),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1),_hooks_usePropsFor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(94),_styles_Buttons_styles__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(127),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2),EndCall=function EndCall(props){var compactMode="compact"===props.displayType,hangUpButtonProps=Object(_hooks_usePropsFor__WEBPACK_IMPORTED_MODULE_4__.a)(_internal_react_components__WEBPACK_IMPORTED_MODULE_2__.t),styles=Object(react__WEBPACK_IMPORTED_MODULE_3__.useMemo)((function(){var _props$styles;return Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.r)(compactMode?_styles_Buttons_styles__WEBPACK_IMPORTED_MODULE_5__.d:_styles_Buttons_styles__WEBPACK_IMPORTED_MODULE_5__.e,null!==(_props$styles=props.styles)&&void 0!==_props$styles?_props$styles:{})}),[props.styles]);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_internal_react_components__WEBPACK_IMPORTED_MODULE_2__.t,Object.assign({"data-ui-id":"call-composite-hangup-button"},hangUpButtonProps,{styles:styles,showLabel:!compactMode}))};EndCall.displayName="EndCall",EndCall.__docgenInfo={description:"@private",methods:[],displayName:"EndCall",props:{displayType:{required:!1,tsType:{name:"CallControlDisplayType"},description:""},styles:{required:!1,tsType:{name:"ControlBarButtonStyles"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/buttons/EndCall.tsx"]={name:"EndCall",docgenInfo:EndCall.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/buttons/EndCall.tsx"})},472:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Microphone}));__webpack_require__(7);var _internal_calling_component_bindings__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(88),_internal_react_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(21),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1),_localization__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(91),_hooks_usePropsFor__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(94),_hooks_useSelector__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(87),_selectors_baseSelectors__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(67),_styles_Buttons_styles__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(127),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(2),Microphone=function Microphone(props){var microphoneButtonProps=Object(_hooks_usePropsFor__WEBPACK_IMPORTED_MODULE_5__.a)(_internal_react_components__WEBPACK_IMPORTED_MODULE_2__.B),callStatus=Object(_hooks_useSelector__WEBPACK_IMPORTED_MODULE_6__.a)(_selectors_baseSelectors__WEBPACK_IMPORTED_MODULE_7__.a),isLocalMicrophoneEnabled=Object(_hooks_useSelector__WEBPACK_IMPORTED_MODULE_6__.a)(_selectors_baseSelectors__WEBPACK_IMPORTED_MODULE_7__.g),strings=Object(_localization__WEBPACK_IMPORTED_MODULE_4__.b)().strings.call;Object(_internal_calling_component_bindings__WEBPACK_IMPORTED_MODULE_1__.c)(callStatus)&&(microphoneButtonProps.disabled=!0,microphoneButtonProps.checked=isLocalMicrophoneEnabled);var microphoneButtonStrings=Object(_internal_calling_component_bindings__WEBPACK_IMPORTED_MODULE_1__.c)(callStatus)?{strings:{tooltipOffContent:strings.microphoneToggleInLobbyNotAllowed,tooltipOnContent:strings.microphoneToggleInLobbyNotAllowed}}:{},styles=Object(react__WEBPACK_IMPORTED_MODULE_3__.useMemo)((function(){var _props$styles;return Object(_styles_Buttons_styles__WEBPACK_IMPORTED_MODULE_8__.b)(null!==(_props$styles=props.styles)&&void 0!==_props$styles?_props$styles:{})}),[props.styles]);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_internal_react_components__WEBPACK_IMPORTED_MODULE_2__.B,Object.assign({autoFocus:!0,"data-ui-id":"call-composite-microphone-button"},microphoneButtonProps,{showLabel:"compact"!==props.displayType,styles:styles},microphoneButtonStrings,{enableDeviceSelectionMenu:props.splitButtonsForDeviceSelection}))};Microphone.displayName="Microphone",Microphone.__docgenInfo={description:"@private",methods:[],displayName:"Microphone",props:{displayType:{required:!1,tsType:{name:"CallControlDisplayType"},description:""},styles:{required:!1,tsType:{name:"ControlBarButtonStyles"},description:""},splitButtonsForDeviceSelection:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/buttons/Microphone.tsx"]={name:"Microphone",docgenInfo:Microphone.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/buttons/Microphone.tsx"})},473:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ScreenShare}));__webpack_require__(7);var _internal_react_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),_hooks_usePropsFor__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(94),_styles_Buttons_styles__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(127),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),ScreenShare=function ScreenShare(props){var screenShareButtonProps=Object(_hooks_usePropsFor__WEBPACK_IMPORTED_MODULE_3__.a)(_internal_react_components__WEBPACK_IMPORTED_MODULE_1__.F),styles=Object(react__WEBPACK_IMPORTED_MODULE_2__.useMemo)((function(){var _props$styles;return Object(_styles_Buttons_styles__WEBPACK_IMPORTED_MODULE_4__.b)(null!==(_props$styles=props.styles)&&void 0!==_props$styles?_props$styles:{})}),[props.styles]);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_internal_react_components__WEBPACK_IMPORTED_MODULE_1__.F,Object.assign({"data-ui-id":"call-composite-screenshare-button"},screenShareButtonProps,{showLabel:"compact"!==props.displayType,disabled:isDisabled(props.option),styles:styles}))};ScreenShare.displayName="ScreenShare";var isDisabled=function isDisabled(option){return void 0!==option&&!0!==option&&!1!==option&&option.disabled};ScreenShare.__docgenInfo={description:"@private",methods:[],displayName:"ScreenShare",props:{option:{required:!1,tsType:{name:"union",raw:"boolean | { disabled: boolean }",elements:[{name:"boolean"},{name:"signature",type:"object",raw:"{ disabled: boolean }",signature:{properties:[{key:"disabled",value:{name:"boolean",required:!0}}]}}]},description:""},displayType:{required:!1,tsType:{name:"CallControlDisplayType"},description:""},styles:{required:!1,tsType:{name:"ControlBarButtonStyles"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/buttons/ScreenShare.tsx"]={name:"ScreenShare",docgenInfo:ScreenShare.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/buttons/ScreenShare.tsx"})},474:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return controlBarContainerStyles}));var controlBarContainerStyles={paddingTop:"0.25rem",paddingBottom:"0.25rem",boxShadow:"\n    0px 6.400000095367432px 14.399999618530273px 0px #00000021;\n    0px 1.2000000476837158px 3.5999999046325684px 0px #0000001A;\n  "}},475:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return blueBannerPalette}));var blueBannerPalette={background:"#d7eaf8",header:"#004173",link:"#004173"}},476:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ImportantHeading}));__webpack_require__(7);var _fluentui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(499),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1538),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(1),__webpack_require__(2)),ImportantHeading=function ImportantHeading(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_2__.a,{style:importantIconStyles,primaryFill:props.color})," ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.a,{styles:{root:Object.assign({},importantTextStyles,{color:props.color})},children:"Important"})]})},importantIconStyles={height:"1rem",verticalAlign:"text-bottom",display:"inline-block"},importantTextStyles={lineHeight:"1.5rem",fontWeight:"600"};ImportantHeading.__docgenInfo={description:"Small component that shows the `(i) important` used in banners.\n@private",methods:[],displayName:"ImportantHeading",props:{color:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/BetaBanners/ImportantBannerHeading.tsx"]={name:"ImportantHeading",docgenInfo:ImportantHeading.__docgenInfo,path:"stories/BetaBanners/ImportantBannerHeading.tsx"})},477:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _fluentui_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(616),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4),_BetaBanners_DetailedBetaBanner__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(1),__webpack_require__(478)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2),containerText=__webpack_require__(1371).default,serverText=__webpack_require__(1372).default,getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_BetaBanners_DetailedBetaBanner__WEBPACK_IMPORTED_MODULE_3__.a,{}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.j,{children:"CallWithChatComposite"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"CallWithChatComposite brings together key components to provide a full call with chat experience out of the box."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Basic usage"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"A CallWithChatComposite is comprised of two key underlying parts: an ACS Call and an ACS Chat thread. As such you must provide details for both in the CallWithChatAdapter interface."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"A key thing to note is that initialization of the adapter is asynchronous. Thus, the initialization step requires special handling, as the example code below shows."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.h,{code:containerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Prerequisites"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"CallWithChatComposite provides the UI for an *existing user* to join a call and a chat. Thus, the user and thread must be created beforehand. Typically, the user and group call or teams meeting are created on a Contoso-owned service and provided to the client application that then passes it to the CallWithChatComposite."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.h,{code:serverText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Running in a Mobile browser"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:'CallWithChatComposite by default is optimized for desktop views. To provide an optimized mobile experience, you may set the `formFactor` property to `"mobile"`. The CallWithChatComposite does not detect if it is running on mobile device vs desktop, instead you must identify if your clients device is a mobile device and set the `formFactor` property to `"mobile"`. This prop can be set at any time and immediately updates the composite UI to be optimized for a mobile device.'}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.h,{code:'\n<CallWithChatComposite formFactor="mobile" />\n'}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_0__.a,{children:'Note: Only Protrait mode is supported when the `formFactor` is set to "mobile". Landscape mode is not supported.'}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"You can try out the form factor property in the [CallWithChatComposite Basic Example](./?path=/story/composites-call-with-chat-basicexample--basic-example)."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Theming"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"CallWithChatComposite can be themed with Fluent UI themes, just like the base components. Look at the [CallComposite theme example](./?path=/story/composites-call-themeexample--theme-example) to see theming in action or the [overall theming example](./?path=/docs/theming--page) to see how theming works for all the components in this UI library."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.e,{children:"Joining a Teams Meeting"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_1__.d,{children:"The [Joining a Teams Meeting](./?path=/story/composites-call-with-chat-jointeamsmeeting) preview provides an easy playground to join an existing Teams meeting. This is useful if you want to explore the composite in a Teams interop scenario."})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallWithChatComposite/CallWithChatCompositeDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/CallWithChatComposite/CallWithChatCompositeDocs.tsx"})},478:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DetailedBetaBanner}));__webpack_require__(802);var _fluentui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(69),_fluentui_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(499),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(22),_fluentui_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(898),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1539),_constants__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__(1),__webpack_require__(14)),_BannerPalettes__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(475),_ImportantBannerHeading__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(476),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2),DetailedBetaBanner=function DetailedBetaBanner(props){var _props$palette,palette=null!==(_props$palette=props.palette)&&void 0!==_props$palette?_props$palette:_BannerPalettes__WEBPACK_IMPORTED_MODULE_8__.a;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.a,{className:bannerContainerStyles(palette.background),children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.a.Item,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_ImportantBannerHeading__WEBPACK_IMPORTED_MODULE_9__.a,{color:palette.header})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.a.Item,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.a,{className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.H)({lineHeight:"1.5rem"}),children:["This feature is currently in public preview. Public preview APIs may be unstable and are not recommended for production workloads. As such these features are only available in @azure/communication-react npm packages suffixed with -beta. For more information, see:"," ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_4__.a,{className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.H)({color:palette.link,fontWeight:"600"}),href:_constants__WEBPACK_IMPORTED_MODULE_7__.f,target:"_blank",children:["Supplemental Terms of Use for Microsoft Azure Previews ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_5__.a,{})]}),"."]})})]})};DetailedBetaBanner.displayName="DetailedBetaBanner";var bannerContainerStyles=function bannerContainerStyles(color){return Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.H)({background:color,borderRadius:"0.375rem",padding:"1rem",gap:"1rem",marginBottom:"2rem"})};DetailedBetaBanner.__docgenInfo={description:"@private",methods:[],displayName:"DetailedBetaBanner",props:{palette:{required:!1,tsType:{name:"BannerPalette"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/BetaBanners/DetailedBetaBanner.tsx"]={name:"DetailedBetaBanner",docgenInfo:DetailedBetaBanner.__docgenInfo,path:"stories/BetaBanners/DetailedBetaBanner.tsx"})},479:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallWithChatExperience}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(253),_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(80),react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CallWithChatExperience=function CallWithChatExperience(props){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(),2),callWithChatAdapter=_useState2[0],setCallWithChatAdapter=_useState2[1],credential=Object(react__WEBPACK_IMPORTED_MODULE_14__.useMemo)((function(){try{return new _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__.a(props.token)}catch(_unused){return void console.error("Failed to construct token credential")}}),[props.token]);if(Object(react__WEBPACK_IMPORTED_MODULE_14__.useEffect)((function(){props&&credential&&props.locator&&props.displayName&&props.userId&&props.endpointUrl&&function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setCallWithChatAdapter,_context.next=3,Object(_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__.createAzureCommunicationCallWithChatAdapter)({userId:props.userId,displayName:props.displayName,credential:credential,locator:props.locator,endpoint:props.endpointUrl});case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapters(){return _ref.apply(this,arguments)}}()()}),[credential,props]),callWithChatAdapter){var options={callControls:props.callWithChatControlOptions};return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__.CallWithChatComposite,{callWithChatAdapter:callWithChatAdapter,fluentTheme:props.fluentTheme,options:options})}return void 0===credential?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.Fragment,{children:"Failed to construct credential. Provided token is malformed."}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.Fragment,{children:"Initializing..."})};CallWithChatExperience.__docgenInfo={description:"",methods:[],displayName:"CallWithChatExperience",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},locator:{required:!0,tsType:{name:"union",raw:"TeamsMeetingLinkLocator | CallAndChatLocator",elements:[{name:"TeamsMeetingLinkLocator"},{name:"CallAndChatLocator"}]},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},callInvitationURL:{required:!1,tsType:{name:"string"},description:""},callWithChatControlOptions:{required:!1,tsType:{name:"union",raw:"boolean | CallWithChatControlOptions",elements:[{name:"boolean"},{name:"CallWithChatControlOptions"}]},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallWithChatComposite/snippets/CallWithChat.snippet.tsx"]={name:"CallWithChatExperience",docgenInfo:CallWithChatExperience.__docgenInfo,path:"stories/CallWithChatComposite/snippets/CallWithChat.snippet.tsx"})},480:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ConfigHintBanner})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ConfigJoinMeetingHintBanner}));__webpack_require__(1);var _CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(191),_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(14),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),ConfigHintBanner=function ConfigHintBanner(){var emptyConfigTips=Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("p",{children:["Please provide an"," ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("a",{href:_constants__WEBPACK_IMPORTED_MODULE_2__.e,target:"_blank",rel:"noreferrer",children:"access token, userId"}),", endpointUrl and display name to use."]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("p",{children:"A display name has already been set by default, but feel free to change it."})]});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__.b)([emptyConfigTips])})},ConfigJoinMeetingHintBanner=function ConfigJoinMeetingHintBanner(){var emptyConfigTips=Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("p",{children:["Please provide the an"," ",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("a",{href:_constants__WEBPACK_IMPORTED_MODULE_2__.e,target:"_blank",rel:"noreferrer",children:"access token, userId"}),", endpointUrl, display name, and teams meeting link."]});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__.b)([emptyConfigTips])})};ConfigHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallWithChatComposite/Utils.tsx"]={name:"ConfigHintBanner",docgenInfo:ConfigHintBanner.__docgenInfo,path:"stories/CallWithChatComposite/Utils.tsx"}),ConfigJoinMeetingHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigJoinMeetingHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallWithChatComposite/Utils.tsx"]={name:"ConfigJoinMeetingHintBanner",docgenInfo:ConfigJoinMeetingHintBanner.__docgenInfo,path:"stories/CallWithChatComposite/Utils.tsx"})},481:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DevicesButtonWithKnobs}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(7),__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(21),react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1),_controlsUtils__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(6),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var DevicesButtonWithKnobs=function DevicesButtonWithKnobs(deviceButtonProps){var _onSelectSpeaker,_onSelectMicrophone,_onSelectCamera,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(_controlsUtils__WEBPACK_IMPORTED_MODULE_15__.e[0]),2),selectedCamera=_useState2[0],setSelectedCamera=_useState2[1],_useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(_controlsUtils__WEBPACK_IMPORTED_MODULE_15__.f[0]),2),selectedMicrophone=_useState4[0],setSelectedMicrophone=_useState4[1],_useState6=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(_controlsUtils__WEBPACK_IMPORTED_MODULE_15__.g[0]),2),selectedSpeaker=_useState6[0],setSelectedSpeaker=_useState6[1],exampleOptionProps={selectedCamera:selectedCamera,selectedMicrophone:selectedMicrophone,selectedSpeaker:selectedSpeaker,onSelectCamera:(_onSelectCamera=_asyncToGenerator(regeneratorRuntime.mark((function _callee(device){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:setSelectedCamera(device);case 1:case"end":return _context.stop()}}),_callee)}))),function onSelectCamera(_x){return _onSelectCamera.apply(this,arguments)}),onSelectMicrophone:(_onSelectMicrophone=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(device){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:setSelectedMicrophone(device);case 1:case"end":return _context2.stop()}}),_callee2)}))),function onSelectMicrophone(_x2){return _onSelectMicrophone.apply(this,arguments)}),onSelectSpeaker:(_onSelectSpeaker=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(device){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:setSelectedSpeaker(device);case 1:case"end":return _context3.stop()}}),_callee3)}))),function onSelectSpeaker(_x3){return _onSelectSpeaker.apply(this,arguments)})};return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__.s,Object.assign({},deviceButtonProps,exampleOptionProps))};DevicesButtonWithKnobs.displayName="DevicesButtonWithKnobs",DevicesButtonWithKnobs.__docgenInfo={description:"",methods:[],displayName:"DevicesButtonWithKnobs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Devices/snippets/DevicesButtonWithKnobs.snippet.tsx"]={name:"DevicesButtonWithKnobs",docgenInfo:DevicesButtonWithKnobs.__docgenInfo,path:"stories/ControlBar/Buttons/Devices/snippets/DevicesButtonWithKnobs.snippet.tsx"})},482:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(1),__webpack_require__(2)),getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.j,{children:"Incoming Call Alerts"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"The Incoming Call Alert Components alert about an incoming call. They can render a local video preview, custom avatar image, caller name and incoming call alert text."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.e,{children:"Incoming Call Modal"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.h,{code:"\nimport { StreamMedia, VideoTile } from '@azure/communication-react';\nimport { DefaultButton, Persona, PersonaSize, Stack, Dialog, DialogType, DialogFooter } from '@fluentui/react';\nimport { CallEndIcon, CallIcon, CallVideoIcon, CallVideoOffIcon } from '@fluentui/react-northstar';\nimport { DefaultPalette, mergeStyles } from '@fluentui/react';\n\nconst palette = DefaultPalette;\n\nconst incomingCallModalContainerStyle = {\n  borderRadius: '0.75rem'\n};\n\nconst incomingCallModalLocalPreviewStyle = mergeStyles({\n  height: '10rem',\n  background: palette.neutralLighterAlt,\n  margin: '1.5rem 0',\n  borderRadius: '0.25rem',\n  '& video': {\n    borderRadius: '0.25rem'\n  }\n});\n\ninterface IncomingCallModalProps extends IncomingCallToastProps {\n  /** Text to the right of a Caller's Name */\n  callerNameAlt?: string;\n  /** A Caller's subtitle. Displayed right below the callers name */\n  callerTitle?: string;\n  /** Receiver's Name */\n  localParticipantDisplayName?: string;\n  /** If set to 'true', mirrors the local video preview of the receiver */\n  localVideoInverted?: boolean;\n  /** Local Video Stream Element. An HTML Element containing a video stream. */\n  localVideoStreamElement: HTMLElement | null;\n  /** Provide a function that handles the call behavior when Video Toggle Button is clicked */\n  onClickVideoToggle: () => void;\n}\n\nconst IncomingCallModal = (props: IncomingCallModalProps): JSX.Element => {\n  const {\n    alertText,\n    avatar,\n    callerName,\n    callerNameAlt,\n    callerTitle,\n    localParticipantDisplayName,\n    localVideoInverted,\n    onClickAccept,\n    onClickReject,\n    onClickVideoToggle,\n    localVideoStreamElement\n  } = props;\n  const palette = DefaultPalette;\n  const [hideDialog, { toggle: toggleHideDialog }] = useBoolean(false);\n  const dialogContentProps = { type: DialogType.normal, title: alertText ?? 'Incoming Video Call' };\n\n  const mediaGalleryLocalParticipant: JSX.Element = (\n    <VideoTile\n      renderElement={<StreamMedia videoStreamElement={localVideoStreamElement} />}\n      displayName={localParticipantDisplayName}\n      isMirrored={localVideoInverted}\n    />\n  );\n\n  cosnt showLocalVideo = !!localVideoStreamElement;\n\n  return (\n    <>\n      <Dialog\n        hidden={hideDialog}\n        onDismiss={toggleHideDialog}\n        dialogContentProps={dialogContentProps}\n        modalProps={{\n          isBlocking: true,\n          styles: { main: incomingCallModalContainerStyle }\n        }}\n      >\n        <Stack horizontal verticalAlign=\"center\">\n          <Stack horizontalAlign=\"start\" style={{ marginRight: '0.5rem' }}>\n            <Persona\n              imageUrl={avatar}\n              text={callerName}\n              size={PersonaSize.size40}\n              hidePersonaDetails={true}\n              aria-label={callerName}\n            />\n          </Stack>\n          <Stack grow={1} horizontalAlign=\"center\" style={{ alignItems: 'flex-start' }}>\n            <Stack style={{ fontSize: '0.875rem', color: palette.black, fontWeight: 'bold' }}>\n              <span>\n                {callerName ?? 'No display name'}\n                {callerNameAlt ? (\n                  <span style={{ opacity: 0.5, marginLeft: '0.2rem' }}> &bull; {callerNameAlt}</span>\n                ) : null}\n              </span>\n            </Stack>\n            <Stack style={{ fontSize: '0.75rem', color: palette.neutralDark }}>\n              <span>{callerTitle ?? ''}</span>\n            </Stack>\n          </Stack>\n        </Stack>\n\n        {showLocalVideo ? (\n          <Stack className={incomingCallModalLocalPreviewStyle}>{mediaGalleryLocalParticipant}</Stack>\n        ) : null}\n\n        <DialogFooter>\n          <DefaultButton\n            style={{ background: palette.neutralLighterAlt, border: 'none' }}\n            onClick={() => onClickVideoToggle()}\n            onRenderIcon={() => (showLocalVideo ? <CallVideoIcon size=\"small\" /> : <CallVideoOffIcon size=\"small\" />)}\n          />\n\n          <DefaultButton\n            onClick={() => onClickAccept()}\n            text=\"Accept\"\n            style={{ background: palette.green, border: 'none' }}\n          />\n\n          <DefaultButton\n            onClick={() => onClickReject()}\n            text=\"Decline\"\n            style={{ background: palette.redDark, border: 'none' }}\n          />\n        </DialogFooter>\n      </Dialog>\n    </>\n  );\n};\n"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.e,{children:"Incoming Call Toast"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.h,{code:"\nimport { DefaultButton, Persona, PersonaSize, Stack, Dialog, DialogType, DialogFooter } from '@fluentui/react';\nimport { CallEnd20Filled, Call20Filled } from '@fluentui/react-icons';\nimport { DefaultPalette, mergeStyles } from '@fluentui/react';\n\nconst palette = DefaultPalette;\n\nconst incomingCallToastStyle = mergeStyles({\n  minWidth: '20rem',\n  width: '100%',\n  height: '100%',\n  backgroundColor: palette.whiteTranslucent40,\n  opacity: 0.95,\n  borderRadius: '0.5rem',\n  boxShadow: theme.effects.elevation8,\n  padding: '1rem'\n});\n\nconst incomingCallToastAvatarContainerStyle = mergeStyles({\n  marginRight: '0.5rem'\n});\n\nconst incomingCallAcceptButtonStyle = mergeStyles({\n  backgroundColor: palette.greenDark,\n  color: palette.white,\n  borderRadius: '2rem',\n  minWidth: '2rem',\n  width: '2rem',\n  border: 'none',\n  ':hover, :active': {\n    backgroundColor: palette.green,\n    color: palette.white\n  }\n});\n\nconst incomingCallRejectButtonStyle = mergeStyles({\n  backgroundColor: palette.redDark,\n  color: palette.white,\n  borderRadius: '2rem',\n  minWidth: '2rem',\n  width: '2rem',\n  border: 'none',\n  ':hover, :active': {\n    backgroundColor: palette.red,\n    color: palette.white\n  }\n});\n\ntype IncomingCallToastProps = {\n  /** Caller's Name */\n  callerName?: string;\n  /** Alert Text. For example \"incoming video call...\" */\n  alertText?: string;\n  /** Caller's Avatar/Profile Image */\n  avatar?: string;\n  /** Provide a function that handles the call behavior when Accept Button is clicked */\n  onClickAccept: () => void;\n  /** Provide a function that handles the call behavior when Reject Button is clicked */\n  onClickReject: () => void;\n};\n\nconst IncomingCallToast = (props: IncomingCallToastProps): JSX.Element => {\n  const { callerName, alertText, avatar, onClickAccept, onClickReject } = props;\n\n  return (\n    <Stack horizontal verticalAlign=\"center\" className={incomingCallToastStyle}>\n      <Stack horizontalAlign=\"start\" className={incomingCallToastAvatarContainerStyle}>\n        <Persona\n          imageUrl={avatar}\n          text={callerName}\n          size={PersonaSize.size40}\n          hidePersonaDetails={true}\n          aria-label={callerName}\n        />\n      </Stack>\n\n      <Stack grow={1} horizontalAlign=\"center\" style={{ alignItems: 'flex-start', fontFamily: 'Segoe UI' }}>\n        <Stack style={{ fontSize: '0.875rem' }}>\n          <b>{callerName ?? 'No display name'}</b>\n        </Stack>\n        <Stack style={{ fontSize: '0.75rem' }}>\n          <span>{alertText ?? 'Incoming call'}</span>\n        </Stack>\n      </Stack>\n\n      <Stack horizontal tokens={{ childrenGap: 10 }}>\n        <DefaultButton\n          className={incomingCallRejectButtonStyle}\n          onClick={() => onClickReject()}\n          onRenderIcon={() => <CallEnd20Filled />}\n        />\n        <DefaultButton\n          className={incomingCallAcceptButtonStyle}\n          onClick={() => onClickAccept()}\n          onRenderIcon={() => <Call20Filled />}\n        />\n      </Stack>\n    </Stack>\n  );\n};\n"})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/IncomingCallAlerts/IncomingCallAlertsDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/Examples/IncomingCallAlerts/IncomingCallAlertsDocs.tsx"})},483:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(1),__webpack_require__(2)),CallComponentText=__webpack_require__(1417).default,ComplianceBannerText=__webpack_require__(1418).default,LobbyComponentText=__webpack_require__(1419).default,getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.j,{children:"Teams Interop"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Azure Communication Services applications can inter-operate with Microsoft Teams. There are some additional considerations when connecting to a Teams meeting."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.e,{children:"Compliance notifications for recording and transcription"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"This example shows how you might notify your users when a Teams meeting is being recorded or transcribed. Here, a MessageBar is optionally added to the video frame:"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.i,{children:"Create Compliance Banner"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.h,{code:ComplianceBannerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.i,{children:"Use Compliance Banner"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.h,{code:CallComponentText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.j,{children:"Lobby Component"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"The Lobby component can be used for scenarios where the call is in a waiting state."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.e,{children:"Create a Lobby Component"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.h,{code:LobbyComponentText})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/TeamsInterop/TeamsInteropDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/Examples/TeamsInterop/TeamsInteropDocs.tsx"})},484:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return VideoTileExample}));var _azure_communication_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(77),_azure_communication_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21),_utils__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(1),__webpack_require__(178)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2),VideoTileExample=function VideoTileExample(){var videoStreamElement=Object(_utils__WEBPACK_IMPORTED_MODULE_3__.a)(1)[0];return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.b,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_1__.K,{renderElement:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_1__.H,{styles:{root:{"& video":{borderRadius:"0rem"}}},videoStreamElement:videoStreamElement}),displayName:"Jack Reacher",isMirrored:!0,isMuted:!0,styles:{root:{height:"300px",width:"400px"},videoContainer:{border:"5px solid red"},overlayContainer:{background:"rgba(165, 13, 13, 0.5)"},displayNameContainer:{top:"1rem",bottom:"auto",right:"1rem",left:"auto",backgroundColor:"blue",color:"white"}}})})};VideoTileExample.displayName="VideoTileExample",VideoTileExample.__docgenInfo={description:"",methods:[],displayName:"VideoTileExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Styling/snippets/StylingVideoTile.snippet.tsx"]={name:"VideoTileExample",docgenInfo:VideoTileExample.__docgenInfo,path:"stories/Styling/snippets/StylingVideoTile.snippet.tsx"})},485:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createDefaultChatHandlers})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getSelector}));__webpack_require__(39),__webpack_require__(12);var src=__webpack_require__(32),memoize_one_esm=__webpack_require__(153);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var createDefaultChatHandlers=Object(memoize_one_esm.a)((function(chatClient,chatThreadClient){var _onLoadPreviousChatMessages,_updateThreadTopicName,_onRemoveParticipant,_onTyping,_onMessageSeen,_onDeleteMessage,_onUpdateMessage,_onSendMessage,messageIterator=void 0;return{onSendMessage:(_onSendMessage=_asyncToGenerator(regeneratorRuntime.mark((function _callee(content,options){var sendMessageRequest;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return sendMessageRequest={content:content,senderDisplayName:chatClient.getState().displayName},_context.next=3,chatThreadClient.sendMessage(sendMessageRequest,options);case 3:case"end":return _context.stop()}}),_callee)}))),function onSendMessage(_x,_x2){return _onSendMessage.apply(this,arguments)}),onUpdateMessage:(_onUpdateMessage=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(messageId,content){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,chatThreadClient.updateMessage(messageId,{content:content});case 2:case"end":return _context2.stop()}}),_callee2)}))),function onUpdateMessage(_x3,_x4){return _onUpdateMessage.apply(this,arguments)}),onDeleteMessage:(_onDeleteMessage=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(messageId){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,chatThreadClient.deleteMessage(messageId);case 2:case"end":return _context3.stop()}}),_callee3)}))),function onDeleteMessage(_x5){return _onDeleteMessage.apply(this,arguments)}),onMessageSeen:(_onMessageSeen=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(chatMessageId){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,chatThreadClient.sendReadReceipt({chatMessageId:chatMessageId});case 2:case"end":return _context4.stop()}}),_callee4)}))),function onMessageSeen(_x6){return _onMessageSeen.apply(this,arguments)}),onTyping:(_onTyping=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,chatThreadClient.sendTypingNotification();case 2:case"end":return _context5.stop()}}),_callee5)}))),function onTyping(){return _onTyping.apply(this,arguments)}),onRemoveParticipant:(_onRemoveParticipant=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(userId){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,chatThreadClient.removeParticipant(Object(src.e)(userId));case 2:case"end":return _context6.stop()}}),_callee6)}))),function onRemoveParticipant(_x7){return _onRemoveParticipant.apply(this,arguments)}),updateThreadTopicName:(_updateThreadTopicName=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(topicName){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,chatThreadClient.updateTopic(topicName);case 2:case"end":return _context7.stop()}}),_callee7)}))),function updateThreadTopicName(_x8){return _updateThreadTopicName.apply(this,arguments)}),onLoadPreviousChatMessages:(_onLoadPreviousChatMessages=_asyncToGenerator(regeneratorRuntime.mark((function _callee8(messagesToLoad){var remainingMessagesToGet,isAllChatMessagesLoaded,_message$value,message;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:void 0===messageIterator&&(messageIterator=chatThreadClient.listMessages({maxPageSize:50})),remainingMessagesToGet=messagesToLoad,isAllChatMessagesLoaded=!1;case 3:if(!(remainingMessagesToGet>=1)){_context8.next=13;break}return _context8.next=6,messageIterator.next();case 6:if(message=_context8.sent,null!==(_message$value=message.value)&&void 0!==_message$value&&_message$value.type&&"text"===message.value.type&&remainingMessagesToGet--,!message.done){_context8.next=11;break}return isAllChatMessagesLoaded=!0,_context8.abrupt("break",13);case 11:_context8.next=3;break;case 13:return _context8.abrupt("return",isAllChatMessagesLoaded);case 14:case"end":return _context8.stop()}}),_callee8)}))),function onLoadPreviousChatMessages(_x9){return _onLoadPreviousChatMessages.apply(this,arguments)})}})),react=__webpack_require__(1),jsx_runtime=__webpack_require__(2),ChatClientContext=Object(react.createContext)(void 0),ChatClientProvider_ChatClientProvider=function ChatClientProvider(props){return Object(jsx_runtime.jsx)(ChatClientContext.Provider,{value:props.chatClient,children:props.children})};ChatClientProvider_ChatClientProvider.displayName="ChatClientProvider";ChatClientProvider_ChatClientProvider.__docgenInfo={description:"A {@link React.Context} that stores a {@link StatefulChatClient}.\n\nChat components from this package must be wrapped with a {@link ChatClientProvider}.\n\n@public",methods:[],displayName:"ChatClientProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},chatClient:{required:!0,tsType:{name:"StatefulChatClient"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../chat-component-bindings/src/providers/ChatClientProvider.tsx"]={name:"ChatClientProvider",docgenInfo:ChatClientProvider_ChatClientProvider.__docgenInfo,path:"../chat-component-bindings/src/providers/ChatClientProvider.tsx"});var ChatThreadClientContext=Object(react.createContext)(void 0),ChatThreadClientProvider_ChatThreadClientProvider=function ChatThreadClientProvider(props){return Object(jsx_runtime.jsx)(ChatThreadClientContext.Provider,{value:props.chatThreadClient,children:props.children})};ChatThreadClientProvider_ChatThreadClientProvider.displayName="ChatThreadClientProvider";ChatThreadClientProvider_ChatThreadClientProvider.__docgenInfo={description:"A {@link React.Context} that stores a {@link @azure/communication-chat#ChatThreadClient}.\n\nChat components from this package must be wrapped with a {@link ChatThreadClientProvider}.\n\n@public",methods:[],displayName:"ChatThreadClientProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},chatThreadClient:{required:!0,tsType:{name:"ChatThreadClient"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../chat-component-bindings/src/providers/ChatThreadClientProvider.tsx"]={name:"ChatThreadClientProvider",docgenInfo:ChatThreadClientProvider_ChatThreadClientProvider.__docgenInfo,path:"../chat-component-bindings/src/providers/ChatThreadClientProvider.tsx"});__webpack_require__(7);var react_components_src=__webpack_require__(21);__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var es=__webpack_require__(50),baseSelectors_getUserId=(__webpack_require__(122),__webpack_require__(98),function getUserId(state){return Object(src.g)(state.userId)}),getDisplayName=function getDisplayName(state){return state.displayName},getParticipants=function getParticipants(state,props){var _state$threads$props$2;return props.threadId&&(null===(_state$threads$props$2=state.threads[props.threadId])||void 0===_state$threads$props$2?void 0:_state$threads$props$2.participants)||{}},sendBoxSelector=Object(es.a)([baseSelectors_getUserId,getDisplayName],(function(userId,displayName){return{displayName:displayName,userId:userId}})),ACSKnownMessageType_text=(__webpack_require__(34),__webpack_require__(62),__webpack_require__(355),__webpack_require__(125),__webpack_require__(70),"text"),ACSKnownMessageType_html="html",ACSKnownMessageType_richtextHtml="richtext/html",ACSKnownMessageType_participantAdded="participantAdded",ACSKnownMessageType_participantRemoved="participantRemoved",compareMessages=(__webpack_require__(426),__webpack_require__(1363),__webpack_require__(255),function compareMessages(firstMessage,secondMessage){if(void 0===firstMessage.createdOn)return 1;if(void 0===secondMessage.createdOn)return-1;var firstDate=new Date(firstMessage.createdOn).getTime(),secondDate=new Date(secondMessage.createdOn).getTime(),idDelta=firstMessage.messageId&&secondMessage.messageId?Number.parseInt(firstMessage.messageId)-Number.parseInt(secondMessage.messageId):0;return firstDate-secondDate==0?idDelta:firstDate-secondDate});__webpack_require__(168);function getParticipantsWhoHaveReadMessage_slicedToArray(arr,i){return function getParticipantsWhoHaveReadMessage_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function getParticipantsWhoHaveReadMessage_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function getParticipantsWhoHaveReadMessage_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return getParticipantsWhoHaveReadMessage_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return getParticipantsWhoHaveReadMessage_arrayLikeToArray(o,minLen)}(arr,i)||function getParticipantsWhoHaveReadMessage_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function getParticipantsWhoHaveReadMessage_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var memoizedAllConvertChatMessage=Object(src.f)((function(_key,chatMessage,userId,isSeen,isLargeGroup,readNumber,readBy){var messageType=chatMessage.type.toLowerCase();return messageType===ACSKnownMessageType_text||messageType===ACSKnownMessageType_richtextHtml||messageType===ACSKnownMessageType_html?messageThreadSelector_convertToUiChatMessage(chatMessage,userId,isSeen,isLargeGroup,readNumber,readBy):messageThreadSelector_convertToUiSystemMessage(chatMessage)})),messageThreadSelector_convertToUiChatMessage=function convertToUiChatMessage(message,userId,isSeen,isLargeGroup,readNumber,readBy){var _message$content,messageSenderId=void 0!==message.sender?Object(src.g)(message.sender):userId;return{messageType:"chat",createdOn:message.createdOn,content:null===(_message$content=message.content)||void 0===_message$content?void 0:_message$content.message,contentType:sanitizedMessageContentType(message.type),status:!isLargeGroup&&"delivered"===message.status&&isSeen?"seen":message.status,senderDisplayName:message.senderDisplayName,senderId:messageSenderId,messageId:message.id,clientMessageId:message.clientMessageId,editedOn:message.editedOn,deletedOn:message.deletedOn,mine:messageSenderId===userId,readNumber:readNumber,readBy:readBy,metadata:message.metadata}},messageThreadSelector_convertToUiSystemMessage=function convertToUiSystemMessage(message){var _message$content$part,_message$content2,_message$content2$par,_message$content$topi,_message$content3,systemMessageType=message.type;return"participantAdded"===systemMessageType||"participantRemoved"===systemMessageType?{messageType:"system",systemMessageType:systemMessageType,createdOn:message.createdOn,participants:null!==(_message$content$part=null===(_message$content2=message.content)||void 0===_message$content2||null===(_message$content2$par=_message$content2.participants)||void 0===_message$content2$par?void 0:_message$content2$par.filter((function(participant){return participant.displayName&&""!==participant.displayName})).map((function(participant){return{userId:Object(src.g)(participant.id),displayName:participant.displayName}})))&&void 0!==_message$content$part?_message$content$part:[],messageId:message.id,iconName:"participantAdded"===systemMessageType?"PeopleAdd":"PeopleBlock"}:{messageType:"system",systemMessageType:"topicUpdated",createdOn:message.createdOn,topic:null!==(_message$content$topi=null===(_message$content3=message.content)||void 0===_message$content3?void 0:_message$content3.topic)&&void 0!==_message$content$topi?_message$content$topi:"",messageId:message.id,iconName:"Edit"}},hasValidParticipant=function hasValidParticipant(chatMessage){var _chatMessage$content;return!(null===(_chatMessage$content=chatMessage.content)||void 0===_chatMessage$content||!_chatMessage$content.participants)&&chatMessage.content.participants.some((function(p){return!!p.displayName}))},messageThreadSelector=Object(es.a)([baseSelectors_getUserId,function getChatMessages(state,props){var _state$threads$props$;return props.threadId&&(null===(_state$threads$props$=state.threads[props.threadId])||void 0===_state$threads$props$?void 0:_state$threads$props$.chatMessages)||{}},function getLatestReadTime(state,props){var _state$threads$props$5;return props.threadId&&(null===(_state$threads$props$5=state.threads[props.threadId])||void 0===_state$threads$props$5?void 0:_state$threads$props$5.latestReadTime)||new Date(0)},function getIsLargeGroup(state,props){var _state$threads$props$4,participants=null===(_state$threads$props$4=state.threads[props.threadId])||void 0===_state$threads$props$4?void 0:_state$threads$props$4.participants;return!!participants&&Object.values(participants).length>20},function getReadReceipts(state,props){var _state$threads$props$3;return null===(_state$threads$props$3=state.threads[null==props?void 0:props.threadId])||void 0===_state$threads$props$3?void 0:_state$threads$props$3.readReceipts},getParticipants],(function(userId,chatMessages,latestReadTime,isLargeGroup,readReceipts,participants){var messageThreadParticipantCount=Object.values(participants).filter((function(p){return p.displayName&&""!==p.displayName})).length,readReceiptForEachSender={};readReceipts.forEach((function(r){var _participants$toFlatC,_participants$toFlatC2;readReceiptForEachSender[Object(src.g)(r.sender)]={lastReadMessage:r.chatMessageId,name:null!==(_participants$toFlatC=null===(_participants$toFlatC2=participants[Object(src.g)(r.sender)])||void 0===_participants$toFlatC2?void 0:_participants$toFlatC2.displayName)&&void 0!==_participants$toFlatC?_participants$toFlatC:""}}));var convertedMessages=memoizedAllConvertChatMessage((function(memoizedFn){return Object.values(chatMessages).filter((function(message){return message.type.toLowerCase()===ACSKnownMessageType_text||message.type.toLowerCase()===ACSKnownMessageType_richtextHtml||message.type.toLowerCase()===ACSKnownMessageType_html||message.type===ACSKnownMessageType_participantAdded&&hasValidParticipant(message)||message.type===ACSKnownMessageType_participantRemoved&&hasValidParticipant(message)||void 0!==message.clientMessageId})).filter((function(message){return message.content&&""!==message.content.message})).map((function(message){var _message$id,readBy=function getParticipantsWhoHaveReadMessage(message,readReceiptForEachSender){return Object.entries(readReceiptForEachSender).filter((function(_ref){var _ref2=getParticipantsWhoHaveReadMessage_slicedToArray(_ref,2);return _ref2[0],_ref2[1].lastReadMessage>=message.id})).filter((function(_ref3){var _ref4=getParticipantsWhoHaveReadMessage_slicedToArray(_ref3,2),readReceipt=(_ref4[0],_ref4[1]);return readReceipt.name&&""!==readReceipt.name})).map((function(_ref5){var _ref6=getParticipantsWhoHaveReadMessage_slicedToArray(_ref5,2);return{id:_ref6[0],name:_ref6[1].name}}))}(message,readReceiptForEachSender);return memoizedFn(null!==(_message$id=message.id)&&void 0!==_message$id?_message$id:message.clientMessageId,message,userId,message.createdOn<=latestReadTime,isLargeGroup,readBy.length,readBy)}))}));return function updateMessagesWithAttached(chatMessagesWithStatus,userId){chatMessagesWithStatus.sort(compareMessages),chatMessagesWithStatus.forEach((function(message,index,messages){if("chat"===message.messageType){var attached=!1,previousMessage=index>0?messages[index-1]:void 0,nextMessage=index===messages.length-1?void 0:messages[index+1],previousSenderId="chat"===(null==previousMessage?void 0:previousMessage.messageType)?previousMessage.senderId:void 0,nextSenderId="chat"===(null==nextMessage?void 0:nextMessage.messageType)?nextMessage.senderId:void 0;attached=previousSenderId!==message.senderId?message.senderId===nextSenderId&&"top":message.senderId===nextSenderId||"bottom",message.attached=attached}}))}(convertedMessages),{userId:userId,showMessageStatus:!isLargeGroup,messages:convertedMessages,messageThreadParticipantCount:messageThreadParticipantCount}})),sanitizedMessageContentType=function sanitizedMessageContentType(type){var lowerCaseType=type.toLowerCase();return"text"===lowerCaseType||"html"===lowerCaseType||"richtext/html"===lowerCaseType?lowerCaseType:"unknown"},typingIndicatorSelector=(__webpack_require__(189),__webpack_require__(266),Object(es.a)([function getTypingIndicators(state,props){var _state$threads$props$6;return props.threadId&&(null===(_state$threads$props$6=state.threads[props.threadId])||void 0===_state$threads$props$6?void 0:_state$threads$props$6.typingIndicators)||[]},getParticipants,baseSelectors_getUserId],(function(typingIndicators,participants,userId){return Object.values(participants).length>=20?{typingUsers:[]}:{typingUsers:function convertSdkTypingIndicatorsToCommunicationParticipants(typingIndicators,participants){return typingIndicators.map((function(typingIndicator){var _participants$toFlatC;return{userId:Object(src.g)(typingIndicator.sender),displayName:null===(_participants$toFlatC=participants[Object(src.g)(typingIndicator.sender)])||void 0===_participants$toFlatC?void 0:_participants$toFlatC.displayName}}))}(function filterTypingIndicators(typingIndicators,userId){for(var filteredTypingIndicators=[],seen=new Set,date8SecondsAgo=new Date(Date.now()-8e3),i=typingIndicators.length-1;i>=0;i--){var typingIndicator=typingIndicators[i];Object(src.g)(typingIndicator.sender)!==userId&&(typingIndicator.receivedOn<date8SecondsAgo||seen.has(Object(src.g)(typingIndicator.sender))||(seen.add(Object(src.g)(typingIndicator.sender)),filteredTypingIndicators.push(typingIndicator)))}return filteredTypingIndicators}(typingIndicators,userId),participants)}}))),identifierModels=(__webpack_require__(74),__webpack_require__(437)),chatParticipantListSelector=es.a([baseSelectors_getUserId,getParticipants,getDisplayName],(function(userId,chatParticipants,displayName){var participants=function convertChatParticipantsToCommunicationParticipants(chatParticipants){return chatParticipants.map((function(participant){return{userId:Object(src.g)(participant.id),displayName:participant.displayName,isRemovable:"communicationUser"==Object(identifierModels.a)(participant.id).kind}}))}(Object.values(chatParticipants));if(0!==participants.length){var moderatorIdx=function moderatorIndex(participants){return participants.map((function(p){return p.displayName})).indexOf(void 0)}(participants);if(-1!==moderatorIdx)moderatorIdx===participants.map((function(p){return p.userId})).indexOf(userId)?participants[moderatorIdx].displayName=displayName:participants=participants.filter((function(p){return p.displayName}))}return{myUserId:userId,participants:participants}}));__webpack_require__(296);function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function errorBarSelector_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return errorBarSelector_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return errorBarSelector_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function errorBarSelector_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var errorBarSelector=Object(es.a)([function getLatestErrors(state){return state.latestErrors}],(function(latestErrors){var activeErrorMessages=[],specificSendMessageErrorSeen=!1,_error=latestUnableToReachChatServiceError(latestErrors);void 0!==_error&&activeErrorMessages.push(_error);var _error2=latestAccessDeniedError(latestErrors);void 0!==_error2&&activeErrorMessages.push(_error2);var _error3$timestamp,sendMessageError=latestErrors["ChatThreadClient.sendMessage"],_error3=latestNotInThisThreadError(latestErrors);void 0!==_error3&&(void 0!==sendMessageError?(activeErrorMessages.push({type:"sendMessageNotInChatThread",timestamp:sendMessageError.timestamp>(null!==(_error3$timestamp=_error3.timestamp)&&void 0!==_error3$timestamp?_error3$timestamp:0)?sendMessageError.timestamp:_error3.timestamp}),specificSendMessageErrorSeen=!0):activeErrorMessages.push(_error3));return specificSendMessageErrorSeen||void 0===sendMessageError||activeErrorMessages.push({type:"sendMessageGeneric",timestamp:sendMessageError.timestamp}),activeErrorMessages.splice(maxErrorCount),{activeErrorMessages:activeErrorMessages}})),maxErrorCount=3,accessErrorTargets=["ChatThreadClient.getProperties","ChatThreadClient.listMessages","ChatThreadClient.listParticipants","ChatThreadClient.sendMessage","ChatThreadClient.sendTypingNotification"],latestUnableToReachChatServiceError=function latestUnableToReachChatServiceError(latestErrors){return latestActiveErrorSatisfying(latestErrors,"unableToReachChatService",(function(error){return!!error&&!!error.innerError&&"REQUEST_SEND_ERROR"===error.innerError.code}))},latestAccessDeniedError=function latestAccessDeniedError(latestErrors){return latestActiveErrorSatisfying(latestErrors,"accessDenied",(function(error){return!!error&&!!error.innerError&&401===error.innerError.statusCode}))},latestNotInThisThreadError=function latestNotInThisThreadError(latestErrors){return latestActiveErrorSatisfying(latestErrors,"userNotInChatThread",(function(error){return!(!error||!error.innerError)&&[400,403,404].some((function(statusCode){return error.innerError.statusCode===statusCode}))}))},latestActiveErrorSatisfying=function latestActiveErrorSatisfying(errors,activeErrorType,predicate){var _step,activeErrorMessages=[],_iterator=_createForOfIteratorHelper(accessErrorTargets);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _error4=errors[_step.value];predicate(_error4)&&activeErrorMessages.push({type:activeErrorType,timestamp:_error4.timestamp})}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(0!==activeErrorMessages.length)return activeErrorMessages.sort((function(a,b){var _a$timestamp$getTime,_a$timestamp,_b$timestamp$getTime,_b$timestamp;return(null!==(_a$timestamp$getTime=null===(_a$timestamp=a.timestamp)||void 0===_a$timestamp?void 0:_a$timestamp.getTime())&&void 0!==_a$timestamp$getTime?_a$timestamp$getTime:0)-(null!==(_b$timestamp$getTime=null===(_b$timestamp=b.timestamp)||void 0===_b$timestamp?void 0:_b$timestamp.getTime())&&void 0!==_b$timestamp$getTime?_b$timestamp$getTime:0)})),activeErrorMessages[activeErrorMessages.length-1]},getSelector=function getSelector(component){return usePropsFor_findSelector(component)},usePropsFor_findSelector=function findSelector(component){switch(component){case react_components_src.G:return sendBoxSelector;case react_components_src.A:return messageThreadSelector;case react_components_src.I:return typingIndicatorSelector;case react_components_src.D:return chatParticipantListSelector;case react_components_src.u:return errorBarSelector}}},57:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",(function(){return DEFAULT_COMPOSITE_ICONS})),__webpack_require__.d(__webpack_exports__,"c",(function(){return ChatCompositeIcon})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CallCompositeIcon})),__webpack_require__.d(__webpack_exports__,"b",(function(){return CallWithChatCompositeIcon}));__webpack_require__(7);var _fluentui_react_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1519),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(893),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(896),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1518),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1521),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1534),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1535),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1517),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(1520),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1536),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(1530),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(1532),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(1533),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(894),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1522),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1523),_internal_react_components__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(21),_fluentui_react__WEBPACK_IMPORTED_MODULE_19__=(__webpack_require__(1),__webpack_require__(499)),_fluentui_react__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(22),_fluentui_react__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(229),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(1531),_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1537),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(2),CoffeeIcon=function CoffeeIcon(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_19__.a,{className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_20__.H)(coffeeIconStyle),"aria-hidden":!0,children:""})};CoffeeIcon.displayName="CoffeeIcon";var coffeeIconStyle={fontStyle:"normal",fontSize:"2rem"},COMPOSITE_ONLY_ICONS={Cancel:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_21__.a,{iconName:"Cancel"}),ChevronLeft:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_21__.a,{iconName:"ChevronLeft"}),Download:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_21__.a,{iconName:"Download"}),Link:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_21__.a,{iconName:"Link"}),LobbyScreenConnectingToCall:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(CoffeeIcon,{}),LobbyScreenWaitingToBeAdmitted:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(CoffeeIcon,{}),LocalDeviceSettingsCamera:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_1__.a,{}),LocalDeviceSettingsMic:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_2__.a,{}),LocalDeviceSettingsSpeaker:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_3__.a,{}),LocalPreviewPlaceholder:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_4__.a,{}),LocalCameraSwitch:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_11__.a,{}),ControlBarButtonBadgeIcon:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_22__.a,{}),ControlBarChatButtonActive:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_12__.a,{}),ControlBarChatButtonInactive:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_13__.a,{}),ControlBarPeopleButton:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_14__.a,{}),MoreDrawerMicrophones:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_15__.a,{}),MoreDrawerPeople:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_14__.a,{}),MoreDrawerSpeakers:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_16__.a,{}),MoreDrawerSelectedMicrophone:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_2__.a,{}),MoreDrawerSelectedSpeaker:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_3__.a,{}),Muted:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_5__.a,{}),NetworkReconnectIcon:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_6__.a,{}),NoticePageAccessDeniedTeamsMeeting:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_7__.a,{}),NoticePageJoinCallFailedDueToNoNetwork:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_8__.a,{}),NoticePageLeftCall:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_9__.a,{}),NoticePageRemovedFromCall:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_10__.a,{}),SendBoxAttachFile:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react_icons__WEBPACK_IMPORTED_MODULE_23__.a,{})},DEFAULT_COMPOSITE_ICONS=Object.assign({},_internal_react_components__WEBPACK_IMPORTED_MODULE_17__.r,COMPOSITE_ONLY_ICONS),ChatCompositeIcon=function ChatCompositeIcon(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_21__.a,Object.assign({},props))};ChatCompositeIcon.displayName="ChatCompositeIcon";var CallCompositeIcon=function CallCompositeIcon(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_21__.a,Object.assign({},props))};CallCompositeIcon.displayName="CallCompositeIcon";var CallWithChatCompositeIcon=function CallWithChatCompositeIcon(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_24__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_21__.a,Object.assign({},props))};CallWithChatCompositeIcon.displayName="CallWithChatCompositeIcon",ChatCompositeIcon.__docgenInfo={description:"Icon wrapper to use when including customizable icons inside the ChatComposite.\nThis wrapper ensures the icon name is being type-checked helping ensure no typos\nand ensure that icon is customizable through the composite API.\n\n@private",methods:[],displayName:"ChatCompositeIcon",props:{iconName:{required:!0,tsType:{name:"unknown"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/icons.tsx"]={name:"ChatCompositeIcon",docgenInfo:ChatCompositeIcon.__docgenInfo,path:"../react-composites/src/composites/common/icons.tsx"}),CallCompositeIcon.__docgenInfo={description:"Icon wrapper to use when including customizable icons inside the CallComposite.\nThis wrapper ensures the icon name is being type-checked helping ensure no typos\nand ensure that icon is customizable through the composite API.\n\n@private",methods:[],displayName:"CallCompositeIcon",props:{iconName:{required:!0,tsType:{name:"unknown"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/icons.tsx"]={name:"CallCompositeIcon",docgenInfo:CallCompositeIcon.__docgenInfo,path:"../react-composites/src/composites/common/icons.tsx"}),CallWithChatCompositeIcon.__docgenInfo={description:"Icon wrapper to use when including customizable icons inside the CallWithChatComposite.\nThis wrapper ensures the icon name is being type-checked helping ensure no typos\nand ensure that icon is customizable through the composite API.\n\n@private",methods:[],displayName:"CallWithChatCompositeIcon",props:{iconName:{required:!0,tsType:{name:"unknown"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/icons.tsx"]={name:"CallWithChatCompositeIcon",docgenInfo:CallWithChatCompositeIcon.__docgenInfo,path:"../react-composites/src/composites/common/icons.tsx"})},592:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, StreamMedia, VideoTile, VideoTileStylesProps } from '@azure/communication-react';\nimport React from 'react';\nimport { useVideoStreams } from '../../utils';\n\nexport const VideoTileExample: () => JSX.Element = () => {\n  const customStyles: VideoTileStylesProps = {\n    root: { height: '300px', width: '400px' },\n    videoContainer: { border: '5px solid red' },\n    overlayContainer: { background: 'rgba(165, 13, 13, 0.5)' },\n    displayNameContainer: {\n      top: '1rem',\n      bottom: 'auto',\n      right: '1rem',\n      left: 'auto',\n      backgroundColor: 'blue',\n      color: 'white'\n    }\n  };\n  const videoStyles = { root: { '& video': { borderRadius: '0rem' } } };\n\n  const videoStreamElement = useVideoStreams(1)[0];\n\n  return (\n    <FluentThemeProvider>\n      <VideoTile\n        renderElement={\n          // NOTE: Replace with your own video provider. (An html element with video stream)\n          <StreamMedia styles={videoStyles} videoStreamElement={videoStreamElement} />\n        }\n        displayName={'Jack Reacher'}\n        isMirrored={true}\n        isMuted={true}\n        styles={customStyles}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},6:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"h",(function(){return getControlledBotAvatarSymbol})),__webpack_require__.d(__webpack_exports__,"e",(function(){return defaultControlsCameras})),__webpack_require__.d(__webpack_exports__,"f",(function(){return defaultControlsMicrophones})),__webpack_require__.d(__webpack_exports__,"g",(function(){return defaultControlsSpeakers})),__webpack_require__.d(__webpack_exports__,"i",(function(){return getControlledTheme})),__webpack_require__.d(__webpack_exports__,"a",(function(){return controlsToAdd})),__webpack_require__.d(__webpack_exports__,"j",(function(){return hiddenControl})),__webpack_require__.d(__webpack_exports__,"b",(function(){return defaultCallCompositeHiddenControls})),__webpack_require__.d(__webpack_exports__,"d",(function(){return defaultChatCompositeHiddenControls})),__webpack_require__.d(__webpack_exports__,"c",(function(){return defaultCallWithChatCompositeHiddenControls}));var _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(895),_fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1544),_fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1527),_fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1528),_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(191),_constants__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(14),getControlledBotAvatarSymbol=function getControlledBotAvatarSymbol(AvatarName){switch(AvatarName){case"Default":return"";case"Cat":return"";case"Fox":return"";case"Koala":return""}return""},defaultControlsCameras=[{id:"camera1",name:"Full HD Webcam"},{id:"camera2",name:"Macbook Pro Webcam"}],defaultControlsMicrophones=[{id:"mic1",name:"Realtek HD Audio"},{id:"mic2",name:"Macbook Pro Mic"}],defaultControlsSpeakers=[{id:"speaker1",name:"Realtek HD Audio"},{id:"speaker2",name:"Macbook Pro Speaker"}],getControlledTheme=function getControlledTheme(choice){switch(choice){case"Default":return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_0__.a;case"Dark":return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_1__.a;case"Teams":return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_2__.a;case"Word":return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_3__.a}return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_0__.a},controlsToAdd={avatarInitials:{control:"text",defaultValue:"A B",name:"Avatar initials"},botAvatar:{control:"radio",options:["Default","Cat","Fox","Koala"],defaultValue:"Default",name:"Bot Avatar"},botToken:{control:"text",defaultValue:"",name:"Valid token for bot"},botUserId:{control:"text",defaultValue:"",name:"User identifier for bot"},callerImages:{control:"file",accept:".jpeg, .jpg, .png",defaultValue:[],name:"Avatar"},callerName:{control:"text",defaultValue:"Maximus Aurelius",name:"Caller Name"},callerNameAlt:{control:"text",defaultValue:"1st",name:"Caller Name Alt"},callerTitle:{control:"text",defaultValue:"Emperor and Philosopher, Rome",name:"Caller Title"},callInvitationURL:{control:"text",defaultValue:"",name:"Optional URL to invite other participants to the call"},callLocator:{control:"text",defaultValue:"",name:"Call locator (ACS group ID or Teams meeting link)"},callModalAlertText:{control:"text",defaultValue:"Incoming Video Call",name:"Alert Text"},callToastAlertText:{control:"text",defaultValue:"Incoming Call",name:"Alert Text"},callStateText:{control:"text",defaultValue:"You're in the lobby",name:"Call State Text"},callStateSubText:{control:"text",defaultValue:"You should be admitted shortly",name:"Call State Subtext"},cameras:{control:"object",defaultValue:defaultControlsCameras,name:"Cameras"},chatThreadId:{control:"text",defaultValue:"",name:"Existing thread"},checked:{control:"boolean",defaultValue:!1,name:"Is checked"},connectionString:{control:"text",defaultValue:"",name:_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_4__.a},controlBarDefaultIcons:{control:"radio",options:["airplane","bus","ship"],defaultValue:"airplane",name:"Icon"},controlBarLayout:{control:"select",options:["horizontal","vertical","dockedTop","dockedBottom","dockedLeft","dockedRight","floatingTop","floatingBottom","floatingLeft","floatingRight"],defaultValue:"floatingBottom",name:"Layout"},disabled:{control:"boolean",defaultValue:!1,name:"Disable component"},displayName:{control:"text",defaultValue:"John Smith",name:"Display Name"},enableJumpToNewMessageButton:{control:"boolean",defaultValue:!0,name:"Enable Jump To New Message"},endpointUrl:{control:"text",defaultValue:"",name:"Azure Communication Services endpoint URL"},errorTypes:{control:"check",options:["unableToReachChatService","accessDenied","userNotInChatThread","sendMessageNotInChatThread","sendMessageGeneric","startVideoGeneric","stopVideoGeneric","muteGeneric","unmuteGeneric","startScreenShareGeneric","stopScreenShareGeneric","callNetworkQualityLow","callNoSpeakerFound","callNoMicrophoneFound","callMicrophoneAccessDenied","callMicrophoneMutedBySystem","callMacOsMicrophoneAccessDenied","callLocalVideoFreeze","callCameraAlreadyInUse","callMacOsCameraAccessDenied","callMacOsScreenShareAccessDenied"],defaultValue:["accessDenied"],name:"ErrorType"},excludeMeFromList:{control:"boolean",defaultValue:!1,name:"Are you excluded from the list"},font:{control:"text",defaultValue:"Monaco, Menlo, Consolas",name:"Font"},gridParticipants:{control:"object",defaultValue:[{displayName:"Michael",isVideoReady:!1},{displayName:"Jim",isVideoReady:!1},{displayName:"Pam",isVideoReady:!1},{displayName:"Dwight",isVideoReady:!1}],name:"Participants"},isCameraEnabled:{control:"boolean",defaultValue:!0,name:"Is camera available"},isMe:{control:"boolean",defaultValue:!1,name:"Is You"},isMicrophoneEnabled:{control:"boolean",defaultValue:!0,name:"Is microphone available"},isMuteAllAvailable:{control:"boolean",defaultValue:!1,name:"Mute all participants option"},isMuted:{control:"boolean",defaultValue:!1,name:"Is muted"},isSpeaking:{control:"boolean",defaultValue:!1,name:"Is Speaking"},isScreenSharing:{control:"boolean",defaultValue:!1,name:"Is screen sharing"},isSendBoxWithWarning:{control:"boolean",defaultValue:!1,name:"Has warning/information message"},isVideoAvailable:{control:"boolean",defaultValue:!0,name:"Is video available"},isVideoMirrored:{control:"boolean",defaultValue:!1,name:"Is video mirrored"},isVideoReady:{control:"boolean",defaultValue:!1,name:"Is Video ready"},layoutHeight:{control:{type:"range",min:_constants__WEBPACK_IMPORTED_MODULE_5__.j.min,max:_constants__WEBPACK_IMPORTED_MODULE_5__.j.max,step:_constants__WEBPACK_IMPORTED_MODULE_5__.j.step},defaultValue:_constants__WEBPACK_IMPORTED_MODULE_5__.i,name:"Height (px)"},layoutWidth:{control:{type:"range",min:_constants__WEBPACK_IMPORTED_MODULE_5__.l.min,max:_constants__WEBPACK_IMPORTED_MODULE_5__.l.max,step:_constants__WEBPACK_IMPORTED_MODULE_5__.l.step},defaultValue:_constants__WEBPACK_IMPORTED_MODULE_5__.k,name:"Width (px)"},localParticipantDisplayName:{control:"text",defaultValue:"John Doe",name:"Local Participant displayName"},localParticipant:{control:"object",defaultValue:[{name:"You",status:"Connected",isMuted:!1,isScreenSharing:!1}],name:"Your information"},localVideoInverted:{control:"boolean",defaultValue:!0,name:"Invert Local Video"},localVideoStreamEnabled:{control:"boolean",defaultValue:!0,name:"Turn Local Video On"},messageDeliveredTooltipText:{control:"text",defaultValue:"Sent",name:"Delivered icon tooltip text"},messageFailedToSendTooltipText:{control:"text",defaultValue:"Failed to send",name:"Failed to send icon tooltip text"},messageSeenTooltipText:{control:"text",defaultValue:"Seen",name:"Seen icon tooltip text"},messageReadByTooltipText:{control:"text",defaultValue:"Read by 2 of 2",name:"Read by icon tooltip text"},messageSendingTooltipText:{control:"text",defaultValue:"Sending",name:"Sending icon tooltip text"},messageStatus:{control:"select",options:["delivered","sending","seen","failed"],defaultValue:"delivered",name:"Message Status"},microphones:{control:"object",defaultValue:defaultControlsMicrophones,name:"Microphones"},formFactor:{control:"select",options:["desktop","mobile"],defaultValue:"desktop",name:"Form Factor"},participantItemMenuItemsStr:{control:"text",defaultValue:"Mute, Remove",name:"Menu items (comma separated)"},participantNames:{control:"text",defaultValue:"You, Hal Jordan, Barry Allen, Bruce Wayne",name:"Participants (comma separated with You being local user)"},remoteParticipantNames:{control:"text",defaultValue:"Rick, Daryl, Michonne, Dwight, Pam, Michael, Jim, Kevin, Creed, Angela, Andy, Stanley, Meredith, Phyllis, Oscar, Ryan, Kelly, Andy, Toby, Darryl, Gabe, Erin",name:"Remote participants (comma separated)"},remoteParticipants:{control:"object",defaultValue:[{name:"Rick",status:"InLobby",isMuted:!1,isScreenSharing:!1},{name:"Daryl",status:"Connecting",isMuted:!1,isScreenSharing:!1},{name:"Michonne",status:"Idle",isMuted:!1,isScreenSharing:!1}],name:"Remote participants"},screenShareExperience:{control:"select",options:["none","presenter","viewer"],defaultValue:"none",name:"Screen sharing experience"},sendBoxWarningMessage:{control:"text",defaultValue:"Please wait 30 seconds to send new messages",name:"Warning/information message for SendBox"},showChatParticipants:{control:"boolean",defaultValue:!0,name:"Show Participants Pane"},showChatTopic:{control:"boolean",defaultValue:!0,name:"Show Topic"},showErrorBar:{control:"boolean",defaultValue:!0,name:"Show ErrorBar"},showLabel:{control:"boolean",defaultValue:!1,name:"Show label"},showMessageDate:{control:"boolean",defaultValue:!0,name:"Enable Message Date"},showMessageStatus:{control:"boolean",defaultValue:!0,name:"Enable Message Status Indicator"},showMuteIndicator:{control:"boolean",defaultValue:!0,name:"Show Mute/UnMute Indicator"},speakers:{control:"object",defaultValue:defaultControlsSpeakers,name:"Speakers"},teamsMeetingLink:{control:"text",defaultValue:"",name:"Teams meeting link"},theme:{control:"radio",options:["Default","Dark","Teams","Word"],defaultValue:"Default",name:"Theme"},token:{control:"text",defaultValue:"",name:"Valid token for user"},typingUsers:{control:"object",defaultValue:[{userId:"1",displayName:"User1"},{userId:"2",displayName:"User2"}],name:"Typing users"},userId:{control:"text",defaultValue:"",name:"User identifier for user"},videoGallerylayout:{control:"select",options:["default","floatingLocalVideo"],defaultValue:"floatingLocalVideo",name:"Layout"},videoTileHeight:{control:{type:"range",min:80,max:800,step:10},defaultValue:300,name:"Height (px)"},videoTileWidth:{control:{type:"range",min:100,max:1200,step:10},defaultValue:400,name:"Width (px)"},callWithChatControlOptions:{control:"object",defaultValue:{microphoneButton:!0,cameraButton:!0,screenShareButton:!0,devicesButton:!0,peopleButton:!0,chatButton:!0},name:"CallWithChat Composite UI Controls"}},hiddenControl={control:!1,table:{disable:!0}},defaultCallCompositeHiddenControls={adapter:hiddenControl,fluentTheme:hiddenControl,onRenderAvatar:hiddenControl,identifiers:hiddenControl,locale:hiddenControl,onFetchAvatarPersonaData:hiddenControl,rtl:hiddenControl,options:hiddenControl,callInvitationUrl:hiddenControl},defaultChatCompositeHiddenControls={adapter:hiddenControl,fluentTheme:hiddenControl,onRenderAvatar:hiddenControl,onRenderMessage:hiddenControl,onRenderTypingIndicator:hiddenControl,options:hiddenControl,identifiers:hiddenControl,locale:hiddenControl,onFetchAvatarPersonaData:hiddenControl,rtl:hiddenControl},defaultCallWithChatCompositeHiddenControls={callWithChatAdapter:hiddenControl,fluentTheme:hiddenControl,joinInvitationURL:hiddenControl,rtl:hiddenControl,options:hiddenControl,formFactor:hiddenControl}},603:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(you)","menuTitle":"More Options","removeButtonLabel":"Remove","sharingIconLabel":"Sharing","mutedIconLabel":"Muted"},"typingIndicator":{"singleUser":"{user} is typing ...","multipleUsers":"{users} are typing ...","multipleUsersAbbreviateOne":"{users} and 1 other are typing ...","multipleUsersAbbreviateMany":"{users} and {numOthers} others are typing ...","delimiter":", "},"sendBox":{"placeholderText":"Enter a message","textTooLong":"Your message length is over the maximum limit.","sendButtonAriaLabel":"Send message"},"messageStatusIndicator":{"deliveredAriaLabel":"Message sent","deliveredTooltipText":"Sent","seenAriaLabel":"Message seen by others","seenTooltipText":"Seen","readByTooltipText":"Read by {messageThreadReadCount} of {remoteParticipantsCount}","sendingAriaLabel":"Message sending","sendingTooltipText":"Sending","failedToSendAriaLabel":"Message failed to send","failedToSendTooltipText":"Failed to send"},"endCallButton":{"label":"Leave","tooltipContent":"Leave Call"},"cameraButton":{"onLabel":"Turn off","offLabel":"Turn on","tooltipDisabledContent":"Camera is disabled","tooltipOnContent":"Turn off camera","tooltipOffContent":"Turn on camera","tooltipVideoLoadingContent":"Video is loading","cameraMenuTitle":"Camera","cameraMenuTooltip":"Choose Camera"},"microphoneButton":{"onLabel":"Mute","offLabel":"Unmute","tooltipDisabledContent":"Microphone is disabled","tooltipOnContent":"Mute microphone","tooltipOffContent":"Unmute microphone","microphoneMenuTitle":"Microphone","microphoneMenuTooltip":"Choose Microphone","speakerMenuTitle":"Speaker","speakerMenuTooltip":"Choose Speaker"},"devicesButton":{"label":"Devices","tooltipContent":"Manage devices","cameraMenuTitle":"Camera","cameraMenuTooltip":"Choose Camera","microphoneMenuTitle":"Microphone","microphoneMenuTooltip":"Choose Microphone","speakerMenuTitle":"Speaker","speakerMenuTooltip":"Choose Speaker"},"participantsButton":{"label":"People","tooltipContent":"Show Participants","menuHeader":"In this call","participantsListButtonLabel":"{numParticipants} people","muteAllButtonLabel":"Mute all","copyInviteLinkButtonLabel":"Copy invite link"},"screenShareButton":{"onLabel":"Stop presenting","offLabel":"Present","tooltipDisabledContent":"Presenting is disabled","tooltipOnContent":"Presenting your screen","tooltipOffContent":"Present your screen"},"messageThread":{"yesterday":"Yesterday","sunday":"Sunday","monday":"Monday","tuesday":"Tuesday","wednesday":"Wednesday","thursday":"Thursday","friday":"Friday","saturday":"Saturday","participantJoined":"joined the chat.","participantLeft":"left the chat.","editMessage":"Edit","removeMessage":"Delete","editedTag":"Edited","liveAuthorIntro":"{author} says","editBoxTextLimit":"Your message is over the limit of {limitNumber} characters","editBoxPlaceholderText":"Edit your message","newMessagesIndicator":"New messages","noDisplayNameSub":"No name","editBoxCancelButton":"Cancel","editBoxSubmitButton":"Submit","messageReadCount":"Read by {messageReadByCount} of {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"You are offline","accessDenied":"Unable to access chat services - please check the user credentials provided","userNotInChatThread":"You are no longer in this chat thread","sendMessageNotInChatThread":"Failed to send message because you are no longer in this chat thread","sendMessageGeneric":"Failed to send message","callingNetworkFailure":"Troubling connecting call - you seem to be offline","startVideoGeneric":"Failed to start video","stopVideoGeneric":"Failed to stop video","muteGeneric":"Failed to mute microphone","unmuteGeneric":"Failed to unmute microphone","speakingWhileMuted":"Your microphone is muted","startScreenShareGeneric":"Failed to start screen sharing","stopScreenShareGeneric":"Failed to stop screen sharing","callNetworkQualityLow":"Network quality is low.","callNoSpeakerFound":"No speakers or headphones found. Connect an audio device to hear the call.","callNoMicrophoneFound":"No microphones found. Connect an audio input device.","callMicrophoneAccessDenied":"Unable to access microphone. Click the lock in the address bar to grant permission to this webpage.","callMicrophoneMutedBySystem":"You are muted by your system.","callMacOsMicrophoneAccessDenied":"Unable to access microphone. Grant microphone permission in your macOS privacy settings.","callLocalVideoFreeze":"Network bandwidth is poor. Your video may appear paused for others on the call.","callCameraAccessDenied":"Unable to access camera. Click the lock in the address bar to grant permission to this webpage.","callCameraAlreadyInUse":"Unable to access camera. It may already be in use by another application.","callMacOsCameraAccessDenied":"MacOS is blocking access to your camera. Update your privacy settings to allow this browser to access your camera.","callMacOsScreenShareAccessDenied":"MacOS is blocking screen sharing. Update your privacy settings to allow this browser to record your screen."},"videoGallery":{"screenIsBeingSharedMessage":"You are sharing your screen","screenShareLoadingMessage":"Loading {participant}\'s screen","localVideoLabel":"You","localVideoCameraSwitcherLabel":"Cycle camera"}}')},611:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"Camera","cameraPermissionDenied":"Your browser is blocking access to your camera","cameraTurnedOff":"Your camera is turned off","close":"Close","complianceBannerNowOnlyRecording":"You are now only recording this meeting.","complianceBannerNowOnlyTranscription":"You are now only transcribing this meeting.","complianceBannerRecordingAndTranscriptionSaved":"Recording and transcription are being saved.","complianceBannerRecordingAndTranscriptionStarted":"Recording and transcription have started.","complianceBannerRecordingAndTranscriptionStopped":"Recording and transcription have stopped.","complianceBannerRecordingSaving":"Recording is being saved.","complianceBannerRecordingStarted":"Recording has started.","complianceBannerRecordingStopped":"Recording has stopped.","complianceBannerTranscriptionStarted":"Transcription has started.","complianceBannerTranscriptionConsent":"By joining, you are giving consent for this meeting to be transcribed.","complianceBannerTranscriptionSaving":"Transcription is being saved.","complianceBannerTranscriptionStopped":"Transcription has stopped.","configurationPageTitle":"Start a call","defaultPlaceHolder":"Select an option","failedToJoinCallDueToNoNetworkMoreDetails":"Call was disconnected due to a network issue. Check your connection and join again.","failedToJoinCallDueToNoNetworkTitle":"Call disconnected","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"You were not granted entry in the call. If this was a mistake, re-join the call.","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"Dismissed from lobby","learnMore":"Learn more","leftCallMoreDetails":"If this was a mistake, re-join the call.","leftCallTitle":"You left the call","lobbyScreenConnectingToCallTitle":"Joining call","lobbyScreenWaitingToBeAdmittedTitle":"Waiting to be admitted","microphonePermissionDenied":"Your browser is blocking access to your microphone","mutedMessage":"You\'re muted","networkReconnectMoreDetails":"Looks like something went wrong. We\'re trying to get back into the call.","networkReconnectTitle":"Hold on","privacyPolicy":"Privacy policy","rejoinCallButtonLabel":"Re-join call","removedFromCallMoreDetails":"Another participant removed you from the call.","removedFromCallTitle":"You were removed","soundLabel":"Sound","startCallButtonLabel":"Start call","microphoneToggleInLobbyNotAllowed":"Cannot mute or unmute while in lobby."},"chat":{"chatListHeader":"In this chat"},"callWithChat":{"peopleButtonLabel":"People","chatButtonLabel":"Chat","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"People","peoplePaneSubTitle":"In this call","chatPaneTitle":"Chat","chatButtonNewMessageNotificationLabel":"New Message","pictureInPictureTileAriaLabel":"Video Feeds. Click to return to call screen."}}')},67:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getCallStatus})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getDeviceManager})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getIsScreenShareOn})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getIsPreviewCameraOn})),__webpack_require__.d(__webpack_exports__,"i",(function(){return getPage})),__webpack_require__.d(__webpack_exports__,"g",(function(){return getLocalMicrophoneEnabled})),__webpack_require__.d(__webpack_exports__,"h",(function(){return getLocalVideoStreams})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getIsTranscriptionActive})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getIsRecordingActive})),__webpack_require__.d(__webpack_exports__,"j",(function(){return getUserFacingDiagnostics}));var _internal_calling_component_bindings__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(88),getCallStatus=function getCallStatus(state){var _state$call$state,_state$call2;return null!==(_state$call$state=null===(_state$call2=state.call)||void 0===_state$call2?void 0:_state$call2.state)&&void 0!==_state$call$state?_state$call$state:"None"},getDeviceManager=function getDeviceManager(state){return state.devices},getIsScreenShareOn=function getIsScreenShareOn(state){var _state$call$isScreenS,_state$call3;return null!==(_state$call$isScreenS=null===(_state$call3=state.call)||void 0===_state$call3?void 0:_state$call3.isScreenSharingOn)&&void 0!==_state$call$isScreenS&&_state$call$isScreenS},getIsPreviewCameraOn=function getIsPreviewCameraOn(state){return Object(_internal_calling_component_bindings__WEBPACK_IMPORTED_MODULE_0__.d)(state.devices)},getPage=function getPage(state){return state.page},getLocalMicrophoneEnabled=function getLocalMicrophoneEnabled(state){return state.isLocalPreviewMicrophoneEnabled},getLocalVideoStreams=function getLocalVideoStreams(state){var _state$call4;return null===(_state$call4=state.call)||void 0===_state$call4?void 0:_state$call4.localVideoStreams},getIsTranscriptionActive=function getIsTranscriptionActive(state){var _state$call5;return!(null===(_state$call5=state.call)||void 0===_state$call5||!_state$call5.transcription.isTranscriptionActive)},getIsRecordingActive=function getIsRecordingActive(state){var _state$call6;return!(null===(_state$call6=state.call)||void 0===_state$call6||!_state$call6.recording.isRecordingActive)},getUserFacingDiagnostics=function getUserFacingDiagnostics(state){var _state$call7;return null===(_state$call7=state.call)||void 0===_state$call7?void 0:_state$call7.diagnostics}},77:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",(function(){return themes.b})),__webpack_require__.d(__webpack_exports__,"c",(function(){return themes.a})),__webpack_require__.d(__webpack_exports__,"b",(function(){return FluentThemeProvider.a})),__webpack_require__.d(__webpack_exports__,"e",(function(){return FluentThemeProvider.b})),__webpack_require__.d(__webpack_exports__,"a",(function(){return DEFAULT_COMPONENT_ICONS}));var themes=__webpack_require__(103),FluentThemeProvider=__webpack_require__(200),lib=__webpack_require__(22),WifiWarning20Filled=__webpack_require__(1517),VideoOff20Filled=__webpack_require__(1518),Video20Filled=__webpack_require__(1519),CallEnd20Filled=__webpack_require__(1520),MicOff20Filled=__webpack_require__(1521),MicOn20Filled=__webpack_require__(893),Settings20Filled=__webpack_require__(1675),People20Filled=__webpack_require__(1676),ShareScreenStart20Filled=__webpack_require__(1677),ShareScreenStop20Filled=__webpack_require__(1678),Dismiss20Regular=__webpack_require__(1679),Checkmark20Regular=__webpack_require__(1680),VideoProhibited16Filled=__webpack_require__(1681),MicProhibited16Filled=__webpack_require__(1682),MicOff16Filled=__webpack_require__(1683),SpeakerMute16Filled=__webpack_require__(1684),ChevronLeft20Regular=__webpack_require__(1685),ChevronRight20Regular=__webpack_require__(1686),CheckmarkCircle16Regular=__webpack_require__(1687),Edit20Regular=__webpack_require__(1688),ErrorCircle16Regular=__webpack_require__(1689),Delete20Regular=__webpack_require__(1690),EyeShow16Regular=__webpack_require__(1691),Circle16Regular=__webpack_require__(1692),Video20Regular=__webpack_require__(1693),MicOn20Regular=__webpack_require__(1522),Speaker220Regular=__webpack_require__(1523),MicOff16Regular=__webpack_require__(1694),MoreHorizontal20Regular=__webpack_require__(1695),MoreHorizontal20Filled=__webpack_require__(1696),Send20Regular=__webpack_require__(1697),Send20Filled=__webpack_require__(1698),jsx_runtime=(__webpack_require__(1),__webpack_require__(2)),icons_WifiWarning16Filled=function WifiWarning16Filled(){return Object(jsx_runtime.jsx)("div",{className:Object(lib.H)({transform:"scale(0.8)"}),children:Object(jsx_runtime.jsx)(WifiWarning20Filled.a,{})})};icons_WifiWarning16Filled.displayName="WifiWarning16Filled";var DEFAULT_COMPONENT_ICONS={ControlButtonCameraOff:Object(jsx_runtime.jsx)(VideoOff20Filled.a,{}),ControlButtonCameraOn:Object(jsx_runtime.jsx)(Video20Filled.a,{}),ControlButtonEndCall:Object(jsx_runtime.jsx)(CallEnd20Filled.a,{}),ControlButtonMicOff:Object(jsx_runtime.jsx)(MicOff20Filled.a,{}),ControlButtonMicOn:Object(jsx_runtime.jsx)(MicOn20Filled.a,{}),ControlButtonOptions:Object(jsx_runtime.jsx)(Settings20Filled.a,{}),ControlButtonParticipants:Object(jsx_runtime.jsx)(People20Filled.a,{}),ControlButtonScreenShareStart:Object(jsx_runtime.jsx)(ShareScreenStart20Filled.a,{}),ControlButtonScreenShareStop:Object(jsx_runtime.jsx)(ShareScreenStop20Filled.a,{}),EditBoxCancel:Object(jsx_runtime.jsx)(Dismiss20Regular.a,{}),EditBoxSubmit:Object(jsx_runtime.jsx)(Checkmark20Regular.a,{}),ErrorBarCallCameraAccessDenied:Object(jsx_runtime.jsx)(VideoProhibited16Filled.a,{}),ErrorBarCallCameraAlreadyInUse:Object(jsx_runtime.jsx)(VideoProhibited16Filled.a,{}),ErrorBarCallLocalVideoFreeze:Object(jsx_runtime.jsx)(icons_WifiWarning16Filled,{}),ErrorBarCallMacOsCameraAccessDenied:Object(jsx_runtime.jsx)(VideoProhibited16Filled.a,{}),ErrorBarCallMacOsMicrophoneAccessDenied:Object(jsx_runtime.jsx)(MicProhibited16Filled.a,{}),ErrorBarCallMicrophoneAccessDenied:Object(jsx_runtime.jsx)(MicProhibited16Filled.a,{}),ErrorBarCallMicrophoneMutedBySystem:Object(jsx_runtime.jsx)(MicOff16Filled.a,{}),ErrorBarCallNetworkQualityLow:Object(jsx_runtime.jsx)(icons_WifiWarning16Filled,{}),ErrorBarCallNoMicrophoneFound:Object(jsx_runtime.jsx)(MicProhibited16Filled.a,{}),ErrorBarCallNoSpeakerFound:Object(jsx_runtime.jsx)(SpeakerMute16Filled.a,{}),HorizontalGalleryLeftButton:Object(jsx_runtime.jsx)(ChevronLeft20Regular.a,{}),HorizontalGalleryRightButton:Object(jsx_runtime.jsx)(ChevronRight20Regular.a,{}),MessageDelivered:Object(jsx_runtime.jsx)(CheckmarkCircle16Regular.a,{}),MessageEdit:Object(jsx_runtime.jsx)(Edit20Regular.a,{}),MessageFailed:Object(jsx_runtime.jsx)(ErrorCircle16Regular.a,{}),MessageRemove:Object(jsx_runtime.jsx)(Delete20Regular.a,{}),MessageSeen:Object(jsx_runtime.jsx)(EyeShow16Regular.a,{}),MessageSending:Object(jsx_runtime.jsx)(Circle16Regular.a,{}),OptionsCamera:Object(jsx_runtime.jsx)(Video20Regular.a,{}),OptionsMic:Object(jsx_runtime.jsx)(MicOn20Regular.a,{}),OptionsSpeaker:Object(jsx_runtime.jsx)(Speaker220Regular.a,{}),ParticipantItemMicOff:Object(jsx_runtime.jsx)(MicOff16Regular.a,{}),ParticipantItemOptions:Object(jsx_runtime.jsx)(MoreHorizontal20Regular.a,{}),ParticipantItemOptionsHovered:Object(jsx_runtime.jsx)(MoreHorizontal20Filled.a,{}),ParticipantItemScreenShareStart:Object(jsx_runtime.jsx)(ShareScreenStart20Filled.a,{}),SendBoxSend:Object(jsx_runtime.jsx)(Send20Regular.a,{}),SendBoxSendHovered:Object(jsx_runtime.jsx)(Send20Filled.a,{}),VideoTileMicOff:Object(jsx_runtime.jsx)(MicOff16Filled.a,{})}},796:function(module,__webpack_exports__,__webpack_require__){"use strict";var _ChatComposite__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(438);__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_DE_DE")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_DE_DE",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_DE_DE})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_EN_GB")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_GB",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_EN_GB})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_EN_US")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_US",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_EN_US})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_ES_ES")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ES_ES",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_ES_ES})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_FR_FR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_FR_FR",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_FR_FR})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_IT_IT")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_IT_IT",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_IT_IT})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_JA_JP")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_JA_JP",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_JA_JP})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_KO_KR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_KO_KR",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_KO_KR})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_NL_NL")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_NL_NL",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_NL_NL})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_PT_BR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_PT_BR",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_PT_BR})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_RU_RU")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_RU_RU",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_RU_RU})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_TR_TR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_TR_TR",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_TR_TR})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_ZH_CN")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_CN",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_ZH_CN})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_ZH_TW")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_TW",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_ZH_TW})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"CallComposite")&&__webpack_require__.d(__webpack_exports__,"CallComposite",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.CallComposite})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"CallWithChatComposite")&&__webpack_require__.d(__webpack_exports__,"CallWithChatComposite",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.CallWithChatComposite})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"ChatComposite")&&__webpack_require__.d(__webpack_exports__,"ChatComposite",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.ChatComposite})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"createAzureCommunicationCallAdapter")&&__webpack_require__.d(__webpack_exports__,"createAzureCommunicationCallAdapter",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.createAzureCommunicationCallAdapter})),__webpack_require__.o(_ChatComposite__WEBPACK_IMPORTED_MODULE_0__,"createAzureCommunicationChatAdapter")&&__webpack_require__.d(__webpack_exports__,"createAzureCommunicationChatAdapter",(function(){return _ChatComposite__WEBPACK_IMPORTED_MODULE_0__.createAzureCommunicationChatAdapter}));var _CallComposite__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(300);__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_DE_DE")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_DE_DE",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_DE_DE})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_EN_GB")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_GB",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_EN_GB})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_EN_US")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_US",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_EN_US})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_ES_ES")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ES_ES",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_ES_ES})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_FR_FR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_FR_FR",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_FR_FR})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_IT_IT")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_IT_IT",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_IT_IT})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_JA_JP")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_JA_JP",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_JA_JP})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_KO_KR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_KO_KR",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_KO_KR})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_NL_NL")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_NL_NL",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_NL_NL})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_PT_BR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_PT_BR",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_PT_BR})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_RU_RU")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_RU_RU",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_RU_RU})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_TR_TR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_TR_TR",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_TR_TR})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_ZH_CN")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_CN",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_ZH_CN})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"COMPOSITE_LOCALE_ZH_TW")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_TW",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.COMPOSITE_LOCALE_ZH_TW})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"CallComposite")&&__webpack_require__.d(__webpack_exports__,"CallComposite",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.CallComposite})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"CallWithChatComposite")&&__webpack_require__.d(__webpack_exports__,"CallWithChatComposite",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.CallWithChatComposite})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"ChatComposite")&&__webpack_require__.d(__webpack_exports__,"ChatComposite",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.ChatComposite})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"createAzureCommunicationCallAdapter")&&__webpack_require__.d(__webpack_exports__,"createAzureCommunicationCallAdapter",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.createAzureCommunicationCallAdapter})),__webpack_require__.o(_CallComposite__WEBPACK_IMPORTED_MODULE_1__,"createAzureCommunicationChatAdapter")&&__webpack_require__.d(__webpack_exports__,"createAzureCommunicationChatAdapter",(function(){return _CallComposite__WEBPACK_IMPORTED_MODULE_1__.createAzureCommunicationChatAdapter}));var _common_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(57);__webpack_require__.d(__webpack_exports__,"DEFAULT_COMPOSITE_ICONS",(function(){return _common_icons__WEBPACK_IMPORTED_MODULE_2__.d}));var _localization_locales__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(442);__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_DE_DE",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.a})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_GB",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.b})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_US",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.c})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ES_ES",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.d})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_FR_FR",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.e})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_IT_IT",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.f})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_JA_JP",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.g})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_KO_KR",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.h})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_NL_NL",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.i})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_PT_BR",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.j})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_RU_RU",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.k})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_TR_TR",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.l})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_CN",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.m})),__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_TW",(function(){return _localization_locales__WEBPACK_IMPORTED_MODULE_3__.n}));var _CallWithChatComposite__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(428);__webpack_require__.d(__webpack_exports__,"CallWithChatComposite",(function(){return _CallWithChatComposite__WEBPACK_IMPORTED_MODULE_4__.a})),__webpack_require__.d(__webpack_exports__,"createAzureCommunicationCallWithChatAdapter",(function(){return _CallWithChatComposite__WEBPACK_IMPORTED_MODULE_4__.b}))},799:function(module,exports){},80:function(module,__webpack_exports__,__webpack_require__){"use strict";var _composites__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(796);__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_DE_DE")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_DE_DE",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_DE_DE})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_EN_GB")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_GB",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_EN_GB})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_EN_US")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_EN_US",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_EN_US})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_ES_ES")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ES_ES",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_ES_ES})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_FR_FR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_FR_FR",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_FR_FR})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_IT_IT")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_IT_IT",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_IT_IT})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_JA_JP")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_JA_JP",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_JA_JP})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_KO_KR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_KO_KR",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_KO_KR})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_NL_NL")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_NL_NL",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_NL_NL})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_PT_BR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_PT_BR",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_PT_BR})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_RU_RU")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_RU_RU",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_RU_RU})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_TR_TR")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_TR_TR",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_TR_TR})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_ZH_CN")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_CN",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_ZH_CN})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"COMPOSITE_LOCALE_ZH_TW")&&__webpack_require__.d(__webpack_exports__,"COMPOSITE_LOCALE_ZH_TW",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.COMPOSITE_LOCALE_ZH_TW})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"CallComposite")&&__webpack_require__.d(__webpack_exports__,"CallComposite",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.CallComposite})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"CallWithChatComposite")&&__webpack_require__.d(__webpack_exports__,"CallWithChatComposite",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.CallWithChatComposite})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"ChatComposite")&&__webpack_require__.d(__webpack_exports__,"ChatComposite",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.ChatComposite})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"DEFAULT_COMPOSITE_ICONS")&&__webpack_require__.d(__webpack_exports__,"DEFAULT_COMPOSITE_ICONS",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_COMPOSITE_ICONS})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"createAzureCommunicationCallAdapter")&&__webpack_require__.d(__webpack_exports__,"createAzureCommunicationCallAdapter",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.createAzureCommunicationCallAdapter})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"createAzureCommunicationCallWithChatAdapter")&&__webpack_require__.d(__webpack_exports__,"createAzureCommunicationCallWithChatAdapter",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.createAzureCommunicationCallWithChatAdapter})),__webpack_require__.o(_composites__WEBPACK_IMPORTED_MODULE_0__,"createAzureCommunicationChatAdapter")&&__webpack_require__.d(__webpack_exports__,"createAzureCommunicationChatAdapter",(function(){return _composites__WEBPACK_IMPORTED_MODULE_0__.createAzureCommunicationChatAdapter}))},800:function(module,__webpack_exports__,__webpack_require__){"use strict";var _AzureCommunicationCallAdapter__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(359);__webpack_require__.d(__webpack_exports__,"a",(function(){return _AzureCommunicationCallAdapter__WEBPACK_IMPORTED_MODULE_0__.a}))},801:function(module,exports){},803:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallComposite_CallComposite}));__webpack_require__(39),__webpack_require__(12),__webpack_require__(7);var react=__webpack_require__(1),BaseComposite=__webpack_require__(310),localization=__webpack_require__(91),CallAdapterProvider=__webpack_require__(134),sdk_bundle=__webpack_require__(95),src=__webpack_require__(21),Stack=__webpack_require__(69),Camera=__webpack_require__(470),jsx_runtime=(__webpack_require__(34),__webpack_require__(62),__webpack_require__(2)),usePropsFor=__webpack_require__(94),Buttons_styles=__webpack_require__(127),Devices_Devices=function Devices(props){var devicesButtonProps=Object(usePropsFor.a)(src.s),styles=Object(react.useMemo)((function(){var _props$styles;return Object(Buttons_styles.b)(props.increaseFlyoutItemSize?Buttons_styles.c:{},null!==(_props$styles=props.styles)&&void 0!==_props$styles?_props$styles:{})}),[props.increaseFlyoutItemSize,props.styles]);return Object(jsx_runtime.jsx)(src.s,Object.assign({persistMenu:!0},devicesButtonProps,{showLabel:"compact"!==props.displayType,styles:styles}))};Devices_Devices.displayName="Devices",Devices_Devices.__docgenInfo={description:"@private",methods:[],displayName:"Devices",props:{displayType:{required:!1,tsType:{name:"CallControlDisplayType"},description:""},increaseFlyoutItemSize:{required:!1,tsType:{name:"boolean"},description:""},styles:{required:!1,tsType:{name:"ControlBarButtonStyles"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/buttons/Devices.tsx"]={name:"Devices",docgenInfo:Devices_Devices.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/buttons/Devices.tsx"});var EndCall=__webpack_require__(471),Microphone=__webpack_require__(472),Participants_Participants=function Participants(props){var participantsButtonProps=Object(usePropsFor.a)(src.E),participantsButtonStyles=Object(react.useMemo)((function(){var _props$styles;return Object(Buttons_styles.b)(props.increaseFlyoutItemSize?Buttons_styles.f:{},null!==(_props$styles=props.styles)&&void 0!==_props$styles?_props$styles:{})}),[props.increaseFlyoutItemSize,props.styles]);return Object(jsx_runtime.jsx)(src.E,Object.assign({"data-ui-id":"call-composite-participants-button"},participantsButtonProps,{showLabel:"compact"!==props.displayType,callInvitationURL:props.callInvitationURL,onFetchParticipantMenuItems:props.onFetchParticipantMenuItems,disabled:Participants_isDisabled(props.option),styles:participantsButtonStyles}))};Participants_Participants.displayName="Participants";var Participants_isDisabled=function isDisabled(option){return void 0!==option&&!0!==option&&!1!==option&&option.disabled};Participants_Participants.__docgenInfo={description:"@private",methods:[],displayName:"Participants",props:{option:{required:!1,tsType:{name:"union",raw:"boolean | { disabled: boolean }",elements:[{name:"boolean"},{name:"signature",type:"object",raw:"{ disabled: boolean }",signature:{properties:[{key:"disabled",value:{name:"boolean",required:!0}}]}}]},description:""},callInvitationURL:{required:!1,tsType:{name:"string"},description:""},onFetchParticipantMenuItems:{required:!1,tsType:{name:"ParticipantMenuItemsCallback"},description:""},displayType:{required:!1,tsType:{name:"CallControlDisplayType"},description:""},increaseFlyoutItemSize:{required:!1,tsType:{name:"boolean"},description:""},styles:{required:!1,tsType:{name:"ControlBarButtonStyles"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/buttons/Participants.tsx"]={name:"Participants",docgenInfo:Participants_Participants.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/buttons/Participants.tsx"});var ScreenShare=__webpack_require__(473),CallControls_CallControls=function CallControls(props){var options="boolean"==typeof props.options?{}:props.options,customButtons=Object(react.useMemo)((function(){return function generateCustomButtons(onFetchCustomButtonProps,displayType){var response={first:void 0,afterCameraButton:void 0,afterEndCallButton:void 0,afterMicrophoneButton:void 0,afterDevicesButton:void 0,afterParticipantsButton:void 0,afterScreenShareButton:void 0,last:void 0};if(!onFetchCustomButtonProps)return response;var allButtonProps=onFetchCustomButtonProps.map((function(f){return f({displayType:displayType})})),_loop=function _loop(key){response[key]=Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:allButtonProps.filter((function(buttonProps){return buttonProps.placement===key})).map((function(buttonProps,i){return Object(react.createElement)(src.q,Object.assign({},buttonProps,{key:buttonProps.placement+"_"+i}))}))})};for(var key in response)_loop(key);return response}(onFetchCustomButtonPropsTrampoline(options),null==options?void 0:options.displayType)}),[options]);return!1===props.options?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",children:Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsxs)(src.p,{layout:"horizontal",children:[customButtons.first,isEnabled(null==options?void 0:options.microphoneButton)&&Object(jsx_runtime.jsx)(Microphone.a,{displayType:null==options?void 0:options.displayType}),customButtons.afterMicrophoneButton,isEnabled(null==options?void 0:options.cameraButton)&&Object(jsx_runtime.jsx)(Camera.a,{displayType:null==options?void 0:options.displayType}),customButtons.afterCameraButton,isEnabled(null==options?void 0:options.screenShareButton)&&Object(jsx_runtime.jsx)(ScreenShare.a,{option:null==options?void 0:options.screenShareButton,displayType:null==options?void 0:options.displayType}),customButtons.afterScreenShareButton,isEnabled(null==options?void 0:options.participantsButton)&&Object(jsx_runtime.jsx)(Participants_Participants,{option:null==options?void 0:options.participantsButton,callInvitationURL:props.callInvitationURL,onFetchParticipantMenuItems:props.onFetchParticipantMenuItems,displayType:null==options?void 0:options.displayType,increaseFlyoutItemSize:props.increaseFlyoutItemSize}),customButtons.afterParticipantsButton,isEnabled(null==options?void 0:options.devicesButton)&&Object(jsx_runtime.jsx)(Devices_Devices,{displayType:null==options?void 0:options.displayType,increaseFlyoutItemSize:props.increaseFlyoutItemSize}),customButtons.afterDevicesButton,isEnabled(null==options?void 0:options.endCallButton)&&Object(jsx_runtime.jsx)(EndCall.a,{displayType:null==options?void 0:options.displayType}),customButtons.afterEndCallButton,customButtons.last]})})})};CallControls_CallControls.displayName="CallControls";var isEnabled=function isEnabled(option){return!1!==option},onFetchCustomButtonPropsTrampoline=function onFetchCustomButtonPropsTrampoline(options){return null==options?void 0:options.onFetchCustomButtonProps};CallControls_CallControls.__docgenInfo={description:"@private",methods:[],displayName:"CallControls",props:{callInvitationURL:{required:!1,tsType:{name:"string"},description:""},onFetchParticipantMenuItems:{required:!1,tsType:{name:"ParticipantMenuItemsCallback"},description:""},options:{required:!1,tsType:{name:"union",raw:"boolean | CallControlOptions",elements:[{name:"boolean"},{name:"CallControlOptions"}]},description:""},increaseFlyoutItemSize:{required:!1,tsType:{name:"boolean"},description:"Option to increase the height of the button flyout menu items from 36px to 48px.\nRecommended for mobile devices."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/CallControls.tsx"]={name:"CallControls",docgenInfo:CallControls_CallControls.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/CallControls.tsx"});__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28);var MessageBar=__webpack_require__(616),Link=__webpack_require__(898),utils=__webpack_require__(179);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ComplianceBanner_ComplianceBanner=function ComplianceBanner(props){function determineStates(previous,current){return current?"on":"on"===previous?"stopped":previous}var strings=Object(localization.b)().strings,_useState2=_slicedToArray(Object(react.useState)("NO_STATE"),2),variant=_useState2[0],setVariant=_useState2[1],cachedProps=Object(react.useRef)({latestBooleanState:{callTranscribeState:!1,callRecordState:!1},latestStringState:{callTranscribeState:"off",callRecordState:"off"}});return props.callRecordState===cachedProps.current.latestBooleanState.callRecordState&&props.callTranscribeState===cachedProps.current.latestBooleanState.callTranscribeState||(cachedProps.current={latestBooleanState:props,latestStringState:{callRecordState:determineStates(cachedProps.current.latestStringState.callRecordState,props.callRecordState),callTranscribeState:determineStates(cachedProps.current.latestStringState.callTranscribeState,props.callTranscribeState)}},setVariant(Object(utils.a)(cachedProps.current.latestStringState.callRecordState,cachedProps.current.latestStringState.callTranscribeState)),"stopped"===cachedProps.current.latestStringState.callRecordState&&"stopped"===cachedProps.current.latestStringState.callTranscribeState&&(cachedProps.current.latestStringState.callRecordState="off",cachedProps.current.latestStringState.callTranscribeState="off")),"NO_STATE"===variant?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Object(jsx_runtime.jsx)(MessageBar.a,{onDismiss:function onDismiss(){setVariant("NO_STATE"),"stopped"===cachedProps.current.latestStringState.callRecordState&&(cachedProps.current.latestStringState.callRecordState="off"),"stopped"===cachedProps.current.latestStringState.callTranscribeState&&(cachedProps.current.latestStringState.callTranscribeState="off")},dismissButtonAriaLabel:strings.call.close,children:Object(jsx_runtime.jsx)(BannerMessage,{variant:variant,strings:strings})})};function BannerMessage(props){var variant=props.variant,strings=props.strings;switch(variant){case"TRANSCRIPTION_STOPPED_STILL_RECORDING":return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:strings.call.complianceBannerTranscriptionStopped})," "+strings.call.complianceBannerNowOnlyRecording,Object(jsx_runtime.jsx)(PrivacyPolicy,{linkText:strings.call.privacyPolicy})]});case"RECORDING_STOPPED_STILL_TRANSCRIBING":return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:strings.call.complianceBannerRecordingStopped})," "+strings.call.complianceBannerNowOnlyTranscription,Object(jsx_runtime.jsx)(PrivacyPolicy,{linkText:strings.call.privacyPolicy})]});case"RECORDING_AND_TRANSCRIPTION_STOPPED":return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:strings.call.complianceBannerRecordingAndTranscriptionSaved})," "+strings.call.complianceBannerRecordingAndTranscriptionStopped,Object(jsx_runtime.jsx)(LearnMore,{linkText:strings.call.learnMore})]});case"RECORDING_AND_TRANSCRIPTION_STARTED":return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:strings.call.complianceBannerRecordingAndTranscriptionStarted})," "+strings.call.complianceBannerTranscriptionConsent,Object(jsx_runtime.jsx)(PrivacyPolicy,{linkText:strings.call.privacyPolicy})]});case"TRANSCRIPTION_STARTED":return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:strings.call.complianceBannerTranscriptionStarted})," "+strings.call.complianceBannerTranscriptionConsent,Object(jsx_runtime.jsx)(PrivacyPolicy,{linkText:strings.call.privacyPolicy})]});case"RECORDING_STOPPED":return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:strings.call.complianceBannerRecordingSaving})," "+strings.call.complianceBannerRecordingStopped,Object(jsx_runtime.jsx)(LearnMore,{linkText:strings.call.learnMore})]});case"RECORDING_STARTED":return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:strings.call.complianceBannerRecordingStarted})," "+strings.call.complianceBannerTranscriptionConsent,Object(jsx_runtime.jsx)(PrivacyPolicy,{linkText:strings.call.privacyPolicy})]});case"TRANSCRIPTION_STOPPED":return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:strings.call.complianceBannerTranscriptionSaving})," "+strings.call.complianceBannerTranscriptionStopped,Object(jsx_runtime.jsx)(LearnMore,{linkText:strings.call.learnMore})]})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}function PrivacyPolicy(props){return Object(jsx_runtime.jsx)(Link.a,{href:"https://privacy.microsoft.com/privacystatement#mainnoticetoendusersmodule",target:"_blank",underline:!0,children:props.linkText})}function LearnMore(props){return Object(jsx_runtime.jsx)(Link.a,{href:"https://support.microsoft.com/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24",target:"_blank",underline:!0,children:props.linkText})}PrivacyPolicy.displayName="PrivacyPolicy",LearnMore.displayName="LearnMore",ComplianceBanner_ComplianceBanner.__docgenInfo={description:"@private",methods:[],displayName:"ComplianceBanner",props:{callTranscribeState:{required:!1,tsType:{name:"boolean"},description:""},callRecordState:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/ComplianceBanner.tsx"]={name:"ComplianceBanner",docgenInfo:ComplianceBanner_ComplianceBanner.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/ComplianceBanner.tsx"});var CallPage_styles=__webpack_require__(227),useTheme=__webpack_require__(369),lib=__webpack_require__(22),Text=__webpack_require__(499),icons=__webpack_require__(57);function MutedNotification(props){var locale=Object(localization.b)(),theme=Object(useTheme.a)();return props.speakingWhileMuted?Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,horizontalAlign:"center",children:Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.H)(stackStyle(theme)),children:[Object(jsx_runtime.jsx)(icons.a,{iconName:"Muted",className:Object(lib.H)(iconStyle(theme))}),Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(textStyle(theme)),"aria-live":"polite",children:locale.strings.call.mutedMessage})]})}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}MutedNotification.displayName="MutedNotification";var stackStyle=function stackStyle(theme){return{background:theme.palette.black,opacity:.8,gap:"1rem",padding:"1rem",borderRadius:theme.effects.roundedCorner4,width:"fit-content"}},iconStyle=function iconStyle(theme){return{color:theme.palette.white,maxHeight:"1.25rem"}},textStyle=function textStyle(theme){return{color:theme.palette.white,fontSize:"1rem"}};MutedNotification.__docgenInfo={description:"Notify the user that they're muted.",methods:[],displayName:"MutedNotification",props:{speakingWhileMuted:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/MutedNotification.tsx"]={name:"MutedNotification",docgenInfo:MutedNotification.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/MutedNotification.tsx"});var CallArrangement_CallArrangement=function CallArrangement(props){var _props$callControlPro,containerClassName=Object(react.useMemo)((function(){return props.mobileView?CallPage_styles.c:CallPage_styles.b}),[props.mobileView]),theme=Object(src.M)(),callGalleryStyles=Object(react.useMemo)((function(){return Object(CallPage_styles.d)(theme.palette.neutralLighterAlt)}),[theme.palette.neutralLighterAlt]);return Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,horizontalAlign:"stretch",className:containerClassName,"data-ui-id":props.dataUiId,children:[Object(jsx_runtime.jsxs)(Stack.a.Item,{styles:CallPage_styles.f,children:[Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(ComplianceBanner_ComplianceBanner,Object.assign({},props.complianceBannerProps))}),!1!==props.errorBarProps&&Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(src.u,Object.assign({},props.errorBarProps))}),!!props.mutedNotificationProps&&Object(jsx_runtime.jsx)(MutedNotification,Object.assign({},props.mutedNotificationProps))]}),Object(jsx_runtime.jsx)(Stack.a.Item,{styles:callGalleryStyles,grow:!0,children:props.onRenderGalleryContent&&Object(jsx_runtime.jsx)(Stack.a,{verticalFill:!0,styles:CallPage_styles.e,children:props.onRenderGalleryContent()})}),!1!==(null===(_props$callControlPro=props.callControlProps)||void 0===_props$callControlPro?void 0:_props$callControlPro.options)&&Object(jsx_runtime.jsx)(Stack.a.Item,{className:CallPage_styles.a,children:Object(jsx_runtime.jsx)(CallControls_CallControls,Object.assign({},props.callControlProps))})]})};CallArrangement_CallArrangement.displayName="CallArrangement",CallArrangement_CallArrangement.__docgenInfo={description:"@private",methods:[],displayName:"CallArrangement",props:{complianceBannerProps:{required:!0,tsType:{name:"ComplianceBannerProps"},description:""},errorBarProps:{required:!0,tsType:{name:"union",raw:"ErrorBarProps | false",elements:[{name:"ErrorBarProps"},{name:"literal",value:"false"}]},description:""},mutedNotificationProps:{required:!1,tsType:{name:"MutedNotificationProps"},description:""},callControlProps:{required:!0,tsType:{name:"CallControlsProps"},description:""},onRenderGalleryContent:{required:!0,tsType:{name:"signature",type:"function",raw:"() => JSX.Element",signature:{arguments:[],return:{name:"JSX.Element"}}},description:""},dataUiId:{required:!0,tsType:{name:"string"},description:""},mobileView:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/CallArrangement.tsx"]={name:"CallArrangement",docgenInfo:CallArrangement_CallArrangement.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/CallArrangement.tsx"});var AvatarPersona=__webpack_require__(311),baseSelectors=__webpack_require__(67),useHandlers=__webpack_require__(142),useSelector=__webpack_require__(87),es=__webpack_require__(50),localVideoCameraCycleButtonSelector=Object(es.a)([baseSelectors.b],(function(deviceManager){return{cameras:deviceManager.cameras,selectedCamera:deviceManager.selectedCamera}}));function MediaGallery_slicedToArray(arr,i){return function MediaGallery_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MediaGallery_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MediaGallery_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MediaGallery_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MediaGallery_arrayLikeToArray(o,minLen)}(arr,i)||function MediaGallery_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MediaGallery_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var VideoGalleryStyles={root:{height:"100%",minHeight:"10rem",minWidth:"6rem"}},localVideoViewOptions={scalingMode:"Crop",isMirrored:!0},remoteVideoViewOptions={scalingMode:"Crop"},MediaGallery_MediaGallery=function MediaGallery(props){var videoGalleryProps=Object(usePropsFor.a)(src.J),cameraSwitcherCameras=Object(useSelector.a)(localVideoCameraCycleButtonSelector),cameraSwitcherCallback=Object(useHandlers.a)(src.x),cameraSwitcherProps=Object(react.useMemo)((function(){return Object.assign({},cameraSwitcherCallback,cameraSwitcherCameras)}),[cameraSwitcherCallback,cameraSwitcherCameras]);return MediaGallery_useLocalVideoStartTrigger(!!props.isVideoStreamOn),Object(react.useMemo)((function(){return Object(jsx_runtime.jsx)(src.J,Object.assign({},videoGalleryProps,{localVideoViewOptions:localVideoViewOptions,remoteVideoViewOptions:remoteVideoViewOptions,styles:VideoGalleryStyles,layout:"floatingLocalVideo",showCameraSwitcherInLocalPreview:props.isMobile,localVideoCameraCycleButtonProps:cameraSwitcherProps,onRenderAvatar:function onRenderAvatar(userId,options){return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)({position:"absolute",height:"100%",width:"100%"}),children:Object(jsx_runtime.jsx)(AvatarPersona.a,Object.assign({userId:userId},options,{dataProvider:props.onFetchAvatarPersonaData}))})}}))}),[videoGalleryProps,props.isMobile,props.onFetchAvatarPersonaData,cameraSwitcherProps])},MediaGallery_useLocalVideoStartTrigger=function useLocalVideoStartTrigger(isLocalVideoAvailable,shouldTransition){var _useState2=MediaGallery_slicedToArray(Object(react.useState)(!1),2),isButtonStatusSynced=_useState2[0],setIsButtonStatusSynced=_useState2[1],isPreviewCameraOn=Object(useSelector.a)(baseSelectors.c),mediaGalleryHandlers=Object(useHandlers.a)(MediaGallery_MediaGallery);Object(react.useEffect)((function(){!1!==shouldTransition&&(!isPreviewCameraOn||isLocalVideoAvailable||isButtonStatusSynced||mediaGalleryHandlers.onStartLocalVideo(),setIsButtonStatusSynced(!0))}),[shouldTransition,isButtonStatusSynced,isPreviewCameraOn,isLocalVideoAvailable,mediaGalleryHandlers])},containerStyles={root:{height:"100%",width:"100%",position:"relative"}},overlayBackgroundStyles=function overlayBackgroundStyles(palette,isVideoReady){return{position:"absolute",height:"100%",width:"100%",background:isVideoReady?"black":palette.neutralLighterAlt,opacity:isVideoReady?.6:1,zIndex:0}},overlayContentStyles={height:"100%",width:"100%",zIndex:1},videoTileStyles={root:{height:"100%",width:"100%"}},ExpandedLocalVideoTile_onRenderEmptyPlaceholder=function onRenderEmptyPlaceholder(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},ExpandedLocalVideoTile_localVideoViewOptions={scalingMode:"Crop",isMirrored:!0},ExpandedLocalVideoTile_ExpandedLocalVideoTile=function ExpandedLocalVideoTile(props){var _videoStream$isAvaila,videoStream=props.localParticipantVideoStream,isVideoReady=null!==(_videoStream$isAvaila=null==videoStream?void 0:videoStream.isAvailable)&&void 0!==_videoStream$isAvaila&&_videoStream$isAvaila,renderElement=null==videoStream?void 0:videoStream.renderElement,palette=Object(src.M)().palette;return Object(react.useEffect)((function(){videoStream&&isVideoReady&&props.onCreateLocalStreamView&&props.onCreateLocalStreamView(ExpandedLocalVideoTile_localVideoViewOptions).catch((function(err){return console.log("Can not render video",err)}))}),[isVideoReady,videoStream,props,renderElement]),Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:containerStyles,grow:!0,children:Object(jsx_runtime.jsx)(src.K,{styles:videoTileStyles,renderElement:renderElement?Object(jsx_runtime.jsx)(src.H,{videoStreamElement:renderElement}):void 0,onRenderPlaceholder:ExpandedLocalVideoTile_onRenderEmptyPlaceholder,children:props.overlayContent&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.H)(overlayBackgroundStyles(palette,isVideoReady))}),Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:Object(lib.H)(overlayContentStyles),children:props.overlayContent})]})})})};ExpandedLocalVideoTile_ExpandedLocalVideoTile.displayName="ExpandedLocalVideoTile",ExpandedLocalVideoTile_ExpandedLocalVideoTile.__docgenInfo={description:"@private",methods:[],displayName:"ExpandedLocalVideoTile",props:{localParticipantVideoStream:{required:!0,tsType:{name:"VideoGalleryStream"},description:""},onCreateLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},overlayContent:{required:!1,tsType:{name:"JSX.Element"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/ExpandedLocalVideoTile.tsx"]={name:"ExpandedLocalVideoTile",docgenInfo:ExpandedLocalVideoTile_ExpandedLocalVideoTile.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/ExpandedLocalVideoTile.tsx"});var containerStyle={margin:"1rem",gap:"1.5rem"},titleContainerStyle={gap:"1rem"},NetworkReconnectTile_styles_titleStyle=function titleStyle(palette,isVideoReady){return{fontSize:"1.25rem",fontWeight:lib.e.semibold,color:isVideoReady?"white":palette.neutralPrimary,textAlign:"center"}},moreDetailsStyle=function moreDetailsStyle(palette,isVideoReady){return{fontSize:"1rem",color:isVideoReady?"white":palette.neutralPrimary,textAlign:"center"}},NetworkReconnectTile_NetworkReconnectTile=function NetworkReconnectTile(props){var _videoStream$isAvaila,videoStream=props.localParticipantVideoStream,isVideoReady=null!==(_videoStream$isAvaila=null==videoStream?void 0:videoStream.isAvailable)&&void 0!==_videoStream$isAvaila&&_videoStream$isAvaila,palette=Object(src.M)().palette,strings=Object(localization.b)().strings.call,handlers=Object(useHandlers.a)(ExpandedLocalVideoTile_ExpandedLocalVideoTile);return MediaGallery_useLocalVideoStartTrigger(!!props.localParticipantVideoStream.isAvailable),Object(jsx_runtime.jsx)(ExpandedLocalVideoTile_ExpandedLocalVideoTile,Object.assign({localParticipantVideoStream:props.localParticipantVideoStream,overlayContent:Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,horizontalAlign:"center",verticalAlign:"center",className:Object(lib.H)(containerStyle),children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.H)(titleContainerStyle),children:[Object(jsx_runtime.jsx)(icons.a,{iconName:"NetworkReconnectIcon",className:Object(lib.H)(NetworkReconnectTile_styles_titleStyle)}),Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(NetworkReconnectTile_styles_titleStyle(palette,isVideoReady)),"aria-live":"polite",children:strings.networkReconnectTitle})]}),Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(moreDetailsStyle(palette,isVideoReady)),"aria-live":"polite",children:strings.networkReconnectMoreDetails})]})},handlers))};NetworkReconnectTile_NetworkReconnectTile.displayName="NetworkReconnectTile",NetworkReconnectTile_NetworkReconnectTile.__docgenInfo={description:"@private",methods:[],displayName:"NetworkReconnectTile",props:{localParticipantVideoStream:{required:!0,tsType:{name:"VideoGalleryStream"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/NetworkReconnectTile.tsx"]={name:"NetworkReconnectTile",docgenInfo:NetworkReconnectTile_NetworkReconnectTile.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/NetworkReconnectTile.tsx"});var callStatusSelector=Object(es.a)([baseSelectors.a,baseSelectors.e],(function(callStatus,isScreenShareOn){return{callStatus:callStatus,isScreenShareOn:isScreenShareOn}})),complianceBannerSelector=es.a([baseSelectors.f,baseSelectors.d],(function(isTranscriptionActive,isRecordingActive){return{callTranscribeState:isTranscriptionActive,callRecordState:isRecordingActive}})),mediaGallerySelector=(__webpack_require__(115),es.a([baseSelectors.h],(function(localVideoStreams){var _localVideoStreams$fi,_localVideoStreams$fi2;return{isVideoStreamOn:!(null==localVideoStreams||null===(_localVideoStreams$fi=localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})))||void 0===_localVideoStreams$fi||null===(_localVideoStreams$fi2=_localVideoStreams$fi.view)||void 0===_localVideoStreams$fi2||!_localVideoStreams$fi2.target)}}))),mutedNotificationSelector=es.a([baseSelectors.j],(function(diagnostics){var _diagnostics$media$la;return{speakingWhileMuted:!(null==diagnostics||null===(_diagnostics$media$la=diagnostics.media.latest.speakingWhileMicrophoneIsMuted)||void 0===_diagnostics$media$la||!_diagnostics$media$la.value)}})),calling_component_bindings_src=__webpack_require__(88),localVideoSelector=es.a([callStatusSelector,baseSelectors.b,baseSelectors.h],(function(callStatus,deviceManager,localVideoStreams){var _localVideoStream,_localVideoStream$vie,_localVideoStream2,_localVideoStream2$vi,localVideoStream;return Object(calling_component_bindings_src.b)(callStatus.callStatus)?localVideoStream=null==localVideoStreams?void 0:localVideoStreams.find((function(i){return"Video"===i.mediaStreamType})):Object(calling_component_bindings_src.d)(deviceManager)&&(localVideoStream=deviceManager.unparentedViews[0]),{isAvailable:!!localVideoStream,isMirrored:null===(_localVideoStream=localVideoStream)||void 0===_localVideoStream||null===(_localVideoStream$vie=_localVideoStream.view)||void 0===_localVideoStream$vie?void 0:_localVideoStream$vie.isMirrored,renderElement:null===(_localVideoStream2=localVideoStream)||void 0===_localVideoStream2||null===(_localVideoStream2$vi=_localVideoStream2.view)||void 0===_localVideoStream2$vi?void 0:_localVideoStream2$vi.target}})),lobbySelector=es.a([localVideoSelector],(function(localVideoStreamInfo){return{localParticipantVideoStream:localVideoStreamInfo}})),networkReconnectTileSelector=es.a([baseSelectors.j,lobbySelector],(function(diagnostics,lobbyProps){var _diagnostics$network$;return{networkReconnectValue:null==diagnostics||null===(_diagnostics$network$=diagnostics.network.latest.networkReconnect)||void 0===_diagnostics$network$?void 0:_diagnostics$network$.value,localParticipantVideoStream:lobbyProps.localParticipantVideoStream}})),CallPage_CallPage=function CallPage(props){var callInvitationURL=props.callInvitationURL,onRenderAvatar=props.onRenderAvatar,onFetchAvatarPersonaData=props.onFetchAvatarPersonaData,onFetchParticipantMenuItems=props.onFetchParticipantMenuItems,options=props.options,mobileView=props.mobileView,callStatus=Object(useSelector.a)(callStatusSelector).callStatus,mediaGalleryProps=Object(useSelector.a)(mediaGallerySelector),mediaGalleryHandlers=Object(useHandlers.a)(MediaGallery_MediaGallery),complianceBannerProps=Object(useSelector.a)(complianceBannerSelector),errorBarProps=Object(usePropsFor.a)(src.u),mutedNotificationProps=Object(useSelector.a)(mutedNotificationSelector),networkReconnectTileProps=Object(useSelector.a)(networkReconnectTileSelector),callControlOptions=mobileView?Object(utils.d)(null==options?void 0:options.callControls):null==options?void 0:options.callControls;return Object(jsx_runtime.jsx)(CallArrangement_CallArrangement,{complianceBannerProps:Object.assign({},complianceBannerProps),errorBarProps:!1!==(null==options?void 0:options.errorBar)&&Object.assign({},errorBarProps),mutedNotificationProps:mutedNotificationProps,callControlProps:{callInvitationURL:callInvitationURL,onFetchParticipantMenuItems:onFetchParticipantMenuItems,options:callControlOptions,increaseFlyoutItemSize:mobileView},mobileView:mobileView,onRenderGalleryContent:function onRenderGalleryContent(){return"Connected"===callStatus?CallPage_isNetworkHealthy(networkReconnectTileProps.networkReconnectValue)?Object(jsx_runtime.jsx)(MediaGallery_MediaGallery,Object.assign({isMobile:mobileView},mediaGalleryProps,mediaGalleryHandlers,{onRenderAvatar:onRenderAvatar,onFetchAvatarPersonaData:onFetchAvatarPersonaData})):Object(jsx_runtime.jsx)(NetworkReconnectTile_NetworkReconnectTile,Object.assign({},networkReconnectTileProps)):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},dataUiId:"call-page"})};CallPage_CallPage.displayName="CallPage";var CallPage_isNetworkHealthy=function isNetworkHealthy(value){return!0===value||!1===value||void 0===value||value===sdk_bundle.DiagnosticQuality.Good};CallPage_CallPage.__docgenInfo={description:"@private",methods:[],displayName:"CallPage",props:{mobileView:{required:!0,tsType:{name:"boolean"},description:""},callInvitationURL:{required:!1,tsType:{name:"string"},description:""},onRenderAvatar:{required:!1,tsType:{name:"OnRenderAvatarCallback"},description:""},onFetchAvatarPersonaData:{required:!1,tsType:{name:"AvatarPersonaDataCallback"},description:""},onFetchParticipantMenuItems:{required:!1,tsType:{name:"ParticipantMenuItemsCallback"},description:""},options:{required:!1,tsType:{name:"CallCompositeOptions"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/pages/CallPage.tsx"]={name:"CallPage",docgenInfo:CallPage_CallPage.__docgenInfo,path:"../react-composites/src/composites/CallComposite/pages/CallPage.tsx"});var useAdaptedSelector=__webpack_require__(312),Label=(__webpack_require__(147),__webpack_require__(1742)),Dropdown=__webpack_require__(1731),mainStackTokens={childrenGap:"1rem"},dropDownStyles=function dropDownStyles(theme){return{caretDownWrapper:{height:"2.5rem",lineHeight:"2.5rem"},dropdownItem:{fontSize:"0.875rem",height:"2.5rem",background:theme.palette.neutralQuaternaryAlt},dropdown:{height:"2.5rem",width:"100%",svg:{verticalAlign:"top"}},title:{fontSize:"0.875rem",height:"2.5rem",lineHeight:"2.3125rem"},label:{fontWeight:600,fontSize:"0.875rem"},errorMessage:{fontSize:"0.875rem"}}},dropDownTitleIconStyles=Object(lib.H)({overflow:"hidden",textOverflow:"ellipsis",minWidth:"0",maxWidth:"100%",overflowWrap:"break-word",margin:".063rem"}),optionIconStyles=Object(lib.H)({marginRight:"8px",verticalAlign:"text-top"});function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function LocalDeviceSettings_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return LocalDeviceSettings_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LocalDeviceSettings_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function LocalDeviceSettings_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var getDropDownList=function getDropDownList(list){var _step,noDuplicates=new Map,_iterator=_createForOfIteratorHelper(list);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;noDuplicates.set(item.id,item)}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,dropdownList=[],_iterator2=_createForOfIteratorHelper(noDuplicates.values());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _item=_step2.value;dropdownList.push({key:_item.id,text:""===_item.name?_item.deviceType:_item.name})}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return dropdownList},_onRenderTitle=function onRenderTitle(iconType,props){var icon=props&&function getOptionIcon(type){return"Camera"===type?Object(jsx_runtime.jsx)(icons.a,{iconName:"LocalDeviceSettingsCamera",className:optionIconStyles}):"Microphone"===type?Object(jsx_runtime.jsx)(icons.a,{iconName:"LocalDeviceSettingsMic",className:optionIconStyles}):"Speaker"===type?Object(jsx_runtime.jsx)(icons.a,{iconName:"LocalDeviceSettingsSpeaker",className:optionIconStyles}):void 0}(iconType);return props?Object(jsx_runtime.jsxs)("div",{className:dropDownTitleIconStyles,children:[icon,Object(jsx_runtime.jsx)("span",{children:props[0].text})]}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},LocalDeviceSettings_localVideoViewOptions={scalingMode:"Crop",isMirrored:!0},LocalDeviceSettings_LocalDeviceSettings=function LocalDeviceSettings(props){var _props$cameras$,theme=Object(src.M)(),locale=Object(localization.b)(),defaultPlaceHolder=locale.strings.call.defaultPlaceHolder,cameraLabel=locale.strings.call.cameraLabel,soundLabel=locale.strings.call.soundLabel;return Object(jsx_runtime.jsxs)(Stack.a,{"data-ui-id":"call-composite-device-settings",tokens:mainStackTokens,children:[Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)(Label.a,{id:"call-composite-local-camera-settings-label",className:Object(lib.H)(dropDownStyles(theme).label),disabled:!props.cameraPermissionGranted,children:cameraLabel}),Object(jsx_runtime.jsx)(Dropdown.a,{"data-ui-id":"call-composite-local-camera-settings","aria-labelledby":"call-composite-local-camera-settings-label",placeholder:defaultPlaceHolder,options:props.cameraPermissionGranted?getDropDownList(props.cameras):[{key:"deniedOrUnknown",text:""}],styles:dropDownStyles(theme),disabled:!props.cameraPermissionGranted,errorMessage:void 0===props.cameraPermissionGranted||props.cameraPermissionGranted?void 0:locale.strings.call.cameraPermissionDenied,defaultSelectedKey:props.cameraPermissionGranted?props.selectedCamera?props.selectedCamera.id:props.cameras?null===(_props$cameras$=props.cameras[0])||void 0===_props$cameras$?void 0:_props$cameras$.id:"":"deniedOrUnknown",onChange:function onChange(event,option,index){props.onSelectCamera(props.cameras[null!=index?index:0],LocalDeviceSettings_localVideoViewOptions)},onRenderTitle:function onRenderTitle(props){return _onRenderTitle("Camera",props)}})]}),Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)(Label.a,{id:"call-composite-local-sound-settings-label",className:Object(lib.H)(dropDownStyles(theme).label),disabled:!props.microphonePermissionGranted,children:soundLabel}),Object(jsx_runtime.jsxs)(Stack.a,{"data-ui-id":"call-composite-sound-settings",tokens:mainStackTokens,children:[Object(jsx_runtime.jsx)(Dropdown.a,{"aria-labelledby":"call-composite-local-sound-settings-label",placeholder:defaultPlaceHolder,styles:dropDownStyles(theme),disabled:!props.microphonePermissionGranted,errorMessage:void 0===props.microphonePermissionGranted||props.microphonePermissionGranted?void 0:locale.strings.call.microphonePermissionDenied,options:props.microphonePermissionGranted?getDropDownList(props.microphones):[{key:"deniedOrUnknown",text:""}],defaultSelectedKey:props.microphonePermissionGranted?props.selectedMicrophone?props.selectedMicrophone.id:defaultDeviceId(props.microphones):"deniedOrUnknown",onChange:function onChange(event,option,index){props.onSelectMicrophone(props.microphones[null!=index?index:0])},onRenderTitle:function onRenderTitle(props){return _onRenderTitle("Microphone",props)}}),Object(jsx_runtime.jsx)(Dropdown.a,{"aria-labelledby":"call-composite-local-sound-settings-label",placeholder:defaultPlaceHolder,styles:dropDownStyles(theme),disabled:0===props.speakers.length,options:getDropDownList(props.speakers),defaultSelectedKey:props.selectedSpeaker?props.selectedSpeaker.id:defaultDeviceId(props.speakers),onChange:function onChange(event,option,index){props.onSelectSpeaker(props.speakers[null!=index?index:0])},onRenderTitle:function onRenderTitle(props){return _onRenderTitle("Speaker",props)}})]})]})]})};LocalDeviceSettings_LocalDeviceSettings.displayName="LocalDeviceSettings";var defaultDeviceId=function defaultDeviceId(devices){if(0===devices.length)return"";var defaultDevice=devices.find((function(device){return device.isSystemDefault}));return defaultDevice?defaultDevice.id:devices[0].id};LocalDeviceSettings_LocalDeviceSettings.__docgenInfo={description:"@private",methods:[],displayName:"LocalDeviceSettings",props:{cameras:{required:!0,tsType:{name:"Array",elements:[{name:"VideoDeviceInfo"}],raw:"VideoDeviceInfo[]"},description:""},microphones:{required:!0,tsType:{name:"Array",elements:[{name:"AudioDeviceInfo"}],raw:"AudioDeviceInfo[]"},description:""},speakers:{required:!0,tsType:{name:"Array",elements:[{name:"AudioDeviceInfo"}],raw:"AudioDeviceInfo[]"},description:""},selectedCamera:{required:!1,tsType:{name:"VideoDeviceInfo"},description:""},selectedMicrophone:{required:!1,tsType:{name:"AudioDeviceInfo"},description:""},selectedSpeaker:{required:!1,tsType:{name:"AudioDeviceInfo"},description:""},microphonePermissionGranted:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},cameraPermissionGranted:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},onSelectCamera:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: VideoDeviceInfo, options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"VideoDeviceInfo"}},{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onSelectMicrophone:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: AudioDeviceInfo) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"AudioDeviceInfo"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onSelectSpeaker:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: AudioDeviceInfo) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"AudioDeviceInfo"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/LocalDeviceSettings.tsx"]={name:"LocalDeviceSettings",docgenInfo:LocalDeviceSettings_LocalDeviceSettings.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/LocalDeviceSettings.tsx"});var PrimaryButton=__webpack_require__(1721),videoCameraIconStyle=Object(lib.H)({marginRight:"0.375rem",fontSize:"1.375rem"}),buttonStyle=Object(lib.H)({fontWeight:600,fontSize:"0.875rem",height:"2.75rem",width:"100%"}),buttonWithIconStyles={textContainer:{display:"contents"}},Video20Filled=__webpack_require__(1519),StartCallButton_StartCallButton=function StartCallButton(props){var isDisabled=props.isDisabled,onClickHandler=props.onClickHandler,rejoinCall=props.rejoinCall,locale=Object(localization.b)();return Object(jsx_runtime.jsx)(PrimaryButton.a,{"data-ui-id":"call-composite-start-call-button",disabled:isDisabled,className:Object(lib.H)(buttonStyle,props.className),styles:buttonWithIconStyles,text:rejoinCall?locale.strings.call.rejoinCallButtonLabel:locale.strings.call.startCallButtonLabel,onClick:onClickHandler,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Video20Filled.a,{className:videoCameraIconStyle})}})};StartCallButton_StartCallButton.displayName="StartCallButton",StartCallButton_StartCallButton.__docgenInfo={description:"@private",methods:[],displayName:"StartCallButton",props:{onClickHandler:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},isDisabled:{required:!0,tsType:{name:"boolean"},description:""},className:{required:!1,tsType:{name:"string"},description:""},rejoinCall:{required:!1,tsType:{name:"boolean"},description:"If set, the button is intended to rejoin an existing call."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/StartCallButton.tsx"]={name:"StartCallButton",docgenInfo:StartCallButton_StartCallButton.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/StartCallButton.tsx"});var devicePermissionSelector=es.a([baseSelectors.b],(function(deviceManager){return{video:deviceManager.deviceAccess?deviceManager.deviceAccess.video:void 0,audio:deviceManager.deviceAccess?deviceManager.deviceAccess.audio:void 0}})),localPreviewSelector=es.a([baseSelectors.b],(function(deviceManager){var view=deviceManager.unparentedViews.length>0&&deviceManager.unparentedViews[0].view;return{videoStreamElement:view?view.target:null}})),localPreviewContainerStyle={borderRadius:".25rem"},localPreviewContainerStyleDesktop=Object(lib.H)(Object.assign({},localPreviewContainerStyle,{width:"50%",minWidth:"11rem",maxWidth:"25rem",height:"18.75rem",padding:"0.5rem"})),localPreviewContainerStyleMobile=Object(lib.H)(Object.assign({},localPreviewContainerStyle,{width:"100%",height:"100%"})),cameraOffLabelStyle=Object(lib.H)({fontFamily:"Segoe UI Regular",fontSize:"0.75rem"}),localPreviewTileStyle={root:{borderRadius:".25rem"}};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var LocalPreview_LocalPreview=function LocalPreview(props){var locale=Object(localization.b)(),cameraButtonProps=Object(usePropsFor.a)(src.o),localPreviewProps=Object(useSelector.a)(localPreviewSelector),devicesButtonProps=Object(usePropsFor.a)(src.s),_useSelector=Object(useSelector.a)(devicePermissionSelector),microphonePermissionGranted=_useSelector.audio,cameraPermissionGranted=_useSelector.video,isLocalMicrophoneEnabled=Object(useSelector.a)(baseSelectors.g),adapter=Object(CallAdapterProvider.b)(),onToggleMic=Object(react.useCallback)(_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:isLocalMicrophoneEnabled?adapter.mute():adapter.unmute();case 1:case"end":return _context.stop()}}),_callee)}))),[adapter,isLocalMicrophoneEnabled]),theme=Object(src.M)(),onRenderPlaceholder=Object(react.useCallback)((function(){return Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.H)({width:"100%",height:"100%"}),verticalAlign:"center",tokens:{childrenGap:"0.25rem"},children:[Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(icons.a,{iconName:"LocalPreviewPlaceholder",className:Object(lib.H)(cameraOffLabelStyle,{color:theme.palette.neutralTertiary})})}),Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(cameraOffLabelStyle,{color:theme.palette.neutralSecondary}),children:locale.strings.call.cameraTurnedOff})})]})}),[theme,locale.strings.call.cameraTurnedOff]),devicesButtonStyles=props.mobileView?{menuStyles:{menuItemStyles:Buttons_styles.a}}:void 0;return Object(jsx_runtime.jsx)(Stack.a,{"data-ui-id":"call-composite-local-preview",className:props.mobileView?localPreviewContainerStyleMobile:localPreviewContainerStyleDesktop,children:Object(jsx_runtime.jsx)(src.K,{styles:localPreviewTileStyle,renderElement:null!=localPreviewProps&&localPreviewProps.videoStreamElement?Object(jsx_runtime.jsx)(src.H,{videoStreamElement:localPreviewProps.videoStreamElement}):void 0,onRenderPlaceholder:onRenderPlaceholder,children:Object(jsx_runtime.jsxs)(src.p,{layout:"floatingBottom",children:[Object(jsx_runtime.jsx)(src.B,{"data-ui-id":"call-composite-local-device-settings-microphone-button",checked:isLocalMicrophoneEnabled,onToggleMicrophone:onToggleMic,disabled:!microphonePermissionGranted,showLabel:!0}),Object(jsx_runtime.jsx)(src.o,Object.assign({"data-ui-id":"call-composite-local-device-settings-camera-button"},cameraButtonProps,{showLabel:!0,disabled:!cameraPermissionGranted})),props.showDevicesButton&&Object(jsx_runtime.jsx)(src.s,Object.assign({"data-ui-id":"call-composite-local-device-settings-options-button"},devicesButtonProps,{disabled:!microphonePermissionGranted||!cameraPermissionGranted,showLabel:!0,styles:devicesButtonStyles}))]})})})};LocalPreview_LocalPreview.displayName="LocalPreview",LocalPreview_LocalPreview.__docgenInfo={description:"@private",methods:[],displayName:"LocalPreview",props:{mobileView:{required:!0,tsType:{name:"boolean"},description:""},showDevicesButton:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/LocalPreview.tsx"]={name:"LocalPreview",docgenInfo:LocalPreview_LocalPreview.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/LocalPreview.tsx"});var configurationStackTokensDesktop={childrenGap:"2rem"},configurationStackTokensMobile={childrenGap:"1rem"},configurationContainerStyle={height:"100%",width:"100%",padding:"0.5rem"},configurationContainerStyleDesktop=Object(lib.H)(Object.assign({},configurationContainerStyle,{minWidth:"25rem",minHeight:"22rem"})),configurationContainerStyleMobile=Object(lib.H)(Object.assign({},configurationContainerStyle,{minWidth:"16rem",minHeight:"21rem"})),selectionContainerStyle=Object(lib.H)({width:"50%",minWidth:"11rem",maxWidth:"18.75rem",padding:"0.5rem"}),titleContainerStyleDesktop=Object(lib.H)({fontSize:"1.25rem",lineHeight:"1.75rem",fontWeight:600}),titleContainerStyleMobile=Object(lib.H)({fontSize:"1.0625rem",lineHeight:"1.375rem",fontWeight:600,textAlign:"center"}),callDetailsContainerStylesDesktop={root:{marginBottom:"1.563rem"}},callDetailsStyle={fontSize:"0.9375",lineHeight:"1.25rem",marginTop:"0.25rem"},callDetailsStyleDesktop=Object(lib.H)(Object.assign({},callDetailsStyle)),callDetailsStyleMobile=Object(lib.H)(Object.assign({},callDetailsStyle,{textAlign:"center"})),startCallButtonContainerStyleDesktop={root:{paddingTop:"1.125rem"}},startCallButtonContainerStyleMobile={root:{textAlign:"center"}},startCallButtonStyleMobile=Object(lib.H)({width:"100%",maxWidth:"unset"}),ConfigurationPage_ConfigurationPage=function ConfigurationPage(props){var startCallHandler=props.startCallHandler,mobileView=props.mobileView,options=Object(useAdaptedSelector.a)(Object(calling_component_bindings_src.f)(src.s)),localDeviceSettingsHandlers=Object(useHandlers.a)(LocalDeviceSettings_LocalDeviceSettings),_useSelector=Object(useSelector.a)(devicePermissionSelector),cameraPermissionGranted=_useSelector.video,microphonePermissionGranted=_useSelector.audio,locale=Object(localization.b)(),title=Object(jsx_runtime.jsx)(Stack.a.Item,{className:mobileView?titleContainerStyleMobile:titleContainerStyleDesktop,children:locale.strings.call.configurationPageTitle}),callDescription=locale.strings.call.configurationPageCallDetails&&Object(jsx_runtime.jsx)(Stack.a.Item,{className:mobileView?callDetailsStyleMobile:callDetailsStyleDesktop,children:locale.strings.call.configurationPageCallDetails});return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!mobileView,horizontalAlign:mobileView?"stretch":"center",verticalAlign:"center",tokens:mobileView?configurationStackTokensMobile:configurationStackTokensDesktop,className:mobileView?configurationContainerStyleMobile:configurationContainerStyleDesktop,children:[mobileView&&Object(jsx_runtime.jsxs)(Stack.a.Item,{children:[title,callDescription]}),Object(jsx_runtime.jsx)(LocalPreview_LocalPreview,{mobileView:mobileView,showDevicesButton:mobileView}),Object(jsx_runtime.jsxs)(Stack.a,{className:mobileView?void 0:selectionContainerStyle,children:[!mobileView&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsxs)(Stack.a.Item,{styles:callDetailsContainerStylesDesktop,children:[title,callDescription]}),Object(jsx_runtime.jsx)(LocalDeviceSettings_LocalDeviceSettings,Object.assign({},options,localDeviceSettingsHandlers,{cameraPermissionGranted:cameraPermissionGranted,microphonePermissionGranted:microphonePermissionGranted}))]}),Object(jsx_runtime.jsx)(Stack.a,{styles:mobileView?startCallButtonContainerStyleMobile:startCallButtonContainerStyleDesktop,children:Object(jsx_runtime.jsx)(StartCallButton_StartCallButton,{className:mobileView?startCallButtonStyleMobile:void 0,onClickHandler:startCallHandler,isDisabled:!microphonePermissionGranted})})]})]})};ConfigurationPage_ConfigurationPage.displayName="ConfigurationPage",ConfigurationPage_ConfigurationPage.__docgenInfo={description:"@private",methods:[],displayName:"ConfigurationPage",props:{mobileView:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/pages/ConfigurationPage.tsx"]={name:"ConfigurationPage",docgenInfo:ConfigurationPage_ConfigurationPage.__docgenInfo,path:"../react-composites/src/composites/CallComposite/pages/ConfigurationPage.tsx"});var NoticePage_styles_containerStyle={maxWidth:"22.5rem",margin:"1rem"},containerItemGap={childrenGap:"0.5rem"},rejoinCallButtonContainerStyles={root:{paddingTop:"1.125rem"}},titleStyles={fontSize:"1.25rem",fontWeight:600},moreDetailsStyles={fontSize:"1rem"};function NoticePage(props){var adapter=Object(CallAdapterProvider.b)();return Object(jsx_runtime.jsx)(Stack.a,{verticalFill:!0,verticalAlign:"center",horizontalAlign:"center","data-ui-id":props.dataUiId,children:Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.H)(NoticePage_styles_containerStyle),tokens:containerItemGap,children:[props.iconName&&Object(jsx_runtime.jsx)(icons.a,{iconName:props.iconName}),Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(titleStyles),children:props.title}),Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(moreDetailsStyles),children:props.moreDetails}),Object(jsx_runtime.jsx)(Stack.a,{styles:rejoinCallButtonContainerStyles,children:Object(jsx_runtime.jsx)(StartCallButton_StartCallButton,{onClickHandler:function onClickHandler(){return adapter.joinCall()},isDisabled:!1,rejoinCall:!0})})]})})}NoticePage.displayName="NoticePage",NoticePage.__docgenInfo={description:"Generic page with a title and more details text for serving up a notice to the user.\n\n@private",methods:[],displayName:"NoticePage",props:{iconName:{required:!0,tsType:{name:"unknown"},description:""},title:{required:!0,tsType:{name:"string"},description:""},moreDetails:{required:!1,tsType:{name:"string"},description:""},dataUiId:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/pages/NoticePage.tsx"]={name:"NoticePage",docgenInfo:NoticePage.__docgenInfo,path:"../react-composites/src/composites/CallComposite/pages/NoticePage.tsx"});var overlayContainerStyle={margin:"1rem"},LobbyTile_styles_titleStyle=function titleStyle(palette,isVideoReady){return{fontSize:"1.75rem",color:isVideoReady?"white":palette.neutralPrimary,textAlign:"center"}},LobbyTile_styles_moreDetailsStyle=function moreDetailsStyle(palette,isVideoReady){return{fontSize:"1rem",color:isVideoReady?"white":palette.neutralPrimary,textAlign:"center"}},LobbyTile_LobbyTile=function LobbyTile(props){var _videoStream$isAvaila,videoStream=props.localParticipantVideoStream,isVideoReady=null!==(_videoStream$isAvaila=null==videoStream?void 0:videoStream.isAvailable)&&void 0!==_videoStream$isAvaila&&_videoStream$isAvaila,palette=Object(src.M)().palette,handlers=Object(useHandlers.a)(ExpandedLocalVideoTile_ExpandedLocalVideoTile);return Object(jsx_runtime.jsx)(ExpandedLocalVideoTile_ExpandedLocalVideoTile,Object.assign({localParticipantVideoStream:props.localParticipantVideoStream,overlayContent:props.overlayProps?Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,horizontalAlign:"center",verticalAlign:"center",className:Object(lib.H)(overlayContainerStyle),children:[Object(jsx_runtime.jsx)(Stack.a.Item,{className:Object(lib.H)(LobbyTile_styles_titleStyle(palette,isVideoReady)),children:props.overlayProps.overlayIcon}),Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(LobbyTile_styles_titleStyle(palette,isVideoReady)),"aria-live":"polite",children:props.overlayProps.title}),props.overlayProps.moreDetails&&Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.H)(LobbyTile_styles_moreDetailsStyle(palette,isVideoReady)),children:props.overlayProps.moreDetails})]}):void 0},handlers))};LobbyTile_LobbyTile.displayName="LobbyTile",LobbyTile_LobbyTile.__docgenInfo={description:"@private",methods:[],displayName:"LobbyTile",props:{localParticipantVideoStream:{required:!0,tsType:{name:"VideoGalleryStream"},description:""},overlayProps:{required:!0,tsType:{name:"LobbyOverlayProps"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/components/LobbyTile.tsx"]={name:"LobbyTile",docgenInfo:LobbyTile_LobbyTile.__docgenInfo,path:"../react-composites/src/composites/CallComposite/components/LobbyTile.tsx"});var LobbyPage_LobbyPage=function LobbyPage(props){var _props$options,_props$options2,_props$options3,errorBarProps=Object(usePropsFor.a)(src.u),lobbyProps=Object(useSelector.a)(lobbySelector),strings=Object(localization.b)().strings.call,inLobby="InLobby"===Object(useSelector.a)(baseSelectors.a);MediaGallery_useLocalVideoStartTrigger(lobbyProps.localParticipantVideoStream.isAvailable,inLobby);var callControlOptions=props.mobileView?Object(utils.d)(null===(_props$options=props.options)||void 0===_props$options?void 0:_props$options.callControls):null===(_props$options2=props.options)||void 0===_props$options2?void 0:_props$options2.callControls;return callControlOptions=disableLobbyPageControls(callControlOptions),Object(jsx_runtime.jsx)(CallArrangement_CallArrangement,{complianceBannerProps:{},errorBarProps:!1!==(null===(_props$options3=props.options)||void 0===_props$options3?void 0:_props$options3.errorBar)&&Object.assign({},errorBarProps),callControlProps:{options:callControlOptions,increaseFlyoutItemSize:props.mobileView},mobileView:props.mobileView,onRenderGalleryContent:function onRenderGalleryContent(){return Object(jsx_runtime.jsx)(LobbyTile_LobbyTile,Object.assign({},lobbyProps,{overlayProps:overlayProps(strings,inLobby)}))},dataUiId:"lobby-page"})};LobbyPage_LobbyPage.displayName="LobbyPage";var disableLobbyPageControls=function disableLobbyPageControls(callControlOptions){var newOptions=callControlOptions;return!1!==newOptions&&(!0===newOptions||void 0===newOptions?newOptions={participantsButton:{disabled:!0},screenShareButton:{disabled:!0}}:(!1!==newOptions.participantsButton&&(newOptions.participantsButton={disabled:!0}),!1!==newOptions.screenShareButton&&(newOptions.screenShareButton={disabled:!0}))),newOptions},overlayProps=function overlayProps(strings,inLobby){return inLobby?LobbyPage_overlayPropsWaitingToBeAdmitted(strings,inLobby):LobbyPage_overlayPropsConnectingToCall(strings,inLobby)},LobbyPage_overlayPropsConnectingToCall=function overlayPropsConnectingToCall(strings,inLobby){return{title:strings.lobbyScreenConnectingToCallTitle,moreDetails:strings.lobbyScreenConnectingToCallMoreDetails,overlayIcon:Object(jsx_runtime.jsx)(icons.a,{iconName:"LobbyScreenConnectingToCall"})}},LobbyPage_overlayPropsWaitingToBeAdmitted=function overlayPropsWaitingToBeAdmitted(strings,inLobby){return{title:strings.lobbyScreenWaitingToBeAdmittedTitle,moreDetails:strings.lobbyScreenWaitingToBeAdmittedMoreDetails,overlayIcon:Object(jsx_runtime.jsx)(icons.a,{iconName:"LobbyScreenWaitingToBeAdmitted"})}};LobbyPage_LobbyPage.__docgenInfo={description:"@private",methods:[],displayName:"LobbyPage",props:{mobileView:{required:!0,tsType:{name:"boolean"},description:""},options:{required:!1,tsType:{name:"CallCompositeOptions"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/pages/LobbyPage.tsx"]={name:"LobbyPage",docgenInfo:LobbyPage_LobbyPage.__docgenInfo,path:"../react-composites/src/composites/CallComposite/pages/LobbyPage.tsx"});var mainScreenContainerStyle={height:"100%",width:"100%"},mainScreenContainerStyleDesktop=Object(lib.H)(Object.assign({},mainScreenContainerStyle,{minWidth:"30rem",minHeight:"22rem"})),mainScreenContainerStyleMobile=Object(lib.H)(Object.assign({},mainScreenContainerStyle,{minWidth:"19.5rem",minHeight:"21rem"}));function CallComposite_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var CallComposite_MainScreen=function MainScreen(props){var callInvitationUrl=props.callInvitationUrl,onRenderAvatar=props.onRenderAvatar,onFetchAvatarPersonaData=props.onFetchAvatarPersonaData,onFetchParticipantMenuItems=props.onFetchParticipantMenuItems,page=Object(useSelector.a)(baseSelectors.i),adapter=Object(CallAdapterProvider.b)(),locale=Object(localization.b)();switch(page){case"configuration":return Object(jsx_runtime.jsx)(ConfigurationPage_ConfigurationPage,{mobileView:props.mobileView,startCallHandler:function startCallHandler(){adapter.joinCall()}});case"accessDeniedTeamsMeeting":return Object(jsx_runtime.jsx)(NoticePage,{iconName:"NoticePageAccessDeniedTeamsMeeting",title:locale.strings.call.failedToJoinTeamsMeetingReasonAccessDeniedTitle,moreDetails:locale.strings.call.failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails,dataUiId:"access-denied-teams-meeting-page"});case"removedFromCall":return Object(jsx_runtime.jsx)(NoticePage,{iconName:"NoticePageRemovedFromCall",title:locale.strings.call.removedFromCallTitle,moreDetails:locale.strings.call.removedFromCallMoreDetails,dataUiId:"removed-from-call-page"});case"joinCallFailedDueToNoNetwork":return Object(jsx_runtime.jsx)(NoticePage,{iconName:"NoticePageJoinCallFailedDueToNoNetwork",title:locale.strings.call.failedToJoinCallDueToNoNetworkTitle,moreDetails:locale.strings.call.failedToJoinCallDueToNoNetworkMoreDetails,dataUiId:"join-call-failed-due-to-no-network-page"});case"leftCall":return Object(jsx_runtime.jsx)(NoticePage,{iconName:"NoticePageLeftCall",title:locale.strings.call.leftCallTitle,moreDetails:locale.strings.call.leftCallMoreDetails,dataUiId:"left-call-page"});case"lobby":return Object(jsx_runtime.jsx)(LobbyPage_LobbyPage,{mobileView:props.mobileView,options:props.options});case"call":return Object(jsx_runtime.jsx)(CallPage_CallPage,{onRenderAvatar:onRenderAvatar,callInvitationURL:callInvitationUrl,onFetchAvatarPersonaData:onFetchAvatarPersonaData,onFetchParticipantMenuItems:onFetchParticipantMenuItems,mobileView:props.mobileView,options:props.options});default:throw new Error("Invalid call composite page")}},CallComposite_CallComposite=function CallComposite(props){var adapter=props.adapter,callInvitationUrl=props.callInvitationUrl,onFetchAvatarPersonaData=props.onFetchAvatarPersonaData,onFetchParticipantMenuItems=props.onFetchParticipantMenuItems,options=props.options,_props$formFactor=props.formFactor,formFactor=void 0===_props$formFactor?"desktop":_props$formFactor;Object(react.useEffect)((function(){!function CallComposite_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CallComposite_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CallComposite_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,adapter.askDevicePermission({video:!0,audio:!0});case 2:adapter.queryCameras(),adapter.queryMicrophones(),adapter.querySpeakers();case 5:case"end":return _context.stop()}}),_callee)})))()}),[adapter]);var mobileView="mobile"===formFactor,mainScreenContainerClassName=Object(react.useMemo)((function(){return mobileView?mainScreenContainerStyleMobile:mainScreenContainerStyleDesktop}),[mobileView]);return Object(jsx_runtime.jsx)("div",{className:mainScreenContainerClassName,children:Object(jsx_runtime.jsx)(BaseComposite.a,Object.assign({},props,{children:Object(jsx_runtime.jsx)(CallAdapterProvider.a,{adapter:adapter,children:Object(jsx_runtime.jsx)(CallComposite_MainScreen,{callInvitationUrl:callInvitationUrl,onFetchAvatarPersonaData:onFetchAvatarPersonaData,onFetchParticipantMenuItems:onFetchParticipantMenuItems,mobileView:mobileView,options:options})})}))})};CallComposite_CallComposite.displayName="CallComposite",CallComposite_CallComposite.__docgenInfo={description:"A customizable UI composite for calling experience.\n\n@remarks Call composite min width/height are as follow:\n- mobile: 19.5rem x 21rem (312px x 336px, with default rem at 16px)\n- desktop: 30rem x 22rem (480px x 352px, with default rem at 16px)\n\n@public",methods:[],displayName:"CallComposite",props:{adapter:{required:!0,tsType:{name:"CallAdapter"},description:"An adapter provides logic and data to the composite.\nComposite can also be controlled using the adapter."},formFactor:{required:!1,tsType:{name:"union",raw:"'desktop' | 'mobile'",elements:[{name:"literal",value:"'desktop'"},{name:"literal",value:"'mobile'"}]},description:"Optimizes the composite form factor for either desktop or mobile.\n@remarks `mobile` is currently only optimized for Portrait mode on mobile devices and does not support landscape.\n@defaultValue 'desktop'"},callInvitationUrl:{required:!1,tsType:{name:"string"},description:"URL to invite new participants to the current call. If this is supplied, a button appears in the Participants\nButton flyout menu."},options:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  /**\n   * Surface Azure Communication Services backend errors in the UI with {@link @azure/communication-react#ErrorBar}.\n   * Hide or show the error bar.\n   * @defaultValue true\n   */\n  errorBar?: boolean;\n  /**\n   * Hide or Customize the control bar element.\n   * Can be customized by providing an object of type {@link @azure/communication-react#CallControlOptions}.\n   * @defaultValue true\n   */\n  callControls?: boolean | CallControlOptions;\n}",signature:{properties:[{key:"errorBar",value:{name:"boolean",required:!1}},{key:"callControls",value:{name:"union",raw:"boolean | CallControlOptions",elements:[{name:"boolean"},{name:"CallControlOptions"}],required:!1}}]}},description:"Flags to enable/disable or customize UI elements of the {@link CallComposite}."}},composes:["BaseCompositeProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/CallComposite.tsx"]={name:"CallComposite",docgenInfo:CallComposite_CallComposite.__docgenInfo,path:"../react-composites/src/composites/CallComposite/CallComposite.tsx"})},804:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ChatComposite_ChatComposite}));__webpack_require__(7);var react=__webpack_require__(1),BaseComposite=__webpack_require__(310),ChatAdapterProvider=__webpack_require__(163),lib=__webpack_require__(22),chatScreenContainerStyle=Object(lib.H)({height:"100%",width:"100%",minHeight:"20rem",minWidth:"19.5rem"}),chatContainer=Object(lib.H)({height:"100%",width:"100%",overflow:"hidden","*::-webkit-scrollbar":{width:"0.3rem",height:"0.3rem"},".scroll::-webkit-scrollbar-track":{background:"rgba(150, 150, 150)",borderRadius:"0.3rem"},"*::-webkit-scrollbar-thumb":{borderRadius:"10px",background:"rgba(150, 150, 150)"}}),chatArea=Object(lib.H)({height:"100%",width:"100%",overflow:"hidden"}),chatWrapper=Object(lib.H)({height:"100%",width:"100%",overflow:"auto"}),chatHeaderContainerStyle=Object(lib.H)({width:"100%",paddingLeft:"1.5rem",paddingRight:"1.5rem","@media screen and (max-width: 25rem)":{paddingLeft:"5%",paddingRight:"5%"},borderBottom:"0.063rem solid #DDDDDD"}),topicNameLabelStyle=Object(lib.H)({fontSize:"1.1rem",lineHeight:"2.5rem",fontWeight:600,marginRight:"0.125rem",textOverflow:"ellipsis",overflowY:"hidden"}),messageThreadChatCompositeStyles={root:{maxWidth:"41.25rem"}},typingIndicatorContainerStyles={padding:"0rem 0.25rem"},sendboxContainerStyles={maxWidth:"41.25rem",width:"100%",alignSelf:"center"},Stack=(__webpack_require__(34),__webpack_require__(28),__webpack_require__(16),__webpack_require__(69)),src=__webpack_require__(21),AvatarPersona=__webpack_require__(311),es=__webpack_require__(50),jsx_runtime=__webpack_require__(2),ChatHeader_ChatHeader=function ChatHeader(props){return Object(jsx_runtime.jsx)(Stack.a,{className:chatHeaderContainerStyle,horizontal:!0,children:Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)("div",{className:topicNameLabelStyle,children:props.topic})})})};ChatHeader_ChatHeader.displayName="ChatHeader";var getHeaderProps=es.a([function getTopicName(state,props){var _state$threads$props$,_state$threads$props$2;return(null===(_state$threads$props$=state.threads[props.threadId])||void 0===_state$threads$props$||null===(_state$threads$props$2=_state$threads$props$.properties)||void 0===_state$threads$props$2?void 0:_state$threads$props$2.topic)||""}],(function(topic){return{topic:topic}}));ChatHeader_ChatHeader.__docgenInfo={description:"@private",methods:[],displayName:"ChatHeader",props:{topic:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatHeader.tsx"]={name:"ChatHeader",docgenInfo:ChatHeader_ChatHeader.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatHeader.tsx"});var useTheme=__webpack_require__(369),Icon=__webpack_require__(884),Text=__webpack_require__(499),ProgressIndicator=__webpack_require__(1745),getFileTypeIconProps=__webpack_require__(1747),FileCard_FileCard=function FileCard(props){var fileName=props.fileName,fileExtension=props.fileExtension,progress=props.progress,actionIcon=props.actionIcon,theme=Object(useTheme.a)(),showProgressIndicator=function showProgressIndicator(){return void 0!==progress&&progress<1},containerClassName=Object(lib.H)({width:"14rem",background:theme.palette.neutralLighter,borderRadius:theme.effects.roundedCorner4,boxShadow:theme.effects.elevation8}),fileInfoWrapperClassName=Object(lib.H)({padding:"0.75rem",paddingBottom:showProgressIndicator()?"0.5rem":"0.75rem"}),fileInfoClassName=Object(lib.H)({paddingLeft:"0.25rem"}),actionIconClassName=Object(lib.H)({cursor:"pointer",padding:"0.25rem"}),progressIndicatorStyles={itemProgress:{height:0,padding:"2px 0",borderRadius:"0 0 "+theme.effects.roundedCorner4+" "+theme.effects.roundedCorner4}};return Object(jsx_runtime.jsxs)(Stack.a,{className:containerClassName,children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",className:fileInfoWrapperClassName,children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(Icon.a,Object.assign({},Object(getFileTypeIconProps.a)({extension:fileExtension,size:24,imageFileType:"svg"})))}),Object(jsx_runtime.jsx)(Stack.a,{className:fileInfoClassName,children:Object(jsx_runtime.jsx)(Text.a,{children:fileName})})]}),Object(jsx_runtime.jsx)(Stack.a,{className:actionIconClassName,onClick:function onClick(){props.actionHandler&&props.actionHandler()},children:actionIcon&&actionIcon})]}),showProgressIndicator()&&Object(jsx_runtime.jsx)(ProgressIndicator.a,{percentComplete:progress,styles:progressIndicatorStyles})]})};FileCard_FileCard.displayName="FileCard",FileCard_FileCard.__docgenInfo={description:"@beta",methods:[],displayName:"FileCard",props:{fileName:{required:!0,tsType:{name:"string"},description:"File name."},fileExtension:{required:!0,tsType:{name:"string"},description:"Extension of the file used for rendering the file icon."},progress:{required:!1,tsType:{name:"number"},description:"File upload progress percentage between 0 and 1.\nFile transfer progress indicator is only shown when the value is greater than 0 and less than 1."},actionIcon:{required:!1,tsType:{name:"JSX.Element"},description:"Icon to display for actions like download, upload, etc. along the file name."},actionHandler:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Function that runs when actionIcon is clicked"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/file-sharing/FileCard.tsx"]={name:"FileCard",docgenInfo:FileCard_FileCard.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/file-sharing/FileCard.tsx"});var fileCardGroupClassName=Object(lib.H)({flexFlow:"row wrap","& > *":{margin:"0.5rem",marginLeft:"0 rem",marginRight:"auto"},":not(:first-child)":{marginLeft:"0.5rem"}}),FileCardGroup_FileCardGroup=function FileCardGroup(props){var children=props.children;return Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,className:fileCardGroupClassName,children:children})};FileCardGroup_FileCardGroup.displayName="FileCardGroup",FileCardGroup_FileCardGroup.__docgenInfo={description:"@beta",methods:[],displayName:"FileCardGroup",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/file-sharing/FileCardGroup.tsx"]={name:"FileCardGroup",docgenInfo:FileCardGroup_FileCardGroup.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/file-sharing/FileCardGroup.tsx"});__webpack_require__(15),__webpack_require__(97),__webpack_require__(133),__webpack_require__(375);var acs_ui_common_src=__webpack_require__(32);var icons=__webpack_require__(57),FileUploadButton_FileUploadButton=function FileUploadButton(props){var inputRef=Object(react.useRef)(null),theme=Object(useTheme.a)(),accept=props.accept,_props$multiple=props.multiple,multiple=void 0!==_props$multiple&&_props$multiple,_onChange=props.onChange,fileUploadButtonClassName=Object(lib.H)({width:"1.5rem",height:"1.5rem",cursor:"pointer",padding:"0.15rem",":hover":{backgroundColor:theme.palette.neutralLighter}});return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(Stack.a,{verticalAlign:"center",horizontalAlign:"center",className:fileUploadButtonClassName,onClick:function onClick(){var _inputRef$current;return null===(_inputRef$current=inputRef.current)||void 0===_inputRef$current?void 0:_inputRef$current.click()},children:Object(jsx_runtime.jsx)(FileUploadButton_SendBoxAttachFileIconTrampoline,{})}),Object(jsx_runtime.jsx)("input",{ref:inputRef,hidden:!0,multiple:multiple,accept:accept,type:"file",onChange:function onChange(e){_onChange&&_onChange(e.currentTarget.files)}})]})},FileUploadButton_SendBoxAttachFileIconTrampoline=function SendBoxAttachFileIconTrampoline(){return Object(jsx_runtime.jsx)(icons.c,{iconName:"SendBoxAttachFile"})};FileUploadButton_SendBoxAttachFileIconTrampoline.displayName="SendBoxAttachFileIconTrampoline";var FileUploadButton_FileUploadButtonWrapper=function FileUploadButtonWrapper(props){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(jsx_runtime.jsx)(FileUploadButton_FileUploadButton,Object.assign({},props))})};FileUploadButton_FileUploadButton.__docgenInfo={description:"@internal",methods:[],displayName:"FileUploadButton",props:{accept:{required:!1,tsType:{name:"string"},description:'A string containing the comma separated list of accepted file types.\nSimilar to the `accept` attribute of the `<input type="file" />` element.'},multiple:{required:!1,tsType:{name:"boolean"},description:'Allows multiple files to be selected if set to `true`.\nDefault value is `false`.\nSimilar to the `multiple` attribute of the `<input type="file" />` element.'},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(files: FileList | null) => void",signature:{arguments:[{name:"files",type:{name:"union",raw:"FileList | null",elements:[{name:"FileList"},{name:"null"}]}}],return:{name:"void"}}},description:'onChange handler for the file upload button.\nSimilar to the `onChange` attribute of the `<input type="file" />` element.\nCalled every time files are selected through the file upload button with a {@link FileList}\nof selected files.'}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/file-sharing/FileUploadButton.tsx"]={name:"FileUploadButton",docgenInfo:FileUploadButton_FileUploadButton.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/file-sharing/FileUploadButton.tsx"}),FileUploadButton_FileUploadButtonWrapper.__docgenInfo={description:"A wrapper to return {@link FileUploadButton} component conditionally.\nIt will return `<></>` for stable builds.\n@internal",methods:[],displayName:"FileUploadButtonWrapper"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/file-sharing/FileUploadButton.tsx"]={name:"FileUploadButtonWrapper",docgenInfo:FileUploadButton_FileUploadButtonWrapper.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/file-sharing/FileUploadButton.tsx"});__webpack_require__(1364),__webpack_require__(113),__webpack_require__(56);var truncatedFileName=function truncatedFileName(fileName,length){return fileName.substring(0,length).trimEnd()+(fileName.length>length?"... ":"")},extension=function extension(fileName){return fileName.split(".").pop()||""},memoize_one_esm=(__webpack_require__(40),__webpack_require__(9),__webpack_require__(19),__webpack_require__(12),__webpack_require__(24),__webpack_require__(17),__webpack_require__(18),__webpack_require__(23),__webpack_require__(153));function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var useAdaptedSelector=function useAdaptedSelector(selector,selectorProps){return useAdaptedSelector_useSelectorWithAdaptation(selector,adaptCompositeState,selectorProps)},useAdaptedSelector_useSelectorWithAdaptation=function useSelectorWithAdaptation(selector,adaptState,selectorProps){var adapter=Object(ChatAdapterProvider.b)(),mounted=Object(react.useRef)(!1);Object(react.useEffect)((function(){return mounted.current=!0,function(){mounted.current=!1}}));var threadId=adapter.getState().thread.threadId,threadConfigProps=Object(react.useMemo)((function(){return{threadId:threadId}}),[threadId]),_useState2=_slicedToArray(Object(react.useState)(selector(adaptState(adapter.getState()),null!=selectorProps?selectorProps:threadConfigProps)),2),props=_useState2[0],setProps=_useState2[1],propRef=Object(react.useRef)(props);return propRef.current=props,Object(react.useEffect)((function(){var onStateChange=function onStateChange(state){if(mounted.current){var newProps=selector(adaptState(state),null!=selectorProps?selectorProps:threadConfigProps);propRef.current!==newProps&&setProps(newProps)}};return adapter.onStateChange(onStateChange),function(){adapter.offStateChange(onStateChange)}}),[adaptState,adapter,selector,selectorProps,threadConfigProps]),props},memoizeState=Object(memoize_one_esm.a)((function(userId,displayName,threads,latestErrors){return{userId:userId,displayName:displayName,threads:threads,latestErrors:latestErrors}})),memoizeThreads=Object(memoize_one_esm.a)((function(thread){var _ref;return(_ref={})[thread.threadId]=thread,_ref})),adaptCompositeState=function adaptCompositeState(compositeState){return memoizeState(compositeState.userId,compositeState.displayName,memoizeThreads(compositeState.thread),compositeState.latestErrors)},chat_component_bindings_src=__webpack_require__(485),createCompositeHandlers=Object(memoize_one_esm.a)((function(adapter){return{onSendMessage:adapter.sendMessage,onLoadPreviousChatMessages:adapter.loadPreviousChatMessages,onMessageSeen:adapter.sendReadReceipt,onTyping:adapter.sendTypingIndicator,onRemoveParticipant:adapter.removeParticipant,updateThreadTopicName:adapter.setTopic,onUpdateMessage:adapter.updateMessage,onDeleteMessage:adapter.deleteMessage}})),usePropsFor_usePropsFor=function usePropsFor(component){var selector=Object(chat_component_bindings_src.b)(component);if(!selector)throw new Error("Can't find the selector for component, please check supported component list");return Object.assign({},useAdaptedSelector(selector),function useHandlers(_component){return createCompositeHandlers(Object(ChatAdapterProvider.b)())}())},ParticipantContainer_styles=__webpack_require__(92),ParticipantContainer=__webpack_require__(469),localization=__webpack_require__(91),ChatScreenPeoplePane_ChatScreenPeoplePane=function ChatScreenPeoplePane(props){var onFetchAvatarPersonaData=props.onFetchAvatarPersonaData,onFetchParticipantMenuItems=props.onFetchParticipantMenuItems,chatListHeader=Object(localization.b)().strings.chat.chatListHeader,participantListProps=usePropsFor_usePropsFor(src.D);return Object(jsx_runtime.jsx)(ParticipantContainer.a,{participantListProps:participantListProps,title:chatListHeader,onFetchAvatarPersonaData:onFetchAvatarPersonaData,onFetchParticipantMenuItems:onFetchParticipantMenuItems})};ChatScreenPeoplePane_ChatScreenPeoplePane.displayName="ChatScreenPeoplePane",ChatScreenPeoplePane_ChatScreenPeoplePane.__docgenInfo={description:"@private",methods:[],displayName:"ChatScreenPeoplePane",props:{onFetchAvatarPersonaData:{required:!1,tsType:{name:"AvatarPersonaDataCallback"},description:""},onFetchParticipantMenuItems:{required:!1,tsType:{name:"ParticipantMenuItemsCallback"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatScreenPeoplePane.tsx"]={name:"ChatScreenPeoplePane",docgenInfo:ChatScreenPeoplePane_ChatScreenPeoplePane.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatScreenPeoplePane.tsx"});__webpack_require__(62),__webpack_require__(36),__webpack_require__(782);var fileUploadsSelector=Object(es.a)([function getFileUploads(state){return null==state?void 0:state.fileUploads}],(function(fileUploads){var files=[],haveAllFileUploadsCompleted=void 0;return fileUploads&&(files=Object.keys(fileUploads).map((function(key){return fileUploads[key]})),haveAllFileUploadsCompleted=Object.keys(fileUploads).every((function(key){return!!fileUploads[key].metadata}))),{files:files,completed:haveAllFileUploadsCompleted}})),FileUploadCards_FileUploadCards=function FileUploadCards(){var adapter=Object(ChatAdapterProvider.c)(),files=function useSelector(selector,selectorProps){return useAdaptedSelector_useSelectorWithAdaptation(selector,(function(state){return state}),selectorProps)}(fileUploadsSelector).files;return Object(jsx_runtime.jsx)(FileCardGroup_FileCardGroup,{children:files&&files.filter((function(file){return!file.errorMessage})).map((function(file){return Object(jsx_runtime.jsx)(FileCard_FileCard,{fileName:truncatedFileName(file.filename,15),progress:file.progress,fileExtension:extension(file.filename),actionIcon:Object(jsx_runtime.jsx)(FileUploadCards_CancelIconTrampoline,{}),actionHandler:function actionHandler(){adapter.cancelFileUpload&&adapter.cancelFileUpload(file.id)}},file.id)}))})};FileUploadCards_FileUploadCards.displayName="FileUploadCards";var FileUploadCards_CancelIconTrampoline=function CancelIconTrampoline(){return Object(jsx_runtime.jsx)(icons.c,{iconName:"Cancel"})};FileUploadCards_CancelIconTrampoline.displayName="CancelIconTrampoline",FileUploadCards_FileUploadCards.__docgenInfo={description:"@beta",methods:[],displayName:"FileUploadCards"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/FileUploadCards.tsx"]={name:"FileUploadCards",docgenInfo:FileUploadCards_FileUploadCards.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/FileUploadCards.tsx"});var FileDownloadCards_FileDownloadCards=function FileDownloadCards(props){var userId=props.userId,message=props.message,fileDownloads=message.metadata?function extractFileMetadata(metadata){return metadata.fileSharingMetadata?JSON.parse(metadata.fileSharingMetadata):[]}(message.metadata):[];return Object(jsx_runtime.jsx)(FileCardGroup_FileCardGroup,{children:fileDownloads&&fileDownloads.map((function(file){return Object(jsx_runtime.jsx)(FileCard_FileCard,{fileName:truncatedFileName(file.name,15),fileExtension:extension(file.name),actionIcon:Object(jsx_runtime.jsx)(FileDownloadCards_DownloadIconTrampoline,{}),actionHandler:function actionHandler(){props.downloadHandler&&props.downloadHandler(userId,file),!props.downloadHandler&&window.open(file.url,"_blank","noopener,noreferrer")}},file.name)}))})};FileDownloadCards_FileDownloadCards.displayName="FileDownloadCards";var FileDownloadCards_DownloadIconTrampoline=function DownloadIconTrampoline(){return Object(jsx_runtime.jsx)(icons.c,{iconName:"Download"})};FileDownloadCards_DownloadIconTrampoline.displayName="DownloadIconTrampoline",FileDownloadCards_FileDownloadCards.__docgenInfo={description:"@beta",methods:[],displayName:"FileDownloadCards"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/FileDownloadCards.tsx"]={name:"FileDownloadCards",docgenInfo:FileDownloadCards_FileDownloadCards.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/FileDownloadCards.tsx"});var ChatScreen_ChatScreen=function ChatScreen(props){var onFetchAvatarPersonaData=props.onFetchAvatarPersonaData,onRenderMessage=props.onRenderMessage,onRenderTypingIndicator=props.onRenderTypingIndicator,options=props.options,styles=props.styles,adapter=(props.fileSharing,Object(ChatAdapterProvider.b)());Object(react.useEffect)((function(){adapter.fetchInitialData()}),[adapter]);var messageThreadProps=usePropsFor_usePropsFor(src.A),sendBoxProps=usePropsFor_usePropsFor(src.G),typingIndicatorProps=usePropsFor_usePropsFor(src.I),headerProps=useAdaptedSelector(getHeaderProps),errorBarProps=usePropsFor_usePropsFor(src.u),onRenderAvatarCallback=Object(react.useCallback)((function(userId,defaultOptions){return Object(jsx_runtime.jsx)(AvatarPersona.a,Object.assign({userId:userId,hidePersonaDetails:!0},defaultOptions,{dataProvider:onFetchAvatarPersonaData}))}),[onFetchAvatarPersonaData]),messageThreadStyles=Object.assign({},messageThreadChatCompositeStyles,null==styles?void 0:styles.messageThread),typingIndicatorStyles=Object.assign({},null==styles?void 0:styles.typingIndicator),sendBoxStyles=Object.assign({},null==styles?void 0:styles.sendBox);Object(acs_ui_common_src.g)(adapter.getState().userId);return Object(jsx_runtime.jsxs)(Stack.a,{className:chatContainer,grow:!0,children:[!1!==(null==options?void 0:options.topic)&&Object(jsx_runtime.jsx)(ChatHeader_ChatHeader,Object.assign({},headerProps)),Object(jsx_runtime.jsxs)(Stack.a,{className:chatArea,tokens:ParticipantContainer_styles.c,horizontal:!0,grow:!0,children:[Object(jsx_runtime.jsxs)(Stack.a,{className:chatWrapper,grow:!0,children:[!1!==(null==options?void 0:options.errorBar)&&Object(jsx_runtime.jsx)(src.u,Object.assign({},errorBarProps)),Object(jsx_runtime.jsx)(src.A,Object.assign({},messageThreadProps,{onRenderAvatar:onRenderAvatarCallback,onRenderMessage:onRenderMessage,onRenderFileDownloads:function onRenderFileDownloads(userId,message){return Object(jsx_runtime.jsx)(FileDownloadCards_FileDownloadCards,{userId:userId,message:message})},numberOfChatMessagesToReload:5,styles:messageThreadStyles})),Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.H)(sendboxContainerStyles),children:[Object(jsx_runtime.jsx)("div",{className:Object(lib.H)(typingIndicatorContainerStyles),children:onRenderTypingIndicator?onRenderTypingIndicator(typingIndicatorProps.typingUsers):Object(jsx_runtime.jsx)(src.I,Object.assign({},typingIndicatorProps,{styles:typingIndicatorStyles}))}),Object(jsx_runtime.jsx)(src.G,Object.assign({},sendBoxProps,{onRenderFileUploads:function onRenderFileUploads(){return Object(jsx_runtime.jsx)(FileUploadCards_FileUploadCards,{})},autoFocus:null==options?void 0:options.autoFocus,styles:sendBoxStyles})),false]})]}),!0===(null==options?void 0:options.participantPane)&&Object(jsx_runtime.jsx)(ChatScreenPeoplePane_ChatScreenPeoplePane,{onFetchAvatarPersonaData:onFetchAvatarPersonaData,onFetchParticipantMenuItems:props.onFetchParticipantMenuItems})]})]})};ChatScreen_ChatScreen.displayName="ChatScreen",ChatScreen_ChatScreen.__docgenInfo={description:"@private",methods:[],displayName:"ChatScreen",props:{options:{required:!1,tsType:{name:"ChatCompositeOptions"},description:""},onFetchAvatarPersonaData:{required:!1,tsType:{name:"AvatarPersonaDataCallback"},description:""},onRenderMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageProps: MessageProps, defaultOnRender?: MessageRenderer) => JSX.Element",signature:{arguments:[{name:"messageProps",type:{name:"MessageProps"}},{name:"defaultOnRender",type:{name:"MessageRenderer"}}],return:{name:"JSX.Element"}}},description:""},onRenderTypingIndicator:{required:!1,tsType:{name:"signature",type:"function",raw:"(typingUsers: CommunicationParticipant[]) => JSX.Element",signature:{arguments:[{name:"typingUsers",type:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"}}],return:{name:"JSX.Element"}}},description:""},onFetchParticipantMenuItems:{required:!1,tsType:{name:"ParticipantMenuItemsCallback"},description:""},styles:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  messageThread?: MessageThreadStyles;\n  sendBox?: SendBoxStylesProps;\n  typingIndicator?: TypingIndicatorStylesProps;\n}",signature:{properties:[{key:"messageThread",value:{name:"MessageThreadStyles",required:!1}},{key:"sendBox",value:{name:"SendBoxStylesProps",required:!1}},{key:"typingIndicator",value:{name:"TypingIndicatorStylesProps",required:!1}}]}},description:""},hasFocusOnMount:{required:!1,tsType:{name:"literal",value:"'sendBoxTextField'"},description:""},fileSharing:{required:!1,tsType:{name:"FileSharingOptions"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatScreen.tsx"]={name:"ChatScreen",docgenInfo:ChatScreen_ChatScreen.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatScreen.tsx"});var ChatComposite_ChatComposite=function ChatComposite(props){var adapter=props.adapter,options=props.options,onFetchAvatarPersonaData=props.onFetchAvatarPersonaData,onRenderTypingIndicator=props.onRenderTypingIndicator,onRenderMessage=props.onRenderMessage,onFetchParticipantMenuItems=props.onFetchParticipantMenuItems;return Object(jsx_runtime.jsx)("div",{className:chatScreenContainerStyle,children:Object(jsx_runtime.jsx)(BaseComposite.a,Object.assign({},props,{children:Object(jsx_runtime.jsx)(ChatAdapterProvider.a,{adapter:adapter,children:Object(jsx_runtime.jsx)(ChatScreen_ChatScreen,Object.assign({options:options,onFetchAvatarPersonaData:onFetchAvatarPersonaData,onRenderTypingIndicator:onRenderTypingIndicator,onRenderMessage:onRenderMessage,onFetchParticipantMenuItems:onFetchParticipantMenuItems},function fileSharingOptions(){return{fileSharing:null==options?void 0:options.fileSharing}}()))})}))})};ChatComposite_ChatComposite.displayName="ChatComposite",ChatComposite_ChatComposite.__docgenInfo={description:"A customizable UI composite for the chat experience.\n\n@remarks Chat composite min width and height are respectively 19.5rem and 20rem (312px and 320px, with default rem at 16px)\n\n@public",methods:[],displayName:"ChatComposite",props:{adapter:{required:!0,tsType:{name:"ChatAdapter"},description:"An adapter provides logic and data to the composite.\nComposite can also be controlled using the adapter."},onRenderMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageProps: MessageProps, defaultOnRender?: MessageRenderer) => JSX.Element",signature:{arguments:[{name:"messageProps",type:{name:"MessageProps"}},{name:"defaultOnRender",type:{name:"MessageRenderer"}}],return:{name:"JSX.Element"}}},description:"`(messageProps: MessageProps, defaultOnRender?: MessageRenderer) => JSX.Element`\nA callback for customizing the message renderer."},onRenderTypingIndicator:{required:!1,tsType:{name:"signature",type:"function",raw:"(typingUsers: CommunicationParticipant[]) => JSX.Element",signature:{arguments:[{name:"typingUsers",type:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"}}],return:{name:"JSX.Element"}}},description:"`(typingUsers: CommunicationParticipant[]) => JSX.Element`\nA callback for customizing the typing indicator renderer."},options:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  /**\n   * Surface Azure Communication Services backend errors in the UI with {@link @azure/communication-react#ErrorBar}.\n   * Hide or show the error bar.\n   * @defaultValue true\n   */\n  errorBar?: boolean;\n  /* @conditional-compile-remove(chat-composite-participant-pane) */\n  /**\n   * Show or hide the participant pane. This feature is in beta and not supported on mobile or narrow screen views.\n   * @defaultValue false\n   *\n   * @beta\n   */\n  participantPane?: boolean;\n  /**\n   * Show or hide the topic at the top of the chat. Hidden if set to `false`\n   * @defaultValue true\n   */\n  topic?: boolean;\n  /**\n   * enumerable to determine if the input box has focus on render or not.\n   * When undefined nothing has focus on render\n   */\n  autoFocus?: 'sendBoxTextField';\n\n  /* @conditional-compile-remove(file-sharing) */\n  /**\n   * Properties for configuring the File Sharing feature.\n   * If undefined, file sharing feature will be disabled.\n   * @beta\n   */\n  fileSharing?: FileSharingOptions;\n}",signature:{properties:[{key:"errorBar",value:{name:"boolean",required:!1}},{key:"participantPane",value:{name:"boolean",required:!1}},{key:"topic",value:{name:"boolean",required:!1}},{key:"autoFocus",value:{name:"literal",value:"'sendBoxTextField'",required:!1}},{key:"fileSharing",value:{name:"FileSharingOptions",required:!1}}]}},description:"Flags to enable/disable visual elements of the {@link ChatComposite}."}},composes:["BaseCompositeProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatComposite.tsx"]={name:"ChatComposite",docgenInfo:ChatComposite_ChatComposite.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatComposite.tsx"})},843:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(you)","menuTitle":"More Options","removeButtonLabel":"Remove","sharingIconLabel":"Sharing","mutedIconLabel":"Muted"},"typingIndicator":{"singleUser":"{user} is typing ...","multipleUsers":"{users} are typing ...","multipleUsersAbbreviateOne":"{users} and 1 other are typing ...","multipleUsersAbbreviateMany":"{users} and {numOthers} others are typing ...","delimiter":", "},"sendBox":{"placeholderText":"Enter a message","textTooLong":"Your message length is over the maximum limit.","sendButtonAriaLabel":"Send message"},"messageStatusIndicator":{"deliveredAriaLabel":"Message sent","deliveredTooltipText":"Sent","seenAriaLabel":"Message seen by others","seenTooltipText":"Seen","readByTooltipText":"Read by {messageThreadReadCount} of {remoteParticipantsCount}","sendingAriaLabel":"Message sending","sendingTooltipText":"Sending","failedToSendAriaLabel":"Message failed to send","failedToSendTooltipText":"Failed to send"},"endCallButton":{"label":"Leave","tooltipContent":"Leave Call"},"cameraButton":{"onLabel":"Turn off","offLabel":"Turn on","tooltipDisabledContent":"Camera is disabled","tooltipOnContent":"Turn off camera","tooltipOffContent":"Turn on camera","tooltipVideoLoadingContent":"Video is loading","cameraMenuTitle":"Camera","cameraMenuTooltip":"Choose Camera"},"microphoneButton":{"onLabel":"Mute","offLabel":"Unmute","tooltipDisabledContent":"Microphone is disabled","tooltipOnContent":"Mute microphone","tooltipOffContent":"Unmute microphone","microphoneMenuTitle":"Microphone","microphoneMenuTooltip":"Choose Microphone","speakerMenuTitle":"Speaker","speakerMenuTooltip":"Choose Speaker"},"devicesButton":{"label":"Devices","tooltipContent":"Manage devices","cameraMenuTitle":"Camera","cameraMenuTooltip":"Choose Camera","microphoneMenuTitle":"Microphone","microphoneMenuTooltip":"Choose Microphone","speakerMenuTitle":"Speaker","speakerMenuTooltip":"Choose Speaker"},"participantsButton":{"label":"People","tooltipContent":"Show Participants","menuHeader":"In this call","participantsListButtonLabel":"{numParticipants} people","muteAllButtonLabel":"Mute all","copyInviteLinkButtonLabel":"Copy invite link"},"screenShareButton":{"onLabel":"Stop presenting","offLabel":"Present","tooltipDisabledContent":"Presenting is disabled","tooltipOnContent":"Presenting your screen","tooltipOffContent":"Present your screen"},"messageThread":{"yesterday":"Yesterday","sunday":"Sunday","monday":"Monday","tuesday":"Tuesday","wednesday":"Wednesday","thursday":"Thursday","friday":"Friday","saturday":"Saturday","participantJoined":"joined the chat.","participantLeft":"left the chat.","editMessage":"Edit","removeMessage":"Delete","editedTag":"Edited","liveAuthorIntro":"{author} says","editBoxTextLimit":"Your message is over the limit of {limitNumber} characters","editBoxPlaceholderText":"Edit your message","newMessagesIndicator":"New messages","noDisplayNameSub":"No name","editBoxCancelButton":"Cancel","editBoxSubmitButton":"Submit","messageReadCount":"Read by {messageReadByCount} of {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"You are offline","accessDenied":"Unable to access chat services - please check the user credentials provided","userNotInChatThread":"You are no longer in this chat thread","sendMessageNotInChatThread":"Failed to send message because you are no longer in this chat thread","sendMessageGeneric":"Failed to send message","callingNetworkFailure":"Troubling connecting call - you seem to be offline","startVideoGeneric":"Failed to start video","stopVideoGeneric":"Failed to stop video","muteGeneric":"Failed to mute microphone","unmuteGeneric":"Failed to unmute microphone","speakingWhileMuted":"Your microphone is muted","startScreenShareGeneric":"Failed to start screen sharing","stopScreenShareGeneric":"Failed to stop screen sharing","callNetworkQualityLow":"Network quality is low.","callNoSpeakerFound":"No speakers or headphones found. Connect an audio device to hear the call.","callNoMicrophoneFound":"No microphones found. Connect an audio input device.","callMicrophoneAccessDenied":"Unable to access microphone. Click the lock in the address bar to grant permission to this webpage.","callMicrophoneMutedBySystem":"You are muted by your system.","callMacOsMicrophoneAccessDenied":"Unable to access microphone. Grant microphone permission in your macOS privacy settings.","callLocalVideoFreeze":"Network bandwidth is poor. Your video may appear paused for others on the call.","callCameraAccessDenied":"Unable to access camera. Click the lock in the address bar to grant permission to this webpage.","callCameraAlreadyInUse":"Unable to access camera. It may already be in use by another application.","callMacOsCameraAccessDenied":"MacOS is blocking access to your camera. Update your privacy settings to allow this browser to access your camera.","callMacOsScreenShareAccessDenied":"MacOS is blocking screen sharing. Update your privacy settings to allow this browser to record your screen."},"videoGallery":{"screenIsBeingSharedMessage":"You are sharing your screen","screenShareLoadingMessage":"Loading {participant}\'s screen","localVideoLabel":"You","localVideoCameraSwitcherLabel":"Cycle camera"}}')},844:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(Sie)","menuTitle":"Weitere Optionen","removeButtonLabel":"Entfernen","sharingIconLabel":"Teilen","mutedIconLabel":"Stumm geschaltet"},"typingIndicator":{"singleUser":"{user} schreibt ...","multipleUsers":"{users} schreiben ...","multipleUsersAbbreviateOne":"{users} und 1 andere Person schreiben ...","multipleUsersAbbreviateMany":"{users} und {numOthers} andere schreiben ...","delimiter":", "},"sendBox":{"placeholderText":"Nachricht eingeben","textTooLong":"Ihre Nachrichtenlnge berschreitet den maximalen Grenzwert.","sendButtonAriaLabel":"Nachricht senden"},"messageStatusIndicator":{"deliveredAriaLabel":"Nachricht gesendet","deliveredTooltipText":"Gesendet","seenAriaLabel":"Nachricht von anderen gesehen","seenTooltipText":"Gesehen","readByTooltipText":"Gelesen von {messageThreadReadCount} von {remoteParticipantsCount}","sendingAriaLabel":"Nachricht wird gesendet","sendingTooltipText":"Wird gesendet","failedToSendAriaLabel":"Nachricht konnte nicht gesendet werden","failedToSendTooltipText":"Fehler beim Senden"},"endCallButton":{"label":"Verlassen","tooltipContent":"Anruf verlassen"},"cameraButton":{"onLabel":"Deaktivieren","offLabel":"Aktivieren","tooltipDisabledContent":"Kamera ist deaktiviert","tooltipOnContent":"Kamera ausschalten","tooltipOffContent":"Kamera einschalten","tooltipVideoLoadingContent":"Video wird geladen","cameraMenuTitle":"Kamera","cameraMenuTooltip":"Kamera auswhlen"},"microphoneButton":{"onLabel":"Stumm schalten","offLabel":"Stummschaltung aufheben","tooltipDisabledContent":"Mikrofon ist deaktiviert","tooltipOnContent":"Mikrofon stummschalten","tooltipOffContent":"Mikrofonstummschaltung aufheben","microphoneMenuTitle":"Mikrofon","microphoneMenuTooltip":"Mikrofon auswhlen","speakerMenuTitle":"Lautsprecher","speakerMenuTooltip":"Lautsprecher auswhlen"},"devicesButton":{"label":"Gerte","tooltipContent":"Gerte verwalten","cameraMenuTitle":"Kamera","cameraMenuTooltip":"Kamera auswhlen","microphoneMenuTitle":"Mikrofon","microphoneMenuTooltip":"Mikrofon auswhlen","speakerMenuTitle":"Lautsprecher","speakerMenuTooltip":"Lautsprecher auswhlen"},"participantsButton":{"label":"Personen","tooltipContent":"Teilnehmer anzeigen","menuHeader":"In diesem Anruf","participantsListButtonLabel":"{numParticipants}Personen","muteAllButtonLabel":"Alle stumm schalten","copyInviteLinkButtonLabel":"Einladungslink kopieren"},"screenShareButton":{"onLabel":"Prsentation beenden","offLabel":"Prsentieren","tooltipDisabledContent":"Prsentieren ist deaktiviert","tooltipOnContent":"Ihr Bildschirm wird prsentiert","tooltipOffContent":"Prsentieren Sie Ihren Bildschirm"},"messageThread":{"yesterday":"Gestern","sunday":"Sonntag","monday":"Montag","tuesday":"Dienstag","wednesday":"Mittwoch","thursday":"Donnerstag","friday":"Freitag","saturday":"Samstag","participantJoined":"ist dem Chat beigetreten.","participantLeft":"hat den Chat verlassen.","editMessage":"Bearbeiten","removeMessage":"Lschen","editedTag":"Bearbeitet","liveAuthorIntro":"{author} sagt","editBoxTextLimit":"Ihre Nachricht berschreitet das Limit von {limitNumber} Zeichen.","editBoxPlaceholderText":"Bearbeiten Sie Ihre Nachricht","newMessagesIndicator":"Neue Nachrichten","noDisplayNameSub":"Kein Name","editBoxCancelButton":"Abbrechen","editBoxSubmitButton":"bermitteln","messageReadCount":"Gelesen von {messageReadByCount} von {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"Sie sind offline.","accessDenied":"Auf die Chatdienste kann nicht zugegriffen werden. berprfen Sie die angegebenen Benutzeranmeldeinformationen.","userNotInChatThread":"Sie sind nicht mehr in diesem Chatthread vertreten.","sendMessageNotInChatThread":"Fehler beim Senden der Nachricht, weil Sie sich nicht mehr in diesem Chatthread befinden.","sendMessageGeneric":"Fehler beim Senden der Nachricht","callingNetworkFailure":"Problematische Anrufverbindung  Sie scheinen offline zu sein","startVideoGeneric":"Video konnte nicht gestartet werden","stopVideoGeneric":"Video konnte nicht beendet werden","muteGeneric":"Mikrofon konnte nicht stummgeschaltet werden","unmuteGeneric":"Stummschaltung des Mikrofons konnte nicht beendet werden","speakingWhileMuted":"Ihr Mikrofon ist stummgeschaltet","startScreenShareGeneric":"Bildschirmfreigabe konnte nicht gestartet werden","stopScreenShareGeneric":"Bildschirmfreigabe konnte nicht beendet werden","callNetworkQualityLow":"Die Netzwerkqualitt ist niedrig.","callNoSpeakerFound":"Keine Lautsprecher oder Kopfhrer gefunden. Schlieen Sie ein Audiogert an, um den Anruf zu hren.","callNoMicrophoneFound":"Es wurden keine Mikrofone gefunden. Schlieen Sie ein Audioeingabegert an.","callMicrophoneAccessDenied":"Auf das Mikrofon kann nicht zugegriffen werden. Klicken Sie auf die Sperre in der Adressleiste, um dieser Webseite Berechtigungen zu erteilen.","callMicrophoneMutedBySystem":"Sie werden von Ihrem System stummgeschaltet.","callMacOsMicrophoneAccessDenied":"Auf das Mikrofon kann nicht zugegriffen werden. Erteilen Sie die Mikrofonberechtigung in Ihren macOS-Datenschutzeinstellungen.","callLocalVideoFreeze":"Die Netzwerkbandbreite ist schlecht. Ihr Video wird mglicherweise fr andere Personen whrend des Anrufs angehalten angezeigt.","callCameraAccessDenied":"Auf die Kamera kann nicht zugegriffen werden. Klicken Sie auf die Sperre in der Adressleiste, um dieser Webseite Berechtigungen zu erteilen.","callCameraAlreadyInUse":"Auf die Kamera kann nicht zugegriffen werden. Sie wird mglicherweise bereits von einer anderen Anwendung verwendet.","callMacOsCameraAccessDenied":"MacOS blockiert den Zugriff auf Ihre Kamera. Aktualisieren Sie Ihre Datenschutzeinstellungen, damit dieser Browser auf Ihre Kamera zugreifen kann.","callMacOsScreenShareAccessDenied":"MacOS blockiert die Bildschirmfreigabe. Aktualisieren Sie Ihre Datenschutzeinstellungen, damit dieser Browser Ihren Bildschirm aufzeichnen kann."},"videoGallery":{"screenIsBeingSharedMessage":"Sie teilen Ihren Bildschirm","screenShareLoadingMessage":"Der Bildschirm von {participant} wird geladen","localVideoLabel":"Sie","localVideoCameraSwitcherLabel":"Fahrrad-/Motorrad-Kamera"}}')},845:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(t)","menuTitle":"Ms opciones","removeButtonLabel":"Quitar","sharingIconLabel":"Compartiendo","mutedIconLabel":"Silenciado"},"typingIndicator":{"singleUser":"{user} est escribiendo...","multipleUsers":"{users} estn escribiendo...","multipleUsersAbbreviateOne":"{users} y 1 usuario ms estn escribiendo...","multipleUsersAbbreviateMany":"{users} y {numOthers} usuarios ms estn escribiendo...","delimiter":", "},"sendBox":{"placeholderText":"Escribir un mensaje","textTooLong":"La longitud del mensaje supera el lmite mximo.","sendButtonAriaLabel":"Enviar mensaje"},"messageStatusIndicator":{"deliveredAriaLabel":"Mensaje enviado","deliveredTooltipText":"Enviado","seenAriaLabel":"Mensaje visto por otros usuarios","seenTooltipText":"Visto","readByTooltipText":"Ledo por {messageThreadReadCount} de {remoteParticipantsCount}","sendingAriaLabel":"Envo de mensajes","sendingTooltipText":"Enviando","failedToSendAriaLabel":"Error al enviar el mensaje","failedToSendTooltipText":"Error al enviar"},"endCallButton":{"label":"Baja","tooltipContent":"Abandonar llamada"},"cameraButton":{"onLabel":"Desactivar","offLabel":"Activar","tooltipDisabledContent":"La cmara est deshabilitada","tooltipOnContent":"Desconectar la cmara","tooltipOffContent":"Activar la cmara","tooltipVideoLoadingContent":"El vdeo se est cargando","cameraMenuTitle":"Cmara","cameraMenuTooltip":"Elegir cmara"},"microphoneButton":{"onLabel":"Silenciar","offLabel":"Reactivar audio","tooltipDisabledContent":"El micrfono est deshabilitado","tooltipOnContent":"Silenciar micrfono","tooltipOffContent":"Reactivar micrfono","microphoneMenuTitle":"Micrfono","microphoneMenuTooltip":"Elegir micrfono","speakerMenuTitle":"Altavoz","speakerMenuTooltip":"Elegir altavoz"},"devicesButton":{"label":"Dispositivos","tooltipContent":"Administrar dispositivos","cameraMenuTitle":"Cmara","cameraMenuTooltip":"Elegir cmara","microphoneMenuTitle":"Micrfono","microphoneMenuTooltip":"Elegir micrfono","speakerMenuTitle":"Altavoz","speakerMenuTooltip":"Elegir altavoz"},"participantsButton":{"label":"Contactos","tooltipContent":"Mostrar participantes","menuHeader":"En esta llamada","participantsListButtonLabel":"{numParticipants} personas","muteAllButtonLabel":"Silenciar a todos","copyInviteLinkButtonLabel":"Copiar vnculo de invitacin"},"screenShareButton":{"onLabel":"Dejar de presentar","offLabel":"Presentar","tooltipDisabledContent":"La presentacin est deshabilitada","tooltipOnContent":"Presentando su pantalla","tooltipOffContent":"Presentar la pantalla"},"messageThread":{"yesterday":"Ayer","sunday":"Domingo","monday":"Lunes","tuesday":"Martes","wednesday":"Mircoles","thursday":"Jueves","friday":"Viernes","saturday":"Sbado","participantJoined":"se uni al chat.","participantLeft":"abandon el chat.","editMessage":"Editar","removeMessage":"Eliminar","editedTag":"Editado","liveAuthorIntro":"{author} dice","editBoxTextLimit":"El mensaje supera el lmite de {limitNumber} caracteres","editBoxPlaceholderText":"Editar el mensaje","newMessagesIndicator":"Mensajes nuevos","noDisplayNameSub":"Sin nombre","editBoxCancelButton":"Cancelar","editBoxSubmitButton":"Enviar","messageReadCount":"Ledo por {messageReadByCount} de {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"Sin conexin","accessDenied":"No se puede acceder a los servicios de chat. Compruebe las credenciales de usuario proporcionadas.","userNotInChatThread":"Ya no est en este hilo de chat","sendMessageNotInChatThread":"No se pudo enviar el mensaje porque ya no est en este hilo de chat","sendMessageGeneric":"Error al enviar el mensaje","callingNetworkFailure":"Problema al conectar la llamada; parece que no hay conexin","startVideoGeneric":"No se pudo iniciar el vdeo","stopVideoGeneric":"No se pudo detener el vdeo","muteGeneric":"No se pudo silenciar el micrfono","unmuteGeneric":"No se pudo reactivar el micrfono","speakingWhileMuted":"El micrfono est desactivado","startScreenShareGeneric":"No se pudo iniciar la pantalla compartida","stopScreenShareGeneric":"No se pudo detener la pantalla compartida","callNetworkQualityLow":"La calidad de la red es baja.","callNoSpeakerFound":"No se encontraron altavoces ni auriculares. Conecta un dispositivo de audio para escuchar la llamada.","callNoMicrophoneFound":"No se encontraron micrfonos. Conecta un dispositivo de entrada de audio.","callMicrophoneAccessDenied":"No se puede acceder al micrfono. Haga clic en el bloqueo de la barra de direcciones para conceder permiso a esta pgina web.","callMicrophoneMutedBySystem":"Su sistema ha silenciado su audio.","callMacOsMicrophoneAccessDenied":"No se puede acceder al micrfono. Conceda permiso al micrfono en la configuracin de privacidad de macOS.","callLocalVideoFreeze":"El ancho de banda de red es deficiente. Es posible que el vdeo aparezca pausado para otros usuarios en la llamada.","callCameraAccessDenied":"No se puede acceder a la cmara. Haga clic en el bloqueo de la barra de direcciones para conceder permiso a esta pgina web.","callCameraAlreadyInUse":"No se puede acceder a la cmara. Puede que ya la est usando otra aplicacin.","callMacOsCameraAccessDenied":"MacOS est bloqueando el acceso a la cmara. Actualiza la configuracin de privacidad para permitir que este explorador acceda a la cmara.","callMacOsScreenShareAccessDenied":"MacOS est bloqueando el uso compartido de la pantalla. Actualice la configuracin de privacidad para permitir que este explorador grabe la pantalla."},"videoGallery":{"screenIsBeingSharedMessage":"Est compartiendo su pantalla","screenShareLoadingMessage":"Cargando la pantalla de {participant}","localVideoLabel":"T","localVideoCameraSwitcherLabel":"Cmara de ciclo"}}')},846:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(vous)","menuTitle":"Plus doptions","removeButtonLabel":"Supprimer","sharingIconLabel":"Partage","mutedIconLabel":"Muet activ"},"typingIndicator":{"singleUser":"{user} en train dcrire...","multipleUsers":"{users} sont en train d\'crire...","multipleUsersAbbreviateOne":"{users} et 1 autre en train d\'crire...","multipleUsersAbbreviateMany":"{users} et {numOthers} autres en train dcrire...","delimiter":", "},"sendBox":{"placeholderText":"Saisir un message","textTooLong":"La longueur de votre message dpasse la limite maximale.","sendButtonAriaLabel":"Envoyer un message"},"messageStatusIndicator":{"deliveredAriaLabel":"Message envoy","deliveredTooltipText":"Envoy","seenAriaLabel":"Message vu par dautres personnes","seenTooltipText":"Vu","readByTooltipText":"Lu par {messageThreadReadCount} participants sur {remoteParticipantsCount}","sendingAriaLabel":"Envoi du message","sendingTooltipText":"Envoi","failedToSendAriaLabel":"chec d\'envoi du message","failedToSendTooltipText":"chec de l\'envoi"},"endCallButton":{"label":"Quitter","tooltipContent":"Quitter lappel"},"cameraButton":{"onLabel":"Dsactiver","offLabel":"Activer","tooltipDisabledContent":"La camra est dsactive.","tooltipOnContent":"Dsactiver la camra","tooltipOffContent":"Activer la camra","tooltipVideoLoadingContent":"Chargement de la vido","cameraMenuTitle":"Camra","cameraMenuTooltip":"Choisissez l\'appareil photo"},"microphoneButton":{"onLabel":"Dsactiver le son","offLabel":"Ractiver le son","tooltipDisabledContent":"Le microphone est dsactiv.","tooltipOnContent":"Dsactiver le micro","tooltipOffContent":"Activer le micro","microphoneMenuTitle":"Microphone","microphoneMenuTooltip":"Choisissez le micro","speakerMenuTitle":"Haut-parleur","speakerMenuTooltip":"Choisissez le haut-parleur"},"devicesButton":{"label":"Appareils","tooltipContent":"Grer les appareils","cameraMenuTitle":"Appareil photo","cameraMenuTooltip":"Choisir une camra","microphoneMenuTitle":"Microphone","microphoneMenuTooltip":"Choisir le micro","speakerMenuTitle":"Haut-parleur","speakerMenuTooltip":"Choisir une enceinte"},"participantsButton":{"label":"Personnes","tooltipContent":"Afficher les participants","menuHeader":"Pendant cet appel","participantsListButtonLabel":"{numParticipants} contacts","muteAllButtonLabel":"Dsactiver tous les micros","copyInviteLinkButtonLabel":"Copier le lien d\'invitation"},"screenShareButton":{"onLabel":"Arrter le partage","offLabel":"Partager","tooltipDisabledContent":"Le partage de vido est dsactiv.","tooltipOnContent":"Cesser le partage de votre cran","tooltipOffContent":"Partager votre cran"},"messageThread":{"yesterday":"Hier","sunday":"Dimanche","monday":"Lundi","tuesday":"Mardi","wednesday":"Mercredi","thursday":"Jeudi","friday":"Vendredi","saturday":"Samedi","participantJoined":"a rejoint la conversation.","participantLeft":"a quitt le conversation.","editMessage":"Modifier","removeMessage":"Supprimer","editedTag":"Modifi","liveAuthorIntro":"{author} dit","editBoxTextLimit":"Votre message dpasse la limite de {limitNumber} caractres","editBoxPlaceholderText":"Modifier votre message","newMessagesIndicator":"Nouveaux messages","noDisplayNameSub":"Sans nom","editBoxCancelButton":"Annuler","editBoxSubmitButton":"Envoyer","messageReadCount":"Lu par {messageReadByCount} participants sur {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"Vous tes hors connexion","accessDenied":"Impossible daccder aux services de conversation. Vrifiez les informations didentification de lutilisateur fournies","userNotInChatThread":"Vous nest plus dans ce thread de conversation","sendMessageNotInChatThread":"chec de lenvoi du message car vous ntes plus dans ce thread de conversation","sendMessageGeneric":"chec de lenvoi du message","callingNetworkFailure":"Perturbation de lappel de connexion : vous semblez tre hors connexion","startVideoGeneric":"chec du dmarrage de la vido","stopVideoGeneric":"chec de larrt de la vido","muteGeneric":"chec de la dsactivation du son du microphone","unmuteGeneric":"chec de lactivation du son du microphone","speakingWhileMuted":"Votre micro est dsactiv","startScreenShareGeneric":"chec du dmarrage du partage dcran","stopScreenShareGeneric":"chec de larrt du partage dcran","callNetworkQualityLow":"La qualit de rseau est faible.","callNoSpeakerFound":"Aucun haut-parleur ou casque na t trouv. Connectez un priphrique audio pour entendre lappel.","callNoMicrophoneFound":"Aucun micro na t trouv. Connectez un priphrique dentre audio.","callMicrophoneAccessDenied":"Impossible daccder au microphone. Cliquez sur le verrou dans la barre dadresses pour accorder lautorisation  cette page Web.","callMicrophoneMutedBySystem":"Votre micro est dsactiv par votre systme.","callMacOsMicrophoneAccessDenied":"Impossible daccder au microphone. Accordez lautorisation de microphone dans vos paramtres de confidentialit macOS.","callLocalVideoFreeze":"La bande passante rseau est mdiocre. Votre vido peut apparatre suspendue pour les autres participants  lappel.","callCameraAccessDenied":"Impossible daccder  la camra. Cliquez sur le verrou dans la barre dadresses pour accorder lautorisation  cette page Web.","callCameraAlreadyInUse":"Impossible daccder  la camra. Il est peut-tre dj utilis par une autre application.","callMacOsCameraAccessDenied":"MacOS bloque laccs  votre camra. Mettez  jour vos paramtres de confidentialit pour autoriser ce navigateur  accder  votre camra.","callMacOsScreenShareAccessDenied":"MacOS bloque le partage dcran. Mettez  jour vos paramtres de confidentialit pour permettre  ce navigateur denregistrer votre cran."},"videoGallery":{"screenIsBeingSharedMessage":"Vous partagez votre cran.","screenShareLoadingMessage":"Chargement de lcran de {participant}","localVideoLabel":"Vous","localVideoCameraSwitcherLabel":"Faire un cycle de camra"}}')},847:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(tu)","menuTitle":"Altre opzioni","removeButtonLabel":"Rimuovi","sharingIconLabel":"Condivisione","mutedIconLabel":"Disattivato"},"typingIndicator":{"singleUser":"{user} sta scrivendo ...","multipleUsers":"{users} stanno scrivendo ...","multipleUsersAbbreviateOne":"{users} e 1 altro stanno scrivendo ...","multipleUsersAbbreviateMany":"{users} e {numOthers} altri stanno scrivendo ...","delimiter":", "},"sendBox":{"placeholderText":"Immetti un messaggio","textTooLong":"La lunghezza del messaggio supera il limite massimo.","sendButtonAriaLabel":"Invio messaggio"},"messageStatusIndicator":{"deliveredAriaLabel":"Il messaggio  stato inviato","deliveredTooltipText":"Inviato","seenAriaLabel":"Messaggio visualizzato da altri utenti","seenTooltipText":"Visualizzato","readByTooltipText":"Letto da {messageThreadReadCount} di {remoteParticipantsCount}","sendingAriaLabel":"Invio del messaggio","sendingTooltipText":"Invio in corso","failedToSendAriaLabel":"Invio messaggio non riuscito","failedToSendTooltipText":"Invio non riuscito"},"endCallButton":{"label":"Permesso","tooltipContent":"Abbandona chiamata"},"cameraButton":{"onLabel":"Disabilita","offLabel":"Abilita","tooltipDisabledContent":"La videocamera  disabilitata","tooltipOnContent":"Spegni la videocamera","tooltipOffContent":"Accendi la videocamera","tooltipVideoLoadingContent":"Il video  in corso di caricamento","cameraMenuTitle":"Fotocamera","cameraMenuTooltip":"Scegli la fotocamera"},"microphoneButton":{"onLabel":"Disattiva audio","offLabel":"Riattiva audio","tooltipDisabledContent":"Il microfono  disabilitato","tooltipOnContent":"Disattiva microfono","tooltipOffContent":"Riattiva microfono","microphoneMenuTitle":"Microfono","microphoneMenuTooltip":"Scegli il microfono","speakerMenuTitle":"Altoparlante","speakerMenuTooltip":"Scegli laltoparlante"},"devicesButton":{"label":"Dispositivi","tooltipContent":"Gestisci dispositivi","cameraMenuTitle":"Fotocamera","cameraMenuTooltip":"Scegli la fotocamera","microphoneMenuTitle":"Microfono","microphoneMenuTooltip":"Scegli il microfono","speakerMenuTitle":"Altoparlante","speakerMenuTooltip":"Scegli laltoparlante"},"participantsButton":{"label":"Persone","tooltipContent":"Mostra partecipanti","menuHeader":"In questa chiamata","participantsListButtonLabel":"{numParticipants} persone","muteAllButtonLabel":"Disattiva l\'audio di tutti","copyInviteLinkButtonLabel":"Copia il collegamento dellinvito"},"screenShareButton":{"onLabel":"Interrompi presentazione","offLabel":"Presentazione","tooltipDisabledContent":"La presentazione  disabilitata.","tooltipOnContent":"Presentazione dello schermo","tooltipOffContent":"Presenta lo schermo"},"messageThread":{"yesterday":"Ieri","sunday":"Domenica","monday":"Luned","tuesday":"Marted","wednesday":"Mercoled","thursday":"Gioved","friday":"Venerd","saturday":"Sabato","participantJoined":"si  unito alla chat.","participantLeft":"ha abbandonato la chat.","editMessage":"Modifica","removeMessage":"Elimina","editedTag":"Modificato","liveAuthorIntro":"{author} dice","editBoxTextLimit":"Il messaggio ha superato il limite di caratteri {limitNumber}","editBoxPlaceholderText":"Modifica il messaggio","newMessagesIndicator":"Nuovi messaggi","noDisplayNameSub":"Nessun nome","editBoxCancelButton":"Annulla","editBoxSubmitButton":"Invia","messageReadCount":"Letto da {messageReadByCount} di {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"Sei offline","accessDenied":"Non  possibile accedere ai servizi di chat. Controllare le credenziali utente specificate","userNotInChatThread":"Non fai pi parte di questo thread di chat","sendMessageNotInChatThread":"Non  stato possibile inviare il messaggio perch non sei pi in questo thread di chat","sendMessageGeneric":"Impossibile inviare il messaggio","callingNetworkFailure":"Problema di connessione della chiamata: sembra che tu sia offline","startVideoGeneric":"Non  stato possibile avviare il video","stopVideoGeneric":"Non  stato possibile arrestare il video","muteGeneric":"Non  stato possibile disattivare l\'audio del microfono","unmuteGeneric":"Non  stato possibile riattivare l\'audio del microfono","speakingWhileMuted":"Il microfono  disattivato","startScreenShareGeneric":"Non  stato possibile avviare la condivisione dello schermo","stopScreenShareGeneric":"Non  stato possibile arrestare la condivisione dello schermo","callNetworkQualityLow":"La qualit della rete  bassa.","callNoSpeakerFound":"Non sono stati trovati altoparlanti o cuffie. Connetti un dispositivo audio per ascoltare la chiamata.","callNoMicrophoneFound":"Nessun microfono trovato. Connetti un dispositivo di input audio.","callMicrophoneAccessDenied":"Impossibile accedere al microfono. Fare clic sul blocco nella barra degli indirizzi per concedere l\'autorizzazione a questa pagina Web.","callMicrophoneMutedBySystem":"Il sistema disattiva l\'audio.","callMacOsMicrophoneAccessDenied":"Impossibile accedere al microfono. Concedi l\'autorizzazione al microfono nelle impostazioni di privacy di macOS.","callLocalVideoFreeze":"Larghezza di banda di rete insufficiente. Il video potrebbe essere sospeso per gli altri partecipanti alla chiamata.","callCameraAccessDenied":"Non  possibile accedere alla fotocamera. Fare clic sul blocco nella barra degli indirizzi per concedere l\'autorizzazione a questa pagina Web.","callCameraAlreadyInUse":"Non  possibile accedere alla fotocamera. Potrebbe essere gi in uso da un\'altra applicazione.","callMacOsCameraAccessDenied":"MacOS sta bloccando l\'accesso alla fotocamera. Aggiorna le impostazioni di privacy per consentire a questo browser di accedere alla fotocamera.","callMacOsScreenShareAccessDenied":"MacOS sta bloccando la condivisione dello schermo. Aggiorna le impostazioni di privacy per consentire a questo browser di registrare lo schermo."},"videoGallery":{"screenIsBeingSharedMessage":"Stai condividendo lo schermo","screenShareLoadingMessage":"Caricamento dello schermo di {participant}","localVideoLabel":"Tu","localVideoCameraSwitcherLabel":"Ciclo fotocamera"}}')},848:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"()","menuTitle":"","removeButtonLabel":"","sharingIconLabel":"","mutedIconLabel":""},"typingIndicator":{"singleUser":"{user} ...","multipleUsers":"{users} ...","multipleUsersAbbreviateOne":"{users}  1 ...","multipleUsersAbbreviateMany":"{users}  {numOthers} ...","delimiter":","},"sendBox":{"placeholderText":"","textTooLong":"","sendButtonAriaLabel":""},"messageStatusIndicator":{"deliveredAriaLabel":"","deliveredTooltipText":"","seenAriaLabel":"","seenTooltipText":"","readByTooltipText":"{remoteParticipantsCount}  {messageThreadReadCount} ","sendingAriaLabel":"","sendingTooltipText":"","failedToSendAriaLabel":"","failedToSendTooltipText":""},"endCallButton":{"label":"","tooltipContent":""},"cameraButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":"","tooltipOnContent":"","tooltipOffContent":"","tooltipVideoLoadingContent":"","cameraMenuTitle":"","cameraMenuTooltip":""},"microphoneButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":"","tooltipOnContent":"","tooltipOffContent":"","microphoneMenuTitle":"","microphoneMenuTooltip":"","speakerMenuTitle":"","speakerMenuTooltip":""},"devicesButton":{"label":"","tooltipContent":"","cameraMenuTitle":"","cameraMenuTooltip":"","microphoneMenuTitle":"","microphoneMenuTooltip":"","speakerMenuTitle":"","speakerMenuTooltip":""},"participantsButton":{"label":"","tooltipContent":"","menuHeader":"","participantsListButtonLabel":"{numParticipants} ","muteAllButtonLabel":"","copyInviteLinkButtonLabel":""},"screenShareButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":"","tooltipOnContent":"","tooltipOffContent":""},"messageThread":{"yesterday":"","sunday":"","monday":"","tuesday":"","wednesday":"","thursday":"","friday":"","saturday":"","participantJoined":"","participantLeft":"","editMessage":"","removeMessage":"","editedTag":"","liveAuthorIntro":"{author} ","editBoxTextLimit":"{limitNumber}","editBoxPlaceholderText":"","newMessagesIndicator":"","noDisplayNameSub":"","editBoxCancelButton":"","editBoxSubmitButton":"","messageReadCount":"{remoteParticipantsCount}  {messageReadByCount} "},"errorBar":{"unableToReachChatService":"","accessDenied":" - ","userNotInChatThread":" ","sendMessageNotInChatThread":" ","sendMessageGeneric":"","callingNetworkFailure":"","startVideoGeneric":"","stopVideoGeneric":"","muteGeneric":"","unmuteGeneric":"","speakingWhileMuted":"","startScreenShareGeneric":"","stopScreenShareGeneric":"","callNetworkQualityLow":"","callNoSpeakerFound":"","callNoMicrophoneFound":"","callMicrophoneAccessDenied":"  Web ","callMicrophoneMutedBySystem":"","callMacOsMicrophoneAccessDenied":"macOS ","callLocalVideoFreeze":"","callCameraAccessDenied":"  Web ","callCameraAlreadyInUse":"","callMacOsCameraAccessDenied":"MacOS ","callMacOsScreenShareAccessDenied":"MacOS "},"videoGallery":{"screenIsBeingSharedMessage":"","screenShareLoadingMessage":"{participant} ","localVideoLabel":"","localVideoCameraSwitcherLabel":" "}}')},849:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"()","menuTitle":" ","removeButtonLabel":"","sharingIconLabel":" ","mutedIconLabel":""},"typingIndicator":{"singleUser":"{user}   ...","multipleUsers":"{users}   ...","multipleUsersAbbreviateOne":"{users}   1  ...","multipleUsersAbbreviateMany":"{users}   {numOthers}   ...","delimiter":"   "},"sendBox":{"placeholderText":" ","textTooLong":"    .","sendButtonAriaLabel":" "},"messageStatusIndicator":{"deliveredAriaLabel":" ","deliveredTooltipText":"","seenAriaLabel":"   ","seenTooltipText":"","readByTooltipText":"{messageThreadReadCount}/{remoteParticipantsCount} ","sendingAriaLabel":"  ","sendingTooltipText":" ","failedToSendAriaLabel":"  ","failedToSendTooltipText":" "},"endCallButton":{"label":"","tooltipContent":" "},"cameraButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":" ","tooltipOnContent":" ","tooltipOffContent":" ","tooltipVideoLoadingContent":"  .","cameraMenuTitle":"","cameraMenuTooltip":" "},"microphoneButton":{"onLabel":"","offLabel":" ","tooltipDisabledContent":" ","tooltipOnContent":" ","tooltipOffContent":"  ","microphoneMenuTitle":"","microphoneMenuTooltip":" ","speakerMenuTitle":"","speakerMenuTooltip":" "},"devicesButton":{"label":"","tooltipContent":" ","cameraMenuTitle":"","cameraMenuTooltip":" ","microphoneMenuTitle":"","microphoneMenuTooltip":" ","speakerMenuTitle":"","speakerMenuTooltip":" "},"participantsButton":{"label":"","tooltipContent":" ","menuHeader":" ","participantsListButtonLabel":"{numParticipants}","muteAllButtonLabel":" ","copyInviteLinkButtonLabel":"  "},"screenShareButton":{"onLabel":" ","offLabel":"","tooltipDisabledContent":"   ","tooltipOnContent":"  ","tooltipOffContent":" "},"messageThread":{"yesterday":"","sunday":"","monday":"","tuesday":"","wednesday":"","thursday":"","friday":"","saturday":"","participantJoined":" .","participantLeft":"  .","editMessage":"","removeMessage":"","editedTag":"","liveAuthorIntro":"{author}  .","editBoxTextLimit":" {limitNumber}   .","editBoxPlaceholderText":" ","newMessagesIndicator":" ","noDisplayNameSub":" ","editBoxCancelButton":"","editBoxSubmitButton":"","messageReadCount":"{messageReadByCount}/{remoteParticipantsCount} "},"errorBar":{"unableToReachChatService":" .","accessDenied":"    .     .","userNotInChatThread":"     .","sendMessageNotInChatThread":"         .","sendMessageGeneric":"  ","callingNetworkFailure":"   -    .","startVideoGeneric":"  ","stopVideoGeneric":"  ","muteGeneric":"  ","unmuteGeneric":"   ","speakingWhileMuted":" ","startScreenShareGeneric":"   ","stopScreenShareGeneric":"   ","callNetworkQualityLow":"  .","callNoSpeakerFound":"     .       .","callNoMicrophoneFound":"   .    .","callMicrophoneAccessDenied":"   .         .","callMicrophoneMutedBySystem":"  .","callMacOsMicrophoneAccessDenied":"   . macOS      .","callLocalVideoFreeze":"  .          .","callCameraAccessDenied":"   .         .","callCameraAlreadyInUse":"   .        .","callMacOsCameraAccessDenied":"MacOS     .          .","callMacOsScreenShareAccessDenied":"MacOS    .          ."},"videoGallery":{"screenIsBeingSharedMessage":"  .","screenShareLoadingMessage":"{participant}    ","localVideoLabel":"","localVideoCameraSwitcherLabel":" "}}')},850:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(jij)","menuTitle":"Meer opties","removeButtonLabel":"Verwijderen","sharingIconLabel":"Delen","mutedIconLabel":"Gedempt"},"typingIndicator":{"singleUser":"{user} typt ...","multipleUsers":"{users} typen ...","multipleUsersAbbreviateOne":"{users} en 1 andere persoon typen ...","multipleUsersAbbreviateMany":"{users} en {numOthers} anderen typen ...","delimiter":", "},"sendBox":{"placeholderText":"Een bericht invoeren","textTooLong":"De lengte van uw bericht overschrijdt de maximumlimiet.","sendButtonAriaLabel":"Bericht verzenden"},"messageStatusIndicator":{"deliveredAriaLabel":"Bericht verzonden","deliveredTooltipText":"Verzonden","seenAriaLabel":"Bericht gezien door anderen","seenTooltipText":"Gezien","readByTooltipText":"Gelezen door {messageThreadReadCount} van {remoteParticipantsCount}","sendingAriaLabel":"Bericht verzenden","sendingTooltipText":"Verzenden","failedToSendAriaLabel":"Het bericht is niet verzonden","failedToSendTooltipText":"Kan niet verzenden"},"endCallButton":{"label":"Verlaten","tooltipContent":"Gesprek verlaten"},"cameraButton":{"onLabel":"Uitschakelen","offLabel":"Inschakelen","tooltipDisabledContent":"Camera is uitgeschakeld","tooltipOnContent":"Camera uitschakelen","tooltipOffContent":"Camera inschakelen","tooltipVideoLoadingContent":"Video wordt geladen","cameraMenuTitle":"Camera","cameraMenuTooltip":"Camera kiezen"},"microphoneButton":{"onLabel":"Dempen","offLabel":"Dempen opheffen","tooltipDisabledContent":"Microfoon is uitgeschakeld","tooltipOnContent":"Microfoon uitschakelen","tooltipOffContent":"Microfoon inschakelen","microphoneMenuTitle":"Microfoon","microphoneMenuTooltip":"Microfoon kiezen","speakerMenuTitle":"Luidspreker","speakerMenuTooltip":"Luidspreker kiezen"},"devicesButton":{"label":"Apparaten","tooltipContent":"Apparaten beheren","cameraMenuTitle":"Camera","cameraMenuTooltip":"Camera kiezen","microphoneMenuTitle":"Microfoon","microphoneMenuTooltip":"Microfoon kiezen","speakerMenuTitle":"Spreker","speakerMenuTooltip":"Luidspreker kiezen"},"participantsButton":{"label":"Personen","tooltipContent":"Deelnemers weergeven","menuHeader":"In dit gesprek","participantsListButtonLabel":"{numParticipants} personen","muteAllButtonLabel":"Alles dempen","copyInviteLinkButtonLabel":"Uitnodigingskoppeling kopiren"},"screenShareButton":{"onLabel":"Presenteren stoppen","offLabel":"Presenteren","tooltipDisabledContent":"Presenteren is uitgeschakeld","tooltipOnContent":"Uw scherm presenteren","tooltipOffContent":"Uw scherm presenteren"},"messageThread":{"yesterday":"Gisteren","sunday":"Zondag","monday":"Maandag","tuesday":"Dinsdag","wednesday":"Woensdag","thursday":"Donderdag","friday":"Vrijdag","saturday":"Zaterdag","participantJoined":"neemt nu deel aan de chat.","participantLeft":"heeft de chat verlaten.","editMessage":"Bewerken","removeMessage":"Verwijderen","editedTag":"Bewerkt","liveAuthorIntro":"{author} zegt","editBoxTextLimit":"Uw bericht heeft de limiet van {limitNumber} tekens overschreden","editBoxPlaceholderText":"Uw bericht bewerken","newMessagesIndicator":"Nieuwe berichten","noDisplayNameSub":"Geen naam","editBoxCancelButton":"Annuleren","editBoxSubmitButton":"Verzenden","messageReadCount":"Gelezen door {messageReadByCount} van {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"U bent offline","accessDenied":"Kan geen toegang krijgen tot chatservices. Controleer de opgegeven gebruikersreferenties","userNotInChatThread":"U bent niet meer aanwezig in deze chatthread","sendMessageNotInChatThread":"Verzenden van bericht is mislukt omdat u zich niet meer in deze chatthread bevindt","sendMessageGeneric":"Kan bericht niet verzenden","callingNetworkFailure":"Er zijn problemen met het verbinden van een gesprek - Het lijkt erop dat u offline bent","startVideoGeneric":"Kan video niet starten","stopVideoGeneric":"Kan video niet stoppen","muteGeneric":"Kan microfoon niet dempen","unmuteGeneric":"Kan dempen van microfoon niet opheffen","speakingWhileMuted":"De microfoon is gedempt","startScreenShareGeneric":"Kan scherm delen niet starten","stopScreenShareGeneric":"Kan scherm delen niet stoppen","callNetworkQualityLow":"De netwerkkwaliteit is laag.","callNoSpeakerFound":"Geen luidsprekers of hoofdtelefoon gevonden. Sluit een audioapparaat aan om het gesprek te beluisteren.","callNoMicrophoneFound":"Geen microfoons gevonden. Sluit een audio-invoerapparaat aan.","callMicrophoneAccessDenied":"Kan geen toegang krijgen tot de microfoon. Klik op de vergrendeling in de adresbalk om toestemming te verlenen aan deze webpagina.","callMicrophoneMutedBySystem":"U bent gedempt door jouw systeem.","callMacOsMicrophoneAccessDenied":"Kan geen toegang krijgen tot de microfoon. Verleen microfoonmachtiging in de privacyinstellingen voor macOS.","callLocalVideoFreeze":"De netwerkbandbreedte is slecht. Je video wordt mogelijk onderbroken weergegeven voor anderen in het gesprek.","callCameraAccessDenied":"Kan geen toegang krijgen tot de camera. Klik op de vergrendeling in de adresbalk om toestemming te verlenen aan deze webpagina.","callCameraAlreadyInUse":"Kan geen toegang krijgen tot de camera. Het wordt mogelijk al gebruikt door een andere toepassing.","callMacOsCameraAccessDenied":"MacOS blokkeert de toegang tot jouw camera. Werk je privacyinstellingen bij, zodat deze browser toegang heeft tot jouw camera.","callMacOsScreenShareAccessDenied":"MacOS blokkeert scherm delen. Werk je privacyinstellingen bij, zodat deze browser jouw scherm kan opnemen."},"videoGallery":{"screenIsBeingSharedMessage":"U deelt uw scherm","screenShareLoadingMessage":"Scherm van {participant} laden","localVideoLabel":"U","localVideoCameraSwitcherLabel":"Camera wisselen"}}')},851:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(voc)","menuTitle":"Mais opes","removeButtonLabel":"Remover","sharingIconLabel":"Compartilhamento","mutedIconLabel":"Silenciado"},"typingIndicator":{"singleUser":"{user} est digitando ...","multipleUsers":"{users} esto digitando ...","multipleUsersAbbreviateOne":"{users} e 1 outro esto digitando...","multipleUsersAbbreviateMany":"{users} e {numOthers} outros esto digitando ...","delimiter":", "},"sendBox":{"placeholderText":"Inserir uma mensagem","textTooLong":"O comprimento da mensagem est acima do limite mximo.","sendButtonAriaLabel":"Enviar mensagem"},"messageStatusIndicator":{"deliveredAriaLabel":"Mensagem enviada","deliveredTooltipText":"Enviado","seenAriaLabel":"Mensagem vista por outras pessoas","seenTooltipText":"Visto","readByTooltipText":"Lido por {messageThreadReadCount} de {remoteParticipantsCount}","sendingAriaLabel":"Envio de mensagem","sendingTooltipText":"Enviando","failedToSendAriaLabel":"Falha ao enviar mensagem","failedToSendTooltipText":"Falha ao enviar"},"endCallButton":{"label":"Sair","tooltipContent":"Sair da Chamada"},"cameraButton":{"onLabel":"Desabilitar","offLabel":"Habilitar","tooltipDisabledContent":"A cmera est desabilitada","tooltipOnContent":"Desabilitar a cmera","tooltipOffContent":"Ligar a cmera","tooltipVideoLoadingContent":"O vdeo est carregando","cameraMenuTitle":"Cmera","cameraMenuTooltip":"Escolher Cmera"},"microphoneButton":{"onLabel":"Mudo","offLabel":"Desativar mudo","tooltipDisabledContent":"O microfone est desabilitado","tooltipOnContent":"Ativar mudo do microfone","tooltipOffContent":"Desativar mudo do microfone","microphoneMenuTitle":"Microfone","microphoneMenuTooltip":"Escolher Microfone","speakerMenuTitle":"Alto-falante","speakerMenuTooltip":"Escolher Alto-falante"},"devicesButton":{"label":"Dispositivos","tooltipContent":"Gerenciar dispositivos","cameraMenuTitle":"Cmera","cameraMenuTooltip":"Escolher Cmera","microphoneMenuTitle":"Microfone","microphoneMenuTooltip":"Escolher Microfone","speakerMenuTitle":"Alto-falante","speakerMenuTooltip":"Escolher Alto-falante"},"participantsButton":{"label":"Pessoas","tooltipContent":"Mostrar Participantes","menuHeader":"Nesta chamada","participantsListButtonLabel":"{numParticipants} pessoas","muteAllButtonLabel":"Silenciar todos","copyInviteLinkButtonLabel":"Copiar o link de convite"},"screenShareButton":{"onLabel":"Interromper apresentao","offLabel":"Apresentao","tooltipDisabledContent":"A apresentao est desabilitada.","tooltipOnContent":"Apresentando sua tela","tooltipOffContent":"Apresentar sua tela"},"messageThread":{"yesterday":"Ontem","sunday":"Domingo","monday":"Segunda","tuesday":"Tera-feira","wednesday":"Quarta-feira","thursday":"quinta-feira","friday":"Sexta-feira","saturday":"Sbado","participantJoined":"ingressou no chat.","participantLeft":"saiu do chat.","editMessage":"Editar","removeMessage":"Excluir","editedTag":"Editado","liveAuthorIntro":"{author} disse","editBoxTextLimit":"Sua mensagem est acima do limite de {limitNumber} caracteres","editBoxPlaceholderText":"Edite sua mensagem","newMessagesIndicator":"Novas mensagens","noDisplayNameSub":"Sem nome","editBoxCancelButton":"Cancelar","editBoxSubmitButton":"Enviar","messageReadCount":"Lido por {messageReadByCount} de {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"Voc est offline","accessDenied":"No  possvel acessar os servios de chat - verifique as credenciais do usurio fornecidas","userNotInChatThread":"Voc no est mais neste tpico de chat","sendMessageNotInChatThread":"Falha ao enviar mensagem porque voc no est mais neste thread de chat","sendMessageGeneric":"Falha ao enviar mensagem","callingNetworkFailure":"Chamada de conexo desabilitar - parece que voc est offline","startVideoGeneric":"Falha ao iniciar o vdeo","stopVideoGeneric":"Falha ao interromper o vdeo","muteGeneric":"Falha ao ativar mudo do microfone","unmuteGeneric":"Falha ao desativar mudo do microfone","speakingWhileMuted":"O microfone est com o mudo ativado","startScreenShareGeneric":"Falha ao iniciar o compartilhamento de tela","stopScreenShareGeneric":"Falha ao interromper o compartilhamento de tela","callNetworkQualityLow":"A qualidade da rede  baixa.","callNoSpeakerFound":"Nenhum alto-falante ou fone de ouvido encontrado. Conecte um dispositivo de udio para ouvir a chamada.","callNoMicrophoneFound":"Nenhum microfone encontrado. Conecte um dispositivo de entrada de udio.","callMicrophoneAccessDenied":"No  possvel acessar o microfone. Clique no bloqueio na barra de endereos para conceder permisso a esta pgina da Web.","callMicrophoneMutedBySystem":"Voc est com as notificaes desativada pelo sistema.","callMacOsMicrophoneAccessDenied":"No  possvel acessar o microfone. Conceda permisso ao microfone nas configuraes de privacidade do macOS.","callLocalVideoFreeze":"A largura de banda da rede  ruim. Seu vdeo pode aparecer em pausa para outras pessoas na chamada.","callCameraAccessDenied":"No  possvel acessar a cmera. Clique no bloqueio na barra de endereos para conceder permisso a esta pgina da Web.","callCameraAlreadyInUse":"No  possvel acessar a cmera. Talvez ele j esteja em uso por outro aplicativo.","callMacOsCameraAccessDenied":"O MacOS est bloqueando o acesso  sua cmera. Atualize suas configuraes de privacidade para permitir que este navegador acesse sua cmera.","callMacOsScreenShareAccessDenied":"O MacOS est bloqueando o compartilhamento de tela. Atualize suas configuraes de privacidade para permitir que este navegador grave sua tela."},"videoGallery":{"screenIsBeingSharedMessage":"Voc est compartilhando suatela","screenShareLoadingMessage":"Carregando a tela do {participant}","localVideoLabel":"Voc","localVideoCameraSwitcherLabel":"Cmera de ciclo"}}')},852:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"()","menuTitle":" ","removeButtonLabel":"","sharingIconLabel":" ","mutedIconLabel":" "},"typingIndicator":{"singleUser":"{user}  ...","multipleUsers":"{users}  ...","multipleUsersAbbreviateOne":"{users}   1  ...","multipleUsersAbbreviateMany":"{users}   {numOthers}  ...","delimiter":"; "},"sendBox":{"placeholderText":" ","textTooLong":"    .","sendButtonAriaLabel":" "},"messageStatusIndicator":{"deliveredAriaLabel":" ","deliveredTooltipText":"","seenAriaLabel":"   ","seenTooltipText":"","readByTooltipText":": {messageThreadReadCount}  {remoteParticipantsCount}","sendingAriaLabel":" ","sendingTooltipText":"","failedToSendAriaLabel":"   ","failedToSendTooltipText":"  "},"endCallButton":{"label":"","tooltipContent":" "},"cameraButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":" ","tooltipOnContent":" ","tooltipOffContent":" ","tooltipVideoLoadingContent":" ","cameraMenuTitle":"","cameraMenuTooltip":" "},"microphoneButton":{"onLabel":" ","offLabel":" ","tooltipDisabledContent":" ","tooltipOnContent":" ","tooltipOffContent":" ","microphoneMenuTitle":"","microphoneMenuTooltip":" ","speakerMenuTitle":"","speakerMenuTooltip":" "},"devicesButton":{"label":"","tooltipContent":" ","cameraMenuTitle":"","cameraMenuTooltip":" ","microphoneMenuTitle":"","microphoneMenuTooltip":" ","speakerMenuTitle":"","speakerMenuTooltip":" "},"participantsButton":{"label":"","tooltipContent":" ","menuHeader":"  ","participantsListButtonLabel":": {numParticipants}","muteAllButtonLabel":"  ","copyInviteLinkButtonLabel":"   "},"screenShareButton":{"onLabel":" ","offLabel":"","tooltipDisabledContent":" ","tooltipOnContent":" ","tooltipOffContent":" "},"messageThread":{"yesterday":"","sunday":"","monday":"","tuesday":"","wednesday":"","thursday":"","friday":"","saturday":"","participantJoined":"  .","participantLeft":" .","editMessage":"","removeMessage":"","editedTag":"","liveAuthorIntro":"{author} ","editBoxTextLimit":"     {limitNumber} ","editBoxPlaceholderText":" ","newMessagesIndicator":" ","noDisplayNameSub":" ","editBoxCancelButton":"","editBoxSubmitButton":"","messageReadCount":": {messageReadByCount}  {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"   ","accessDenied":"      .     ","userNotInChatThread":"       ","sendMessageNotInChatThread":"   ,          ","sendMessageGeneric":"   ","callingNetworkFailure":"    ,    ","startVideoGeneric":"   ","stopVideoGeneric":"   ","muteGeneric":"   ","unmuteGeneric":"   ","speakingWhileMuted":" ","startScreenShareGeneric":"    ","stopScreenShareGeneric":"    ","callNetworkQualityLow":"  : .","callNoSpeakerFound":"    .   ,   .","callNoMicrophoneFound":"  .    .","callMicrophoneAccessDenied":"     .     ,      -.","callMicrophoneMutedBySystem":"   .","callMacOsMicrophoneAccessDenied":"     .          macOS.","callLocalVideoFreeze":"   .          .","callCameraAccessDenied":"     .     ,      -.","callCameraAlreadyInUse":"     . ,     .","callMacOsCameraAccessDenied":"MacOS    .   ,       .","callMacOsScreenShareAccessDenied":"MacOS   .   ,       ."},"videoGallery":{"screenIsBeingSharedMessage":"   ","screenShareLoadingMessage":"   {participant}","localVideoLabel":"","localVideoCameraSwitcherLabel":"  "}}')},853:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(siz)","menuTitle":"Dier Seenekler","removeButtonLabel":"Kaldr","sharingIconLabel":"Paylam","mutedIconLabel":"Ses kapatld"},"typingIndicator":{"singleUser":"{user} yazyor...","multipleUsers":"{users} yazyor ...","multipleUsersAbbreviateOne":"{users} ve 1 kii daha yazyor...","multipleUsersAbbreviateMany":"{users} ve {numOthers} kii daha yazyor...","delimiter":", "},"sendBox":{"placeholderText":"Bir mesaj girin","textTooLong":"letinizin uzunluu st snr ayor.","sendButtonAriaLabel":"leti gnder"},"messageStatusIndicator":{"deliveredAriaLabel":"leti gnderildi","deliveredTooltipText":"Gnderilen","seenAriaLabel":"leti bakalar tarafndan grld","seenTooltipText":"Grld","readByTooltipText":"{messageThreadReadCount} / {remoteParticipantsCount} katlmc tarafndan okundu","sendingAriaLabel":"leti gnderiliyor","sendingTooltipText":"Gnderiliyor","failedToSendAriaLabel":"leti gnderilemedi","failedToSendTooltipText":"Gnderilemedi"},"endCallButton":{"label":"Ayrl","tooltipContent":"Aramadan Ayrl"},"cameraButton":{"onLabel":"Kapat","offLabel":"A","tooltipDisabledContent":"Kamera devre d","tooltipOnContent":"Kameray kapat","tooltipOffContent":"Kameray a","tooltipVideoLoadingContent":"Video ykleniyor","cameraMenuTitle":"Kamera","cameraMenuTooltip":"Kamera Se"},"microphoneButton":{"onLabel":"Sesi kapat","offLabel":"Sesi a","tooltipDisabledContent":"Mikrofon devre d","tooltipOnContent":"Mikrofonun sesini kapat","tooltipOffContent":"Mikrofonun sesini a","microphoneMenuTitle":"Mikrofon","microphoneMenuTooltip":"Mikrofon Se","speakerMenuTitle":"Hoparlr","speakerMenuTooltip":"Hoparlr Se"},"devicesButton":{"label":"Cihazlar","tooltipContent":"Cihazlar ynet","cameraMenuTitle":"Kamera","cameraMenuTooltip":"Kamera Se","microphoneMenuTitle":"Mikrofon","microphoneMenuTooltip":"Mikrofon Se","speakerMenuTitle":"Hoparlr","speakerMenuTooltip":"Hoparlr Se"},"participantsButton":{"label":"Kiiler","tooltipContent":"Katlmclar Gster","menuHeader":"Bu aramada","participantsListButtonLabel":"{numParticipants} kiiler","muteAllButtonLabel":"Tmnn sesini kapat","copyInviteLinkButtonLabel":"Davet balantsn kopyala"},"screenShareButton":{"onLabel":"Sunumu Durdur","offLabel":"Sun","tooltipDisabledContent":"Sunu devre d brakld.","tooltipOnContent":"Ekrannz sunuluyor","tooltipOffContent":"Ekrannz sunun"},"messageThread":{"yesterday":"Dn","sunday":"Pazar","monday":"Pazartesi","tuesday":"Sal","wednesday":"aramba","thursday":"Perembe","friday":"Cuma","saturday":"Cumartesi","participantJoined":"sohbete katld.","participantLeft":"sohbetten ayrld.","editMessage":"Dzenle","removeMessage":"Sil","editedTag":"Dzenlendi","liveAuthorIntro":"{author} yle diyor:","editBoxTextLimit":"letiniz en fazla {limitNumber} ayor","editBoxPlaceholderText":"letinizi dzenleyin","newMessagesIndicator":"Yeni iletiler","noDisplayNameSub":"Ad yok","editBoxCancelButton":"ptal","editBoxSubmitButton":"Gnder","messageReadCount":"{messageReadByCount} / {remoteParticipantsCount} katlmc tarafndan okundu"},"errorBar":{"unableToReachChatService":"evrimdsnz","accessDenied":"Sohbet hizmetlerine eriilemedi. Ltfen salanan kullanc kimlik bilgilerini denetleyin","userNotInChatThread":"Artk bu sohbet yazmas iinde deilsiniz","sendMessageNotInChatThread":"Artk bu sohbet yazmas iinde olmadnz iin ileti gnderilemedi","sendMessageGeneric":"leti gnderilemedi","callingNetworkFailure":"Arama balanrken sorun olutu; evrimd grnyorsunuz","startVideoGeneric":"Video balatlamad","stopVideoGeneric":"Video durdurulamad","muteGeneric":"Mikrofonun sesi kapatlamad","unmuteGeneric":"Mikrofonun sesi alamad","speakingWhileMuted":"Mikrofonunuzun sesi kapal","startScreenShareGeneric":"Ekran paylam balatlamad","stopScreenShareGeneric":"Ekran paylam durdurulamad","callNetworkQualityLow":"A kalitesi dk.","callNoSpeakerFound":"Hoparlr veya kulaklk bulunamad. Aramay dinlemek iin bir ses aygt balayn.","callNoMicrophoneFound":"Mikrofon bulunamad. Ses giri cihaz balan.","callMicrophoneAccessDenied":"Mikrofona eriemiyor. Bu web sayfas iin izin vermek iin adres ubuundaki kilidi tklatn.","callMicrophoneMutedBySystem":"Sisteminiz tarafndan sessize alndnz.","callMacOsMicrophoneAccessDenied":"Mikrofona eriilemiyor. macOS gizlilik ayarlarnzda mikrofon izni verin.","callLocalVideoFreeze":"A bant genilii dk. Grntl aramada bakalar iin duraklatlm grnyor olabilir.","callCameraAccessDenied":"Kameraya eriemiyor. Bu web sayfas iin izin vermek iin adres ubuundaki kilidi tklatn.","callCameraAlreadyInUse":"Kameraya eriemiyor. Baka bir uygulama tarafndan zaten kullanlyor olabilir.","callMacOsCameraAccessDenied":"MacOS kameranza eriimi engelliyor. Bu taraycnn kameranza erimesine izin vermek iin gizlilik ayarlarnz gncelletirin.","callMacOsScreenShareAccessDenied":"MacOS ekran paylamn engelliyor. Bu taraycnn ekrannz kaydetmesini izin vermek iin gizlilik ayarlarnz gncelletirin."},"videoGallery":{"screenIsBeingSharedMessage":"Ekrannz paylayorsunuz.","screenShareLoadingMessage":"{participant} adl katlmcnn ekrann ykleme","localVideoLabel":"Siz","localVideoCameraSwitcherLabel":"Kameray deitir"}}')},854:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"()","menuTitle":"","removeButtonLabel":"","sharingIconLabel":"","mutedIconLabel":""},"typingIndicator":{"singleUser":"{user} ...","multipleUsers":"{users} ...","multipleUsersAbbreviateOne":"{users}  1 ...","multipleUsersAbbreviateMany":"{users}  {numOthers} ...","delimiter":" "},"sendBox":{"placeholderText":"","textTooLong":"","sendButtonAriaLabel":""},"messageStatusIndicator":{"deliveredAriaLabel":"","deliveredTooltipText":"","seenAriaLabel":"","seenTooltipText":"","readByTooltipText":" {participantCountNotIncludingSelf}  {messageThreadReadCount} ","sendingAriaLabel":"","sendingTooltipText":"","failedToSendAriaLabel":"","failedToSendTooltipText":""},"endCallButton":{"label":"","tooltipContent":""},"cameraButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":"","tooltipOnContent":"","tooltipOffContent":"","tooltipVideoLoadingContent":"","cameraMenuTitle":"","cameraMenuTooltip":""},"microphoneButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":"","tooltipOnContent":"","tooltipOffContent":"","microphoneMenuTitle":"","microphoneMenuTooltip":"","speakerMenuTitle":"","speakerMenuTooltip":""},"devicesButton":{"label":"","tooltipContent":"","cameraMenuTitle":"","cameraMenuTooltip":"","microphoneMenuTitle":"","microphoneMenuTooltip":"","speakerMenuTitle":"","speakerMenuTooltip":""},"participantsButton":{"label":"","tooltipContent":"","menuHeader":"","participantsListButtonLabel":"{numParticipants} ","muteAllButtonLabel":"","copyInviteLinkButtonLabel":""},"screenShareButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":"","tooltipOnContent":"","tooltipOffContent":""},"messageThread":{"yesterday":"","sunday":"","monday":"","tuesday":"","wednesday":"","thursday":"","friday":"","saturday":"","participantJoined":"","participantLeft":"","editMessage":"","removeMessage":"","editedTag":"","liveAuthorIntro":"{author} ","editBoxTextLimit":"{limitNumber}","editBoxPlaceholderText":"","newMessagesIndicator":"","noDisplayNameSub":"","editBoxCancelButton":"","editBoxSubmitButton":"","messageReadCount":"Read by {messageReadByCount} of {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"","accessDenied":" - ","userNotInChatThread":"","sendMessageNotInChatThread":"","sendMessageGeneric":"","callingNetworkFailure":" - ","startVideoGeneric":"","stopVideoGeneric":"","muteGeneric":"","unmuteGeneric":"","speakingWhileMuted":"","startScreenShareGeneric":"","stopScreenShareGeneric":"","callNetworkQualityLow":"","callNoSpeakerFound":"","callNoMicrophoneFound":"","callMicrophoneAccessDenied":"","callMicrophoneMutedBySystem":"","callMacOsMicrophoneAccessDenied":" macOS ","callLocalVideoFreeze":"","callCameraAccessDenied":"","callCameraAlreadyInUse":"","callMacOsCameraAccessDenied":"MacOS ","callMacOsScreenShareAccessDenied":"MacOS "},"videoGallery":{"screenIsBeingSharedMessage":"","screenShareLoadingMessage":" {participant} ","localVideoLabel":"","localVideoCameraSwitcherLabel":""}}')},855:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"()","menuTitle":"","removeButtonLabel":"","sharingIconLabel":"","mutedIconLabel":""},"typingIndicator":{"singleUser":"{user} ...","multipleUsers":"{users} ...","multipleUsersAbbreviateOne":"{users}  1 ...","multipleUsersAbbreviateMany":"{users}  {numOthers} ...","delimiter":" "},"sendBox":{"placeholderText":"","textTooLong":"","sendButtonAriaLabel":""},"messageStatusIndicator":{"deliveredAriaLabel":"","deliveredTooltipText":"","seenAriaLabel":"","seenTooltipText":"","readByTooltipText":" {messageThreadReadCount} / {remoteParticipantsCount}","sendingAriaLabel":"","sendingTooltipText":"","failedToSendAriaLabel":"","failedToSendTooltipText":""},"endCallButton":{"label":"","tooltipContent":""},"cameraButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":"","tooltipOnContent":"","tooltipOffContent":"","tooltipVideoLoadingContent":"","cameraMenuTitle":"","cameraMenuTooltip":""},"microphoneButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":"","tooltipOnContent":"","tooltipOffContent":"","microphoneMenuTitle":"","microphoneMenuTooltip":"","speakerMenuTitle":"","speakerMenuTooltip":""},"devicesButton":{"label":"","tooltipContent":"","cameraMenuTitle":"","cameraMenuTooltip":"","microphoneMenuTitle":"","microphoneMenuTooltip":"","speakerMenuTitle":"","speakerMenuTooltip":""},"participantsButton":{"label":"","tooltipContent":"","menuHeader":"","participantsListButtonLabel":"{numParticipants} ","muteAllButtonLabel":"","copyInviteLinkButtonLabel":""},"screenShareButton":{"onLabel":"","offLabel":"","tooltipDisabledContent":"","tooltipOnContent":"","tooltipOffContent":""},"messageThread":{"yesterday":"","sunday":"","monday":"","tuesday":"","wednesday":"","thursday":"","friday":"","saturday":"","participantJoined":"","participantLeft":"","editMessage":"","removeMessage":"","editedTag":"","liveAuthorIntro":"{author} ","editBoxTextLimit":" {limitNumber} ","editBoxPlaceholderText":"","newMessagesIndicator":"","noDisplayNameSub":"","editBoxCancelButton":"","editBoxSubmitButton":"","messageReadCount":" {messageReadByCount} / {remoteParticipantsCount}"},"errorBar":{"unableToReachChatService":"","accessDenied":" - ","userNotInChatThread":"","sendMessageNotInChatThread":"","sendMessageGeneric":"","callingNetworkFailure":" - ","startVideoGeneric":"","stopVideoGeneric":"","muteGeneric":"","unmuteGeneric":"","speakingWhileMuted":"","startScreenShareGeneric":"","stopScreenShareGeneric":"","callNetworkQualityLow":"","callNoSpeakerFound":"","callNoMicrophoneFound":"","callMicrophoneAccessDenied":"","callMicrophoneMutedBySystem":"","callMacOsMicrophoneAccessDenied":" MacOS ","callLocalVideoFreeze":"","callCameraAccessDenied":"","callCameraAlreadyInUse":"","callMacOsCameraAccessDenied":"MacOS ","callMacOsScreenShareAccessDenied":"MacOS "},"videoGallery":{"screenIsBeingSharedMessage":"","screenShareLoadingMessage":" {participant} ","localVideoLabel":"","localVideoCameraSwitcherLabel":""}}')},863:function(module,exports){module.exports="1.1.1-beta.1"},868:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"Camera","cameraPermissionDenied":"Your browser is blocking access to your camera","cameraTurnedOff":"Your camera is turned off","close":"Close","complianceBannerNowOnlyRecording":"You are now only recording this meeting.","complianceBannerNowOnlyTranscription":"You are now only transcribing this meeting.","complianceBannerRecordingAndTranscriptionSaved":"Recording and transcription are being saved.","complianceBannerRecordingAndTranscriptionStarted":"Recording and transcription have started.","complianceBannerRecordingAndTranscriptionStopped":"Recording and transcription have stopped.","complianceBannerRecordingSaving":"Recording is being saved.","complianceBannerRecordingStarted":"Recording has started.","complianceBannerRecordingStopped":"Recording has stopped.","complianceBannerTranscriptionStarted":"Transcription has started.","complianceBannerTranscriptionConsent":"By joining, you are giving consent for this meeting to be transcribed.","complianceBannerTranscriptionSaving":"Transcription is being saved.","complianceBannerTranscriptionStopped":"Transcription has stopped.","configurationPageTitle":"Start a call","defaultPlaceHolder":"Select an option","failedToJoinCallDueToNoNetworkMoreDetails":"Call was disconnected due to a network issue. Check your connection and join again.","failedToJoinCallDueToNoNetworkTitle":"Call disconnected","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"You were not granted entry in the call. If this was a mistake, re-join the call.","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"Dismissed from lobby","learnMore":"Learn more","leftCallMoreDetails":"If this was a mistake, re-join the call.","leftCallTitle":"You left the call","lobbyScreenConnectingToCallTitle":"Joining call","lobbyScreenWaitingToBeAdmittedTitle":"Waiting to be admitted","microphonePermissionDenied":"Your browser is blocking access to your microphone","mutedMessage":"You\'re muted","networkReconnectMoreDetails":"Looks like something went wrong. We\'re trying to get back into the call.","networkReconnectTitle":"Hold on","privacyPolicy":"Privacy policy","rejoinCallButtonLabel":"Re-join call","removedFromCallMoreDetails":"Another participant removed you from the call.","removedFromCallTitle":"You were removed","soundLabel":"Sound","startCallButtonLabel":"Start call","microphoneToggleInLobbyNotAllowed":"Cannot mute or unmute while in lobby."},"chat":{"chatListHeader":"In this chat"},"callWithChat":{"peopleButtonLabel":"People","chatButtonLabel":"Chat","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"People","peoplePaneSubTitle":"In this call","chatPaneTitle":"Chat","chatButtonNewMessageNotificationLabel":"New Message","pictureInPictureTileAriaLabel":"Video Feeds. Click to return to call screen."}}')},869:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"Kamera","cameraPermissionDenied":"Ihr Browser blockiert den Zugriff auf Ihre Kamera.","cameraTurnedOff":"Ihre Kamera ist deaktiviert.","close":"Schlieen","complianceBannerNowOnlyRecording":"Sie zeichnen nun nur diese Besprechung auf.","complianceBannerNowOnlyTranscription":"Sie transkribieren diese Besprechung jetzt nur noch.","complianceBannerRecordingAndTranscriptionSaved":"Aufzeichnung und Transkription werden gespeichert.","complianceBannerRecordingAndTranscriptionStarted":"Die Aufzeichnung und Transkription haben begonnen.","complianceBannerRecordingAndTranscriptionStopped":"Die Aufzeichnung und Transkription wurden beendet.","complianceBannerRecordingSaving":"Aufzeichnung wird gespeichert.","complianceBannerRecordingStarted":"Die Aufzeichnung wurde gestartet.","complianceBannerRecordingStopped":"Aufzeichnung wurde beendet.","complianceBannerTranscriptionStarted":"Die Transkription hat begonnen.","complianceBannerTranscriptionConsent":"Durch Ihre Teilnahme stimmen Sie zu, dass diese Besprechung transkribiert wird.","complianceBannerTranscriptionSaving":"Die Transkription wird gespeichert.","complianceBannerTranscriptionStopped":"Die Transkription wurde beendet.","configurationPageTitle":"Einen Anruf beginnen","defaultPlaceHolder":"Option auswhlen","failedToJoinCallDueToNoNetworkMoreDetails":"Der Anruf wurde aufgrund eines Netzwerkproblems getrennt. berprfen Sie Ihre Verbindung, und treten Sie erneut bei.","failedToJoinCallDueToNoNetworkTitle":"Anruf unterbrochen","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"Ihnen wurde keine Teilnahme am Anruf gewhrt. Wenn dies ein Fehler war, treten Sie dem Anruf erneut bei.","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"Aus Wartebereich entlassen","learnMore":"Weitere Informationen","leftCallMoreDetails":"Wenn dies ein Fehler war, nehmen Sie erneut am Anruf teil.","leftCallTitle":"Sie haben den Anruf verlassen","lobbyScreenConnectingToCallTitle":"Teilnehmen am Anruf","lobbyScreenWaitingToBeAdmittedTitle":"Warten auf die Zulassung","microphonePermissionDenied":"Ihr Browser blockiert den Zugriff auf Ihr Mikrofon.","mutedMessage":"Sie sind stummgeschaltet.","networkReconnectMoreDetails":"Offensichtlich ist etwas schief gegangen. Wir versuchen, Sie wieder mit dem Anruf zu verbinden.","networkReconnectTitle":"Einen Augenblick bitte","privacyPolicy":"Datenschutzrichtlinie","rejoinCallButtonLabel":"Am Anruf erneut teilnehmen","removedFromCallMoreDetails":"Ein anderer Teilnehmer hat Sie aus dem Anruf entfernt.","removedFromCallTitle":"Sie wurden entfernt","soundLabel":"Sound","startCallButtonLabel":"Anruf beginnen","microphoneToggleInLobbyNotAllowed":"Stummschalten oder Aufheben der Stummschaltung im Wartebereich nicht zulssig."},"chat":{"chatListHeader":"In diesem Chat"},"callWithChat":{"peopleButtonLabel":"Personen","chatButtonLabel":"Chat","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"Personen","peoplePaneSubTitle":"In diesem Anruf","chatPaneTitle":"Chat","chatButtonNewMessageNotificationLabel":"Neue Nachricht","pictureInPictureTileAriaLabel":"Videofeeds. Klicken Sie hier, um zum Anrufbildschirm zurckzukehren."}}')},87:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useSelector}));var _useAdaptedSelector__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(312),useSelector=function useSelector(selector,selectorProps){return Object(_useAdaptedSelector__WEBPACK_IMPORTED_MODULE_0__.b)(selector,(function(state){return state}),selectorProps)}},870:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"Cmara","cameraPermissionDenied":"El explorador est bloqueando el acceso a la cmara","cameraTurnedOff":"La cmara est apagada","close":"Cerrar","complianceBannerNowOnlyRecording":"Solo est grabando esta reunin.","complianceBannerNowOnlyTranscription":"Solo est transcribiendo esta reunin.","complianceBannerRecordingAndTranscriptionSaved":"Se estn guardando la grabacin y la transcripcin.","complianceBannerRecordingAndTranscriptionStarted":"Se han iniciado la grabacin y la transcripcin.","complianceBannerRecordingAndTranscriptionStopped":"Se han detenido la grabacin y la transcripcin.","complianceBannerRecordingSaving":"La grabacin se est guardando.","complianceBannerRecordingStarted":"Se ha iniciado la grabacin.","complianceBannerRecordingStopped":"La grabacin se ha detenido.","complianceBannerTranscriptionStarted":"La transcripcin se ha iniciado.","complianceBannerTranscriptionConsent":"Al unirse, da su consentimiento para que se transcriba esta reunin.","complianceBannerTranscriptionSaving":"Se est guardando la transcripcin.","complianceBannerTranscriptionStopped":"La transcripcin se ha detenido.","configurationPageTitle":"Iniciar una llamada","defaultPlaceHolder":"Seleccionar una opcin","failedToJoinCallDueToNoNetworkMoreDetails":"Se desconect la llamada debido a un problema de red. Compruebe la conexin y nase de nuevo.","failedToJoinCallDueToNoNetworkTitle":"Llamada desconectada","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"No se te concedi la entrada a la llamada. Si se trata de un error, vuelve a unirte.","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"Rechazado de la sala de espera","learnMore":"Ms informacin","leftCallMoreDetails":"Si se trata de un error, vuelve a unirte a la llamada.","leftCallTitle":"Has abandonado la llamada","lobbyScreenConnectingToCallTitle":"Unindose a la llamada","lobbyScreenWaitingToBeAdmittedTitle":"Esperando a ser admitido","microphonePermissionDenied":"El explorador est bloqueando el acceso al micrfono","mutedMessage":"Ests silenciado","networkReconnectMoreDetails":"Parece que hubo un problema. Estamos intentando reconectar la llamada.","networkReconnectTitle":"Espere","privacyPolicy":"Directiva de privacidad","rejoinCallButtonLabel":"Volver a unirse a la llamada","removedFromCallMoreDetails":"Otro participante te ha eliminado de la llamada.","removedFromCallTitle":"Fuiste eliminado","soundLabel":"Sonido","startCallButtonLabel":"Iniciar llamada","microphoneToggleInLobbyNotAllowed":"No se puede silenciar ni reactivar el audio mientras se est en la sala de espera."},"chat":{"chatListHeader":"En este chat"},"callWithChat":{"peopleButtonLabel":"Contactos","chatButtonLabel":"Chat","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"Contactos","peoplePaneSubTitle":"En esta llamada","chatPaneTitle":"Chat","chatButtonNewMessageNotificationLabel":"Nuevo mensaje","pictureInPictureTileAriaLabel":"Fuentes de vdeo. Hacer clic para volver a la pantalla de la llamada."}}')},871:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"Appareil photo","cameraPermissionDenied":"Votre navigateur bloque laccs  votre camra","cameraTurnedOff":"Votre camra est dsactive","close":"Fermer","complianceBannerNowOnlyRecording":"Vous nenregistrez dsormais que cette runion.","complianceBannerNowOnlyTranscription":" prsent, vous ne transcrivez que cette runion.","complianceBannerRecordingAndTranscriptionSaved":"Sauvegarde en cours de lenregistrement et de la transcription.","complianceBannerRecordingAndTranscriptionStarted":"Dmarrage de lenregistrement et de la transcription.","complianceBannerRecordingAndTranscriptionStopped":"Lenregistrement et la transcription ont pris fin.","complianceBannerRecordingSaving":"Sauvegarde en cours de l\'enregistrement.","complianceBannerRecordingStarted":"Lenregistrement a dmarr.","complianceBannerRecordingStopped":"Lenregistrement a pris fin.","complianceBannerTranscriptionStarted":"Dmarrage de la transcription.","complianceBannerTranscriptionConsent":"En participant, vous autorisez la transcription de cette runion.","complianceBannerTranscriptionSaving":"Sauvegarde en cours de la transcription.","complianceBannerTranscriptionStopped":"La transcription a pris fin.","configurationPageTitle":"Lancer un appel","defaultPlaceHolder":"Slectionnez une option","failedToJoinCallDueToNoNetworkMoreDetails":"Lappel a t dconnect en raison dun problme rseau. Vrifiez votre connexion et rejoignez-la  nouveau.","failedToJoinCallDueToNoNetworkTitle":"Appel dconnect","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"Vous navez pas reu dentre dans lappel. Sil sagissait dune erreur, rejoignez  nouveau lappel.","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"Rejet de la salle dattente","learnMore":"En savoir plus","leftCallMoreDetails":"Sil sagissait dune erreur, rejoignez  nouveau lappel.","leftCallTitle":"Vous avez quitt lappel.","lobbyScreenConnectingToCallTitle":"Connexion  l\'appel","lobbyScreenWaitingToBeAdmittedTitle":"En attente dadmission","microphonePermissionDenied":"Votre navigateur bloque laccs  votre micro","mutedMessage":"Le son de votre micro est dsactiv.","networkReconnectMoreDetails":"On dirait qu\'une erreur est survenue. Nous tentons de vous reconnecter  lappel.","networkReconnectTitle":"Patience","privacyPolicy":"Politique de confidentialit","rejoinCallButtonLabel":"Rejoindre lappel  nouveau.","removedFromCallMoreDetails":"Un autre participant vous a supprim de lappel.","removedFromCallTitle":"Vous avez t supprim.","soundLabel":"Son","startCallButtonLabel":"Lancer l\'appel","microphoneToggleInLobbyNotAllowed":"Impossible de dsactiver ou dactiver le son dans la salle dattente."},"chat":{"chatListHeader":"Dans cette conversation"},"callWithChat":{"peopleButtonLabel":"Personnes","chatButtonLabel":"Clavardage","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"Personnes","peoplePaneSubTitle":"Pendant cet appel","chatPaneTitle":"Clavardage","chatButtonNewMessageNotificationLabel":"Nouveau message","pictureInPictureTileAriaLabel":"Flux vido. Cliquez pour revenir  lcran dappel."}}')},872:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"Fotocamera","cameraPermissionDenied":"Il browser blocca l\'accesso alla fotocamera","cameraTurnedOff":"La videocamera  disabilitata","close":"Chiudi","complianceBannerNowOnlyRecording":" in corso la registrazione solo di questa riunione.","complianceBannerNowOnlyTranscription":" in corso la trascrizione solo di questa riunione.","complianceBannerRecordingAndTranscriptionSaved":" in corso il salvataggio della registrazione e della trascrizione.","complianceBannerRecordingAndTranscriptionStarted":"Registrazione e trascrizione avviate.","complianceBannerRecordingAndTranscriptionStopped":"Registrazione e trascrizione interrotte.","complianceBannerRecordingSaving":"Salvataggio della registrazione in corso.","complianceBannerRecordingStarted":"Registrazione avviata.","complianceBannerRecordingStopped":"Registrazione arrestata.","complianceBannerTranscriptionStarted":"Trascrizione avviata.","complianceBannerTranscriptionConsent":"Partecipando, fornisci il consenso per la trascrizione di questa riunione.","complianceBannerTranscriptionSaving":" in corso il salvataggio della trascrizione.","complianceBannerTranscriptionStopped":"Trascrizione interrotta.","configurationPageTitle":"Avvia una chiamata","defaultPlaceHolder":"Seleziona un\'opzione","failedToJoinCallDueToNoNetworkMoreDetails":"La chiamata  stata disconnessa a causa di un problema di rete. Controlla la connessione e partecipa di nuovo.","failedToJoinCallDueToNoNetworkTitle":"Chiamata interrotta","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"Non ti  stato concesso laccesso alla chiamata. Se si  trattato di un errore, partecipa di nuovo alla chiamata.","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"Ignorato dalla sala di attesa","learnMore":"Ulteriori informazioni","leftCallMoreDetails":"Se si  trattato di un errore, partecipa di nuovo alla chiamata.","leftCallTitle":"Hai abbandonato la chiamata","lobbyScreenConnectingToCallTitle":"Partecipazione alla chiamata","lobbyScreenWaitingToBeAdmittedTitle":"In attesa di essere ammessi","microphonePermissionDenied":"Il browser blocca l\'accesso al microfono","mutedMessage":"L\'audio  disattivato.","networkReconnectMoreDetails":"Sembra si sia verificato un errore. Stiamo cercando di ristabilire la connessione alla chiamata.","networkReconnectTitle":"Attendi","privacyPolicy":"Informativa sulla privacy","rejoinCallButtonLabel":"Partecipa alla chiamata","removedFromCallMoreDetails":"Un altro partecipante ti ha rimosso dalla chiamata.","removedFromCallTitle":"Sei stato rimosso","soundLabel":"Suono","startCallButtonLabel":"Avvia chiamata","microphoneToggleInLobbyNotAllowed":"Impossibile attivare o disattivare l\'audio nella sala di attesa."},"chat":{"chatListHeader":"In questa chat"},"callWithChat":{"peopleButtonLabel":"Persone","chatButtonLabel":"Chat","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"Persone","peoplePaneSubTitle":"In questa chiamata","chatPaneTitle":"Chat","chatButtonNewMessageNotificationLabel":"Nuovo messaggio","pictureInPictureTileAriaLabel":"Feed video. Fare clic per tornare alla schermata della chiamata."}}')},873:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"","cameraPermissionDenied":"","cameraTurnedOff":"","close":"","complianceBannerNowOnlyRecording":"","complianceBannerNowOnlyTranscription":"","complianceBannerRecordingAndTranscriptionSaved":"","complianceBannerRecordingAndTranscriptionStarted":"","complianceBannerRecordingAndTranscriptionStopped":"","complianceBannerRecordingSaving":"","complianceBannerRecordingStarted":"","complianceBannerRecordingStopped":"","complianceBannerTranscriptionStarted":"","complianceBannerTranscriptionConsent":"","complianceBannerTranscriptionSaving":"","complianceBannerTranscriptionStopped":"","configurationPageTitle":"","defaultPlaceHolder":"","failedToJoinCallDueToNoNetworkMoreDetails":"","failedToJoinCallDueToNoNetworkTitle":"","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"","learnMore":"","leftCallMoreDetails":"","leftCallTitle":"","lobbyScreenConnectingToCallTitle":"","lobbyScreenWaitingToBeAdmittedTitle":"","microphonePermissionDenied":"","mutedMessage":"","networkReconnectMoreDetails":"","networkReconnectTitle":"","privacyPolicy":" ","rejoinCallButtonLabel":"","removedFromCallMoreDetails":"","removedFromCallTitle":"","soundLabel":"","startCallButtonLabel":"","microphoneToggleInLobbyNotAllowed":""},"chat":{"chatListHeader":""},"callWithChat":{"peopleButtonLabel":"","chatButtonLabel":"","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"","peoplePaneSubTitle":"","chatPaneTitle":"","chatButtonNewMessageNotificationLabel":"","pictureInPictureTileAriaLabel":"  "}}')},874:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"","cameraPermissionDenied":"     .","cameraTurnedOff":"  ","close":"","complianceBannerNowOnlyRecording":"   / .","complianceBannerNowOnlyTranscription":"    .","complianceBannerRecordingAndTranscriptionSaved":"/   .","complianceBannerRecordingAndTranscriptionStarted":"/  .","complianceBannerRecordingAndTranscriptionStopped":"/  .","complianceBannerRecordingSaving":"/  .","complianceBannerRecordingStarted":"/ .","complianceBannerRecordingStopped":"/ .","complianceBannerTranscriptionStarted":" .","complianceBannerTranscriptionConsent":"      .","complianceBannerTranscriptionSaving":"  .","complianceBannerTranscriptionStopped":" .","configurationPageTitle":" ","defaultPlaceHolder":" ","failedToJoinCallDueToNoNetworkMoreDetails":"     .    .","failedToJoinCallDueToNoNetworkTitle":"  ","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"     .    .","failedToJoinTeamsMeetingReasonAccessDeniedTitle":" .","learnMore":" ","leftCallMoreDetails":"   .","leftCallTitle":" .","lobbyScreenConnectingToCallTitle":" ","lobbyScreenWaitingToBeAdmittedTitle":"  ","microphonePermissionDenied":"     .","mutedMessage":" .","networkReconnectMoreDetails":"   .    .","networkReconnectTitle":"","privacyPolicy":"   ","rejoinCallButtonLabel":"  ","removedFromCallMoreDetails":"    .","removedFromCallTitle":" .","soundLabel":"","startCallButtonLabel":" ","microphoneToggleInLobbyNotAllowed":"       ."},"chat":{"chatListHeader":" "},"callWithChat":{"peopleButtonLabel":"","chatButtonLabel":"","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"","peoplePaneSubTitle":" ","chatPaneTitle":"","chatButtonNewMessageNotificationLabel":" ","pictureInPictureTileAriaLabel":" .    ."}}')},875:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"Camera","cameraPermissionDenied":"Uw browser blokkeert de toegang tot uw camera","cameraTurnedOff":"Camera is uitgeschakeld","close":"Sluiten","complianceBannerNowOnlyRecording":"U bent nu alleen deze vergadering aan het opnemen.","complianceBannerNowOnlyTranscription":"U bent nu alleen deze vergadering aan het transcriberen.","complianceBannerRecordingAndTranscriptionSaved":"Opname en transcriptie worden opgeslagen.","complianceBannerRecordingAndTranscriptionStarted":"Opname en transcriptie zijn gestart.","complianceBannerRecordingAndTranscriptionStopped":"Opname en transcriptie zijn gestopt.","complianceBannerRecordingSaving":"De opname wordt opgeslagen.","complianceBannerRecordingStarted":"De opname is gestart.","complianceBannerRecordingStopped":"De opname is gestopt.","complianceBannerTranscriptionStarted":"Transcriptie is gestart.","complianceBannerTranscriptionConsent":"Door deel te nemen, geeft u toestemming voor het transcriberen van deze vergadering.","complianceBannerTranscriptionSaving":"Transcriptie wordt opgeslagen.","complianceBannerTranscriptionStopped":"Transcriptie is gestopt.","configurationPageTitle":"Een oproep starten","defaultPlaceHolder":"Een optie selecteren","failedToJoinCallDueToNoNetworkMoreDetails":"De verbinding is verbroken vanwege een netwerkprobleem. Controleer de verbinding en neem opnieuw deel.","failedToJoinCallDueToNoNetworkTitle":"Verbinding verbroken","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"U hebt geen toegang gekregen in het gesprek. Als dit een fout is, neemt u opnieuw deel aan het gesprek.","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"Verwijderd uit lobby","learnMore":"Meer informatie","leftCallMoreDetails":"Als dit een vergissing was, neemt u opnieuw deel aan het gesprek.","leftCallTitle":"U hebt het gesprek verlaten","lobbyScreenConnectingToCallTitle":"Deelnemen aan oproep","lobbyScreenWaitingToBeAdmittedTitle":"Wachten om te worden toegelaten","microphonePermissionDenied":"Uw browser blokkeert de toegang tot uw microfoon","mutedMessage":"Uw geluid is gedempt","networkReconnectMoreDetails":"Er is iets misgegaan. We proberen terug te gaan naar het gesprek.","networkReconnectTitle":"Wacht even","privacyPolicy":"Privacybeleid","rejoinCallButtonLabel":"Opnieuw deelnemen aan gesprek","removedFromCallMoreDetails":"Een andere deelnemer heeft u uit het gesprek verwijderd.","removedFromCallTitle":"U bent verwijderd","soundLabel":"Geluid","startCallButtonLabel":"Gesprek starten","microphoneToggleInLobbyNotAllowed":"Kan niet dempen of dempen opheffen in de lobby."},"chat":{"chatListHeader":"In deze chat"},"callWithChat":{"peopleButtonLabel":"Personen","chatButtonLabel":"Chatten","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"Personen","peoplePaneSubTitle":"In dit gesprek","chatPaneTitle":"Chatten","chatButtonNewMessageNotificationLabel":"Nieuw bericht","pictureInPictureTileAriaLabel":"Videofeeds. Klik om terug te keren naar het oproepscherm."}}')},876:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"Cmera","cameraPermissionDenied":"Seu navegador est bloqueando o acesso  cmera","cameraTurnedOff":"Sua cmera est desativada","close":"Fechar","complianceBannerNowOnlyRecording":"Voc agora est apenas gravando esta reunio.","complianceBannerNowOnlyTranscription":"Voc agora est apenas transcrevendo esta reunio.","complianceBannerRecordingAndTranscriptionSaved":"A gravao e a transcrio esto sendo salvas.","complianceBannerRecordingAndTranscriptionStarted":"A gravao e a transcrio foram iniciadas.","complianceBannerRecordingAndTranscriptionStopped":"A gravao e a transcrio foram interrompidas.","complianceBannerRecordingSaving":"A gravao est sendo salva.","complianceBannerRecordingStarted":"A gravao foi iniciada.","complianceBannerRecordingStopped":"A gravao foi interrompida.","complianceBannerTranscriptionStarted":"A transcrio foi iniciada.","complianceBannerTranscriptionConsent":"Ao ingressar, voc est dando consentimento para que esta reunio seja transcrita.","complianceBannerTranscriptionSaving":"A transcrio est sendo salva.","complianceBannerTranscriptionStopped":"A transcrio foi interrompida.","configurationPageTitle":"Iniciar uma chamada","defaultPlaceHolder":"Selecionar uma opo","failedToJoinCallDueToNoNetworkMoreDetails":"A chamada foi desconectada devido a um problema de rede. Verifique sua conexo e ingresse novamente.","failedToJoinCallDueToNoNetworkTitle":"Chamada desconectada","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"Voc no recebeu entrada na chamada. Se isso foi um erro, ingresse novamente na chamada.","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"Ignorado do lobby","learnMore":"Saber mais","leftCallMoreDetails":"Se isso foi um erro, ingresse novamente na chamada.","leftCallTitle":"Voc saiu da chamada","lobbyScreenConnectingToCallTitle":"Ingressando na chamada","lobbyScreenWaitingToBeAdmittedTitle":"Esperando para ser admitido","microphonePermissionDenied":"Seu navegador est bloqueando o acesso ao microfone","mutedMessage":"Voc est com o mudo ativado","networkReconnectMoreDetails":"Parece que algo deu errado. Estamos tentando retornar  chamada.","networkReconnectTitle":"Em espera","privacyPolicy":"Poltica de privacidade","rejoinCallButtonLabel":"Reingressar na chamada","removedFromCallMoreDetails":"Outro participante removeu voc da chamada.","removedFromCallTitle":"Voc foi removido","soundLabel":"Som","startCallButtonLabel":"Iniciar chamada","microphoneToggleInLobbyNotAllowed":"No  possvel ativar ou desativar mudo enquanto estiver no lobby."},"chat":{"chatListHeader":"Neste chat"},"callWithChat":{"peopleButtonLabel":"Pessoas","chatButtonLabel":"Chat","moreDrawerMicrophoneMenuTitle":"Microfone","moreDrawerSpeakerMenuTitle":"Alto-falante","peoplePaneTitle":"Pessoas","peoplePaneSubTitle":"Nesta chamada","chatPaneTitle":"Chat","chatButtonNewMessageNotificationLabel":"Nova mensagem","pictureInPictureTileAriaLabel":"Feeds de vdeo. Clique para retornar  tela de chamada."}}')},877:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"","cameraPermissionDenied":"     ","cameraTurnedOff":" ","close":"","complianceBannerNowOnlyRecording":"      .","complianceBannerNowOnlyTranscription":"      .","complianceBannerRecordingAndTranscriptionSaved":"   .","complianceBannerRecordingAndTranscriptionStarted":"   .","complianceBannerRecordingAndTranscriptionStopped":"   .","complianceBannerRecordingSaving":" .","complianceBannerRecordingStarted":" .","complianceBannerRecordingStopped":" .","complianceBannerTranscriptionStarted":" .","complianceBannerTranscriptionConsent":",       .","complianceBannerTranscriptionSaving":" .","complianceBannerTranscriptionStopped":" .","configurationPageTitle":"","defaultPlaceHolder":"   ","failedToJoinCallDueToNoNetworkMoreDetails":"   -   .      .","failedToJoinCallDueToNoNetworkTitle":" ","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"     .     ,    .","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"    \\" \\"","learnMore":"","leftCallMoreDetails":"    ,    .","leftCallTitle":"  ","lobbyScreenConnectingToCallTitle":"  ","lobbyScreenWaitingToBeAdmittedTitle":" ","microphonePermissionDenied":"     ","mutedMessage":"  ","networkReconnectMoreDetails":", -   .     .","networkReconnectTitle":"","privacyPolicy":" ","rejoinCallButtonLabel":"   ","removedFromCallMoreDetails":"     .","removedFromCallTitle":"  ","soundLabel":"","startCallButtonLabel":" ","microphoneToggleInLobbyNotAllowed":"    ,   \\" \\"."},"chat":{"chatListHeader":"  "},"callWithChat":{"peopleButtonLabel":"","chatButtonLabel":"","moreDrawerMicrophoneMenuTitle":"","moreDrawerSpeakerMenuTitle":"","peoplePaneTitle":"","peoplePaneSubTitle":"  ","chatPaneTitle":"","chatButtonNewMessageNotificationLabel":" ","pictureInPictureTileAriaLabel":" . ,     ."}}')},878:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"Kamera","cameraPermissionDenied":"Taraycnz kameranza eriimi engelliyor","cameraTurnedOff":"Kameranz kapatld","close":"Kapat","complianceBannerNowOnlyRecording":"u anda yalnzca bu toplanty kaydediyorsunuz.","complianceBannerNowOnlyTranscription":"u anda yalnzca bu toplantnn dkmn oluturuyorsunuz.","complianceBannerRecordingAndTranscriptionSaved":"Kayt ve dkm kaydediliyor.","complianceBannerRecordingAndTranscriptionStarted":"Kayt ve dkm balatld.","complianceBannerRecordingAndTranscriptionStopped":"Kayt ve dkm durduruldu.","complianceBannerRecordingSaving":"Kayt kaydediliyor.","complianceBannerRecordingStarted":"Kayt balad.","complianceBannerRecordingStopped":"Kayt durduruldu.","complianceBannerTranscriptionStarted":"Dkm balatld.","complianceBannerTranscriptionConsent":"Katlarak bu toplantnn dkmnn karlmasna onay verirsiniz.","complianceBannerTranscriptionSaving":"Dkm kaydediliyor.","complianceBannerTranscriptionStopped":"Dkm durduruldu.","configurationPageTitle":"Arama balatn","defaultPlaceHolder":"Bir seenek belirleyin","failedToJoinCallDueToNoNetworkMoreDetails":"Bir a sorunu nedeniyle arama balants kesildi. Balantnz kontrol edin ve yeniden katln.","failedToJoinCallDueToNoNetworkTitle":"Arama kesildi","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"Aramaya katlmanza izin verilmedi. Bu ilem yanllkla yapldysa aramaya yeniden katln.","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"Lobiden karld","learnMore":"Daha fazla bilgi edinin","leftCallMoreDetails":"Bu bir hataysa aramaya yeniden katln.","leftCallTitle":"Aramadan ayrldnz","lobbyScreenConnectingToCallTitle":"Aramaya katlyorsunuz","lobbyScreenWaitingToBeAdmittedTitle":"Kabul edilmeyi bekliyor","microphonePermissionDenied":"Taraycnz mikrofonunuza eriimi engelliyor","mutedMessage":"Sesiniz kapatld","networkReconnectMoreDetails":"Bir sorun olutu gibi grnyor. arya geri alnmaya allyor.","networkReconnectTitle":"Bekleyin","privacyPolicy":"Gizlilik ilkesi","rejoinCallButtonLabel":"arya yeniden katl","removedFromCallMoreDetails":"Baka bir katlmc sizi aramadan kard.","removedFromCallTitle":"karldnz","soundLabel":"Ses","startCallButtonLabel":"Arama balat","microphoneToggleInLobbyNotAllowed":"Lobideyken sesi kapatlamaz veya alamaz."},"chat":{"chatListHeader":"Bu sohbette"},"callWithChat":{"peopleButtonLabel":"Kiiler","chatButtonLabel":"Sohbet","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"Kiiler","peoplePaneSubTitle":"Bu aramada","chatPaneTitle":"Sohbet","chatButtonNewMessageNotificationLabel":"Yeni leti","pictureInPictureTileAriaLabel":"Video Aklar. ar ekranna dnmek iin tklayn."}}')},879:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"","cameraPermissionDenied":"","cameraTurnedOff":"","close":"","complianceBannerNowOnlyRecording":"","complianceBannerNowOnlyTranscription":"","complianceBannerRecordingAndTranscriptionSaved":"","complianceBannerRecordingAndTranscriptionStarted":"","complianceBannerRecordingAndTranscriptionStopped":"","complianceBannerRecordingSaving":"","complianceBannerRecordingStarted":"","complianceBannerRecordingStopped":"","complianceBannerTranscriptionStarted":"","complianceBannerTranscriptionConsent":"","complianceBannerTranscriptionSaving":"","complianceBannerTranscriptionStopped":"","configurationPageTitle":"","defaultPlaceHolder":"","failedToJoinCallDueToNoNetworkMoreDetails":"","failedToJoinCallDueToNoNetworkTitle":"","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"","learnMore":"","leftCallMoreDetails":"","leftCallTitle":"","lobbyScreenConnectingToCallTitle":"","lobbyScreenWaitingToBeAdmittedTitle":"","microphonePermissionDenied":"","mutedMessage":"","networkReconnectMoreDetails":"","networkReconnectTitle":"","privacyPolicy":"","rejoinCallButtonLabel":"","removedFromCallMoreDetails":"","removedFromCallTitle":"","soundLabel":"","startCallButtonLabel":"","microphoneToggleInLobbyNotAllowed":""},"chat":{"chatListHeader":""},"callWithChat":{"peopleButtonLabel":"","chatButtonLabel":"","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"","peoplePaneSubTitle":"","chatPaneTitle":"","chatButtonNewMessageNotificationLabel":"","pictureInPictureTileAriaLabel":""}}')},88:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return createDefaultCallingHandlers})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getSelector})),__webpack_require__.d(__webpack_exports__,"b",(function(){return _isInCall})),__webpack_require__.d(__webpack_exports__,"d",(function(){return _isPreviewOn})),__webpack_require__.d(__webpack_exports__,"c",(function(){return _isInLobbyOrConnecting})),__webpack_require__.d(__webpack_exports__,"a",(function(){return videoGalleryUtils_dominantSpeakersWithFlatId}));__webpack_require__(115);var es=__webpack_require__(50),src=__webpack_require__(32),getDeviceManager=function getDeviceManager(state){return state.deviceManager},getRemoteParticipants=function getRemoteParticipants(state,props){var _state$calls$props$ca2;return null===(_state$calls$props$ca2=state.calls[props.callId])||void 0===_state$calls$props$ca2?void 0:_state$calls$props$ca2.remoteParticipants},getIsScreenSharingOn=function getIsScreenSharingOn(state,props){var _state$calls$props$ca3;return null===(_state$calls$props$ca3=state.calls[props.callId])||void 0===_state$calls$props$ca3?void 0:_state$calls$props$ca3.isScreenSharingOn},getIsMuted=function getIsMuted(state,props){var _state$calls$props$ca4;return null===(_state$calls$props$ca4=state.calls[props.callId])||void 0===_state$calls$props$ca4?void 0:_state$calls$props$ca4.isMuted},getLocalVideoStreams=function getLocalVideoStreams(state,props){var _state$calls$props$ca5;return null===(_state$calls$props$ca5=state.calls[props.callId])||void 0===_state$calls$props$ca5?void 0:_state$calls$props$ca5.localVideoStreams},getDisplayName=function getDisplayName(state){var _state$callAgent;return null===(_state$callAgent=state.callAgent)||void 0===_state$callAgent?void 0:_state$callAgent.displayName},baseSelectors_getIdentifier=function getIdentifier(state){return Object(src.g)(state.userId)};__webpack_require__(130),__webpack_require__(39),__webpack_require__(12),__webpack_require__(23),__webpack_require__(15),__webpack_require__(28),__webpack_require__(16),__webpack_require__(9),__webpack_require__(19),__webpack_require__(24),__webpack_require__(17),__webpack_require__(18),__webpack_require__(40);function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var _isInCall=function _isInCall(callStatus){return!!callStatus&&!["None","Disconnected","Connecting"].includes(callStatus)},_isInLobbyOrConnecting=function _isInLobbyOrConnecting(callStatus){return!!callStatus&&["Connecting","Ringing","InLobby"].includes(callStatus)},_isPreviewOn=function _isPreviewOn(deviceManager){return deviceManager.unparentedViews.length>0&&void 0!==deviceManager.unparentedViews[0].view},disposeAllLocalPreviewViews=function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(callClient){var unparentedViews,_iterator,_step,view;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:unparentedViews=callClient.getState().deviceManager.unparentedViews,_iterator=_createForOfIteratorHelper(unparentedViews),_context.prev=2,_iterator.s();case 4:if((_step=_iterator.n()).done){_context.next=10;break}return view=_step.value,_context.next=8,callClient.disposeView(void 0,void 0,view);case 8:_context.next=4;break;case 10:_context.next=15;break;case 12:_context.prev=12,_context.t0=_context.catch(2),_iterator.e(_context.t0);case 15:return _context.prev=15,_iterator.f(),_context.finish(15);case 18:case"end":return _context.stop()}}),_callee,null,[[2,12,15,18]])})));return function disposeAllLocalPreviewViews(_x){return _ref.apply(this,arguments)}}(),microphoneButtonSelector=es.a([function getCallExists(state,props){return!!state.calls[props.callId]},getIsMuted,getDeviceManager],(function(callExists,isMuted,deviceManager){var permission=!deviceManager.deviceAccess||deviceManager.deviceAccess.audio;return{disabled:!callExists||!permission,checked:!!callExists&&!isMuted,microphones:deviceManager.microphones,speakers:deviceManager.speakers,selectedMicrophone:deviceManager.selectedMicrophone,selectedSpeaker:deviceManager.selectedSpeaker}})),cameraButtonSelector=es.a([getLocalVideoStreams,getDeviceManager],(function(localVideoStreams,deviceManager){var previewOn=_isPreviewOn(deviceManager),localVideoFromCall=null==localVideoStreams?void 0:localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})),permission=!deviceManager.deviceAccess||deviceManager.deviceAccess.video;return{disabled:!deviceManager.selectedCamera||!permission,checked:void 0!==localVideoStreams&&localVideoStreams.length>0?!!localVideoFromCall:previewOn,cameras:deviceManager.cameras,selectedCamera:deviceManager.selectedCamera}})),screenShareButtonSelector=es.a([getIsScreenSharingOn],(function(isScreenSharingOn){return{checked:isScreenSharingOn}})),devicesButtonSelector=es.a([getDeviceManager],(function(deviceManager){return{microphones:deviceManager.microphones,speakers:deviceManager.speakers,cameras:deviceManager.cameras,selectedMicrophone:deviceManager.selectedMicrophone,selectedSpeaker:deviceManager.selectedSpeaker,selectedCamera:deviceManager.selectedCamera}})),sdk_bundle=(__webpack_require__(122),__webpack_require__(95)),memoize_one_esm=__webpack_require__(153);function createHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function createHandlers_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){createHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){createHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var areStreamsEqual=function areStreamsEqual(prevStream,newStream){return!!prevStream&&!!newStream&&prevStream.source.id===newStream.source.id},createDefaultCallingHandlers=Object(memoize_one_esm.a)((function(callClient,callAgent,deviceManager,call){var onStartLocalVideo=function(){var _ref=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var callId,videoDeviceInfo,cameras,stream;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,onDisposeLocalStreamView();case 2:if(callId=null==call?void 0:call.id,videoDeviceInfo=callClient.getState().deviceManager.selectedCamera){_context.next=10;break}return _context.next=7,null==deviceManager?void 0:deviceManager.getCameras();case 7:cameras=_context.sent,(videoDeviceInfo=cameras&&cameras.length>0?cameras[0]:void 0)&&(null==deviceManager||deviceManager.selectCamera(videoDeviceInfo));case 10:if(callId&&videoDeviceInfo){_context.next=12;break}return _context.abrupt("return");case 12:if(stream=new sdk_bundle.LocalVideoStream(videoDeviceInfo),!call||call.localVideoStreams.find((function(s){return areStreamsEqual(s,stream)}))){_context.next=16;break}return _context.next=16,call.startVideo(stream);case 16:case"end":return _context.stop()}}),_callee)})));return function onStartLocalVideo(){return _ref.apply(this,arguments)}}(),onStopLocalVideo=function(){var _ref2=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee2(stream){var callId;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(callId=null==call?void 0:call.id){_context2.next=3;break}return _context2.abrupt("return");case 3:if(!call||!call.localVideoStreams.find((function(s){return areStreamsEqual(s,stream)}))){_context2.next=8;break}return _context2.next=6,call.stopVideo(stream);case 6:return _context2.next=8,callClient.disposeView(callId,void 0,{source:stream.source,mediaStreamType:stream.mediaStreamType});case 8:case"end":return _context2.stop()}}),_callee2)})));return function onStopLocalVideo(_x){return _ref2.apply(this,arguments)}}(),onToggleCamera=function(){var _ref3=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee3(options){var stream,selectedCamera;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!call||!_isInCall(call.state)){_context3.next=11;break}if(!(stream=call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})))){_context3.next=7;break}return _context3.next=5,onStopLocalVideo(stream);case 5:_context3.next=9;break;case 7:return _context3.next=9,onStartLocalVideo();case 9:_context3.next=21;break;case 11:if(!(selectedCamera=callClient.getState().deviceManager.selectedCamera)){_context3.next=21;break}if(!_isPreviewOn(callClient.getState().deviceManager)){_context3.next=19;break}return _context3.next=17,onDisposeLocalStreamView();case 17:_context3.next=21;break;case 19:return _context3.next=21,callClient.createView(void 0,void 0,{source:selectedCamera,mediaStreamType:"Video"},options);case 21:case"end":return _context3.stop()}}),_callee3)})));return function onToggleCamera(_x2){return _ref3.apply(this,arguments)}}(),onSelectMicrophone=function(){var _ref4=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee4(device){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(deviceManager){_context4.next=2;break}return _context4.abrupt("return");case 2:return _context4.abrupt("return",deviceManager.selectMicrophone(device));case 3:case"end":return _context4.stop()}}),_callee4)})));return function onSelectMicrophone(_x3){return _ref4.apply(this,arguments)}}(),onSelectSpeaker=function(){var _ref5=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee5(device){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(deviceManager){_context5.next=2;break}return _context5.abrupt("return");case 2:return _context5.abrupt("return",deviceManager.selectSpeaker(device));case 3:case"end":return _context5.stop()}}),_callee5)})));return function onSelectSpeaker(_x4){return _ref5.apply(this,arguments)}}(),onSelectCamera=function(){var _ref6=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee6(device,options){var stream;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(deviceManager){_context6.next=2;break}return _context6.abrupt("return");case 2:if(!call||!_isInCall(call.state)){_context6.next=8;break}return deviceManager.selectCamera(device),stream=call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})),_context6.abrupt("return",null==stream?void 0:stream.switchSource(device));case 8:if(_isPreviewOn(callClient.getState().deviceManager)){_context6.next=12;break}return deviceManager.selectCamera(device),_context6.abrupt("return");case 12:return _context6.next=14,onDisposeLocalStreamView();case 14:return deviceManager.selectCamera(device),_context6.next=17,callClient.createView(void 0,void 0,{source:device,mediaStreamType:"Video"},options);case 17:case"end":return _context6.stop()}}),_callee6)})));return function onSelectCamera(_x5,_x6){return _ref6.apply(this,arguments)}}(),onToggleMicrophone=function(){var _ref7=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(call&&_isInCall(call.state)){_context7.next=2;break}throw new Error("Please invoke onToggleMicrophone after call is started");case 2:if(!call.isMuted){_context7.next=8;break}return _context7.next=5,call.unmute();case 5:_context7.t0=_context7.sent,_context7.next=11;break;case 8:return _context7.next=10,call.mute();case 10:_context7.t0=_context7.sent;case 11:return _context7.abrupt("return",_context7.t0);case 12:case"end":return _context7.stop()}}),_callee7)})));return function onToggleMicrophone(){return _ref7.apply(this,arguments)}}(),onStartScreenShare=function(){var _ref8=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,null==call?void 0:call.startScreenSharing();case 2:return _context8.abrupt("return",_context8.sent);case 3:case"end":return _context8.stop()}}),_callee8)})));return function onStartScreenShare(){return _ref8.apply(this,arguments)}}(),onStopScreenShare=function(){var _ref9=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,null==call?void 0:call.stopScreenSharing();case 2:return _context9.abrupt("return",_context9.sent);case 3:case"end":return _context9.stop()}}),_callee9)})));return function onStopScreenShare(){return _ref9.apply(this,arguments)}}(),onToggleScreenShare=function(){var _ref10=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee10(){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(null==call||!call.isScreenSharingOn){_context10.next=6;break}return _context10.next=3,onStopScreenShare();case 3:_context10.t0=_context10.sent,_context10.next=9;break;case 6:return _context10.next=8,onStartScreenShare();case 8:_context10.t0=_context10.sent;case 9:return _context10.abrupt("return",_context10.t0);case 10:case"end":return _context10.stop()}}),_callee10)})));return function onToggleScreenShare(){return _ref10.apply(this,arguments)}}(),onHangUp=function(){var _ref11=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,null==call?void 0:call.hangUp();case 2:return _context11.abrupt("return",_context11.sent);case 3:case"end":return _context11.stop()}}),_callee11)})));return function onHangUp(){return _ref11.apply(this,arguments)}}(),onCreateLocalStreamView=function(){var _ref12=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee12(options){var callState,localStream;return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:if(call&&0!==call.localVideoStreams.length){_context12.next=2;break}return _context12.abrupt("return");case 2:if(callState=callClient.getState().calls[call.id]){_context12.next=5;break}return _context12.abrupt("return");case 5:if(localStream=callState.localVideoStreams.find((function(item){return"Video"===item.mediaStreamType}))){_context12.next=8;break}return _context12.abrupt("return");case 8:return _context12.abrupt("return",callClient.createView(call.id,void 0,localStream,options));case 9:case"end":return _context12.stop()}}),_callee12)})));return function onCreateLocalStreamView(_x7){return _ref12.apply(this,arguments)}}(),onCreateRemoteStreamView=function(){var _ref13=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee13(userId){var options,callState,participant,remoteVideoStream,screenShareStream,_args13=arguments;return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:if(options=_args13.length>1&&void 0!==_args13[1]?_args13[1]:{scalingMode:"Crop"},call){_context13.next=3;break}return _context13.abrupt("return");case 3:if(callState=callClient.getState().calls[call.id]){_context13.next=6;break}throw new Error("Call Not Found: "+call.id);case 6:if((participant=Object.values(callState.remoteParticipants).find((function(participant){return Object(src.g)(participant.identifier)===userId})))&&participant.videoStreams){_context13.next=9;break}return _context13.abrupt("return");case 9:remoteVideoStream=Object.values(participant.videoStreams).find((function(i){return"Video"===i.mediaStreamType})),screenShareStream=Object.values(participant.videoStreams).find((function(i){return"ScreenSharing"===i.mediaStreamType})),remoteVideoStream&&remoteVideoStream.isAvailable&&!remoteVideoStream.view&&callClient.createView(call.id,participant.identifier,remoteVideoStream,options),screenShareStream&&screenShareStream.isAvailable&&!screenShareStream.view&&callClient.createView(call.id,participant.identifier,screenShareStream,{scalingMode:"Fit"});case 13:case"end":return _context13.stop()}}),_callee13)})));return function onCreateRemoteStreamView(_x8){return _ref13.apply(this,arguments)}}(),onDisposeRemoteStreamView=function(){var _ref14=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee14(userId){var callState,participant,remoteVideoStream,screenShareStream;return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:if(call){_context14.next=2;break}return _context14.abrupt("return");case 2:if(callState=callClient.getState().calls[call.id]){_context14.next=5;break}throw new Error("Call Not Found: "+call.id);case 5:if((participant=Object.values(callState.remoteParticipants).find((function(participant){return Object(src.g)(participant.identifier)===userId})))&&participant.videoStreams){_context14.next=8;break}return _context14.abrupt("return");case 8:remoteVideoStream=Object.values(participant.videoStreams).find((function(i){return"Video"===i.mediaStreamType})),screenShareStream=Object.values(participant.videoStreams).find((function(i){return"ScreenSharing"===i.mediaStreamType})),remoteVideoStream&&remoteVideoStream.view&&callClient.disposeView(call.id,participant.identifier,remoteVideoStream),screenShareStream&&screenShareStream.view&&callClient.disposeView(call.id,participant.identifier,screenShareStream);case 12:case"end":return _context14.stop()}}),_callee14)})));return function onDisposeRemoteStreamView(_x9){return _ref14.apply(this,arguments)}}(),onDisposeLocalStreamView=function(){var _ref15=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee15(){return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return _context15.next=2,disposeAllLocalPreviewViews(callClient);case 2:case"end":return _context15.stop()}}),_callee15)})));return function onDisposeLocalStreamView(){return _ref15.apply(this,arguments)}}();return{onHangUp:onHangUp,onSelectCamera:onSelectCamera,onSelectMicrophone:onSelectMicrophone,onSelectSpeaker:onSelectSpeaker,onStartCall:function onStartCall(participants,options){return callAgent?callAgent.startCall(participants,options):void 0},onStartScreenShare:onStartScreenShare,onStopScreenShare:onStopScreenShare,onToggleCamera:onToggleCamera,onToggleMicrophone:onToggleMicrophone,onToggleScreenShare:onToggleScreenShare,onCreateLocalStreamView:onCreateLocalStreamView,onCreateRemoteStreamView:onCreateRemoteStreamView,onRemoveParticipant:function(){var _ref16=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee16(userId){return regeneratorRuntime.wrap((function _callee16$(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:return _context16.next=2,null==call?void 0:call.removeParticipant(Object(src.e)(userId));case 2:case"end":return _context16.stop()}}),_callee16)})));return function onRemoveParticipant(_x10){return _ref16.apply(this,arguments)}}(),onStartLocalVideo:onStartLocalVideo,onDisposeRemoteStreamView:onDisposeRemoteStreamView,onDisposeLocalStreamView:onDisposeLocalStreamView}})),react=(__webpack_require__(7),__webpack_require__(1)),jsx_runtime=__webpack_require__(2),CallAgentContext=Object(react.createContext)(void 0),CallAgentProvider_CallAgentProviderBase=function CallAgentProviderBase(props){var initialState={callAgent:props.callAgent};return Object(jsx_runtime.jsx)(CallAgentContext.Provider,{value:initialState,children:props.children})};CallAgentProvider_CallAgentProviderBase.displayName="CallAgentProviderBase";var CallAgentProvider_CallAgentProvider=function CallAgentProvider(props){return Object(jsx_runtime.jsx)(CallAgentProvider_CallAgentProviderBase,Object.assign({},props))};CallAgentProvider_CallAgentProvider.displayName="CallAgentProvider";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CallClientProvider_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallClientProvider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallClientProvider_arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallClientProvider_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}CallAgentProvider_CallAgentProvider.__docgenInfo={description:"A {@link React.Context} that stores a {@link @azure/communication-calling#CallAgent}.\n\nCalling components from this package must be wrapped with a {@link CallAgentProvider}.\n\n@public",methods:[],displayName:"CallAgentProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},callAgent:{required:!1,tsType:{name:"CallAgent"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../calling-component-bindings/src/providers/CallAgentProvider.tsx"]={name:"CallAgentProvider",docgenInfo:CallAgentProvider_CallAgentProvider.__docgenInfo,path:"../calling-component-bindings/src/providers/CallAgentProvider.tsx"});var CallClientContext=Object(react.createContext)(void 0),CallClientProvider_CallClientProviderBase=function CallClientProviderBase(props){var callClient=props.callClient,_useState2=_slicedToArray(Object(react.useState)(void 0),2),deviceManager=_useState2[0],setDeviceManager=_useState2[1];Object(react.useEffect)((function(){callClient.getDeviceManager().then((function(manager){manager.getCameras(),manager.getMicrophones(),manager.getSpeakers(),setDeviceManager(manager)})).catch((function(error){throw new Error(error)}))}),[callClient]);var initialState={callClient:callClient,deviceManager:deviceManager};return Object(jsx_runtime.jsx)(CallClientContext.Provider,{value:initialState,children:props.children})};CallClientProvider_CallClientProviderBase.displayName="CallClientProviderBase";var CallClientProvider_CallClientProvider=function CallClientProvider(props){return Object(jsx_runtime.jsx)(CallClientProvider_CallClientProviderBase,Object.assign({},props))};CallClientProvider_CallClientProvider.displayName="CallClientProvider";CallClientProvider_CallClientProvider.__docgenInfo={description:"A {@link React.Context} that stores a {@link StatefulCallClient}.\n\nCalling components from this package must be wrapped with a {@link CallClientProvider}.\n\n@public",methods:[],displayName:"CallClientProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},callClient:{required:!0,tsType:{name:"StatefulCallClient"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../calling-component-bindings/src/providers/CallClientProvider.tsx"]={name:"CallClientProvider",docgenInfo:CallClientProvider_CallClientProvider.__docgenInfo,path:"../calling-component-bindings/src/providers/CallClientProvider.tsx"});var CallContext=Object(react.createContext)(void 0),CallProvider_CallProviderBase=function CallProviderBase(props){var children=props.children,initialState={call:props.call};return Object(jsx_runtime.jsx)(CallContext.Provider,{value:initialState,children:children})};CallProvider_CallProviderBase.displayName="CallProviderBase";var CallProvider_CallProvider=function CallProvider(props){return Object(jsx_runtime.jsx)(CallProvider_CallProviderBase,Object.assign({},props))};CallProvider_CallProvider.displayName="CallProvider";CallProvider_CallProvider.__docgenInfo={description:"A {@link React.Context} that stores a {@link @azure/communication-calling#Call}.\n\nCalling components from this package must be wrapped with a {@link CallProvider}.\n\n@public",methods:[],displayName:"CallProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},call:{required:!1,tsType:{name:"Call"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../calling-component-bindings/src/providers/CallProvider.tsx"]={name:"CallProvider",docgenInfo:CallProvider_CallProvider.__docgenInfo,path:"../calling-component-bindings/src/providers/CallProvider.tsx"});var react_components_src=__webpack_require__(21),checkIsSpeaking=(__webpack_require__(125),__webpack_require__(70),function checkIsSpeaking(participant){return participant.isSpeaking&&!participant.isMuted}),videoGalleryUtils_dominantSpeakersWithFlatId=(__webpack_require__(34),__webpack_require__(62),function _dominantSpeakersWithFlatId(dominantSpeakers){var _dominantSpeakers$spe;return null==dominantSpeakers||null===(_dominantSpeakers$spe=dominantSpeakers.speakersList)||void 0===_dominantSpeakers$spe?void 0:_dominantSpeakers$spe.map(src.g)}),videoGalleryUtils_videoGalleryRemoteParticipantsMemo=function _videoGalleryRemoteParticipantsMemo(remoteParticipants){return remoteParticipants?memoizedAllConvertRemoteParticipant((function(memoizedFn){return Object.values(remoteParticipants).filter((function(participant){return"InLobby"!==participant.state})).map((function(participant){return memoizedFn(Object(src.g)(participant.identifier),participant.isMuted,checkIsSpeaking(participant),participant.videoStreams,participant.displayName)}))})):[]},memoizedAllConvertRemoteParticipant=Object(src.f)((function(userId,isMuted,isSpeaking,videoStreams,displayName){return convertRemoteParticipantToVideoGalleryRemoteParticipant(userId,isMuted,isSpeaking,videoStreams,displayName)})),convertRemoteParticipantToVideoGalleryRemoteParticipant=function convertRemoteParticipantToVideoGalleryRemoteParticipant(userId,isMuted,isSpeaking,videoStreams,displayName){var rawVideoStreamsArray=Object.values(videoStreams),videoStream=void 0,screenShareStream=void 0;return rawVideoStreamsArray[0]&&("Video"===rawVideoStreamsArray[0].mediaStreamType?videoStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0]):screenShareStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0])),rawVideoStreamsArray[1]&&("ScreenSharing"===rawVideoStreamsArray[1].mediaStreamType?screenShareStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1]):videoStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1])),{userId:userId,displayName:displayName,isMuted:isMuted,isSpeaking:isSpeaking,videoStream:videoStream,screenShareStream:screenShareStream,isScreenSharingOn:void 0!==screenShareStream&&screenShareStream.isAvailable}},convertRemoteVideoStreamToVideoGalleryStream=function convertRemoteVideoStreamToVideoGalleryStream(stream){var _stream$view,_stream$view2;return{id:stream.id,isAvailable:stream.isAvailable,isMirrored:null===(_stream$view=stream.view)||void 0===_stream$view?void 0:_stream$view.isMirrored,renderElement:null===(_stream$view2=stream.view)||void 0===_stream$view2?void 0:_stream$view2.target}},videoGallerySelector=Object(es.a)([function getScreenShareRemoteParticipant(state,props){var _state$calls$props$ca6;return null===(_state$calls$props$ca6=state.calls[props.callId])||void 0===_state$calls$props$ca6?void 0:_state$calls$props$ca6.screenShareRemoteParticipant},getRemoteParticipants,getLocalVideoStreams,getIsMuted,getIsScreenSharingOn,getDisplayName,baseSelectors_getIdentifier,function getDominantSpeakers(state,props){var _state$calls$props$ca;return null===(_state$calls$props$ca=state.calls[props.callId])||void 0===_state$calls$props$ca?void 0:_state$calls$props$ca.dominantSpeakers}],(function(screenShareRemoteParticipantId,remoteParticipants,localVideoStreams,isMuted,isScreenSharingOn,displayName,identifier,dominantSpeakers){var _localVideoStream$vie,_localVideoStream$vie2,screenShareRemoteParticipant=screenShareRemoteParticipantId&&remoteParticipants?remoteParticipants[screenShareRemoteParticipantId]:void 0,localVideoStream=null==localVideoStreams?void 0:localVideoStreams.find((function(i){return"Video"===i.mediaStreamType})),dominantSpeakerIds=videoGalleryUtils_dominantSpeakersWithFlatId(dominantSpeakers),dominantSpeakersMap={};return null==dominantSpeakerIds||dominantSpeakerIds.forEach((function(speaker,idx){return dominantSpeakersMap[speaker]=idx})),{screenShareParticipant:screenShareRemoteParticipant?convertRemoteParticipantToVideoGalleryRemoteParticipant(Object(src.g)(screenShareRemoteParticipant.identifier),screenShareRemoteParticipant.isMuted,checkIsSpeaking(screenShareRemoteParticipant),screenShareRemoteParticipant.videoStreams,screenShareRemoteParticipant.displayName):void 0,localParticipant:{userId:identifier,displayName:null!=displayName?displayName:"",isMuted:isMuted,isScreenSharingOn:isScreenSharingOn,videoStream:{isAvailable:!!localVideoStream,isMirrored:null==localVideoStream||null===(_localVideoStream$vie=localVideoStream.view)||void 0===_localVideoStream$vie?void 0:_localVideoStream$vie.isMirrored,renderElement:null==localVideoStream||null===(_localVideoStream$vie2=localVideoStream.view)||void 0===_localVideoStream$vie2?void 0:_localVideoStream$vie2.target}},remoteParticipants:videoGalleryUtils_videoGalleryRemoteParticipantsMemo(remoteParticipants),dominantSpeakers:dominantSpeakerIds}})),identifierModels=(__webpack_require__(426),__webpack_require__(355),__webpack_require__(437)),participantListSelector=Object(es.a)([baseSelectors_getIdentifier,getDisplayName,getRemoteParticipants,getIsScreenSharingOn,getIsMuted],(function(userId,displayName,remoteParticipants,isScreenSharingOn,isMuted){var participants=remoteParticipants?function convertRemoteParticipantsToParticipantListParticipants(remoteParticipants){return remoteParticipants.filter((function(participant){return"InLobby"!==participant.state})).map((function(participant){var isScreenSharing=Object.values(participant.videoStreams).some((function(videoStream){return"ScreenSharing"===videoStream.mediaStreamType&&videoStream.isAvailable}));return{userId:Object(src.g)(participant.identifier),displayName:participant.displayName,state:participant.state,isMuted:participant.isMuted,isScreenSharing:isScreenSharing,isSpeaking:participant.isSpeaking,isRemovable:"communicationUser"===Object(identifierModels.a)(participant.identifier).kind}})).sort((function(a,b){var _a$displayName,_b$displayName,nameA=(null===(_a$displayName=a.displayName)||void 0===_a$displayName?void 0:_a$displayName.toLowerCase())||"",nameB=(null===(_b$displayName=b.displayName)||void 0===_b$displayName?void 0:_b$displayName.toLowerCase())||"";return nameA<nameB?-1:nameA>nameB?1:0}))}(Object.values(remoteParticipants)):[];return participants.push({userId:userId,displayName:displayName,isScreenSharing:isScreenSharingOn,isMuted:isMuted,state:"Connected",isRemovable:!1}),{participants:participants,myUserId:userId}})),participantsButtonSelector=Object(es.a)([participantListSelector],(function(participantListProps){return participantListProps}));__webpack_require__(296);var errorBarSelector=Object(es.a)([function getLatestErrors(state){return state.latestErrors},function getDiagnostics(state,props){var _state$calls$props$ca7;return null===(_state$calls$props$ca7=state.calls[props.callId])||void 0===_state$calls$props$ca7?void 0:_state$calls$props$ca7.diagnostics},getDeviceManager],(function(latestErrors,diagnostics,deviceManager){var _diagnostics$network$,_diagnostics$network$2,_deviceManager$device,_deviceManager$device2,activeErrorMessages=[];return(null==diagnostics||null===(_diagnostics$network$=diagnostics.network.latest.networkReceiveQuality)||void 0===_diagnostics$network$?void 0:_diagnostics$network$.value)!==sdk_bundle.DiagnosticQuality.Bad&&(null==diagnostics||null===(_diagnostics$network$2=diagnostics.network.latest.networkReceiveQuality)||void 0===_diagnostics$network$2?void 0:_diagnostics$network$2.value)!=sdk_bundle.DiagnosticQuality.Poor||activeErrorMessages.push({type:"callNetworkQualityLow"}),null!=diagnostics&&diagnostics.media.latest.noSpeakerDevicesEnumerated&&activeErrorMessages.push({type:"callNoSpeakerFound"}),null!=diagnostics&&diagnostics.media.latest.noMicrophoneDevicesEnumerated&&activeErrorMessages.push({type:"callNoMicrophoneFound"}),(!1===(null===(_deviceManager$device=deviceManager.deviceAccess)||void 0===_deviceManager$device?void 0:_deviceManager$device.audio)||null!=diagnostics&&diagnostics.media.latest.microphoneNotFunctioning)&&activeErrorMessages.push({type:"callMicrophoneAccessDenied"}),null!=diagnostics&&diagnostics.media.latest.microphoneMuteUnexpectedly&&activeErrorMessages.push({type:"callMicrophoneMutedBySystem"}),null!=diagnostics&&diagnostics.media.latest.microphonePermissionDenied&&activeErrorMessages.push({type:"callMacOsMicrophoneAccessDenied"}),!1===(null===(_deviceManager$device2=deviceManager.deviceAccess)||void 0===_deviceManager$device2?void 0:_deviceManager$device2.video)?activeErrorMessages.push({type:"callCameraAccessDenied"}):null!=diagnostics&&diagnostics.media.latest.cameraFreeze&&activeErrorMessages.push({type:"callCameraAlreadyInUse"}),null!=diagnostics&&diagnostics.media.latest.cameraPermissionDenied&&activeErrorMessages.push({type:"callMacOsCameraAccessDenied"}),null!=diagnostics&&diagnostics.media.latest.screenshareRecordingDisabled&&activeErrorMessages.push({type:"callMacOsScreenShareAccessDenied"}),appendActiveErrorIfDefined(activeErrorMessages,latestErrors,"Call.stopVideo","stopVideoGeneric"),appendActiveErrorIfDefined(activeErrorMessages,latestErrors,"Call.mute","muteGeneric"),appendActiveErrorIfDefined(activeErrorMessages,latestErrors,"Call.stopScreenSharing","stopScreenShareGeneric"),appendActiveErrorIfDefined(activeErrorMessages,latestErrors,"Call.startVideo","startVideoGeneric"),appendActiveErrorIfDefined(activeErrorMessages,latestErrors,"Call.unmute","unmuteGeneric"),activeErrorMessages.splice(maxErrorCount),{activeErrorMessages:activeErrorMessages}})),appendActiveErrorIfDefined=function appendActiveErrorIfDefined(activeErrorMessages,latestErrors,target,activeErrorType){void 0!==latestErrors[target]&&activeErrorMessages.push({type:activeErrorType,timestamp:latestErrors[target].timestamp})},maxErrorCount=3,emptySelector=function emptySelector(){return{}},getSelector=function getSelector(component){return usePropsFor_findSelector(component)},usePropsFor_findSelector=function findSelector(component){switch(component){case react_components_src.J:return videoGallerySelector;case react_components_src.B:return microphoneButtonSelector;case react_components_src.o:return cameraButtonSelector;case react_components_src.F:return screenShareButtonSelector;case react_components_src.s:return devicesButtonSelector;case react_components_src.D:return participantListSelector;case react_components_src.E:return participantsButtonSelector;case react_components_src.t:return emptySelector;case react_components_src.u:return errorBarSelector}}},880:function(module){module.exports=JSON.parse('{"call":{"cameraLabel":"","cameraPermissionDenied":"","cameraTurnedOff":"","close":"","complianceBannerNowOnlyRecording":"","complianceBannerNowOnlyTranscription":"","complianceBannerRecordingAndTranscriptionSaved":"","complianceBannerRecordingAndTranscriptionStarted":"","complianceBannerRecordingAndTranscriptionStopped":"","complianceBannerRecordingSaving":"","complianceBannerRecordingStarted":"","complianceBannerRecordingStopped":"","complianceBannerTranscriptionStarted":"","complianceBannerTranscriptionConsent":"","complianceBannerTranscriptionSaving":"","complianceBannerTranscriptionStopped":"","configurationPageTitle":"","defaultPlaceHolder":"","failedToJoinCallDueToNoNetworkMoreDetails":"","failedToJoinCallDueToNoNetworkTitle":"","failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails":"","failedToJoinTeamsMeetingReasonAccessDeniedTitle":"","learnMore":"","leftCallMoreDetails":"","leftCallTitle":"","lobbyScreenConnectingToCallTitle":"","lobbyScreenWaitingToBeAdmittedTitle":"","microphonePermissionDenied":"","mutedMessage":"","networkReconnectMoreDetails":"","networkReconnectTitle":"","privacyPolicy":"","rejoinCallButtonLabel":"","removedFromCallMoreDetails":"","removedFromCallTitle":"","soundLabel":"","startCallButtonLabel":"","microphoneToggleInLobbyNotAllowed":""},"chat":{"chatListHeader":""},"callWithChat":{"peopleButtonLabel":"","chatButtonLabel":"","moreDrawerMicrophoneMenuTitle":"Microphone","moreDrawerSpeakerMenuTitle":"Speaker","peoplePaneTitle":"","peoplePaneSubTitle":"","chatPaneTitle":"","chatButtonNewMessageNotificationLabel":"","pictureInPictureTileAriaLabel":""}}')},91:function(module,__webpack_exports__,__webpack_require__){"use strict";var _LocalizationProvider__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(441);__webpack_require__.d(__webpack_exports__,"a",(function(){return _LocalizationProvider__WEBPACK_IMPORTED_MODULE_0__.a})),__webpack_require__.d(__webpack_exports__,"b",(function(){return _LocalizationProvider__WEBPACK_IMPORTED_MODULE_0__.b}))},92:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"l",(function(){return sidePaneContainerStyles})),__webpack_require__.d(__webpack_exports__,"k",(function(){return sidePaneContainerHiddenStyles})),__webpack_require__.d(__webpack_exports__,"m",(function(){return sidePaneContainerTokens})),__webpack_require__.d(__webpack_exports__,"n",(function(){return sidePaneHeaderStyles})),__webpack_require__.d(__webpack_exports__,"b",(function(){return paneBodyContainer})),__webpack_require__.d(__webpack_exports__,"i",(function(){return scrollableContainer})),__webpack_require__.d(__webpack_exports__,"j",(function(){return scrollableContainerContents})),__webpack_require__.d(__webpack_exports__,"h",(function(){return peopleSubheadingStyle})),__webpack_require__.d(__webpack_exports__,"g",(function(){return peoplePaneContainerTokens})),__webpack_require__.d(__webpack_exports__,"f",(function(){return participantListWrapper})),__webpack_require__.d(__webpack_exports__,"c",(function(){return participantListContainerPadding})),__webpack_require__.d(__webpack_exports__,"a",(function(){return listHeader})),__webpack_require__.d(__webpack_exports__,"d",(function(){return participantListStack})),__webpack_require__.d(__webpack_exports__,"e",(function(){return participantListStyle}));__webpack_require__(7);var _fluentui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(22),sidePaneContainerStyles={root:{height:"100%",paddingTop:"0.5rem",paddingBottom:"0.5rem",width:"21.5rem"}},sidePaneContainerHiddenStyles={root:Object.assign({},sidePaneContainerStyles,{display:"none"})},sidePaneContainerTokens={childrenGap:"0.5rem"},sidePaneHeaderStyles={root:{fontSize:"0.825rem",lineHeight:"1.25rem",padding:"0.25rem",fontWeight:"600"}},paneBodyContainer={root:{flexDirection:"column",display:"flex"}},scrollableContainer={root:{flexBasis:"0",flexGrow:"1",overflowY:"auto"}},scrollableContainerContents={root:{flexGrow:"1",flexBasis:"0"}},peopleSubheadingStyle={root:{fontSize:"0.75rem"}},peoplePaneContainerTokens={childrenGap:"0.5rem"},participantListWrapper=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.H)({width:"20rem",maxWidth:"50vw",height:"100%"}),participantListContainerPadding={childrenGap:"0.5rem"},listHeader=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.H)({fontSize:"1rem",margin:"1rem"}),participantListStack=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.H)({height:"100%"}),participantListStyle=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.H)({height:"100%",overflowY:"auto",overflowX:"hidden"})},934:function(module,exports,__webpack_require__){__webpack_require__(935),__webpack_require__(1094),__webpack_require__(1095),__webpack_require__(1487),__webpack_require__(1472),__webpack_require__(1497),__webpack_require__(1480),module.exports=__webpack_require__(1352)},94:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return usePropsFor}));__webpack_require__(7);var _internal_calling_component_bindings__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(88),_useAdaptedSelector__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(312),_useHandlers__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(142),usePropsFor=function usePropsFor(component){var selector=Object(_internal_calling_component_bindings__WEBPACK_IMPORTED_MODULE_1__.f)(component);if(!selector)throw new Error("Can't find the selector for component, please check supported component list");return Object.assign({},Object(_useAdaptedSelector__WEBPACK_IMPORTED_MODULE_2__.a)(selector),Object(_useHandlers__WEBPACK_IMPORTED_MODULE_3__.a)(component))}}},[[934,2,3]]]);